<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ansible AWX community documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/ansible.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/rtd-ethical-ads.css" type="text/css" />
    <link rel="shortcut icon" href="_static/images/Ansible-Mark-RGB_Black.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /><!-- extra head elements for Ansible beyond RTD Sphinx Theme -->




</head>

<body class="wy-body-for-nav"><!-- extra body elements for Ansible beyond RTD Sphinx Theme -->

<div class="DocSite-globalNav ansibleNav">
  <ul>
    <li><a href="https://www.ansible.com/ansiblefest" target="_blank">AnsibleFest</a></li>
    <li><a href="https://www.ansible.com/tower" target="_blank">Products</a></li>
    <li><a href="https://www.ansible.com/community" target="_blank">Community</a></li>
    <li><a href="https://www.ansible.com/webinars-training" target="_blank">Webinars & Training</a></li>
    <li><a href="https://www.ansible.com/blog" target="_blank">Blog</a></li>
  </ul>
</div>

<a class="DocSite-nav" href="/" style="padding-bottom: 30px;">

  <img class="DocSiteNav-logo"
    src="_static/images/Ansible-Mark-RGB_White.png"
    alt="Ansible Logo">
  <div class="DocSiteNav-title">AWX community documentation</div>
</a>
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            Ansible AWX
          </a>
              <div class="version">
                latest
              </div><!--- Based on https://github.com/rtfd/sphinx_rtd_theme/pull/438/files -->

<div class="version">
  
    latest
  
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
              <p class="caption" role="heading"><span class="caption-text">Get started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-quickstart/index">AWX Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-contributor/index">AWX Contributor’s Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Users</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-userguide/index">Automating with AWX</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-rest_api/index">AWX API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Administrators</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-administration/index">Administering AWX Deployments</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-upgrade_migration/index">Upgrades and Migrations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Release notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-release_notes/index">Release Notes</a></li>
</ul>
<!-- extra nav elements for Ansible beyond RTD Sphinx Theme -->

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Ansible AWX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Ansible AWX community documentation</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">

  
           <div itemprop="articleBody">
             
  <section id="ansible-awx-documentation">
<h1>Ansible AWX Documentation<a class="headerlink" href="#ansible-awx-documentation" title="Link to this heading"></a></h1>
<p>Ansible AWX helps teams manage complex multi-tier deployments by adding control, knowledge, and delegation to Ansible-powered environments.</p>
<div class="toctree-wrapper compound">
<span id="document-quickstart/index"></span><section id="awx-quickstart">
<span id="qs-start"></span><h2>AWX Quickstart<a class="headerlink" href="#awx-quickstart" title="Link to this heading"></a></h2>
<p>Complete the basic steps for using AWX and running your first playbook.</p>
<p>This guide applies to the latest version of AWX only.
The content in this guide is updated frequently and might contain functionality that is not available in previous versions.
Likewise content in this guide can be removed or replaced if it applies to functionality that is no longer available in the latest version.</p>
<p><strong>Join us online</strong></p>
<p>We talk about AWX documentation on Matrix at <a class="reference external" href="index.html#docs:ansible.im">#docs:ansible.im</a> and on libera IRC at <code class="docutils literal notranslate"><span class="pre">#ansible-docs</span></code> if you ever want to join us and chat about the docs!</p>
<p>You can also find lots of AWX discussion and get answers to questions at <a class="reference external" href="https://forum.ansible.com/">forum.ansible.com</a>.</p>
<div class="toctree-wrapper compound">
<span id="document-quickstart/quick_start"></span><section id="quick-start">
<h3><span class="section-number">1. </span>Quick Start<a class="headerlink" href="#quick-start" title="Link to this heading"></a></h3>
<p id="index-0">Welcome to the AWX Quick Start Guide. At the end of the Quick Start, you will have a functioning AWX application that you can use to launch more sophisticated playbooks. You can expect the Quick Start process to take less than thirty minutes.</p>
<p>To begin, you must install AWX and you must choose a target system where an initial playbook can be deployed (provided by AWX).</p>
<p>This first playbook executes simple Ansible tasks, while teaching you how to use AWX, as well as ensuring its proper setup. This can be any sort of system manageable by Ansible, as described in the <a class="reference external" href="https://docs.ansible.com/ansible/latest/user_guide/basic_concepts.html#managed-nodes">Managed nodes</a> section of the Ansible documentation.</p>
</section>
<span id="document-quickstart/login_superuser"></span><section id="login-as-a-superuser">
<h3><span class="section-number">2. </span>Login as a Superuser<a class="headerlink" href="#login-as-a-superuser" title="Link to this heading"></a></h3>
<p id="index-0">Using the login information provided after your installation completed, open a web browser and log in to AWX by browsing to its server URL at: <code class="docutils literal notranslate"><span class="pre">https://&lt;AWX_SERVER_NAME&gt;/</span></code></p>
<p>Once the AWX UI is accessible, use the credentials specified during the installation process to login. The default username is <code class="docutils literal notranslate"><span class="pre">admin</span></code>. The password for <code class="docutils literal notranslate"><span class="pre">admin</span></code> is the value specified for <code class="docutils literal notranslate"><span class="pre">admin_password</span></code> in your inventory file.</p>
<p>These defaults can be changed later by clicking <strong>Users</strong> from the left navigation bar.</p>
<p><img alt="Login form" src="_images/qs-login-form.png" /></p>
</section>
<span id="document-quickstart/examine_dashboard"></span><section id="examine-the-awx-dashboard">
<h3><span class="section-number">3. </span>Examine the AWX Dashboard<a class="headerlink" href="#examine-the-awx-dashboard" title="Link to this heading"></a></h3>
<p id="index-0">The Dashboard offers a friendly graphical framework for your IT orchestration needs. Along the left side of the Dashboard is the navigation menu, where you can quickly display different views, navigate to your resources, grant access, and administer certain AWX features in the UI.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The new AWX User Interface is available for tech preview and is subject to change in a future release. To preview the new UI, click the <strong>Enable Preview of New User Interface</strong> toggle to <strong>On</strong> from the Miscellaneous System option of the Settings menu.</p>
<img alt="_images/configure-awx-system-misc-preview-newui.png" src="_images/configure-awx-system-misc-preview-newui.png" />
<p>After saving, logout and log back in to access the new UI from the preview banner. To return to the current UI, click the link on the top banner where indicated.</p>
<img alt="_images/ug-dashboard-preview-banner.png" src="_images/ug-dashboard-preview-banner.png" />
</div>
<p>Click on the Menu <img alt="menu" src="_images/menu-icon.png" /> icon at the top of the left navigation to hide or display the navigation bar.</p>
<p>On the main Dashboard view, a summary appears listing your current <strong>Job Status</strong>. You can filter the job status within a period of time or by job type. Also available in their respective tabs are summaries of <strong>Recent Jobs</strong> ran and <strong>Recent Templates</strong> used. These can be sorted by various attributes.</p>
<p><img alt="Home dashboard" src="_images/home-dashboard.png" /></p>
<p>The very last item in the navigation bar is <strong>Settings</strong>, which provides access to the AWX configuration Settings.</p>
<p>The Settings page allows administrators to configure authentication, jobs, system-level attributes, customize the user interface, and product license information. Refer to <a class="reference internal" href="index.html#ag-configure-awx"><span class="std std-ref">AWX Configuration</span></a> section for more detail.</p>
<img alt="_images/ug-settings-menu-screen.png" src="_images/ug-settings-menu-screen.png" />
<p>Regardless of the window or action you’re performing, the very top of each page next to the your user icon is the About (<img alt="about" src="_images/help-about-icon.png" />) icon, which provides you the versions of AWX and Ansible you are currently running.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Keep in mind that the goal of this Quick Start is to launch a simple playbook. To do this, a number of configuration options must be setup. Completing the quick start configuration tasks now ensures that tAWX is configured properly and allows for easier executions of more involved playbooks later on.</p>
</div>
</section>
<span id="document-quickstart/setup"></span><section id="the-settings-page">
<h3><span class="section-number">4. </span>The Settings Page<a class="headerlink" href="#the-settings-page" title="Link to this heading"></a></h3>
<p id="index-0">To enter the Settings window for AWX, click <strong>Settings</strong> from the left navigation bar. This page allows you to modify your AWX configuration, such as settings associated with authentication, jobs, system, and user interface.</p>
<img alt="The main settings window for AWX." src="_images/ug-settings-menu-screen.png" />
<p>For more information on configuring these settings, refer to <a class="reference internal" href="index.html#ag-configure-awx"><span class="std std-ref">AWX Configuration</span></a> section of the <em>AWX Administration Guide</em>.</p>
</section>
<span id="document-quickstart/create_organization"></span><section id="review-the-organization">
<h3><span class="section-number">5. </span>Review the Organization<a class="headerlink" href="#review-the-organization" title="Link to this heading"></a></h3>
<p id="index-0">An organization is a logical collection of users, teams, projects, and inventories. It is the highest level object in the AWX object hierarchy.</p>
<p>From the left navigation bar, click <strong>Organizations</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>AWX creates a default organization automatically. Users of Tower with a Self-support level license only have the</p>
</div>
<p><img alt="Organizations - default view" src="_images/organizations-home-showing-example-organization.png" /></p>
<p id="index-1">A default organization has been automatically created and is available to all users of AWX. It can be used as is or edited later as needed, but deleting it is not recommended.</p>
<p>For the purpose of this Quick Start Guide, leave the default organization as is.</p>
<p>To edit the default organization later, expand its properties by clicking the Edit (<img alt="edit" src="_images/edit-button.png" />) button and entering the appropriate details, then save your changes.</p>
<img alt="_images/qs-organization-list-view-edit-icon.png" src="_images/qs-organization-list-view-edit-icon.png" />
<p><img alt="Organizations - default expanded" src="_images/qs-organization-default-expand-properties.png" /></p>
<p>To add a new organization, refer to the <a class="reference internal" href="index.html#ug-organizations"><span class="std std-ref">Organizations</span></a> section in the <em>AWX User Guide</em>.</p>
</section>
<span id="document-quickstart/create_user"></span><section id="create-a-user">
<h3><span class="section-number">6. </span>Create a User<a class="headerlink" href="#create-a-user" title="Link to this heading"></a></h3>
<p id="index-0">Users associated with an organization are shown in the <strong>Access</strong> tab of the Organization.</p>
<p><img alt="Organizations - default admin user" src="_images/qs-organizations-admin-user-default-organization.png" /></p>
<p>A default <cite>admin</cite> user with the role of System Administrator has been automatically created and is available to all users of AWX. It can be used as is or edited later as needed. You may add other users to an organization, but you must create the user(s) first. Refer to the <a class="reference internal" href="index.html#ug-users-create"><span class="std std-ref">Users</span></a> section in the <em>AWX User Guide</em> for detail.</p>
<p>For the purpose of this Quick Start Guide, leave the default user as is.</p>
</section>
<span id="document-quickstart/create_inventory"></span><section id="create-a-new-inventory">
<h3><span class="section-number">7. </span>Create a new Inventory<a class="headerlink" href="#create-a-new-inventory" title="Link to this heading"></a></h3>
<p id="index-0">An inventory is a collection of hosts managed by AWX. Organizations are assigned to inventories, while permissions to launch playbooks against inventories are controlled at the user and/or team level. For more information, refer to <a class="reference internal" href="index.html#ug-inventories"><span class="std std-ref">Inventories</span></a>, <a class="reference internal" href="index.html#ug-users-permissions"><span class="std std-ref">Users - Permissions</span></a>, and <a class="reference internal" href="index.html#ug-teams-permissions"><span class="std std-ref">Teams - Permissions</span></a> in the <em>AWX User Guide</em>.</p>
<p>To view existing inventories, click <strong>Inventories</strong> from the left navigation bar.</p>
<img alt="_images/qs-inventories-default-list-view.png" src="_images/qs-inventories-default-list-view.png" />
<p>automation controller provides a demo inventory for you to use as you learn how AWX works. It can be used as is or edited later as needed. You may create another inventory if necessary. Refer to <a class="reference internal" href="index.html#ug-inventories-add"><span class="std std-ref">Add a new inventory</span></a> in the <em>AWX User Guide</em> for detail.</p>
<p>For the purpose of this Quick Start Guide, leave the default inventory as is.</p>
<p>Click <strong>Demo Inventory</strong> to view its details.</p>
<p><img alt="Inventories - Demo inventory details" src="_images/qs-inventories-demo-details.png" /></p>
<p>As with organizations, inventories also have associated users and teams that you can view through the <strong>Access</strong> tab.</p>
<img alt="_images/qs-inventories-default-access-list-view.png" src="_images/qs-inventories-default-access-list-view.png" />
<p>A default admin user with the role of System Administrator has been automatically populated for this demo inventory.</p>
<section id="groups-and-hosts">
<h4><span class="section-number">7.1. </span>Groups and Hosts<a class="headerlink" href="#groups-and-hosts" title="Link to this heading"></a></h4>
<p>Note that inventories are divided into groups and hosts. A group might represent a particular environment (e.g. “Datacenter 1” or “Stage Testing”), a server type (e.g. “Application Servers” or “DB Servers”), or any other representation of your environment. The groups and hosts that belong to the Demo inventory are shown in the <strong>Groups</strong> and <strong>Hosts</strong> tabs, respectively.</p>
<p>To add new groups, click the <strong>Add</strong> button in the Groups screen.</p>
<p>Similarly, in the <strong>Hosts</strong> tab, click the <strong>Add</strong> button to add hosts to groups.</p>
<p>For the purposes of this Quick Start and to test that AWX is setup properly, a local host has been added for your use.</p>
<img alt="_images/qs-inventories-default-host.png" src="_images/qs-inventories-default-host.png" />
<p>Suppose that the organization you created earlier has a group of web server hosts supporting a particular application. To add these hosts to the inventory, create a group and add the web server hosts.</p>
<p>Click <strong>Cancel</strong> (if no changes were made) or use the breadcrumb navigational links at the top of the automation controller browser to return to the Inventories list view. Clicking <strong>Save</strong> does not exit the Details dialog.</p>
</section>
</section>
<span id="document-quickstart/create_credential"></span><section id="create-a-credential">
<h3><span class="section-number">8. </span>Create a Credential<a class="headerlink" href="#create-a-credential" title="Link to this heading"></a></h3>
<p id="index-0">Credentials authenticate the AWX user to launch Ansible playbooks, which can include passwords and SSH keys, against inventory hosts. You can also require the AWX user to enter a password or key phrase when a playbook launches using the credentials feature of AWX.</p>
<p>Access the list of credentials by clicking <strong>Credentials</strong> from the left navigation bar.</p>
<p><img alt="Credentials - list view" src="_images/qs-credentials-list-view.png" /></p>
<p>For the purpose of this Quick Start, a demo credential and a Galaxy credential have been provided for your use. The provided Galaxy credential serves as a template and can only be copied and not edited. You may add more credentials as necessary.  Refer to <a class="reference internal" href="index.html#ug-credentials-add"><span class="std std-ref">Add a New Credential</span></a> in the <em>AWX User Guide</em> for detail.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When setting up additional credentials, keep in mind that the user you assign must have root access or be able to use SSH to connect to the host machine.</p>
</div>
<p>Click <strong>Demo Credential</strong> to view its details.</p>
<p><img alt="Credentials - review demo credential" src="_images/qs-credentials-demo-details.png" /></p>
<p>For the purpose of this Quick Start Guide, leave the default demo credential as is. But to edit the default credential later - from the Details tab, click <strong>Edit</strong>, or from the Credentials list view, click the Edit (<img alt="edit" src="_images/edit-button.png" />) button next to the credential name to edit the appropriate details, then save your changes.</p>
</section>
<span id="document-quickstart/create_project"></span><section id="setting-up-a-project">
<h3><span class="section-number">9. </span>Setting up a Project<a class="headerlink" href="#setting-up-a-project" title="Link to this heading"></a></h3>
<p id="index-0">A Project is a logical collection of Ansible playbooks, represented in AWX.</p>
<p>You can manage playbooks and playbook directories by either placing them manually under the Project Base Path on your AWX server, or by placing your playbooks into a source code management (SCM) system supported by AWX, including Git, Subversion, and Mercurial.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is recommended that, whenever possible, you use source control to manage your playbooks. This type of best practice provides the ability to treat your infrastructure as code and is in line with DevOps ideals. While this Quick Start Guide uses lightweight examples to get you up and running, we suggest using source control to manage playbook for production purposes.</p>
</div>
<p>To review existing projects, click <strong>Projects</strong> from the left navigation bar.</p>
<p><img alt="Projects - home" src="_images/qs-projects-home.png" /></p>
<p>The automation controller simplifies the startup process by providing you with a Demo Project to work with initially.</p>
<p>Click on <strong>Demo Project</strong> to view its details.</p>
<p><img alt="Projects - demo project" src="_images/qs-demo-project-details.png" /></p>
<p>For the purpose of this Quick Start Guide, leave the default demo project as is. But to edit the default project later - from the Details tab, click <strong>Edit</strong>, or from the Projects list view, click the Edit (<img alt="edit" src="_images/edit-button.png" />) button next to the project name to edit the appropriate details, then save your changes.</p>
<p>If you want to fetch the project for latest changes, you can manually start an SCM sync for this project. Update the SCM-based demo project from the Details tab, click <strong>Sync</strong>, or from the Projects list view, click the Sync (<img alt="sync" src="_images/refresh-button.png" />) button next to the project name.</p>
<img alt="_images/qs-demo-project-sync-icon-hover.png" src="_images/qs-demo-project-sync-icon-hover.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please note that immediately after adding new projects setup to use source control, a “sync” automatically starts that fetches the project details from the configured source control.</p>
</div>
</section>
<span id="document-quickstart/create_job"></span><section id="create-a-new-job-template">
<h3><span class="section-number">10. </span>Create a new Job Template<a class="headerlink" href="#create-a-new-job-template" title="Link to this heading"></a></h3>
<p id="index-0">A job template combines an Ansible playbook from a project and the settings required to launch it. Review existing job templates by clicking <strong>Templates</strong> from the left navigation bar.</p>
<p><img alt="Job templates - home" src="_images/qs-job-templates-list-view.png" /></p>
<p>For the purpose of this Quick Start, a Demo Job Template has been created for your initial use.</p>
<p>Click <strong>Demo Job Template</strong> to view its details.</p>
<p><img alt="Job templates - review demo template" src="_images/qs-job-template-demo-details.png" /></p>
<p>For the purpose of this Quick Start Guide, leave the default demo job template as is. But to edit the default template later - from the Details tab, click <strong>Edit</strong>, or from the Templates list view, click the Edit (<img alt="edit" src="_images/edit-button.png" />) button next to the template name to edit the appropriate details, then save your changes.</p>
<p><img alt="Job templates - edit demo" src="_images/qs-job-templates-demo-edit.png" /></p>
<p>Click <strong>Cancel</strong> (if no changes were made) or use the breadcrumb navigational links at the top of the automation controller browser to return to the Templates list view. Clicking <strong>Save</strong> does not exit the Details dialog.</p>
</section>
<span id="document-quickstart/launch"></span><section id="launch-it">
<h3><span class="section-number">11. </span>Launch it!<a class="headerlink" href="#launch-it" title="Link to this heading"></a></h3>
<p id="index-0">From the Templates list view, click the Launch (<img alt="launch" src="_images/launch-button.png" />) button to run the Demo Job Template.</p>
<p><img alt="Job templates - home launch" src="_images/qs-job-templates-list-view-click-launch.png" /></p>
<p>The initial job launch returns a status page which updates automatically using AWX’s Live Event feature until the job is complete. Once complete, the job results look like the following:</p>
<p><img alt="Job templates - demo run complete" src="_images/qs-job-templates-demo-complete.png" /></p>
<p>For more details on the job results, refer to <a class="reference internal" href="index.html#ug-jobs"><span class="std std-ref">Jobs</span></a>.</p>
<p>Congratulations! Your AWX installation is officially setup and running properly. To learn more about these AWX features or to learn about administration tasks, the AWX API, etc., refer to the following documentation sets:</p>
<ul class="simple">
<li><p><a class="reference internal" href="index.html#ug-start"><span class="std std-ref">AWX User Guide</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ag-start"><span class="std std-ref">AWX Administration Guide</span></a></p></li>
<li><p><a class="reference internal" href="index.html#api-start"><span class="std std-ref">AWX API Guide</span></a></p></li>
<li><p><a class="reference internal" href="index.html#releasenotes-start"><span class="std std-ref">AWX Release Notes</span></a></p></li>
<li><p><a class="reference external" href="http://docs.ansible.com/">Ansible Documentation</a></p></li>
</ul>
</section>
</div>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-contributor/index"></span><section id="awx-contributor-s-guide">
<span id="contributor-guide"></span><h2>AWX Contributor’s Guide<a class="headerlink" href="#awx-contributor-s-guide" title="Link to this heading"></a></h2>
<p>Want to get involved with the AWX community?
Great!
There are so many ways you can contribute to AWX.</p>
<p><strong>Join us online</strong></p>
<p>You can chat with us and ask questions on Matrix at <a class="reference external" href="index.html#awx:ansible.com">#awx:ansible.com</a> or visit the <a class="reference external" href="https://forum.ansible.com/c/project/7/">Ansible Community Forum</a> to find contributor resources.</p>
<div class="toctree-wrapper compound">
<span id="document-contributor/intro"></span><section id="introduction">
<h3><span class="section-number">1. </span>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h3>
<p>Hi there! We’re excited to have you as a contributor.</p>
<p>Have questions about this document or anything not covered here? Come chat with us and ask questions on Matrix at <a class="reference external" href="index.html#awx:ansible.com">#awx:ansible.com</a>.</p>
<p>Also visit the <a class="reference external" href="https://forum.ansible.com/c/project/7/">Ansible Community Forum</a> to find contributor resources where you can also submit your questions or concerns.</p>
</section>
<span id="document-contributor/setting_up"></span><section id="setting-up-your-development-environment">
<h3><span class="section-number">2. </span>Setting up your development environment<a class="headerlink" href="#setting-up-your-development-environment" title="Link to this heading"></a></h3>
<p>The AWX docs are developed using the Python toolchain. The content itself is authored in ReStructuredText (rst).</p>
<section id="prerequisites">
<h4><span class="section-number">2.1. </span>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading"></a></h4>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#fork-and-clone-the-awx-repo" id="id1">Fork and clone the AWX repo</a></p></li>
<li><p><a class="reference internal" href="#install-python-and-setuptools" id="id2">Install python and setuptools</a></p></li>
<li><p><a class="reference internal" href="#run-local-build-of-the-docs" id="id3">Run local build of the docs</a></p></li>
</ul>
</nav>
<section id="fork-and-clone-the-awx-repo">
<h5><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">2.1.1. </span>Fork and clone the AWX repo</a><a class="headerlink" href="#fork-and-clone-the-awx-repo" title="Link to this heading"></a></h5>
<p>If you have not done so already, you’ll need to fork the AWX repo on GitHub. For more on how to do this, see <a class="reference external" href="https://help.github.com/articles/fork-a-repo/">Fork a Repo</a>.</p>
</section>
<section id="install-python-and-setuptools">
<h5><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">2.1.2. </span>Install python and setuptools</a><a class="headerlink" href="#install-python-and-setuptools" title="Link to this heading"></a></h5>
<p>Install the setuptools package on Linux using pip:</p>
<ol class="arabic simple">
<li><p>If not already installed, <a class="reference external" href="https://www.geeksforgeeks.org/how-to-download-and-install-python-latest-version-on-linux/">download the latest version of Python3</a> on your machine.</p></li>
<li><p>Check if pip3 and python3 are correctly installed in your system using the following command:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">python3 --version</span>
<span class="l l-Scalar l-Scalar-Plain">pip3 --version</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Upgrade pip3 to the latest version to prevent installation issues:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">pip3 install --upgrade pip</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Install Setuptools:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">pip3 install setuptools</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Verify whether the Setuptools has been properly installed:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">python3 -c &#39;import setuptools&#39;</span>
</pre></div>
</div>
<p>If no errors are returned, then the package was installed properly.</p>
<ol class="arabic simple" start="6">
<li><p>Install the tox package so you can build the docs locally:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">pip3 install tox</span>
</pre></div>
</div>
</section>
<section id="run-local-build-of-the-docs">
<h5><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">2.1.3. </span>Run local build of the docs</a><a class="headerlink" href="#run-local-build-of-the-docs" title="Link to this heading"></a></h5>
<p>To build the docs on your local machine, use the tox utility. In your forked branch of your AWX repo, run:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">tox -e docs</span>
</pre></div>
</div>
</section>
</section>
<section id="access-the-awx-user-interface">
<h4><span class="section-number">2.2. </span>Access the AWX user interface<a class="headerlink" href="#access-the-awx-user-interface" title="Link to this heading"></a></h4>
<p>To access an instance of the AWX interface, refer to <a class="reference external" href="https://github.com/ansible/awx/blob/devel/CONTRIBUTING.md#setting-up-your-development-environment">Build and run the development environment</a> for detail. Once you have your environment setup, you can access the AWX UI by logging into it at <a class="reference external" href="https://localhost:8043">https://localhost:8043</a>, and access the API directly at <a class="reference external" href="https://localhost:8043/api/">https://localhost:8043/api/</a>.</p>
</section>
</section>
<span id="document-contributor/work_items"></span><section id="what-should-i-work-on">
<h3><span class="section-number">3. </span>What should I work on?<a class="headerlink" href="#what-should-i-work-on" title="Link to this heading"></a></h3>
<section id="good-first-issue">
<h4><span class="section-number">3.1. </span>Good first issue<a class="headerlink" href="#good-first-issue" title="Link to this heading"></a></h4>
<p>We have a <cite>“good first issue” label</cite> &lt;<a class="reference external" href="https://github.com/ansible/awx/issues?q=is%3Aopen+label%3A%22good+first+issue%22+label%3Acomponent%3Adocs+">https://github.com/ansible/awx/issues?q=is%3Aopen+label%3A%22good+first+issue%22+label%3Acomponent%3Adocs+</a>) we put on some doc issues that might be a good starting point for new contributors with the following filter:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">is:open label:&quot;good first issue&quot; label:component:docs</span>
</pre></div>
</div>
<p>Fixing and updating the documentation are always appreciated, so reviewing the backlog of issues is always a good place to start.</p>
</section>
<section id="things-to-know-prior-to-submitting-revisions">
<h4><span class="section-number">3.2. </span>Things to know prior to submitting revisions<a class="headerlink" href="#things-to-know-prior-to-submitting-revisions" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>All doc revisions or additions are done through pull requests against the <code class="docutils literal notranslate"><span class="pre">devel</span></code> branch.</p></li>
<li><p>You must use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">--signoff</span></code> for any commit to be merged, and agree that usage of <code class="docutils literal notranslate"><span class="pre">--signoff</span></code> constitutes agreement with the terms of <a class="reference external" href="https://github.com/ansible/awx/blob/devel/DCO_1_1.md">DCO 1.1</a>.</p></li>
<li><p>Take care to make sure no merge commits are in the submission, and use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span></code> vs <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">merge</span></code> for this reason.
- If collaborating with someone else on the same branch, consider using <code class="docutils literal notranslate"><span class="pre">--force-with-lease</span></code> instead of <code class="docutils literal notranslate"><span class="pre">--force</span></code>. This will prevent you from accidentally overwriting commits pushed by someone else. For more information, see <a class="reference external" href="https://git-scm.com/docs/git-push#git-push---force-with-leaseltrefnamegt">git push docs</a>.</p></li>
<li><p>If submitting a large doc change, it’s a good idea to join the <a class="reference external" href="https://forum.ansible.com/c/project/7/">Ansible Community Forum</a>, and talk about what you would like to do or add first. Use the <code class="docutils literal notranslate"><span class="pre">#documentation</span></code> and <code class="docutils literal notranslate"><span class="pre">#awx</span></code> tags to help notify relevant people of the topic. This not only helps everyone know what’s going on, it also helps save time and effort, if the community decides some changes are needed. For more information on tags, see <a class="reference external" href="https://forum.ansible.com/t/navigating-the-ansible-forum-tags-categories-and-concepts/39">Navigating the Ansible forum — Tags, Categories, and Concepts</a>.</p></li>
<li><p>We ask all of our community members and contributors to adhere to the <a class="reference external" href="http://docs.ansible.com/ansible/latest/community/code_of_conduct.html">Ansible code of conduct</a>. If you have questions, or need assistance, please reach out to our community team at <a class="reference external" href="mailto:codeofconduct&#37;&#52;&#48;ansible&#46;com">codeofconduct<span>&#64;</span>ansible<span>&#46;</span>com</a>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Issue assignment will only be done for maintainers of the project. If you decide to work on an issue, please feel free to add a comment in the issue to let others know that you are working on it; but know that we will accept the first pull request from whomever is able to fix an issue. Once your PR is accepted we can add you as an assignee to an issue upon request.</p></li>
<li><p>If you work in a part of the docs that is going through active development, your changes may be rejected, or you may be asked to <cite>rebase</cite>. A good idea before starting work is to have a discussion with us and ask questions on Matrix at <a class="reference external" href="index.html#awx:ansible.com">#awx:ansible.com</a> or discuss your ideas on the <a class="reference external" href="https://forum.ansible.com/c/project/7/">Ansible Community Forum</a>.</p></li>
<li><p>If you find an issue with the functions of the UI or API, please see the <a class="reference external" href="https://github.com/ansible/awx/blob/devel/CONTRIBUTING.md#reporting-issues">Reporting Issues</a> section to open an issue.</p></li>
<li><p>If you find an issue with the docs themselves, refer to <a class="reference internal" href="index.html#docs-report-issues"><span class="std std-ref">Reporting Issues</span></a>.</p></li>
</ul>
</div>
</section>
<section id="translations">
<h4><span class="section-number">3.3. </span>Translations<a class="headerlink" href="#translations" title="Link to this heading"></a></h4>
<p>At this time we do not accept PRs for adding additional language translations as we have an automated process for generating our translations. This is because translations require constant care as new strings are added and changed in the code base. Because of this the .po files are overwritten during every translation release cycle. We also can’t support a lot of translations on AWX as its an open source project and each language adds time and cost to maintain. If you would like to see AWX translated into a new language please create an issue and ask others you know to upvote the issue. Our translation team will review the needs of the community and see what they can do around supporting additional language.</p>
<p>If you find an issue with an existing translation, please see the <a class="reference external" href="https://github.com/ansible/awx/blob/devel/CONTRIBUTING.md#reporting-issues">Reporting Issues</a> section to open an issue and our translation team will work with you on a resolution.</p>
</section>
</section>
<span id="document-contributor/report_issues"></span><section id="reporting-issues">
<span id="docs-report-issues"></span><h3><span class="section-number">4. </span>Reporting Issues<a class="headerlink" href="#reporting-issues" title="Link to this heading"></a></h3>
<p>To report issues you find in the AWX documentation, use the GitHub <a class="reference external" href="https://github.com/ansible/awx/issues">issue tracker</a> for filing bugs. In order to save time, and help us respond to issues quickly, make sure to fill out as much of the issue template
as possible. Version information, and an accurate reproducing scenario are critical to helping us identify the problem.</p>
<p>Be sure to attach the <code class="docutils literal notranslate"><span class="pre">component:docs</span></code> label to your issue. These labels are determined by the template data. Please use the template and fill it out as accurately as possible.</p>
<p>Please don’t use the issue tracker as a way to ask how to do something. Instead, discuss it on on the <a class="reference external" href="https://forum.ansible.com/c/project/7/">Ansible Community Forum</a>, or you can chat with us and ask questions on Matrix at <a class="reference external" href="index.html#awx:ansible.com">#awx:ansible.com</a>.</p>
<p>Before opening a new issue, please use the issue search feature to see if what you’re experiencing has already been reported. If you have any extra detail to provide, please comment. Otherwise, rather than posting a “me too” comment, please consider giving it a <a class="reference external" href="https://github.com/blog/2119-add-reactions-to-pull-requests-issues-and-comment">“thumbs up”</a> to give us an indication of the severity of the problem.</p>
<p>See <a class="reference external" href="https://github.com/ansible/awx/blob/devel/ISSUES.md#how-issues-are-resolved">How issues are resolved</a> for more information about the triaging and resolution process.</p>
<section id="getting-help">
<h4><span class="section-number">4.1. </span>Getting help<a class="headerlink" href="#getting-help" title="Link to this heading"></a></h4>
<p>If you require additional assistance, join the discussions on the <a class="reference external" href="https://forum.ansible.com/c/project/7/">Ansible Community Forum</a>. Specify with tags <code class="docutils literal notranslate"><span class="pre">#documentation</span></code> and <code class="docutils literal notranslate"><span class="pre">#awx</span></code> to narrow down the area(s) of interest. For more information on tags, see <a class="reference external" href="https://forum.ansible.com/t/navigating-the-ansible-forum-tags-categories-and-concepts/39">Navigating the Ansible forum — Tags, Categories, and Concepts</a>. You may also reach out to us and ask questions on Matrix at <a class="reference external" href="index.html#awx:ansible.com">#awx:ansible.com</a>.</p>
</section>
</section>
</div>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-userguide/index"></span><section id="automating-with-awx">
<span id="ug-start"></span><h2>Automating with AWX<a class="headerlink" href="#automating-with-awx" title="Link to this heading"></a></h2>
<p>Learn how to use AWX functionality to scale and manage your automation.
This guide assumes moderate familiarity with Ansible, including concepts such as <strong>Playbooks</strong>, <strong>Variables</strong>, and <strong>Tags</strong>.</p>
<p>This guide applies to the latest version of AWX only.
The content in this guide is updated frequently and might contain functionality that is not available in previous versions.
Likewise content in this guide can be removed or replaced if it applies to functionality that is no longer available in the latest version.</p>
<p><strong>Join us online</strong></p>
<p>We talk about AWX documentation on Matrix at <a class="reference external" href="index.html#docs:ansible.im">#docs:ansible.im</a> and on libera IRC at <code class="docutils literal notranslate"><span class="pre">#ansible-docs</span></code> if you ever want to join us and chat about the docs!</p>
<p>You can also find lots of AWX discussion and get answers to questions at <a class="reference external" href="https://forum.ansible.com/">forum.ansible.com</a>.</p>
<div class="toctree-wrapper compound">
<span id="document-userguide/overview"></span><section id="overview">
<span id="id1"></span><h3><span class="section-number">1. </span>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h3>
<p id="index-0">Thank you for your interest in AWX. AWX makes it possible for users across an organization to share, vet, and manage automation content by means of a simple, powerful, and agentless technical implementation. IT managers can provide guidelines on how automation is applied to individual teams. Meanwhile, automation developers retain the freedom to write tasks that use existing knowledge, without the operational overhead of conforming to complex tools and frameworks. It is a more secure and stable foundation for deploying end-to-end automation solutions, from hybrid cloud to the edge.</p>
<p>AWX allows users to define, operate, scale, and delegate automation across their organization.</p>
<section id="real-time-playbook-output-and-exploration">
<h4><span class="section-number">1.1. </span>Real-time Playbook Output and Exploration<a class="headerlink" href="#real-time-playbook-output-and-exploration" title="Link to this heading"></a></h4>
<p id="index-1">Watch playbooks run in real time, seeing each host as they check in. Easily go back and explore the results for specific tasks and hosts in great detail. Search for specific plays or hosts and see just those results, or quickly zero in on errors that need to be corrected.</p>
</section>
<section id="push-button-automation">
<h4><span class="section-number">1.2. </span>“Push Button” Automation<a class="headerlink" href="#push-button-automation" title="Link to this heading"></a></h4>
<p id="index-2">Access your favorite projects and re-trigger execution from the web interface with a minimum of clicking. AWX will ask for input variables, prompt for your credentials, kick off and monitor the job, and display results and host history over time.</p>
</section>
<section id="enhanced-and-simplified-role-based-access-control-and-auditing">
<h4><span class="section-number">1.3. </span>Enhanced and Simplified Role-Based Access Control and Auditing<a class="headerlink" href="#enhanced-and-simplified-role-based-access-control-and-auditing" title="Link to this heading"></a></h4>
<p id="index-3">AWX allows for the granting of permissions to perform a specific task (such as to view, create, or modify a file) to different teams or explicit users through role-based access control (RBAC).</p>
<p>Keep some projects private, while allowing some users to edit inventory and others to run playbooks against only certain systems–either in check (dry run) or live mode. You can also allow certain users to use credentials without exposing the credentials to them. Regardless of what you do, AWX records the history of operations and who made them–including objects edited and jobs launched.</p>
<p>Based on user feedback, AWX both expands and simplifies its role-based access control. No longer is job template visibility configured via a combination of permissions on inventory, projects, and credentials. If you want to give any user or team permissions to use a job template, just assign permissions directly on the job template. Similarly, credentials are now full objects in AWX’s RBAC system, and can be assigned to multiple users and/or teams for use.</p>
<p>AWX includes an ‘Auditor’ type, who can see all aspects of the systems automation, but has no permission to run or change automation, for those that need a system-level auditor. (This may also be useful for a service account that scrapes automation information from the REST API.) Refer to <a class="reference internal" href="index.html#rbac-ug"><span class="std std-ref">Role-Based Access Controls</span></a> for more information.</p>
<p>Subsequent releases of AWX provides more granular permissions, making it easier to delegate inside your organizations and remove automation bottlenecks.</p>
</section>
<section id="cloud-autoscaling-flexibility">
<h4><span class="section-number">1.4. </span>Cloud &amp; Autoscaling Flexibility<a class="headerlink" href="#cloud-autoscaling-flexibility" title="Link to this heading"></a></h4>
<p id="index-4">AWX features a powerful provisioning callback feature that allows nodes to request configuration on demand. While optional, this is an ideal solution for a cloud auto-scaling scenario, integrating with provisioning servers like Cobbler, or when dealing with managed systems with unpredictable uptimes. Requiring no management software to be installed on remote nodes, the callback solution can be triggered via a simple call to ‘curl’ or ‘wget’, and is easily embeddable in init scripts, kickstarts, or preseeds. Access is controlled such that only machines in inventory can request configuration.</p>
</section>
<section id="the-ideal-restful-api">
<h4><span class="section-number">1.5. </span>The Ideal RESTful API<a class="headerlink" href="#the-ideal-restful-api" title="Link to this heading"></a></h4>
<p id="index-5">The AWX REST API is the ideal RESTful API for a systems management application, with all resources fully discoverable, paginated, searchable, and well modeled. A styled API browser allows API exploration from the API root at <code class="docutils literal notranslate"><span class="pre">http://&lt;server</span> <span class="pre">name&gt;/api/</span></code>, showing off every resource and relation. Everything that can be done in the user interface can be done in the API - and more.</p>
</section>
<section id="backup-and-restore">
<h4><span class="section-number">1.6. </span>Backup and Restore<a class="headerlink" href="#backup-and-restore" title="Link to this heading"></a></h4>
<p id="index-6">The ability to backup and restore your system(s) has been integrated into the AWX setup playbook, making it easy for you to backup and replicate your instance as needed.</p>
</section>
<section id="ansible-galaxy-integration">
<h4><span class="section-number">1.7. </span>Ansible Galaxy Integration<a class="headerlink" href="#ansible-galaxy-integration" title="Link to this heading"></a></h4>
<p id="index-7">When it comes to describing your automation, everyone repeats the DRY mantra–“Don’t Repeat Yourself.” Using centralized copies of Ansible roles, such as in Ansible Galaxy, allows you to bring that philosophy to your playbooks. By including an Ansible Galaxy requirements.yml file in your project directory, AWX automatically fetches the roles your playbook needs from Galaxy, GitHub, or your local source control. Refer to <a class="reference internal" href="index.html#ug-galaxy"><span class="std std-ref">Ansible Galaxy Support</span></a> for more information.</p>
</section>
<section id="inventory-support-for-openstack">
<h4><span class="section-number">1.8. </span>Inventory Support for OpenStack<a class="headerlink" href="#inventory-support-for-openstack" title="Link to this heading"></a></h4>
<p id="index-8">Ansible is committed to making OpenStack simple for everyone to use. As part of that,  dynamic inventory support has been added for OpenStack. This allows you to easily target any of the virtual machines or images that you’re running in your OpenStack cloud.</p>
</section>
<section id="remote-command-execution">
<h4><span class="section-number">1.9. </span>Remote Command Execution<a class="headerlink" href="#remote-command-execution" title="Link to this heading"></a></h4>
<p id="index-9">Often times, you just need to do a simple task on a few hosts, whether it’s add a single user, update a single security vulnerability, or restart a misbehaving service. AWX includes remote command execution–any task that you can describe as a single Ansible play can be run on a host or group of hosts in your inventory, allowing you to get managing your systems quickly and easily. Plus, it is all backed by an RBAC engine and detailed audit logging, removing any questions regarding who has done what to what machines.</p>
</section>
<section id="system-tracking">
<h4><span class="section-number">1.10. </span>System Tracking<a class="headerlink" href="#system-tracking" title="Link to this heading"></a></h4>
<p id="index-10">You can collect facts by using the fact caching feature. Refer to <a class="reference internal" href="index.html#ug-fact-caching"><span class="std std-ref">Fact Caching</span></a> for more detail.</p>
</section>
<section id="integrated-notifications">
<h4><span class="section-number">1.11. </span>Integrated Notifications<a class="headerlink" href="#integrated-notifications" title="Link to this heading"></a></h4>
<p id="index-11">AWX allows you to easily keep track of the status of your automation. You can configure stackable notifications for job templates, projects, or entire organizations, and configure different notifications for job start, job success, job failure, and job approval (for workflow nodes). The following notification sources are supported:</p>
<ul class="simple">
<li><p>Email</p></li>
<li><p>Grafana</p></li>
<li><p>IRC</p></li>
<li><p>Mattermost</p></li>
<li><p>PagerDuty</p></li>
<li><p>Rocket.Chat</p></li>
<li><p>Slack</p></li>
<li><p>Twilio</p></li>
<li><p>Webhook (post to an arbitrary webhook, for integration into other tools)</p></li>
</ul>
<p>Additionally, you can <a class="reference internal" href="index.html#ug-custom-notifications"><span class="std std-ref">customize notification messages</span></a> for each of the above notification types.</p>
</section>
<section id="satellite-integration">
<h4><span class="section-number">1.12. </span>Satellite Integration<a class="headerlink" href="#satellite-integration" title="Link to this heading"></a></h4>
<p id="index-12">Dynamic inventory sources for Red Hat Satellite 6 are supported.</p>
</section>
<section id="run-time-job-customization">
<h4><span class="section-number">1.13. </span>Run-time Job Customization<a class="headerlink" href="#run-time-job-customization" title="Link to this heading"></a></h4>
<p id="index-13">Bringing the flexibility of the Ansible command line, you can now prompt for any of the following:</p>
<ul class="simple">
<li><p>inventory</p></li>
<li><p>credential</p></li>
<li><p>job tags</p></li>
<li><p>limits</p></li>
</ul>
</section>
<section id="red-hat-insights-integration">
<h4><span class="section-number">1.14. </span>Red Hat Insights Integration<a class="headerlink" href="#red-hat-insights-integration" title="Link to this heading"></a></h4>
<p id="index-14">AWX supports integration with Red Hat Insights, which allows Insights playbooks to be used as a Project.</p>
</section>
<section id="enhanced-user-interface">
<h4><span class="section-number">1.15. </span>Enhanced User Interface<a class="headerlink" href="#enhanced-user-interface" title="Link to this heading"></a></h4>
<p id="index-15">The layout of the user interface is organized with intuitive navigational elements. With information displayed at-a-glance, it is intuitive to find and use the automation you need. Compact and expanded viewing modes show and hide information as needed, and various built-in attributes make it easy to sort.</p>
</section>
<section id="custom-virtual-environments">
<h4><span class="section-number">1.16. </span>Custom Virtual Environments<a class="headerlink" href="#custom-virtual-environments" title="Link to this heading"></a></h4>
<p id="index-16">Custom Ansible environment support allows you to have different Ansible environments and specify custom paths for different teams and jobs.</p>
</section>
<section id="authentication-enhancements">
<h4><span class="section-number">1.17. </span>Authentication Enhancements<a class="headerlink" href="#authentication-enhancements" title="Link to this heading"></a></h4>
<p id="index-17">AWX supports LDAP, SAML, token-based authentication. Enhanced LDAP and SAML support allows you to integrate your enterprise account information in a more flexible manner. Token-based Authentication allows for easily authentication of third-party tools and services with AWX via integrated OAuth 2 token support.</p>
</section>
<section id="cluster-management">
<h4><span class="section-number">1.18. </span>Cluster Management<a class="headerlink" href="#cluster-management" title="Link to this heading"></a></h4>
<p id="index-18">Run-time management of cluster groups allows for easily configurable scaling.</p>
</section>
<section id="container-platform-support">
<h4><span class="section-number">1.19. </span>Container Platform Support<a class="headerlink" href="#container-platform-support" title="Link to this heading"></a></h4>
<p id="index-19">AWX is available as a containerized pod service for Kubernetes environments that can be scaled up and down easily as needed.</p>
</section>
<section id="workflow-enhancements">
<h4><span class="section-number">1.20. </span>Workflow Enhancements<a class="headerlink" href="#workflow-enhancements" title="Link to this heading"></a></h4>
<p id="index-20">In order to better model your complex provisioning, deployment, and orchestration workflows, AWX expanded workflows in a number
of ways:</p>
<ul class="simple">
<li><p><strong>Inventory overrides for Workflows</strong>. You can now override an inventory across a workflow at workflow definition time, or even at launch time. Define your application deployment workflow, and then easily re-use them in multiple environments.</p></li>
<li><p><strong>Convergence nodes for Workflows</strong>. When modeling complex processes, you sometimes need to wait for multiple steps to finish before proceeding. Now AWX workflows can easily replicate this; workflow steps can now wait for any number of prior workflow steps to complete properly before proceeding.</p></li>
<li><p><strong>Workflow Nesting</strong>. Re-use individual workflows as components of a larger workflow. Examples include combining provisioning and application deployment workflows into a single master workflow.</p></li>
<li><p><strong>Workflow Pause and Approval</strong>. You can build workflows containing approval nodes that require user intervention. This makes it possible to pause workflows in between playbooks so that a user can give approval (or denial) for continuing on to the next step in the workflow.</p></li>
</ul>
</section>
<section id="job-distribution">
<h4><span class="section-number">1.21. </span>Job Distribution<a class="headerlink" href="#job-distribution" title="Link to this heading"></a></h4>
<p id="index-21">As automation moves enterprise-wide, the need to automate at scale grows. AWX offer the ability to take a fact gathering or
configuration job running across thousands of machines and slice it into individual job slices that can be distributed across your AWX cluster for increased reliability, faster job completion, and better cluster utilization. If you need to change a parameter across 15,000 switches at
scale, or gather information across your multi-thousand-node RHEL estate, you can now do so easily.</p>
</section>
<section id="support-for-deployment-in-a-fips-enabled-environment">
<h4><span class="section-number">1.22. </span>Support for deployment in a FIPS-enabled environment<a class="headerlink" href="#support-for-deployment-in-a-fips-enabled-environment" title="Link to this heading"></a></h4>
<p id="index-22">If you require running your environment in restricted modes such as FIPS, AWX deploys and runs in such environments.</p>
</section>
<section id="limit-the-number-of-hosts-per-organization">
<h4><span class="section-number">1.23. </span>Limit the number of hosts per organization<a class="headerlink" href="#limit-the-number-of-hosts-per-organization" title="Link to this heading"></a></h4>
<p id="index-23">Lots of large organizations have instances shared among many organizations. They do not want any one organization to be able to use all the licensed hosts, this feature allows superusers to set a specified upper limit on how many licensed hosts may be allocated to each organization. The AWX algorithm factors changes in the limit for an organization and the number of total hosts across all organizations. Any inventory updates will fail if an inventory sync brings an organization out of compliance with the policy. Additionally, superusers are able to ‘over-allocate’ their licenses, with a warning.</p>
</section>
<section id="inventory-plugins">
<h4><span class="section-number">1.24. </span>Inventory Plugins<a class="headerlink" href="#inventory-plugins" title="Link to this heading"></a></h4>
<p id="index-24">Updated AWX to use the following inventory plugins from upstream collections if inventory updates are run with Ansible 2.9 and later:</p>
<ul class="simple">
<li><p>amazon.aws.aws_ec2</p></li>
<li><p>community.vmware.vmware_vm_inventory</p></li>
<li><p>azure.azcollection.azure_rm</p></li>
<li><p>google.cloud.gcp_compute</p></li>
<li><p>theforeman.foreman.foreman</p></li>
<li><p>openstack.cloud.openstack</p></li>
<li><p>ovirt.ovirt.ovirt</p></li>
<li><p>awx.awx.tower</p></li>
</ul>
</section>
<section id="secret-management-system">
<h4><span class="section-number">1.25. </span>Secret Management System<a class="headerlink" href="#secret-management-system" title="Link to this heading"></a></h4>
<p id="index-25">With a secret management system, external credentials are stored and supplied for use in AWX so you don’t have to provide them directly.</p>
</section>
</section>
<span id="document-userguide/logging_in"></span><section id="logging-in">
<h3><span class="section-number">2. </span>Logging In<a class="headerlink" href="#logging-in" title="Link to this heading"></a></h3>
<p id="index-0">To log in, browse to the user interface at: <code class="docutils literal notranslate"><span class="pre">http://&lt;server</span> <span class="pre">name&gt;/</span></code></p>
<p><img alt="Login form" src="_images/login-form.png" /></p>
<p>Log in using a valid username and password.</p>
<p>The default username is ‘’admin’’, and the default password is set during installation. To configure users and passwords, you can do so by accessing <strong>Users</strong> from the left navigation bar.</p>
</section>
<span id="document-userguide/main_menu"></span><section id="the-user-interface">
<span id="ug-ui-main"></span><h3><span class="section-number">3. </span>The User Interface<a class="headerlink" href="#the-user-interface" title="Link to this heading"></a></h3>
<p id="index-0">The User Interface offers a friendly graphical framework for your IT orchestration needs. The left navigation bar provides quick access to resources, such as <strong>Projects</strong>, <strong>Inventories</strong>, <strong>Job Templates</strong>, and <strong>Jobs</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The new AWX User Interface is available for tech preview and is subject to change in a future release. To preview the new UI, click the <strong>Enable Preview of New User Interface</strong> toggle to <strong>On</strong> from the Miscellaneous System option of the Settings menu.</p>
<img alt="Enabling preview of new user interface in the Miscellaneous System option of the Settings menu." src="_images/configure-awx-system-misc-preview-newui.png" />
<p>After saving, logout and log back in to access the new UI from the preview banner. To return to the current UI, click the link on the top banner where indicated.</p>
<img alt="Tech preview banner to view the new user interface." src="_images/ug-dashboard-preview-banner.png" />
</div>
<p>Across the top-right side of the interface, you can access your user profile, the About page, view related documentation, and log out. Right below these options, you can view the activity stream for that user by clicking on the Activity Stream <img alt="Activity stream icon." src="_images/activitystream.png" /> button.</p>
<img alt="Main screen with arrow showing where the activity stream icon resides on the Dashboard." src="_images/ug-dashboard-top-nav.png" />
<section id="views">
<h4><span class="section-number">3.1. </span>Views<a class="headerlink" href="#views" title="Link to this heading"></a></h4>
<p id="index-1">The User Interface provides several options for viewing information.</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#dashboard-view" id="id1">Dashboard view</a></p></li>
<li><p><a class="reference internal" href="#jobs-view" id="id2">Jobs view</a></p></li>
<li><p><a class="reference internal" href="#schedules-view" id="id3">Schedules view</a></p></li>
<li><p><a class="reference internal" href="#activity-stream" id="id4">Activity Stream</a></p></li>
<li><p><a class="reference internal" href="#workflow-approvals" id="id5">Workflow Approvals</a></p></li>
</ul>
</nav>
<section id="dashboard-view">
<h5><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">3.1.1. </span>Dashboard view</a><a class="headerlink" href="#dashboard-view" title="Link to this heading"></a></h5>
<p id="index-2">The <strong>Dashboard</strong> view begins with a summary of your hosts, inventories, and projects. Each of these is linked to the corresponding objects for easy access.</p>
<img alt="Dashboard showing a summary of your hosts, inventories, and projects; and job run statuses." src="_images/ug-dashboard-topsummary.png" />
<p>On the main Dashboard screen, a summary appears listing your current <strong>Job Status</strong>. The <strong>Job Status</strong> graph displays the number of successful and failed jobs over a specified time period. You can choose to limit the job types that are viewed, and to change the time horizon of the graph.</p>
<p>Also available for view are summaries of <strong>Recent Jobs</strong> and <strong>Recent Templates</strong> on their respective tabs.</p>
<p>The <strong>Recent Jobs</strong> section displays which jobs were most recently run, their status, and time when they were run as well.</p>
<img alt="Summary of the most recently used jobs" src="_images/ug-dashboard-recent-jobs.png" />
<p>The <strong>Recent Templates</strong> section of this display shows a summary of the most recently used templates. You can also access this summary by clicking <strong>Templates</strong> from the left navigation bar.</p>
<img alt="Summary of the most recently used templates" src="_images/ug-dashboard-recent-templates.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Clicking on <strong>Dashboard</strong> from the left navigation bar or the AWX logo at any time returns you to the Dashboard.</p>
</div>
</section>
<section id="jobs-view">
<h5><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">3.1.2. </span>Jobs view</a><a class="headerlink" href="#jobs-view" title="Link to this heading"></a></h5>
<p>Access the <strong>Jobs</strong> view by clicking <strong>Jobs</strong> from the left navigation bar. This view shows all the jobs that have ran, including projects, templates, management jobs, SCM updates, playbook runs, etc.</p>
<img alt="Jobs view showing jobs that have ran, including projects, templates, management jobs, SCM updates, playbook runs, etc." src="_images/ug-dashboard-jobs-view.png" />
</section>
<section id="schedules-view">
<h5><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">3.1.3. </span>Schedules view</a><a class="headerlink" href="#schedules-view" title="Link to this heading"></a></h5>
<p>Access the Schedules view by clicking <strong>Schedules</strong> from the left navigation bar. This view shows all the scheduled jobs that are configured.</p>
<img alt="Schedules view showing all the scheduled jobs that are configured." src="_images/ug-dashboard-schedule-view.png" />
</section>
<section id="activity-stream">
<span id="ug-activitystreams"></span><h5><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">3.1.4. </span>Activity Stream</a><a class="headerlink" href="#activity-stream" title="Link to this heading"></a></h5>
<p id="index-3">Most screens have an Activity Stream (<img alt="Activity stream icon." src="_images/activitystream.png" />) button. Clicking this brings up the
<strong>Activity Stream</strong> for this object.</p>
<p><img alt="Summary of the recent activity on Activity Stream dashboard." src="_images/users-activity-stream.png" /></p>
<p>An Activity Stream shows all changes for a particular object. For each change, the Activity Stream shows the time of the event, the user that
initiated the event, and the action. The information displayed varies depending on the type of event. Clicking on the Examine (<img alt="Examine button" src="_images/examine-button.png" />) button shows the event log for the change.</p>
<p><img alt="Example of an event log of an Activity Stream instance." src="_images/activity-stream-event-log.png" /></p>
<p>The Activity Stream can be filtered by the initiating user (or the
system, if it was system initiated), and by any related object,
such as a particular credential, job template, or schedule.</p>
<p>The Activity Stream on the main Dashboard shows the Activity Stream for the entire instance. Most pages allow viewing an activity stream filtered for that specific object.</p>
</section>
<section id="workflow-approvals">
<h5><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">3.1.5. </span>Workflow Approvals</a><a class="headerlink" href="#workflow-approvals" title="Link to this heading"></a></h5>
<p>Access this view to see your workflow approval queue. The list contains actions that require you to approve or deny before a job can proceed. See
<a class="reference internal" href="index.html#ug-wf-approval-nodes"><span class="std std-ref">Approval nodes</span></a> for further detail.</p>
</section>
</section>
<section id="resources-and-access">
<h4><span class="section-number">3.2. </span>Resources and Access<a class="headerlink" href="#resources-and-access" title="Link to this heading"></a></h4>
<p>The <strong>Resources</strong> and <strong>Access</strong> menus provide you access to the various components of AWX and allow you to configure who has permissions for those resources:</p>
<ul class="simple">
<li><p>Templates (<a class="reference internal" href="index.html#ug-jobtemplates"><span class="std std-ref">Job Templates</span></a> and <a class="reference internal" href="index.html#ug-wf-templates"><span class="std std-ref">Workflow Job Templates</span></a>)</p></li>
<li><p><a class="reference internal" href="index.html#ug-credentials"><span class="std std-ref">Credentials</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ug-projects"><span class="std std-ref">Projects</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ug-inventories"><span class="std std-ref">Inventories</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ug-inventories-add-host"><span class="std std-ref">Hosts</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ug-organizations"><span class="std std-ref">Organizations</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ug-users"><span class="std std-ref">Users</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ug-teams"><span class="std std-ref">Teams</span></a></p></li>
</ul>
</section>
<section id="administration">
<h4><span class="section-number">3.3. </span>Administration<a class="headerlink" href="#administration" title="Link to this heading"></a></h4>
<p id="index-4">The <strong>Administration</strong> menu provides access to the various administrative options. From here, you can create, view, and edit:</p>
<ul class="simple">
<li><p><a class="reference internal" href="index.html#ug-credential-types"><span class="std std-ref">Custom Credential Types</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ug-notifications"><span class="std std-ref">Notifications</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ag-management-jobs"><span class="std std-ref">Management Jobs</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ug-instance-groups"><span class="std std-ref">Instance Groups</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ag-instances"><span class="std std-ref">Instances</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ug-applications-auth"><span class="std std-ref">Applications</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ug-execution-environments"><span class="std std-ref">Execution Environments</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ag-topology-viewer"><span class="std std-ref">Topology Viewer</span></a></p></li>
</ul>
</section>
</section>
<section id="the-settings-menu">
<h3><span class="section-number">4. </span>The Settings Menu<a class="headerlink" href="#the-settings-menu" title="Link to this heading"></a></h3>
<p>Configuring global and system-level settings is accomplished through the <strong>Settings</strong> menu, which is described in further detail in the proceeding section. The <strong>Settings</strong> menu offers access to administrative configuration options.</p>
<p id="index-5">To enter the Settings window for AWX, click <strong>Settings</strong> from the left navigation bar. This page allows you to modify your AWX configuration, such as settings associated with authentication, jobs, system, and user interface.</p>
<img alt="The main settings window for AWX." src="_images/ug-settings-menu-screen.png" />
<p>For more information on configuring these settings, refer to <a class="reference internal" href="index.html#ag-configure-awx"><span class="std std-ref">AWX Configuration</span></a> section of the <em>AWX Administration Guide</em>.</p>
</section>
<span id="document-userguide/search_sort"></span><section id="search">
<span id="ug-search"></span><h3><span class="section-number">5. </span>Search<a class="headerlink" href="#search" title="Link to this heading"></a></h3>
<p id="index-0">AWX has a powerful search tool that provides both search and filter capabilities that span across multiple functions. Acceptable search criteria are provided in an expandable “cheat-sheet” accessible from the <strong>Advanced</strong> option from the <strong>Name</strong> drop-down menu in the search field. From there, use the combination of <strong>Set Type</strong>, <strong>Key</strong>, <strong>Lookup type</strong> to filter.</p>
<p><img alt="key sheet" src="_images/search-bar-key.png" /></p>
<section id="searching-tips">
<h4><span class="section-number">5.1. </span>Searching Tips<a class="headerlink" href="#searching-tips" title="Link to this heading"></a></h4>
<p>These searching tips assume that you are not searching hosts. Most of this section still applies to hosts but with some subtle differences. A typical syntax of a search consists a field (left-hand side) and a value (right-hand side). A colon is used to separate the field that you want to search from the value. If a search doesn’t have a colon (see example 3) it is treated as a simple string search where <code class="docutils literal notranslate"><span class="pre">?search=foobar</span></code> is sent. Here are the examples of syntax used for searching:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name:localhost</span></code> In this example, the string before the colon represents the field that you want to search on. If that string does not match something from <strong>Fields</strong> or <strong>Related Fields</strong> then it’s treated the same way Example 3 is (string search). The string after the colon is the string that you want to search for within the name attribute.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">organization.name:Default</span></code>  This example shows a Related Field Search. The period in the left-hand portion separates the model from the field in this case. Depending on how deep/complex the search is, you could have multiple periods in that left-hand portion.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">foobar</span></code>    Simple string (key term) search that will find all instances of that term using an <code class="docutils literal notranslate"><span class="pre">icontains</span></code> search against the name and description fields. If a space is used between terms (e.g. foo bar), then any results that contain both terms will be returned. If the terms are wrapped in quotes (e.g. “foo bar”), AWX will search for the entire string with the terms appearing together. Specific name searches will search against the API name. For example, <code class="docutils literal notranslate"><span class="pre">Management</span> <span class="pre">job</span></code> in the user interface is <code class="docutils literal notranslate"><span class="pre">system_job</span></code> in the API.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">organization:Default</span></code>  This example shows a Related Field search but without specifying a field to go along with the organization. This is supported by the API and is analogous to a simple string search but done against the organization (will do an <code class="docutils literal notranslate"><span class="pre">icontains</span></code> search against both the name and description).</p></li>
</ol>
<section id="values-for-search-fields">
<h5><span class="section-number">5.1.1. </span>Values for search fields<a class="headerlink" href="#values-for-search-fields" title="Link to this heading"></a></h5>
<p>To find values for certain fields, refer to the API endpoint for extensive options and their valid values. For example, if you want to search against <code class="docutils literal notranslate"><span class="pre">/api/v2/jobs</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">type</span></code> field, you can find the values by performing an <strong>OPTIONS</strong> request to <code class="docutils literal notranslate"><span class="pre">/api/v2/jobs</span></code> and look for entries in the API for <code class="docutils literal notranslate"><span class="pre">&quot;type&quot;</span></code>. Additionally, you can view the related searches by scrolling to the bottom of each screen. In the example for <code class="docutils literal notranslate"><span class="pre">/api/v2/jobs</span></code>, the related search shows:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;related_search_fields&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">   </span><span class="s">&quot;modified_by__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;project__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;project_update__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;credentials__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;unified_job_template__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;created_by__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;inventory__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;labels__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;schedule__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;webhook_credential__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;job_template__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;job_events__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;dependent_jobs__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;launch_config__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;unifiedjob_ptr__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;notifications__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;unified_job_node__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;instance_group__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;hosts__search&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;job_host_summaries__search&quot;</span>
</pre></div>
</div>
<p>The values for Fields come from the keys in a <strong>GET</strong> request. <code class="docutils literal notranslate"><span class="pre">url</span></code>, <code class="docutils literal notranslate"><span class="pre">related</span></code>, and <code class="docutils literal notranslate"><span class="pre">summary_fields</span></code> are not used. The values for Related Fields also come from the <strong>OPTIONS</strong> response, but from a different attribute.  Related Fields is populated by taking all the values from <code class="docutils literal notranslate"><span class="pre">related_search_fields</span></code> and stripping off the <code class="docutils literal notranslate"><span class="pre">__search</span></code> from the end.</p>
<p>Any search that does not start with a value from Fields or a value from the Related Fields, will be treated as a generic string search. Searching for something like <code class="docutils literal notranslate"><span class="pre">localhost</span></code> will result in the UI sending <code class="docutils literal notranslate"><span class="pre">?search=localhost</span></code> as a query parameter to the API endpoint. This is a shortcut for an <code class="docutils literal notranslate"><span class="pre">icontains</span></code> search on the name and description fields.</p>
</section>
<section id="searching-using-values-from-related-fields">
<h5><span class="section-number">5.1.2. </span>Searching using values from Related Fields<a class="headerlink" href="#searching-using-values-from-related-fields" title="Link to this heading"></a></h5>
<p>Searching a Related Field requires you to start the search string with the Related Field. This example describes how to search using values from the Related Field, <cite>organization</cite>.</p>
<p>The left-hand side of the search string must start with <cite>organization</cite> (ex: <code class="docutils literal notranslate"><span class="pre">organization:Default</span></code>). Depending on the related field, you might want to provide more specific direction for the search by providing secondary/tertiary fields. An example of this would be to specify that you want to search for all job templates that use a project matching a certain name. The syntax on this would look like: <code class="docutils literal notranslate"><span class="pre">job_template.project.name:&quot;A</span> <span class="pre">Project&quot;</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This query would execute against the <code class="docutils literal notranslate"><span class="pre">unified_job_templates</span></code> endpoint which is why it starts with <code class="docutils literal notranslate"><span class="pre">job_template</span></code>. If we were searching against the <code class="docutils literal notranslate"><span class="pre">job_templates</span></code> endpoint, then you wouldn’t need the <code class="docutils literal notranslate"><span class="pre">job_template</span></code> portion of that query.</p>
</div>
</section>
<section id="other-search-considerations">
<h5><span class="section-number">5.1.3. </span>Other search considerations<a class="headerlink" href="#other-search-considerations" title="Link to this heading"></a></h5>
<p>The following are a few things about searching in AWX that you should be aware of:</p>
<ul class="simple">
<li><p>There’s currently no supported syntax for <strong>OR</strong> queries. All search terms get <strong>AND</strong>’d in the query parameters.</p></li>
<li><p>The left-hand portion of a search parameter can be wrapped in quotes to support searching for strings with spaces.</p></li>
<li><p>Currently, the values in the Fields are direct attributes expected to be returned in a <strong>GET</strong> request.  Whenever you search against one of the values, AWX essentially does an <code class="docutils literal notranslate"><span class="pre">__icontains</span></code> search. So, for example, <code class="docutils literal notranslate"><span class="pre">name:localhost</span></code> would send back <code class="docutils literal notranslate"><span class="pre">?name__icontains=localhost</span></code>. AWX currently performs this search for every Field value, even <code class="docutils literal notranslate"><span class="pre">id</span></code>, which is not ideal.</p></li>
</ul>
</section>
</section>
<section id="sort">
<h4><span class="section-number">5.2. </span>Sort<a class="headerlink" href="#sort" title="Link to this heading"></a></h4>
<p id="index-1">Where applicable, use the arrows in each column to sort by ascending or descending order (following is an example from the schedules list).</p>
<p><img alt="sort arrow" src="_images/sort-order-example.png" /></p>
<p>The direction of the arrow indicates the sort order of the column.</p>
</section>
</section>
<span id="document-userguide/organizations"></span><section id="organizations">
<span id="ug-organizations"></span><h3><span class="section-number">6. </span>Organizations<a class="headerlink" href="#organizations" title="Link to this heading"></a></h3>
<p id="index-0">An <a class="reference internal" href="index.html#term-Organization"><span class="xref std std-term">Organization</span></a> is a logical collection of <strong>Users</strong>, <strong>Teams</strong>, <strong>Projects</strong>, and <strong>Inventories</strong>, and is the highest level in the AWX object hierarchy.</p>
<p><img alt="AWX Hierarchy" src="_images/AWXHierarchy.png" /></p>
<p>Access the Organizations page by clicking <strong>Organizations</strong> from the left navigation bar. The Organizations page displays all of the existing organizations for your installation. Organizations can be searched by <strong>Name</strong> or <strong>Description</strong>. Modify and remove organizations using the <strong>Edit</strong> and <strong>Delete</strong> buttons.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A default organization is automatically created.</p>
</div>
<p><img alt="Example of organizations home page" src="_images/organizations-home-showing-example-organization.png" /></p>
<p>From this list view, you can edit the details of an organization (<img alt="Edit button" src="_images/edit-button.png" />) from the <strong>Actions</strong> menu.</p>
<section id="creating-a-new-organization">
<span id="ug-organizations-create"></span><h4><span class="section-number">6.1. </span>Creating a New Organization<a class="headerlink" href="#creating-a-new-organization" title="Link to this heading"></a></h4>
<ol class="arabic simple">
<li><p>You can create a new organization by clicking the <strong>Add</strong> button.</p></li>
</ol>
<p><img alt="Create new organization form" src="_images/organizations-new-organization-form.png" /></p>
<ol class="arabic simple" start="2">
<li><p>An organization has several attributes that may be configured:</p></li>
</ol>
<ul class="simple">
<li><p>Enter the <strong>Name</strong> for your organization (required).</p></li>
<li><p>Enter a <strong>Description</strong> for the organization.</p></li>
<li><p>Enter <strong>Instance Groups</strong> on which to run this organization.</p></li>
<li><p>Enter the name of the execution environment or search for an existing <strong>Execution Environment</strong> on which to run this organization. See <a class="reference internal" href="index.html#ug-execution-environments"><span class="std std-ref">Execution Environments</span></a> for more information.</p></li>
<li><p>If used, enter the <strong>Galaxy Credentials</strong> or search from a list of existing ones.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Click <strong>Save</strong> to finish creating the organization.</p></li>
</ol>
<p>Once created, AWX displays the Organization details, and allows for the managing access and execution environments for the organization.</p>
<p><img alt="Organization details tab with edit, delete options" src="_images/organizations-show-record-for-example-organization.png" /></p>
<p>From the <strong>Details</strong> tab, you can edit or delete the organization.</p>
<blockquote id="deletion-warning">
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>If deleting items that are used by other work items, a message opens listing the items are affected by the deletion and prompts you to confirm the deletion. Some screens will contain items that are invalid or previously deleted, so they will fail to run. Below is an example of such a message:</p>
<img alt="_images/warning-deletion-dependencies.png" src="_images/warning-deletion-dependencies.png" />
</div>
</div></blockquote>
</section>
<section id="work-with-access">
<h4><span class="section-number">6.2. </span>Work with Access<a class="headerlink" href="#work-with-access" title="Link to this heading"></a></h4>
<p id="index-1">Clicking on <strong>Access</strong> (beside <strong>Details</strong> when viewing your organization), displays all the Users associated with this Organization and their roles.</p>
<p><img alt="Organization Access tab with user permissions" src="_images/organizations-show-users-permissions-organization.png" /></p>
<p>As you can manage the user membership for this Organization here, you can manage user membership on a per-user basis from the Users page by clicking <strong>Users</strong> from the left navigation bar. Organizations have a unique set of roles not described here. You can assign specific users certain levels of permissions within your organization, or allow them to act as an admin for a particular resource. Refer to <a class="reference internal" href="index.html#rbac-ug"><span class="std std-ref">Role-Based Access Controls</span></a> for more information.</p>
<p>Clicking on a user brings up that user’s details, allowing you to review, grant, edit, and remove associated permissions for that user. For more information, refer to <a class="reference internal" href="index.html#ug-users"><span class="std std-ref">Users</span></a>.</p>
<section id="add-a-user-or-team">
<h5><span class="section-number">6.2.1. </span>Add a User or Team<a class="headerlink" href="#add-a-user-or-team" title="Link to this heading"></a></h5>
<p>In order to add a user or team to an organization, the user or team must already be created. See <a class="reference internal" href="index.html#ug-users-create"><span class="std std-ref">Create a User</span></a> and <a class="reference internal" href="index.html#ug-team-create"><span class="std std-ref">Create a Team</span></a> for additional detail. To add existing users or team to the Organization:</p>
<blockquote>
<div></div></blockquote>
<ol class="arabic simple" id="ug-permissions">
<li><p>In the <strong>Access</strong> tab, click the <strong>Add</strong> button.</p></li>
<li><p>Select a user or team to add and click <strong>Next</strong></p></li>
<li><p>Select one or more users or teams from the list by clicking the check box(es) next to the name(s) to add them as members and click <strong>Next</strong>.</p></li>
</ol>
<img alt="_images/organizations-add-users-for-example-organization.png" src="_images/organizations-add-users-for-example-organization.png" />
<p>In this example, two users have been selected to be added.</p>
<ol class="arabic simple" start="4">
<li><p>Select the role(s) you want the selected user(s) or team(s) to have. Be sure to scroll down for a complete list of roles. Different resources have different options available.</p></li>
</ol>
<blockquote>
<div><img alt="_images/organizations-add-users-roles.png" src="_images/organizations-add-users-roles.png" />
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Click the <strong>Save</strong> button to apply the roles to the selected user(s) or team(s) and to add them as members.</p></li>
</ol>
<p>The Add Users/Teams window closes to display the updated roles assigned for each user and team.</p>
<img alt="Permissions tab with Role Assignments" src="_images/permissions-tab-roles-assigned.png" />
<p>To remove roles for a particular user, click the disassociate (x) button next to its resource.</p>
<img alt="_images/permissions-disassociate.png" src="_images/permissions-disassociate.png" />
<p>This launches a confirmation dialog, asking you to confirm the disassociation.</p>
<img alt="_images/permissions-disassociate-confirm.png" src="_images/permissions-disassociate-confirm.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A user or team with roles associated will retain them even after they have been reassigned to another organization.</p>
</div>
</section>
</section>
<section id="work-with-notifications">
<h4><span class="section-number">6.3. </span>Work with Notifications<a class="headerlink" href="#work-with-notifications" title="Link to this heading"></a></h4>
<p id="index-2">Clicking the <strong>Notifications</strong> tab allows you to review any notification integrations you have setup.</p>
<img alt="List of sample organization notifications" src="_images/organizations-notifications-samples-list.png" />
<p>Use the toggles to enable or disable the notifications to use with your particular organization. For more detail, see <a class="reference internal" href="index.html#ug-notifications-on-off"><span class="std std-ref">Enable and Disable Notifications</span></a>.</p>
<p>If no notifications have been set up, you must create them from the <strong>Notifications</strong> option on the left navigation bar.</p>
<img alt="Empty organization notifications list" src="_images/organization-notifications-empty.png" />
<p>Refer to <a class="reference internal" href="index.html#ug-notifications-types"><span class="std std-ref">Notification Types</span></a> for additional details on configuring various notification types.</p>
</section>
</section>
<span id="document-userguide/users"></span><section id="users">
<span id="ug-users"></span><h3><span class="section-number">7. </span>Users<a class="headerlink" href="#users" title="Link to this heading"></a></h3>
<p id="index-0">A <a class="reference internal" href="index.html#term-User"><span class="xref std std-term">User</span></a> is someone who has access to AWX with associated permissions and credentials. Access the Users page by clicking <strong>Users</strong> from the left navigation bar. The User list may be sorted and searched by <strong>Username</strong>, <strong>First Name</strong>, or <strong>Last Name</strong> and click the headers to toggle your sorting preference.</p>
<img alt="Users - home with example users" src="_images/users-home-with-example-users.png" />
<p>You can easily view permissions and user type information by looking beside their user name in the User overview screen.</p>
<section id="create-a-user">
<span id="ug-users-create"></span><h4><span class="section-number">7.1. </span>Create a User<a class="headerlink" href="#create-a-user" title="Link to this heading"></a></h4>
<p>To create a new user:</p>
<ol class="arabic simple">
<li><p>Click the <strong>Add</strong> button, which opens the Create User dialog.</p></li>
<li><p>Enter the appropriate details about your new user. Fields marked with an asterisk (*) are required.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When modifying your own password, log out and log back in again in order for it to take effect.</p>
</div>
<p>Three types of Users can be assigned:</p>
<ul class="simple">
<li><p><strong>Normal User</strong>: Normal Users have read and write access limited to the resources (such as inventory, projects, and job templates) for which that user has been granted the appropriate roles and privileges.</p></li>
<li><p><strong>System Auditor</strong>: Auditors implicitly inherit the read-only capability for all objects within the environment.</p></li>
<li><p><strong>System Administrator</strong>: A System Administrator (also known as Superuser) has full system administration privileges – with full read and write privileges over the entire installation. A System Administrator is typically responsible for managing all aspects of AWX and delegating responsibilities for day-to-day work to various Users. Assign with caution!</p></li>
</ul>
<img alt="User Types" src="_images/users-create-user-form-types.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The initial user (usually “admin”) created by the installation process is a Superuser. One Superuser must always exist. To delete the “admin” user account, you must first create another Superuser account.</p>
</div>
<ol class="arabic simple" start="3">
<li><p>Select <strong>Save</strong> when finished.</p></li>
</ol>
<p>Once the user is successfully created, the <strong>User</strong> dialog opens for that newly created User.</p>
<img alt="Edit User Form" src="_images/users-edit-user-form.png" />
<p>You may delete the user from its Details screen by clicking <strong>Delete</strong>, or once you exit the details screen, you can delete users from a list of current users. See <a class="reference internal" href="#ug-users-delete"><span class="std std-ref">Delete a User</span></a> for more detail.</p>
<p>The same window opens whether you click on the user’s name, or the Edit (<img alt="Edit button" src="_images/edit-button.png" />) button beside the user. Here, the User’s <strong>Organizations</strong>, <strong>Teams</strong>, and <strong>Roles</strong>, as well as other user membership details, may be reviewed and modified.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the user is not a newly-created user, the user’s details screen displays the last login activity of that user.</p>
<img alt="User details with last login information" src="_images/users-last-login-info.png" />
</div>
<p>When you log in as yourself, and view the details of your own user profile, you can manage tokens from your user profile. See <a class="reference internal" href="#ug-users-tokens"><span class="std std-ref">Users - Tokens</span></a> for more detail.</p>
<img alt="User details with Tokens tab highlighted" src="_images/user-with-token-button.png" />
</section>
<section id="delete-a-user">
<span id="ug-users-delete"></span><h4><span class="section-number">7.2. </span>Delete a User<a class="headerlink" href="#delete-a-user" title="Link to this heading"></a></h4>
<p>Before you can delete a user, you must have user permissions. When you delete a user account, the name and email of the user are permanently removed from AWX.</p>
<ol class="arabic simple">
<li><p>Expand the <strong>Access</strong> menu from the left navigation bar, and click <strong>Users</strong> to display a list of the current users.</p></li>
<li><p>Select the check box(es) for the user(s) that you want to remove and click <strong>Delete</strong>.</p></li>
</ol>
<img alt="Users list view with two users checked" src="_images/users-home-users-checked-delete.png" />
<ol class="arabic simple" start="3">
<li><p>Click <strong>Delete</strong> in the confirmation warning message to permanently delete the user.</p></li>
</ol>
</section>
<section id="users-organizations">
<h4><span class="section-number">7.3. </span>Users - Organizations<a class="headerlink" href="#users-organizations" title="Link to this heading"></a></h4>
<p id="index-1">This displays the list of organizations of which that user is a member. This list may be searched by Organization Name or Description.
Organization membership cannot be modified from this display panel.</p>
<p><img alt="Users - Organizations list for example user" src="_images/users-organizations-list-for-example-user.png" /></p>
</section>
<section id="users-teams">
<h4><span class="section-number">7.4. </span>Users - Teams<a class="headerlink" href="#users-teams" title="Link to this heading"></a></h4>
<p id="index-2">This displays the list of teams of which that user is a member. This list may be searched by <strong>Team Name</strong> or <strong>Description</strong>. Team membership cannot be modified from this display panel. For more information, refer to <a class="reference internal" href="index.html#ug-teams"><span class="std std-ref">Teams</span></a>.</p>
<p>Until a Team has been created and the user has been assigned to that team, the assigned Teams Details for the User appears blank.</p>
<p><img alt="Users - teams list for example user - empty" src="_images/users-teams-list-for-example-user.png" /></p>
</section>
<section id="users-roles">
<span id="ug-users-roles"></span><h4><span class="section-number">7.5. </span>Users - Roles<a class="headerlink" href="#users-roles" title="Link to this heading"></a></h4>
<p id="index-3">The set of permissions assigned to this user (role-based access controls) that provide the ability to read, modify, and administer projects, inventories, job templates, and other AWX elements are Roles.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is important to note that the job template administrator may not have access to other resources (inventory, project, credentials, or instance groups) associated with the template. Without access to these, certain fields in the job template are not editable. System Administrators may grant individual users permissions to certain resources as necessary. See <a class="reference internal" href="#ug-users-permissions"><span class="std std-ref">Add Permissions</span></a> for detail.</p>
</div>
<p>This screen displays a list of the roles that are currently assigned to the selected User and can be sorted and searched by <strong>Name</strong>, <strong>Type</strong>, or <strong>Role</strong>.</p>
<p><img alt="Users - permissions list for example user" src="_images/users-permissions-list-for-example-user.png" /></p>
<section id="add-permissions">
<span id="ug-users-permissions"></span><h5><span class="section-number">7.5.1. </span>Add Permissions<a class="headerlink" href="#add-permissions" title="Link to this heading"></a></h5>
<p>To add permissions to a particular user:</p>
<ol class="arabic simple">
<li><p>Click the <strong>Add</strong> button, which opens the Add Permissions Wizard.</p></li>
</ol>
<img alt="Add User Permissions Form, first step, Add resource type" src="_images/users-add-permissions-form.png" />
<ol class="arabic simple" start="2">
<li><p>Click to select the object for which the user will have access and click <strong>Next</strong>.</p></li>
<li><p>Click to select the resource to assign team roles and click <strong>Next</strong>.</p></li>
</ol>
<img alt="Add User Permissions Form, second step, Select items from list - instance group checked" src="_images/users-permissions-IG-select.png" />
<ol class="arabic simple" start="4">
<li><p>Click the checkbox beside the role to assign that role to your chosen type of resource. Different resources have different options available.</p></li>
</ol>
<img alt="Add User Permissions Form, final step, Select roles to apply - &quot;Use&quot; role checked" src="_images/users-permissions-IG-roles.png" />
<ol class="arabic simple" start="5">
<li><p>Click <strong>Save</strong> when done, and the Add Permissions Wizard closes to display the updated profile for the user with the roles assigned for each selected resource.</p></li>
</ol>
<img alt="Users - Permissions Sample Roles" src="_images/users-permissions-sample-roles.png" />
<p>To remove Permissions for a particular resource, click the disassociate (x) button next to its resource. This launches a confirmation dialog, asking you to confirm the disassociation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can also add teams, individual, or multiple users and assign them permissions at the object level (templates, credentials, inventories, projects, organizations, or instance groups) as well. This feature reduces the time for an organization to onboard many users at one time.</p>
</div>
</section>
</section>
<section id="users-tokens">
<span id="ug-users-tokens"></span><h4><span class="section-number">7.6. </span>Users - Tokens<a class="headerlink" href="#users-tokens" title="Link to this heading"></a></h4>
<p>The <strong>Tokens</strong> tab will only be present for your user (yourself). Before you add a token for your user, you may want to <a class="reference internal" href="index.html#ug-applications-auth-create"><span class="std std-ref">create an application</span></a> if you want to associate your token to it. You may also create a personal access token (PAT) without associating it with any application. To create a token for your user:</p>
<ol class="arabic simple">
<li><p>If not already selected, click on your user from the Users list view to configure your OAuth 2 tokens.</p></li>
</ol>
<ol class="arabic simple" start="2">
<li><p>Click the <strong>Tokens</strong> tab from your user’s profile.</p></li>
</ol>
<p>When no tokens are present, the Tokens screen prompts you to add them:</p>
<img alt="_images/users-tokens-empty.png" src="_images/users-tokens-empty.png" />
<ol class="arabic simple" start="3">
<li><p>Click the <strong>Add</strong> button, which opens the Create Token window.</p></li>
<li><p>Enter the following details in Create Token window:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p><strong>Application</strong>: enter the name of the application with which you want to associate your token. Alternatively, you can search for it by clicking the <img alt="search" src="_images/search-button.png" /> button. This opens a separate window that allows you to choose from the available options. Use the Search bar to filter by name if the list is extensive. Leave this field blank if you want to create a Personal Access Token (PAT) that is not linked to any application.</p></li>
<li><p><strong>Description</strong>: optionally provide a short description for your token.</p></li>
<li><p><strong>Scope</strong> (required): specify the level of access you want this token to have.</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>When done, click <strong>Save</strong> or <strong>Cancel</strong> to abandon your changes.</p></li>
</ol>
<p>After the token is saved, the newly created token for the user displays with the token information and when it expires.</p>
<img alt="_images/users-token-information-example.png" src="_images/users-token-information-example.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the only time the token value and associated refresh token value will ever be shown.</p>
</div>
<p>In the user’s profile, the application for which it is assigned to and its expiration displays in the token list view.</p>
<img alt="_images/users-token-assignment-example.png" src="_images/users-token-assignment-example.png" />
</section>
</section>
<span id="document-userguide/teams"></span><section id="teams">
<span id="ug-teams"></span><h3><span class="section-number">8. </span>Teams<a class="headerlink" href="#teams" title="Link to this heading"></a></h3>
<p id="index-0">A <a class="reference internal" href="index.html#term-Team"><span class="xref std std-term">Team</span></a> is a subdivision of an organization with associated users, projects, credentials, and permissions. Teams provide a means to implement role-based access control schemes and delegate responsibilities across organizations. For instance, permissions may be granted to a whole Team rather than each user on the Team.</p>
<p>You can create as many Teams of users as make sense for your Organization. Each Team can be assigned permissions, just as with Users. Teams can also scalably assign ownership for Credentials, preventing multiple interface click-throughs to assign the same Credentials to the same user.</p>
<p>Access the Teams page by clicking <strong>Teams</strong> from the left navigation bar. The team list may be sorted and searched by <strong>Name</strong> or <strong>Organization</strong>.</p>
<img alt="Teams page containing a list of teams and the organizations they belong to." src="_images/organizations-teams-list.png" />
<p>Clicking the Edit (<img alt="Edit Button" src="_images/edit-button.png" />) button next to the list of <strong>Teams</strong> allows you to edit details about the team. You can also review <strong>Users</strong> and  <strong>Permissions</strong> associated with this Team.</p>
<section id="create-a-team">
<span id="ug-team-create"></span><h4><span class="section-number">8.1. </span>Create a Team<a class="headerlink" href="#create-a-team" title="Link to this heading"></a></h4>
<p>To create a new Team:</p>
<ol class="arabic simple">
<li><p>Click the <strong>Add</strong> button.</p></li>
</ol>
<p><img alt="Create New Team Form" src="_images/teams-create-new-team.png" /></p>
<ol class="arabic simple" start="2">
<li><p>Enter the appropriate details into the following fields:</p></li>
</ol>
<ul class="simple">
<li><p>Name</p></li>
<li><p>Description (optional)</p></li>
<li><p>Organization (Choose from an existing organization)</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Click <strong>Save</strong>.</p></li>
</ol>
<p>Once the Team is successfully created, AWX opens the <strong>Details</strong> dialog, which also allows you to review and edit your Team information.</p>
<p><img alt="Example Team Successfully Created" src="_images/teams-example-team-successfully-created.png" /></p>
<section id="team-access">
<h5><span class="section-number">8.1.1. </span>Team Access<a class="headerlink" href="#team-access" title="Link to this heading"></a></h5>
<p id="index-1">This tab displays the list of Users that are members of this Team. This list may be searched by <strong>Username</strong>, <strong>First Name</strong>, or <strong>Last Name</strong>. For more information, refer to <a class="reference internal" href="index.html#ug-users"><span class="std std-ref">Users</span></a>.</p>
<p><img alt="Teams list showing the Access tab displaying a list of users and their roles." src="_images/teams-users-list.png" /></p>
<section id="add-a-user">
<span id="ug-teams-permissions"></span><h6><span class="section-number">8.1.1.1. </span>Add a User<a class="headerlink" href="#add-a-user" title="Link to this heading"></a></h6>
<p>In order to add a user to a team, the user must already be created. Refer to <a class="reference internal" href="index.html#ug-users-create"><span class="std std-ref">Create a User</span></a> to create a user. Adding a user to a team adds them as a member only, specifying a role for the user on different resources can be done in the <strong>Access</strong> tab . To add existing users to the Team:</p>
<ol class="arabic simple">
<li><p>In the <strong>Access</strong> tab, click the <strong>Add</strong> button.</p></li>
<li><p>Follow the prompts to add user(s) and assign them to roles.</p></li>
<li><p>Click <strong>Save</strong> when done.</p></li>
</ol>
<p>To remove roles for a particular user, click the disassociate (x) button next to its resource.</p>
<img alt="Access tab with list of users and an arrow pointing to the disassociate button next to a user's role." src="_images/permissions-disassociate.png" />
<p>This launches a confirmation dialog, asking you to confirm the disassociation.</p>
<img alt="Disassociation Confirmation" src="_images/permissions-disassociate-confirm.png" />
</section>
</section>
<section id="team-roles">
<h5><span class="section-number">8.1.2. </span>Team Roles<a class="headerlink" href="#team-roles" title="Link to this heading"></a></h5>
<p id="index-2">Selecting the <strong>Roles</strong> view displays a list of the permissions that are currently available for this Team. The permissions list may be sorted and searched by <strong>Resource Name</strong>, <strong>Type</strong>, or <strong>Role</strong>.</p>
<p><img alt="Permissions list with resource names, type and their associated roles." src="_images/teams-permissions-sample-roles.png" /></p>
<p>The set of privileges assigned to Teams that provide the ability to read, modify, and administer projects, inventories, and other AWX elements are permissions. By default, the Team is given the “read” permission (also called a role).</p>
<p>Permissions must be set explicitly via an Inventory, Project, Job Template, or within the Organization view.</p>
<section id="add-team-permissions">
<h6><span class="section-number">8.1.2.1. </span>Add Team Permissions<a class="headerlink" href="#add-team-permissions" title="Link to this heading"></a></h6>
<p>To add permissions to a Team:</p>
<ol class="arabic simple">
<li><p>Click the <strong>Add</strong> button, which opens the Add Permissions Wizard.</p></li>
</ol>
<img alt="Add Teams Permissions Wizard step 1, choose the resource type." src="_images/teams-users-add-permissions-form.png" />
<ol class="arabic simple" start="2">
<li><p>Click to select the object for which the team will have access and click <strong>Next</strong>.</p></li>
<li><p>Click to select the resource to assign team roles and click <strong>Next</strong>.</p></li>
</ol>
<img alt="Add Teams Permissions Wizard step 2, choose the resources from the list, Demo Job template selected." src="_images/teams-permissions-templates-select.png" />
<ol class="arabic simple" start="4">
<li><p>Click the checkbox beside the role to assign that role to your chosen type of resource. Different resources have different options available.</p></li>
</ol>
<img alt="Add Teams Permissions Wizard step 3, choose the roles to apply to the previously selected resource." src="_images/teams-permissions-template-roles.png" />
<ol class="arabic simple" start="5">
<li><p>Click <strong>Save</strong> when done, and the Add Permissions Wizard closes to display the updated profile for the team with the roles assigned for each selected resource.</p></li>
</ol>
<img alt="Updated profile for each team's resources and their roles." src="_images/teams-permissions-sample-roles.png" />
<p>To remove Permissions for a particular resource, click the disassociate (x) button next to its resource. This launches a confirmation dialog, asking you to confirm the disassociation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can also add teams, individual, or multiple users and assign them permissions at the object level (projects, inventories, job templates, and workflow templates) as well. This feature reduces the time for an organization to onboard many users at one time.</p>
</div>
</section>
</section>
</section>
</section>
<span id="document-userguide/rbac"></span><section id="role-based-access-controls">
<span id="rbac-ug"></span><h3><span class="section-number">9. </span>Role-Based Access Controls<a class="headerlink" href="#role-based-access-controls" title="Link to this heading"></a></h3>
<p id="index-0">Role-Based Access Controls (RBAC) are built into AWX and allow administrators to delegate access to server inventories, organizations, and more. Administrators can also centralize the management of various credentials, allowing end users to leverage a needed secret without ever exposing that secret to the end user. RBAC controls allow AWX to help you increase security and streamline management.</p>
<p>This chapter has two parts: the latest RBAC model (<a class="reference internal" href="#rbac-dab-ug"><span class="std std-ref">DAB RBAC</span></a>) and the <a class="reference internal" href="#rbac-legacy-ug"><span class="std std-ref">existing RBAC</span></a> implementation.</p>
<section id="dab-rbac">
<span id="rbac-dab-ug"></span><h4><span class="section-number">9.1. </span>DAB RBAC<a class="headerlink" href="#dab-rbac" title="Link to this heading"></a></h4>
<p id="index-1">This section describes the latest changes to RBAC, involving use of the <code class="docutils literal notranslate"><span class="pre">django-ansible-base</span></code> (DAB) library, to enhance existing roles, provide a uniformed model that is compatible with platform (enterprise) components, and allow creation of custom roles. However, the internals of the system in the backend have changes implemented, but they are not reflected yet in the AWX UI. The change to the backend maintains a compatibility layer so the “old” roles in the API still exists temporarily, until a fully-functional compatible UI replaces the existing roles.</p>
<p>New functionality, specifically custom roles, are possible through direct API clients or the API browser, but the presentation in the AWX UI might not reflect the changes made in the API.</p>
<p>The new DAB version of RBAC allows creation of custom roles which can be done via the <code class="docutils literal notranslate"><span class="pre">/api/v2/role_definitions/</span></code> endpoint. Then these can only be assigned using the new endpoints, <code class="docutils literal notranslate"><span class="pre">/api/v2/role_user_assignments/</span></code> and <code class="docutils literal notranslate"><span class="pre">/api/v2/role_team_assignments/</span></code>.</p>
<p>If you do not want to allow custom roles, you can change the setting <code class="docutils literal notranslate"><span class="pre">ANSIBLE_BASE_ALLOW_CUSTOM_ROLES</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code>. This is still a file-based setting for now.</p>
<p>New “add” permissions are a major highlight of this change. You could create a custom organization role that allows users to create all (or some) types of resources, and apply it to a particular organization. So instead of allowing a user to edit all projects, they can create a new project, and after creating it, they will automatically get admin role just for the objects they created.</p>
<section id="resource-access-for-teams">
<h5><span class="section-number">9.1.1. </span>Resource access for teams<a class="headerlink" href="#resource-access-for-teams" title="Link to this heading"></a></h5>
<p>This section provides a reference for managing team roles within individual resources as shown in the new UI and the corresponding API calls.</p>
<p>Access the resource’s <strong>Team Access</strong> tab to manage the team roles.</p>
<img alt="_images/rbac_jt_team_access.png" src="_images/rbac_jt_team_access.png" />
<p>To obtain a list of team role assignments from the API:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">GET /api/v2/role_team_assignments/?object_id=&lt;template_id&gt;&amp;content_type__model=jobtemplate</span>
</pre></div>
</div>
<p>The columns are arranged so that the team name appears in the first column. The role name is under <code class="docutils literal notranslate"><span class="pre">summary_fields.role_definition.name</span></code></p>
<p>To revoke a role assignment for a team in the API:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">DELETE /api/v2/role_team_assignments/&lt;role_id_from_list_API_above&gt;/</span>
</pre></div>
</div>
<section id="add-roles">
<h6><span class="section-number">9.1.1.1. </span>Add roles<a class="headerlink" href="#add-roles" title="Link to this heading"></a></h6>
<p>Clicking the <strong>Add roles</strong> button from the <strong>Team Access</strong> tab opens the <strong>Add roles</strong> wizard, where you can select the teams to which you want to add roles.</p>
<img alt="_images/rbac_team_access_add-roles.png" src="_images/rbac_team_access_add-roles.png" />
<p>To list the teams from the service endpoint:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">GET /api/v2/teams</span>
</pre></div>
</div>
<p>The next step of the wizard in the controller UI is to apply roles to the selected team(s).</p>
<img alt="_images/rbac_team_access_apply-roles.png" src="_images/rbac_team_access_apply-roles.png" />
<p>To list available role definitions for the selected resource type in the API, issue the following, but replace <code class="docutils literal notranslate"><span class="pre">content_type</span></code> below to match the resource type:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">GET /api/v2/role_definitions/?content_type__model=jobtemplate</span>
</pre></div>
</div>
<p>Finally, review your selections and click <strong>Save</strong> to save your changes.</p>
<img alt="_images/rbac_team_access_add-roles-review.png" src="_images/rbac_team_access_add-roles-review.png" />
<p>To assign roles to selected teams in the API, you must assign a single role to individual teams separately by referencing the team ID and resource ID from the controller associated with the <code class="docutils literal notranslate"><span class="pre">object_id</span></code>.</p>
<p>Make a POST request to this resource (<code class="docutils literal notranslate"><span class="pre">jobtemplate.id</span></code> in this example):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">POST /api/v2/role_team_assignments/</span>
</pre></div>
</div>
<p>The following shows an example of the payload sent for the POST request made above:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span><span class="s">&quot;team&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">25</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;role_definition&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">4</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;object_id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;10&quot;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>When changes are successfully applied via the UI, a message displays to confirm the changes:</p>
<img alt="_images/rbac_team_access_add-roles-success.png" src="_images/rbac_team_access_add-roles-success.png" />
</section>
</section>
<section id="resource-access-for-users">
<h5><span class="section-number">9.1.2. </span>Resource access for users<a class="headerlink" href="#resource-access-for-users" title="Link to this heading"></a></h5>
<p>This section provides a reference for managing user roles within individual resources as shown in the new UI and the corresponding API calls.</p>
<p>Access the resource’s <strong>User Access</strong> tab to manage the user roles.</p>
<img alt="_images/rbac_jt_user_access.png" src="_images/rbac_jt_user_access.png" />
<p>To obtain a list of user role assignments from the API:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">GET /api/v2/role_user_assignments/?object_id=&lt;template_id&gt;&amp;content_type__model=jobtemplate</span>
</pre></div>
</div>
<p>The columns are arranged so that the user name appears in the first column. The role name is under <code class="docutils literal notranslate"><span class="pre">summary_fields.role_definition.name</span></code></p>
<p>To revoke a role assignment for a user in the API:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">DELETE /api/v2/role_user_assignments/&lt;role_id_from_list_API_above&gt;/</span>
</pre></div>
</div>
<section id="id1">
<h6><span class="section-number">9.1.2.1. </span>Add roles<a class="headerlink" href="#id1" title="Link to this heading"></a></h6>
<p>Clicking the <strong>Add roles</strong> button from the <strong>User Access</strong> tab opens the <strong>Add roles</strong> wizard, where you can select the users to which you want to add roles.</p>
<img alt="_images/rbac_user_access_add-roles.png" src="_images/rbac_user_access_add-roles.png" />
<p>To list the teams from the service endpoint:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">GET /api/v2/users</span>
</pre></div>
</div>
<p>The next step of the wizard in the controller UI is to apply roles to the selected team(s).</p>
<img alt="_images/rbac_user_access_apply-roles.png" src="_images/rbac_user_access_apply-roles.png" />
<p>To list available role definitions for the selected resource type in the API, issue the following, but replace <code class="docutils literal notranslate"><span class="pre">content_type</span></code> below to match the resource type:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">GET /api/v2/role_definitions/?content_type__model=jobtemplate</span>
</pre></div>
</div>
<p>Finally, review your selections and click <strong>Save</strong> to save your changes.</p>
<img alt="_images/rbac_user_access_add-roles-review.png" src="_images/rbac_user_access_add-roles-review.png" />
<p>To assign roles to selected users in the API, you must assign a single role to individual users separately by referencing the user ID and resource ID from the controller associated with the <code class="docutils literal notranslate"><span class="pre">object_id</span></code>.</p>
<p>Make a POST request to this resource (<code class="docutils literal notranslate"><span class="pre">jobtemplate.id</span></code> in this example):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">POST /api/v2/role_user_assignments/</span>
</pre></div>
</div>
<p>The following shows an example of the payload sent for the POST request made above:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span><span class="s">&quot;user&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">25</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;role_definition&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">4</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;object_id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;10&quot;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>When changes are successfully applied via the UI, a message displays to confirm the changes:</p>
<img alt="_images/rbac_team_access_add-roles-success.png" src="_images/rbac_team_access_add-roles-success.png" />
</section>
</section>
<section id="custom-roles">
<h5><span class="section-number">9.1.3. </span>Custom roles<a class="headerlink" href="#custom-roles" title="Link to this heading"></a></h5>
<p id="index-2">In the DAB RBAC model, Superusers have the ability to create, modify, and delete custom roles.</p>
<p>To create a custom role, click the <strong>Create role</strong> button from the <strong>Roles</strong> resource in the UI, and provide the details of the new role:</p>
<ul class="simple">
<li><p><strong>Name</strong>: Required</p></li>
<li><p><strong>Description</strong>: Enter an arbitrary description as appropriate (optional)</p></li>
<li><p><strong>Resource Type</strong>: Required. Select the resource type from the drop-down menu (only one resource type per role allowed). This is equivalent to <code class="docutils literal notranslate"><span class="pre">content_type</span></code> in <code class="docutils literal notranslate"><span class="pre">OPTIONS</span> <span class="pre">/api/v2/role_definitions</span></code> for choices.</p></li>
<li><p>Select permissions based on the selected of resource type. (Alan will provide an endpoint containing dictionary for available permissions based on content type (The UI can use this to maintain static readable translatable texts on the client side) TBD)</p></li>
</ul>
<p>Modifying a custom role only allows you to change the permissions but does not not allow changes to the content type.</p>
<p>To delete a custom role:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">DELETE /api/v2/role_definitions/:id</span>
</pre></div>
</div>
</section>
</section>
<section id="legacy-rbac-model">
<span id="rbac-legacy-ug"></span><h4><span class="section-number">9.2. </span>Legacy RBAC model<a class="headerlink" href="#legacy-rbac-model" title="Link to this heading"></a></h4>
<p id="index-3">As in the name, RBAC is role-based, and roles contain a list of permissions. This is a domain-centric concept, where organization-level roles can grant you a permission (like <code class="docutils literal notranslate"><span class="pre">update_project</span></code>) to everything in that domain, including all projects in that organizations.</p>
<p>There are a few main concepts that you should become familiar with regarding AWX’s RBAC design–roles, resources, and users. Users can be members of a role, which gives them certain access to any resources associated with that role, or any resources associated with “descendant” roles.</p>
<p>A role is essentially a list of permissions. Users are granted access to these capabilities and AWX’s resources through the roles to which they are assigned or through roles inherited through the role hierarchy.</p>
<p>Roles associate a group of capabilities with a group of users. All capabilities are derived from membership within a role. Users receive capabilities only through the roles to which they are assigned or through roles they inherit through the role hierarchy. All members of a role have all capabilities granted to that role. Within an organization, roles are relatively stable, while users and capabilities are both numerous and may change rapidly. Users can have many roles.</p>
<section id="role-hierarchy-and-access-inheritance">
<h5><span class="section-number">9.2.1. </span>Role Hierarchy and Access Inheritance<a class="headerlink" href="#role-hierarchy-and-access-inheritance" title="Link to this heading"></a></h5>
<p>Imagine that you have an organization named “SomeCompany” and want to allow two people, “Josie” and “Carter”, access to manage all the settings associated with that organization. You should make both people members of the organization’s <code class="docutils literal notranslate"><span class="pre">admin_role</span></code>.</p>
<p><img alt="user-role-relationship" src="_images/user-role-relationship.png" /></p>
<p>Often, you will have many Roles in a system and you will want some roles to include all of the capabilities of other roles. For example, you may want a System Administrator to have access to everything that an Organization Administrator has access to, who has everything that a Project Administrator has access to, and so on.</p>
<p>This concept is referred to as the ‘Role Hierarchy’:</p>
<ul class="simple">
<li><p>Parent roles get all capabilities bestowed on any child roles</p></li>
<li><p>Members of roles automatically get all capabilities for the role they are a member of, as well as any child roles.</p></li>
</ul>
<p>The Role Hierarchy is represented by allowing Roles to have “Parent Roles”. Any capability that a Role has is implicitly granted to any parent roles (or parents of those parents, and so on).</p>
<p><img alt="rbac-role-hierarchy" src="_images/rbac-role-hierarchy.png" /></p>
<p>Often, you will have many Roles in a system and you will want some roles to include all of the capabilities of other roles. For example, you may want a System Administrator to have access to everything that an Organization Administrator has access to, who has everything that a Project Administrator has access to, and so on. We refer to this concept as the ‘Role Hierarchy’ and it is represented by allowing Roles to have “Parent Roles”. Any capability that a Role has is implicitly granted to any parent roles (or parents of those parents, and so on). Of course Roles can have more than one parent, and capabilities are implicitly granted to all parents.</p>
<p><img alt="rbac-heirarchy-morecomplex" src="_images/rbac-heirarchy-morecomplex.png" /></p>
<p>RBAC controls also give you the capability to explicitly permit User and Teams of Users to run playbooks against certain sets of hosts. Users and teams are restricted to just the sets of playbooks and hosts to which they are granted capabilities. And, with AWX, you can create or import as many Users and Teams as you require–create users and teams manually or import them from LDAP or Active Directory.</p>
<p>RBACs are easiest to think of in terms of who or what can see, change, or delete an “object” for which a specific capability is being determined.</p>
</section>
<section id="applying-rbac">
<h5><span class="section-number">9.2.2. </span>Applying RBAC<a class="headerlink" href="#applying-rbac" title="Link to this heading"></a></h5>
<p>The following sections cover how to apply AWX’s RBAC system in your environment.</p>
<section id="editing-users">
<h6><span class="section-number">9.2.2.1. </span>Editing Users<a class="headerlink" href="#editing-users" title="Link to this heading"></a></h6>
<p>When editing a user, a AWX system administrator may specify the user as being either a <em>System Administrator</em> (also referred to as the Superuser) or a <em>System Auditor</em>.</p>
<ul class="simple">
<li><p>System administrators implicitly inherit all capabilities for all objects (read/write/execute) within the AWX environment.</p></li>
<li><p>System Auditors implicitly inherit the read-only capability for all objects within the AWX environment.</p></li>
</ul>
</section>
<section id="editing-organizations">
<h6><span class="section-number">9.2.2.2. </span>Editing Organizations<a class="headerlink" href="#editing-organizations" title="Link to this heading"></a></h6>
<p>When editing an organization, system administrators may specify the following roles:</p>
<ul class="simple">
<li><p>One or more users as organization administrators</p></li>
<li><p>One or more users as organization auditors</p></li>
<li><p>And one or more users (or teams) as organization members</p></li>
</ul>
<p>Users/teams that are members of an organization can view their organization administrator.</p>
<p>Users who are organization administrators implicitly inherit all capabilities for all objects within that AWX organization.</p>
<p>Users who are organization auditors implicitly inherit the read-only capability for all objects within that AWX organization.</p>
</section>
<section id="editing-projects-in-an-organization">
<h6><span class="section-number">9.2.2.3. </span>Editing Projects in an Organization<a class="headerlink" href="#editing-projects-in-an-organization" title="Link to this heading"></a></h6>
<p>When editing a project in an organization for which they are the administrator, system administrators and organization administrators may specify:</p>
<ul class="simple">
<li><p>One or more users/teams that are project administrators</p></li>
<li><p>One or more users/teams that are project members</p></li>
<li><p>And one or more users/teams that may update the project from SCM, from among the users/teams that are members of that organization.</p></li>
</ul>
<p>Users who are members of a project can view their project administrators.</p>
<p>Project administrators implicitly inherit the capability to update the project from SCM.</p>
<p>Administrators can also specify one or more users/teams (from those that are members of that project) that can use that project in a job template.</p>
</section>
<section id="creating-inventories-and-credentials-within-an-organization">
<h6><span class="section-number">9.2.2.4. </span>Creating Inventories and Credentials within an Organization<a class="headerlink" href="#creating-inventories-and-credentials-within-an-organization" title="Link to this heading"></a></h6>
<p>All access that is granted to use, read, or write credentials is handled through roles, which use AWX’s RBAC system to grant ownership, auditor, or usage roles.</p>
<p>System administrators and organization administrators may create inventories and credentials within organizations under their administrative capabilities.</p>
<p>Whether editing an inventory or a credential, System administrators and organization administrators may specify one or more users/teams (from those that are members of that organization) to be granted the usage capability for that inventory or credential.</p>
<p>System administrators and organization administrators may specify one or more users/teams (from those that are members of that organization) that have the capabilities to update (dynamic or manually) an inventory.  Administrators can also execute ad hoc commands for an inventory.</p>
</section>
<section id="editing-job-templates">
<h6><span class="section-number">9.2.2.5. </span>Editing Job Templates<a class="headerlink" href="#editing-job-templates" title="Link to this heading"></a></h6>
<p>System administrators, organization administrators, and project administrators, within a project under their administrative capabilities, may create and modify new job templates for that project.</p>
<p>When editing a job template, administrators (AWX, organization, and project) can select among the inventory and credentials in the organization for which they have usage capabilities or they may leave those fields blank so that they will be selected at runtime.</p>
<p>Additionally, they may specify one or more users/teams (from those that are members of that project) that have execution capabilities for that job template. The execution capability is valid regardless of any explicit capabilities the user/team may have been granted against the inventory or credential specified in the job template.</p>
</section>
<section id="user-view">
<h6><span class="section-number">9.2.2.6. </span>User View<a class="headerlink" href="#user-view" title="Link to this heading"></a></h6>
<p>A user can:</p>
<ul class="simple">
<li><p>See any organization or project for which they are a member</p></li>
<li><p>Create their own credential objects which only belong to them</p></li>
<li><p>See and execute any job template for which they have been granted execution capabilities</p></li>
</ul>
<p>If a job template that a user has been granted execution capabilities on does not specify an inventory or credential, the user will be prompted at run-time to select among the inventory and credentials in the organization they own or have been granted usage capabilities.</p>
<p>Users that are job template administrators can make changes to job templates; however, to change to the inventory, project, playbook, credentials, or instance groups used in the job template, the user must also have the “Use” role for the project and inventory currently being used or being set.</p>
</section>
</section>
<section id="roles">
<span id="rbac-ug-roles"></span><h5><span class="section-number">9.2.3. </span>Roles<a class="headerlink" href="#roles" title="Link to this heading"></a></h5>
<p>All access that is granted to use, read, or write credentials is handled through roles, and roles are defined for a resource.</p>
<section id="built-in-roles">
<h6><span class="section-number">9.2.3.1. </span>Built-in roles<a class="headerlink" href="#built-in-roles" title="Link to this heading"></a></h6>
<p>The following table lists the RBAC system roles and a brief description of the how that role is defined with regard to privileges in AWX.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>System Role</p></th>
<th class="head"><p>What it can do</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>System Administrator - System wide singleton</p></td>
<td><p>Manages all aspects of the system</p></td>
</tr>
<tr class="row-odd"><td><p>System Auditor - System wide singleton</p></td>
<td><p>Views all aspects of the system</p></td>
</tr>
<tr class="row-even"><td><p>Ad Hoc Role - Inventory</p></td>
<td><p>Runs ad hoc commands on an Inventory</p></td>
</tr>
<tr class="row-odd"><td><p>Admin Role - Organizations, Teams, Inventory, Projects, Job Templates</p></td>
<td><p>Manages all aspects of a defined Organization, Team, Inventory, Project, or Job Template</p></td>
</tr>
<tr class="row-even"><td><p>Auditor Role - All</p></td>
<td><p>Views all aspects of a defined Organization, Team, Inventory, Project, or Job Template</p></td>
</tr>
<tr class="row-odd"><td><p>Execute Role - Job Templates</p></td>
<td><p>Runs assigned Job Template</p></td>
</tr>
<tr class="row-even"><td><p>Member Role - Organization, Team</p></td>
<td><p>User is a member of a defined Organization or Team</p></td>
</tr>
<tr class="row-odd"><td><p>Read Role - Organizations, Teams, Inventory, Projects, Job Templates</p></td>
<td><p>Views all aspects of a defined Organization, Team, Inventory, Project, or Job Template</p></td>
</tr>
<tr class="row-even"><td><p>Update Role - Project</p></td>
<td><p>Updates the Project from the configured source control management system</p></td>
</tr>
<tr class="row-odd"><td><p>Update Role - Inventory</p></td>
<td><p>Updates the Inventory using the cloud source update system</p></td>
</tr>
<tr class="row-even"><td><p>Owner Role - Credential</p></td>
<td><p>Owns and manages all aspects of this Credential</p></td>
</tr>
<tr class="row-odd"><td><p>Use Role - Credential, Inventory, Project, IGs, CGs</p></td>
<td><p>Uses the Credential, Inventory, Project, IGs, or CGs in a Job Template</p></td>
</tr>
</tbody>
</table>
<p>A Singleton Role is a special role that grants system-wide permissions. AWX currently provides two built-in Singleton Roles but the ability to create or customize a Singleton Role is not supported at this time.</p>
</section>
<section id="common-team-roles-personas">
<h6><span class="section-number">9.2.3.2. </span>Common Team Roles - “Personas”<a class="headerlink" href="#common-team-roles-personas" title="Link to this heading"></a></h6>
<p>Support personnel typically works on ensuring that AWX is available and manages it a way to balance supportability and ease-of-use for users. Often, support will assign “Organization Owner/Admin” to users in order to allow them to create a new Organization and add members from their team the respective access needed. This minimizes supporting individuals and focuses more on maintaining uptime of the service and assisting users who are using AWX.</p>
<p>Below are some common roles managed by the AWX Organization:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="line-block">
<div class="line">System Role</div>
<div class="line">(for Organizations)</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Common User</div>
<div class="line">Roles</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Description</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Owner</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Team Lead -</div>
<div class="line">Technical Lead</div>
</div>
</td>
<td><div class="line-block">
<div class="line">This user has the ability to control access for other users in their organization.</div>
<div class="line">They can add/remove and grant users specific access to projects, inventories, and job templates.</div>
<div class="line">This user also has the ability to create/remove/modify any aspect of an organization’s projects,</div>
<div class="line">templates, inventories, teams, and credentials.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">Auditor</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Security Engineer -</div>
<div class="line">Project Manager</div>
</div>
</td>
<td><div class="line-block">
<div class="line">This account can view all aspects of the organization in read-only mode.</div>
<div class="line">This may be good for a user who checks in and maintains compliance.</div>
<div class="line">This might also be a good role for a service account who manages or</div>
<div class="line">ships job data from AWX to some other data  collector.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Member -</div>
<div class="line">Team</div>
</div>
</td>
<td><div class="line-block">
<div class="line">All other users</div>
</div>
</td>
<td><div class="line-block">
<div class="line">These users by default as an organization member do not receive any access to any aspect</div>
<div class="line">of the organization. In order to grant them access the respective organization owner needs</div>
<div class="line">to add them to their respective team and grant them Admin, Execute, Use, Update, Ad-hoc</div>
<div class="line">permissions to each component of the organization’s projects, inventories, and job templates.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">Member -</div>
<div class="line">Team “Owner”</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Power users -</div>
<div class="line">Lead Developer</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Organization Owners can provide “admin” through the team interface, over any component</div>
<div class="line">of their organization including projects, inventories, and job templates. These users are able</div>
<div class="line">to modify and utilize the respective component given access.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Member -</div>
<div class="line">Team “Execute”</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Developers -</div>
<div class="line">Engineers</div>
</div>
</td>
<td><div class="line-block">
<div class="line">This will be the most common and allows the organization member the ability to execute</div>
<div class="line">job templates and read permission to the specific components. This is permission applies to templates.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">Member -</div>
<div class="line">Team “Use”</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Developers -</div>
<div class="line">Engineers</div>
</div>
</td>
<td><div class="line-block">
<div class="line">This permission applies to an organization’s credentials, inventories, and projects.</div>
<div class="line">This permission allows the ability for a user to use the respective component within their job template.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Member -</div>
<div class="line">Team “Update”</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Developers -</div>
<div class="line">Engineers</div>
</div>
</td>
<td><div class="line-block">
<div class="line">This permission applies to projects. Allows the user to be able to run an SCM update on a project.</div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="function-of-roles-editing-and-creating">
<h4><span class="section-number">9.3. </span>Function of roles: editing and creating<a class="headerlink" href="#function-of-roles-editing-and-creating" title="Link to this heading"></a></h4>
<p>Organization “resource roles” functionality are specific to a certain resource type - such as workflows. Being a member of such a role usually provides two types of permissions, in the case of workflows, where a user is given a “workflow admin role” for the organization “Default”:</p>
<ul class="simple">
<li><p>this user can create new workflows in the organization “Default”</p></li>
<li><p>user can edit all workflows in the “Default” organization</p></li>
</ul>
<p>One exception is job templates, where having the role is irrelevant of creation permission (more details on its own section).</p>
<section id="independence-of-resource-roles-and-organization-membership-roles">
<h5><span class="section-number">9.3.1. </span>Independence of resource roles and organization membership roles<a class="headerlink" href="#independence-of-resource-roles-and-organization-membership-roles" title="Link to this heading"></a></h5>
<p>Resource-specific organization roles are independent of the organization roles of admin and member. Having the “workflow admin role” for the “Default” organization will not allow a user to view all users in the organization, but having a “member” role in the “Default” organization will. The two types of roles are delegated independently of each other.</p>
<section id="necessary-permissions-to-edit-job-templates">
<h6><span class="section-number">9.3.1.1. </span>Necessary permissions to edit job templates<a class="headerlink" href="#necessary-permissions-to-edit-job-templates" title="Link to this heading"></a></h6>
<p>Users can edit fields not impacting job runs (non-sensitive fields) with a Job Template admin role alone. However, to edit fields that impact job runs in a job template, a user needs the following:</p>
<ul class="simple">
<li><p><strong>admin</strong> role to the job template and container groups</p></li>
<li><p><strong>use</strong> role to related project</p></li>
<li><p><strong>use</strong> role to related inventory</p></li>
<li><p><strong>use</strong> role to related instance groups</p></li>
</ul>
<p>An “organization job template admin” role was introduced, but having this role isn’t sufficient by itself to edit a job template within the organization if the user does not have use role to the project / inventory / instance group or an admin role to the container group that a job template uses.</p>
<p>In order to delegate <em>full</em> job template control (within an organization) to a user or team, you will need grant the team or user all 3 organization-level roles:</p>
<ul class="simple">
<li><p>job template admin</p></li>
<li><p>project admin</p></li>
<li><p>inventory admin</p></li>
</ul>
<p>This will ensure that the user (or all users who are members of the team with these roles) have full access to modify job templates in the organization. If a job template uses an inventory or project from another organization, the user with these organization roles may still not have permission to modify that job template. For clarity of managing permissions, it is best-practice to not mix projects / inventories from different organizations.</p>
</section>
<section id="rbac-permissions">
<h6><span class="section-number">9.3.1.2. </span>RBAC permissions<a class="headerlink" href="#rbac-permissions" title="Link to this heading"></a></h6>
<p>Each role should have a content object, for instance, the org admin role has a content object of the org. To delegate a role, you need admin permission to the content object, with some exceptions that would result in you being able to reset a user’s password.</p>
<p><strong>Parent</strong> is the organization.</p>
<p><strong>Allow</strong> is what this new permission will explicitly allow.</p>
<p><strong>Scope</strong> is the parent resource that this new role will be created on. Example: <code class="docutils literal notranslate"><span class="pre">Organization.project_create_role</span></code>.</p>
<p>An assumption is being made that the creator of the resource should be given the admin role for that resource. If there are any instances where resource creation does not also imply resource administration, they will be explicitly called out.</p>
<p>Here are the rules associated with each admin type:</p>
<p><strong>Project Admin</strong></p>
<ul class="simple">
<li><p>Allow: Create, read, update, delete any project</p></li>
<li><p>Scope: Organization</p></li>
<li><p>User Interface: <em>Project Add Screen - Organizations</em></p></li>
</ul>
<p><strong>Inventory Admin</strong></p>
<ul class="simple">
<li><p>Parent: Org admin</p></li>
<li><p>Allow: Create, read, update, delete any inventory</p></li>
<li><p>Scope: Organization</p></li>
<li><p>User Interface: <em>Inventory Add Screen - Organizations</em></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As it is with the <strong>Use</strong> role, if you give a user Project Admin and Inventory Admin, it allows them to create Job Templates (not workflows) for your organization.</p>
</div>
<p><strong>Credential Admin</strong></p>
<ul class="simple">
<li><p>Parent: Org admin</p></li>
<li><p>Allow: Create, read, update, delete shared credentials</p></li>
<li><p>Scope: Organization</p></li>
<li><p>User Interface: <em>Credential Add Screen - Organizations</em></p></li>
</ul>
<p><strong>Notification Admin</strong></p>
<ul class="simple">
<li><p>Parent: Org admin</p></li>
<li><p>Allow: Assignment of notifications</p></li>
<li><p>Scope: Organization</p></li>
</ul>
<p><strong>Workflow Admin</strong></p>
<ul class="simple">
<li><p>Parent: Org admin</p></li>
<li><p>Allow: Create a workflow</p></li>
<li><p>Scope: Organization</p></li>
</ul>
<p><strong>Org Execute</strong></p>
<ul class="simple">
<li><p>Parent: Org admin</p></li>
<li><p>Allow: Executing JTs and WFJTs</p></li>
<li><p>Scope: Organization</p></li>
</ul>
<p>The following is a sample scenario showing an organization with its roles and which resource(s) each have access to:</p>
<img alt="_images/rbac-multiple-resources-scenario.png" src="_images/rbac-multiple-resources-scenario.png" />
</section>
</section>
</section>
</section>
<span id="document-userguide/credentials"></span><section id="credentials">
<span id="ug-credentials"></span><h3><span class="section-number">10. </span>Credentials<a class="headerlink" href="#credentials" title="Link to this heading"></a></h3>
<p id="index-0">Credentials are utilized for authentication when launching Jobs against machines, synchronizing with inventory sources, and importing project content from a version control system.</p>
<p>You can grant users and teams the ability to use these credentials, without actually exposing the credential to the user. If you have a user move to a different team or leave the organization, you don’t have to re-key all of your systems just because that credential was available in AWX.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>AWX encrypts passwords and key information in the database and never makes secret information visible via the API. See <a class="reference internal" href="index.html#ag-secret-handling"><span class="std std-ref">Secret handling and connection security</span></a> in the <em>AWX Administration Guide</em> for details.</p>
</div>
<section id="understanding-how-credentials-work">
<span id="how-credentials-work"></span><h4><span class="section-number">10.1. </span>Understanding How Credentials Work<a class="headerlink" href="#understanding-how-credentials-work" title="Link to this heading"></a></h4>
<p id="index-1">AWX uses SSH to connect to remote hosts (or the Windows equivalent).  In order to pass the key from AWX to SSH, the key must be decrypted before it can be written a named pipe. AWX then uses that pipe to send the key to SSH (so that it is never written to disk).</p>
<p>If passwords are used, AWX handles those by responding directly to the password prompt and decrypting the password before writing it to the prompt.</p>
</section>
<section id="getting-started-with-credentials">
<h4><span class="section-number">10.2. </span>Getting Started with Credentials<a class="headerlink" href="#getting-started-with-credentials" title="Link to this heading"></a></h4>
<p id="index-2">Click <strong>Credentials</strong> from the left navigation bar to access the Credentials page. The Credentials page displays a search-able list of all available Credentials and can be sorted by <strong>Name</strong>.</p>
<p><img alt="Credentials - home with example credentials" src="_images/credentials-demo-edit-details.png" /></p>
<p>Credentials added to a Team are made available to all members of the Team, whereas credentials added to a User are only available to that specific User by default.</p>
<p>To help you get started, a Demo Credential has been created for your use.</p>
<p>Clicking on the link for the <strong>Demo Credential</strong> takes you to the <strong>Details</strong> view of this Credential.</p>
<p><img alt="Credentials - Demo credential details" src="_images/credentials-home-with-demo-credential-details.png" /></p>
<p>Clicking the <strong>Access</strong> tab shows you users and teams associated with this Credential and their granted roles (owner, admin, auditor, etc.)</p>
<p><img alt="Credentials - Access tab for Demo credential containing two users with their roles" src="_images/credentials-home-with-permissions-detail.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A credential with roles associated will retain them even after the credential has been reassigned to another organization.</p>
</div>
<p>You can click the <strong>Add</strong> button to assign this <strong>Demo Credential</strong> to additional users. If no users exist, add them from the <strong>Users</strong> menu and refer to the <a class="reference internal" href="index.html#ug-users"><span class="std std-ref">Users</span></a> section for further detail.</p>
<p>Clicking the <strong>Job Templates</strong> tab shows you the job templates associated with this Credential and which jobs recently ran using this particular credential.</p>
<img alt="Credentials - Job Template tab for Demo credential with example job template" src="_images/credentials-home-with-jt-detail.png" />
<p>You can click the <strong>Add</strong> button to assign this <strong>Demo Credential</strong> to additional job templates. Refer to the <a class="reference internal" href="index.html#ug-jobtemplates"><span class="std std-ref">Job Templates</span></a> section for further detail on creating a new job template.</p>
</section>
<section id="add-a-new-credential">
<span id="ug-credentials-add"></span><h4><span class="section-number">10.3. </span>Add a New Credential<a class="headerlink" href="#add-a-new-credential" title="Link to this heading"></a></h4>
<p id="index-3">To create a new credential:</p>
<ol class="arabic simple">
<li><p>Click the <strong>Add</strong> button from the <strong>Credentials</strong> screen.</p></li>
</ol>
<p><img alt="Create credential form" src="_images/credentials-create-credential.png" /></p>
<ol class="arabic simple" start="2">
<li><p>Enter the name for your new credential in the <strong>Name</strong> field.</p></li>
<li><p>Optionally enter a description and enter or select the name of the organization with which the credential is associated.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A credential with a set of permissions associated with one organization will remain even after the credential is reassigned to another organization.</p>
</div>
<ol class="arabic simple" start="4">
<li><p>Enter or select the credential type you want to create.</p></li>
</ol>
<img alt="Credential types drop down menu" src="_images/credential-types-drop-down-menu.png" />
<ol class="arabic simple" start="5">
<li><p>Enter the appropriate details depending on the type of credential selected, as described in the next section, <a class="reference internal" href="#ug-credentials-cred-types"><span class="std std-ref">Credential Types</span></a>.</p></li>
<li><p>Click <strong>Save</strong> when done.</p></li>
</ol>
</section>
<section id="credential-types">
<span id="ug-credentials-cred-types"></span><h4><span class="section-number">10.4. </span>Credential Types<a class="headerlink" href="#credential-types" title="Link to this heading"></a></h4>
<p id="index-4">The following credential types are supported with AWX:</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#amazon-web-services" id="id1">Amazon Web Services</a></p></li>
<li><p><a class="reference internal" href="#aws-secrets-manager" id="id2">AWS Secrets Manager</a></p></li>
<li><p><a class="reference internal" href="#ansible-galaxy-automation-hub-api-token" id="id3">Ansible Galaxy/Automation Hub API Token</a></p></li>
<li><p><a class="reference internal" href="#centrify-vault-credential-provider-lookup" id="id4">Centrify Vault Credential Provider Lookup</a></p></li>
<li><p><a class="reference internal" href="#container-registry" id="id5">Container Registry</a></p></li>
<li><p><a class="reference internal" href="#cyberark-central-credential-provider-lookup" id="id6">CyberArk Central Credential Provider Lookup</a></p></li>
<li><p><a class="reference internal" href="#cyberark-conjur-secrets-manager-lookup" id="id7">CyberArk Conjur Secrets Manager Lookup</a></p></li>
<li><p><a class="reference internal" href="#github-personal-access-token" id="id8">GitHub Personal Access Token</a></p></li>
<li><p><a class="reference internal" href="#gitlab-personal-access-token" id="id9">GitLab Personal Access Token</a></p></li>
<li><p><a class="reference internal" href="#google-compute-engine" id="id10">Google Compute Engine</a></p></li>
<li><p><a class="reference internal" href="#gpg-public-key" id="id11">GPG Public Key</a></p></li>
<li><p><a class="reference internal" href="#hashicorp-vault-secret-lookup" id="id12">HashiCorp Vault Secret Lookup</a></p></li>
<li><p><a class="reference internal" href="#hashicorp-vault-signed-ssh" id="id13">HashiCorp Vault Signed SSH</a></p></li>
<li><p><a class="reference internal" href="#insights" id="id14">Insights</a></p></li>
<li><p><a class="reference internal" href="#machine" id="id15">Machine</a></p></li>
<li><p><a class="reference internal" href="#microsoft-azure-key-vault" id="id16">Microsoft Azure Key Vault</a></p></li>
<li><p><a class="reference internal" href="#microsoft-azure-resource-manager" id="id17">Microsoft Azure Resource Manager</a></p></li>
<li><p><a class="reference internal" href="#network" id="id18">Network</a></p></li>
<li><p><a class="reference internal" href="#openshift-or-kubernetes-api-bearer-token" id="id19">OpenShift or Kubernetes API Bearer Token</a></p></li>
<li><p><a class="reference internal" href="#openstack" id="id20">OpenStack</a></p></li>
<li><p><a class="reference internal" href="#red-hat-ansible-automation-platform" id="id21">Red Hat Ansible Automation Platform</a></p></li>
<li><p><a class="reference internal" href="#red-hat-satellite-6" id="id22">Red Hat Satellite 6</a></p></li>
<li><p><a class="reference internal" href="#red-hat-virtualization" id="id23">Red Hat Virtualization</a></p></li>
<li><p><a class="reference internal" href="#source-control" id="id24">Source Control</a></p></li>
<li><p><a class="reference internal" href="#terraform-backend-configuration" id="id25">Terraform backend configuration</a></p></li>
<li><p><a class="reference internal" href="#thycotic-devops-secrets-vault" id="id26">Thycotic DevOps Secrets Vault</a></p></li>
<li><p><a class="reference internal" href="#thycotic-secret-server" id="id27">Thycotic Secret Server</a></p></li>
<li><p><a class="reference internal" href="#vault" id="id28">Vault</a></p></li>
<li><p><a class="reference internal" href="#vmware-vcenter" id="id29">VMware vCenter</a></p></li>
</ul>
</nav>
<p>The credential types associated with AWS Secrets Manager, Centrify, CyberArk, HashiCorp Vault, Microsoft Azure Key Management System (KMS), and Thycotic are part of the credential plugins capability that allows an external system to lookup your secrets information. See the <a class="reference internal" href="index.html#ug-credential-plugins"><span class="std std-ref">Secret Management System</span></a> section for further detail.</p>
<section id="amazon-web-services">
<span id="ug-credentials-aws"></span><h5><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">10.4.1. </span>Amazon Web Services</a><a class="headerlink" href="#amazon-web-services" title="Link to this heading"></a></h5>
<p id="index-5">Selecting this credential type enables synchronization of cloud inventory with Amazon Web Services.</p>
<p>AWX uses the following environment variables for AWS credentials and are fields prompted in the user interface:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">AWS_ACCESS_KEY_ID</span>
<span class="l l-Scalar l-Scalar-Plain">AWS_SECRET_ACCESS_KEY</span>
<span class="l l-Scalar l-Scalar-Plain">AWS_SECURITY_TOKEN</span>
</pre></div>
</div>
<p><img alt="Credentials - create AWS credential form" src="_images/credentials-create-aws-credential.png" /></p>
<p>Traditional Amazon Web Services credentials consist of the AWS <strong>Access Key</strong> and <strong>Secret Key</strong>.</p>
<p>AWX provides support for EC2 STS tokens (sometimes referred to as IAM STS credentials). Security Token Service (STS) is a web service that enables you to request temporary, limited-privilege credentials for AWS Identity and Access Management (IAM) users. To learn more about the IAM/EC2 STS Token, refer to: <a class="reference external" href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp.html">http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp.html</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the value of your tags in EC2 contain booleans (yes/no/true/false), you must remember to quote them.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>To use implicit IAM role credentials, do not attach AWS cloud credentials in AWX when relying on IAM roles to access the AWS API.  While it may seem to make sense to attach your AWS cloud credential to your job template, doing so will force the use of your AWS credentials and will not “fall through” to use your IAM role credentials (this is due to the use of the boto library.)</p>
</div>
</section>
<section id="aws-secrets-manager">
<h5><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">10.4.2. </span>AWS Secrets Manager</a><a class="headerlink" href="#aws-secrets-manager" title="Link to this heading"></a></h5>
<p>This is considered part of the secret management capability. See <a class="reference internal" href="index.html#ug-credentials-aws-lookup"><span class="std std-ref">AWS Secrets Manager Lookup</span></a> for more detail.</p>
</section>
<section id="ansible-galaxy-automation-hub-api-token">
<h5><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">10.4.3. </span>Ansible Galaxy/Automation Hub API Token</a><a class="headerlink" href="#ansible-galaxy-automation-hub-api-token" title="Link to this heading"></a></h5>
<p id="index-6">Selecting this credential allows AWX to access Galaxy or use a collection published on a local Automation Hub. See <a class="reference internal" href="index.html#ug-collections-usage"><span class="std std-ref">Using Collections via Hub</span></a> for detail. Entering the Galaxy server URL is the only required value on this screen.</p>
<p><img alt="Credentials - create galaxy credential form" src="_images/credentials-create-galaxy-credential.png" /></p>
<p>To populate the <strong>Galaxy Server URL</strong> and the <strong>Auth Server URL</strong> fields, look for the corresponding fields of the Automation Hub section of the <a class="reference external" href="https://console.redhat.com/ansible/automation-hub/token">Red Hat Hybrid Cloud Console</a> labeled <strong>Server URL</strong> and <strong>SSO URL</strong>, respectively.</p>
<img alt="Hub console tokens page" src="_images/hub-console-tokens-page.png" />
</section>
<section id="centrify-vault-credential-provider-lookup">
<h5><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">10.4.4. </span>Centrify Vault Credential Provider Lookup</a><a class="headerlink" href="#centrify-vault-credential-provider-lookup" title="Link to this heading"></a></h5>
<p>This is considered part of the secret management capability. See <a class="reference internal" href="index.html#ug-credentials-centrify"><span class="std std-ref">Centrify Vault Credential Provider Lookup</span></a> for more detail.</p>
</section>
<section id="container-registry">
<h5><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">10.4.5. </span>Container Registry</a><a class="headerlink" href="#container-registry" title="Link to this heading"></a></h5>
<p id="index-7">Selecting this credential allows AWX to access a collection of container images. See <a class="reference external" href="https://www.redhat.com/en/topics/cloud-native-apps/what-is-a-container-registry">What is a container registry?</a> for more information.</p>
<p>Aside from specifying a name, the <strong>Authentication URL</strong> is the only required field on this screen, and it is already pre-populated with a default value. You may change this default by specifying the authentication endpoint for a different container registry.</p>
<p><img alt="Credentials - create container credential form" src="_images/credentials-create-container-credential.png" /></p>
</section>
<section id="cyberark-central-credential-provider-lookup">
<h5><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">10.4.6. </span>CyberArk Central Credential Provider Lookup</a><a class="headerlink" href="#cyberark-central-credential-provider-lookup" title="Link to this heading"></a></h5>
<p>This is considered part of the secret management capability. See <a class="reference internal" href="index.html#ug-credentials-cyberarkccp"><span class="std std-ref">CyberArk Central Credential Provider (CCP) Lookup</span></a> for more detail.</p>
</section>
<section id="cyberark-conjur-secrets-manager-lookup">
<h5><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">10.4.7. </span>CyberArk Conjur Secrets Manager Lookup</a><a class="headerlink" href="#cyberark-conjur-secrets-manager-lookup" title="Link to this heading"></a></h5>
<p>This is considered part of the secret management capability. See <a class="reference internal" href="index.html#ug-credentials-cyberarkconjur"><span class="std std-ref">CyberArk Conjur Secrets Manager Lookup</span></a> for more detail.</p>
</section>
<section id="github-personal-access-token">
<span id="ug-credentials-github"></span><h5><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">10.4.8. </span>GitHub Personal Access Token</a><a class="headerlink" href="#github-personal-access-token" title="Link to this heading"></a></h5>
<p id="index-8">Selecting this credential allows you to access GitHub using a Personal Access Token (PAT), which is obtained through GitHub. See <a class="reference internal" href="index.html#ug-webhooks"><span class="std std-ref">Working with Webhooks</span></a> for detail. Entering the provided token is the only required value in this screen.</p>
<p><img alt="Credentials - create GitHub credential form" src="_images/credentials-create-webhook-github-credential.png" /></p>
<p>GitHub PAT credentials require a value in the <strong>Token</strong> field, which is provided in your GitHub profile settings.</p>
<p>This credential can be used for establishing an API connection to GitHub for use in webhook listener jobs, to post status updates.</p>
</section>
<section id="gitlab-personal-access-token">
<span id="ug-credentials-gitlab"></span><h5><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">10.4.9. </span>GitLab Personal Access Token</a><a class="headerlink" href="#gitlab-personal-access-token" title="Link to this heading"></a></h5>
<p id="index-9">Selecting this credential allows you to access GitLab using a Personal Access Token (PAT), which is obtained through GitLab. See <a class="reference internal" href="index.html#ug-webhooks"><span class="std std-ref">Working with Webhooks</span></a> for detail. Entering the provided token is the only required value in this screen.</p>
<p><img alt="Credentials - create GitLab credential form" src="_images/credentials-create-webhook-gitlab-credential.png" /></p>
<p>GitLab PAT credentials require a value in the <strong>Token</strong> field, which is provided in your GitLab profile settings.</p>
<p>This credential can be used for establishing an API connection to GitLab for use in webhook listener jobs, to post status updates.</p>
</section>
<section id="google-compute-engine">
<h5><a class="toc-backref" href="#id10" role="doc-backlink"><span class="section-number">10.4.10. </span>Google Compute Engine</a><a class="headerlink" href="#google-compute-engine" title="Link to this heading"></a></h5>
<p id="index-10">Selecting this credential type enables synchronization of cloud inventory with Google Compute Engine (GCE).</p>
<p>AWX uses the following environment variables for GCE credentials and are fields prompted in the user interface:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">GCE_EMAIL</span>
<span class="l l-Scalar l-Scalar-Plain">GCE_PROJECT</span>
<span class="l l-Scalar l-Scalar-Plain">GCE_CREDENTIALS_FILE_PATH</span>
</pre></div>
</div>
<p><img alt="Credentials - create GCE credential form" src="_images/credentials-create-gce-credential.png" /></p>
<p>GCE credentials have the following inputs that are required:</p>
<ul class="simple">
<li><p><strong>Service Account Email Address</strong>: The email address assigned to the Google Compute Engine <strong>service account</strong>.</p></li>
<li><p><strong>Project</strong>: Optionally provide the GCE assigned identification or the unique project ID you provided at project creation time.</p></li>
<li><p><strong>Service Account JSON File</strong>: Optionally upload a GCE service account file. Use the folder (<img alt="File browser button" src="_images/file-browser-button.png" />) icon to browse for the file that contains the special account information that can be used by services and applications running on your GCE instance to interact with other Google Cloud Platform APIs. This grants permissions to the service account and virtual machine instances.</p></li>
<li><p><strong>RSA Private Key</strong>: The PEM file associated with the service account email.</p></li>
</ul>
</section>
<section id="gpg-public-key">
<h5><a class="toc-backref" href="#id11" role="doc-backlink"><span class="section-number">10.4.11. </span>GPG Public Key</a><a class="headerlink" href="#gpg-public-key" title="Link to this heading"></a></h5>
<p id="index-11">Selecting this credential type allows you to create a credential that gives AWX the ability to verify the integrity of the project when syncing from source control.</p>
<p><img alt="Credentials - create GPG credential form" src="_images/credentials-create-gpg-credential.png" /></p>
<p>See <a class="reference internal" href="index.html#ug-content-signing"><span class="std std-ref">Project Signing and Verification</span></a> for detailed information on how to generate a valid keypair, use the CLI tool to sign content, and how to add the public key to AWX.</p>
</section>
<section id="hashicorp-vault-secret-lookup">
<h5><a class="toc-backref" href="#id12" role="doc-backlink"><span class="section-number">10.4.12. </span>HashiCorp Vault Secret Lookup</a><a class="headerlink" href="#hashicorp-vault-secret-lookup" title="Link to this heading"></a></h5>
<p>This is considered part of the secret management capability. See <a class="reference internal" href="index.html#ug-credentials-hashivault"><span class="std std-ref">HashiCorp Vault Secret Lookup</span></a> for more detail.</p>
</section>
<section id="hashicorp-vault-signed-ssh">
<h5><a class="toc-backref" href="#id13" role="doc-backlink"><span class="section-number">10.4.13. </span>HashiCorp Vault Signed SSH</a><a class="headerlink" href="#hashicorp-vault-signed-ssh" title="Link to this heading"></a></h5>
<p>This is considered part of the secret management capability. See <a class="reference internal" href="index.html#ug-credentials-hashivaultssh"><span class="std std-ref">HashiCorp Vault Signed SSH</span></a> for more detail.</p>
</section>
<section id="insights">
<h5><a class="toc-backref" href="#id14" role="doc-backlink"><span class="section-number">10.4.14. </span>Insights</a><a class="headerlink" href="#insights" title="Link to this heading"></a></h5>
<p id="index-12">Selecting this credential type enables synchronization of cloud inventory with Red Hat Insights.</p>
<p><img alt="Credentials - create Insights credential form" src="_images/credentials-create-insights-credential.png" /></p>
<p>Insights credentials consist of the Insights <strong>Username</strong> and <strong>Password</strong>, which is the user’s Red Hat Customer Portal Account username and password.</p>
</section>
<section id="machine">
<h5><a class="toc-backref" href="#id15" role="doc-backlink"><span class="section-number">10.4.15. </span>Machine</a><a class="headerlink" href="#machine" title="Link to this heading"></a></h5>
<p id="index-13">Machine credentials enable AWX to invoke Ansible on hosts under your management. Just like using Ansible on the command line, you can specify the SSH username, optionally provide a password, an SSH key, a key password, or even have AWX prompt the user for their password at deployment time. They define ssh and user-level privilege escalation access for playbooks, and are used when submitting jobs to run playbooks on a remote host. Network connections (<code class="docutils literal notranslate"><span class="pre">httpapi</span></code>, <code class="docutils literal notranslate"><span class="pre">netconf</span></code>, and <code class="docutils literal notranslate"><span class="pre">network_cli</span></code>) use <strong>Machine</strong> for the credential type.</p>
<p>Machine/SSH credentials do not use environment variables. Instead, they pass the username via the <code class="docutils literal notranslate"><span class="pre">ansible</span> <span class="pre">-u</span></code> flag, and interactively write the SSH password when the underlying SSH client prompts for it.</p>
<p><img alt="Credentials - create machine credential form" src="_images/credentials-create-machine-credential.png" /></p>
<p>Machine credentials have several attributes that may be configured:</p>
<ul class="simple">
<li><p><strong>Username</strong>: The username to be used for SSH authentication.</p></li>
<li><p><strong>Password</strong>: The actual password to be used for SSH authentication. This password will be stored encrypted in the database, if entered. Alternatively, you can configure AWX to ask the user for the password at launch time by selecting <strong>Prompt on launch</strong>. In these cases, a dialog opens when the job is launched, promoting the user to enter the password and password confirmation.</p></li>
<li><p><strong>SSH Private Key</strong>: Copy or drag-and-drop the SSH private key for the machine credential.</p></li>
<li><p><strong>Private Key Passphrase</strong>: If the SSH Private Key used is protected by a password, you can configure a Key Password for the private key. This password will be stored encrypted in the database, if entered. Alternatively, you can configure AWX to ask the user for the password at launch time by selecting <strong>Prompt on launch</strong>. In these cases, a dialog opens when the job is launched, prompting the user to enter the password and password confirmation.</p></li>
<li><p><strong>Privilege Escalation Method</strong>: Specifies the type of escalation privilege to assign to specific users. This is equivalent to specifying the <code class="docutils literal notranslate"><span class="pre">--become-method=BECOME_METHOD</span></code> parameter, where <code class="docutils literal notranslate"><span class="pre">BECOME_METHOD</span></code> could be any of the typical methods described below, or a custom method you’ve written. Begin entering the name of the method, and the appropriate name auto-populates.</p></li>
</ul>
<img alt="Credentials - create machine credential privilege escalation drop-down menu" src="_images/credentials-create-machine-credential-priv-escalation.png" />
<ul class="simple">
<li><p>empty selection: If a task/play has <code class="docutils literal notranslate"><span class="pre">become</span></code> set to <code class="docutils literal notranslate"><span class="pre">yes</span></code> and is used with an empty selection, then it will default to <code class="docutils literal notranslate"><span class="pre">sudo</span></code></p></li>
<li><p><strong>sudo</strong>: Performs single commands with super user (root user) privileges</p></li>
<li><p><strong>su</strong>: Switches to the super user (root user) account (or to other user accounts)</p></li>
<li><p><strong>pbrun</strong>:  Requests that an application or command be run in a controlled account and provides for advanced root privilege delegation and keylogging</p></li>
<li><p><strong>pfexec</strong>: Executes commands with predefined process attributes, such as specific user or group IDs</p></li>
<li><p><strong>dzdo</strong>: An enhanced version of sudo that uses RBAC information in an Centrify’s Active Directory service (see Centrify’s <a class="reference external" href="http://community.centrify.com/t5/Centrify-Server-Suite/FAQ-What-is-DirectAuthorize-dzdo-dzwin/td-p/21193">site on DZDO</a>)</p></li>
<li><p><strong>pmrun</strong>: Requests that an application is run in a controlled account (refer to <a class="reference external" href="http://documents.software.dell.com/privilege-manager-for-unix/6.0/administrators-guide/privilege-manager-programs/pmrun">Privilege Manager for Unix 6.0</a>)</p></li>
<li><p><strong>runas</strong>: Allows you to run as the current user</p></li>
<li><p><strong>enable</strong>: Switches to elevated permissions on a network device</p></li>
<li><p><strong>doas</strong>: Allows your remote/login user to execute commands as another user via the doas (“Do as user”) utility</p></li>
<li><p><strong>ksu</strong>: Allows your remote/login user to execute commands as another user via Kerberos access</p></li>
<li><p><strong>machinectl</strong>: Allows you to manage containers via the systemd machine manager</p></li>
<li><p><strong>sesu</strong>: Allows your remote/login user to execute commands as another user via the CA Privileged Access Manager</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Custom <code class="docutils literal notranslate"><span class="pre">become</span></code> plugins are available only starting with Ansible 2.8. For more detail on this concept, refer to <cite>Understanding Privilege Escalation  https://docs.ansible.com/ansible/latest/user_guide/become.html</cite> and the <cite>list of become plugins https://docs.ansible.com/ansible/latest/plugins/become.html#plugin-list</cite>.</p>
</div>
<ul class="simple">
<li><p><strong>Privilege Escalation Username</strong> field is only seen if an option for privilege escalation is selected. Enter the username to use with escalation privileges on the remote system.</p></li>
<li><p><strong>Privilege Escalation Password</strong>: field is only seen if an option for privilege escalation is selected. Enter the actual password to be used to authenticate the user via the selected privilege escalation type on the remote system. This password will be stored encrypted in the database, if entered. Alternatively, you may configure AWX to ask the user for the password at launch time by selecting <strong>Prompt on launch</strong>. In these cases, a dialog opens when the job is launched, promoting the user to enter the password and password confirmation.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sudo Password must be used in combination with SSH passwords or SSH Private Keys, since AWX must first establish an authenticated SSH connection with the host prior to invoking sudo to change to the sudo user.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Credentials which are used in <em>Scheduled Jobs</em> must not be configured as “<strong>Prompt on launch</strong>”.</p>
</div>
</section>
<section id="microsoft-azure-key-vault">
<h5><a class="toc-backref" href="#id16" role="doc-backlink"><span class="section-number">10.4.16. </span>Microsoft Azure Key Vault</a><a class="headerlink" href="#microsoft-azure-key-vault" title="Link to this heading"></a></h5>
<p>This is considered part of the secret management capability. See <a class="reference internal" href="index.html#ug-credentials-azurekeyvault"><span class="std std-ref">Microsoft Azure Key Vault</span></a> for more detail.</p>
</section>
<section id="microsoft-azure-resource-manager">
<h5><a class="toc-backref" href="#id17" role="doc-backlink"><span class="section-number">10.4.17. </span>Microsoft Azure Resource Manager</a><a class="headerlink" href="#microsoft-azure-resource-manager" title="Link to this heading"></a></h5>
<p id="index-14">Selecting this credential type enables synchronization of cloud inventory with Microsoft Azure Resource Manager.</p>
<p><img alt="Credentials - create Azure credential form" src="_images/credentials-create-azure-credential.png" /></p>
<p>Microsoft Azure Resource Manager credentials have several attributes that may be configured:</p>
<ul class="simple">
<li><p><strong>Subscription ID</strong>: The Subscription UUID for the Microsoft Azure account (required).</p></li>
<li><p><strong>Username</strong>: The username to use to connect to the Microsoft Azure account.</p></li>
<li><p><strong>Password</strong>: The password to use to connect to the Microsoft Azure account.</p></li>
<li><p><strong>Client ID</strong>: The Client ID for the Microsoft Azure account.</p></li>
<li><p><strong>Client Secret</strong>: The Client Secret for the Microsoft Azure account.</p></li>
<li><p><strong>Tenant ID</strong>: The Tenant ID for the Microsoft Azure account.</p></li>
<li><p><strong>Azure Cloud Environment</strong>: The variable associated with Azure cloud or Azure stack environments.</p></li>
</ul>
<p>These fields are equivalent to the variables in the API. To pass service principal credentials, define the following variables:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">AZURE_CLIENT_ID</span>
<span class="l l-Scalar l-Scalar-Plain">AZURE_SECRET</span>
<span class="l l-Scalar l-Scalar-Plain">AZURE_SUBSCRIPTION_ID</span>
<span class="l l-Scalar l-Scalar-Plain">AZURE_TENANT</span>
<span class="l l-Scalar l-Scalar-Plain">AZURE_CLOUD_ENVIRONMENT</span>
</pre></div>
</div>
<p>To pass an Active Directory username/password pair, define the following variables:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">AZURE_AD_USER</span>
<span class="l l-Scalar l-Scalar-Plain">AZURE_PASSWORD</span>
<span class="l l-Scalar l-Scalar-Plain">AZURE_SUBSCRIPTION_ID</span>
</pre></div>
</div>
<p>You can also pass credentials as parameters to a task within a playbook. The order of precedence is parameters, then environment variables, and finally a file found in your home directory.</p>
<p>To pass credentials as parameters to a task, use the following parameters for service principal credentials:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">client_id</span>
<span class="l l-Scalar l-Scalar-Plain">secret</span>
<span class="l l-Scalar l-Scalar-Plain">subscription_id</span>
<span class="l l-Scalar l-Scalar-Plain">tenant</span>
<span class="l l-Scalar l-Scalar-Plain">azure_cloud_environment</span>
</pre></div>
</div>
<p>Or, pass the following parameters for Active Directory username/password:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ad_user</span>
<span class="l l-Scalar l-Scalar-Plain">password</span>
<span class="l l-Scalar l-Scalar-Plain">subscription_id</span>
</pre></div>
</div>
</section>
<section id="network">
<h5><a class="toc-backref" href="#id18" role="doc-backlink"><span class="section-number">10.4.18. </span>Network</a><a class="headerlink" href="#network" title="Link to this heading"></a></h5>
<p id="index-15">Select the Network credential type <strong>only</strong> if you are using a <cite>local</cite> connection with <cite>provider</cite> to use Ansible networking modules to connect to and manage networking devices. When connecting to network devices, the credential type must match the connection type:</p>
<ul class="simple">
<li><p>For <code class="docutils literal notranslate"><span class="pre">local</span></code> connections using <code class="docutils literal notranslate"><span class="pre">provider</span></code>, credential type should be <strong>Network</strong></p></li>
<li><p>For all other network connections (<code class="docutils literal notranslate"><span class="pre">httpapi</span></code>, <code class="docutils literal notranslate"><span class="pre">netconf</span></code>, and <code class="docutils literal notranslate"><span class="pre">network_cli</span></code>), credential type should be <strong>Machine</strong></p></li>
</ul>
<p>For an overview of connection types available for network devices, refer to <a class="reference external" href="https://docs.ansible.com/ansible/devel/network/getting_started/network_differences.html#multiple-communication-protocols.">Multiple Communication Protocols</a>.</p>
<blockquote>
<div></div></blockquote>
<p>AWX uses the following environment variables for Network credentials and are fields prompted in the user interface:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ANSIBLE_NET_USERNAME</span>
<span class="l l-Scalar l-Scalar-Plain">ANSIBLE_NET_PASSWORD</span>
</pre></div>
</div>
<p><img alt="Credentials - create network credential form" src="_images/credentials-create-network-credential.png" /></p>
<p>Network credentials have several attributes that may be configured:</p>
<ul class="simple">
<li><p><strong>Username</strong>: The username to use in conjunction with the network device (required).</p></li>
<li><p><strong>Password</strong>:  The password to use in conjunction with the network device.</p></li>
<li><p><strong>SSH Private Key</strong>: Copy or drag-and-drop the actual SSH Private Key to be used to authenticate the user to the network via SSH.</p></li>
<li><p><strong>Private Key Passphrase</strong>: The actual passphrase for the private key to be used to authenticate the user to the network via SSH.</p></li>
<li><p><strong>Authorize</strong>: Select this from the Options field to control whether or not to enter privileged mode.</p></li>
<li><p>If <strong>Authorize</strong> is checked, enter a password in the <strong>Authorize Password</strong> field to access privileged mode.</p></li>
</ul>
<p>For more information, refer to the <em>Inside Playbook</em> blog, <a class="reference external" href="https://www.ansible.com/blog/porting-ansible-network-playbooks-with-new-connection-plugins">Porting Ansible Network Playbooks with New Connection Plugins</a>.</p>
</section>
<section id="openshift-or-kubernetes-api-bearer-token">
<span id="ug-credentials-ocp-k8s"></span><h5><a class="toc-backref" href="#id19" role="doc-backlink"><span class="section-number">10.4.19. </span>OpenShift or Kubernetes API Bearer Token</a><a class="headerlink" href="#openshift-or-kubernetes-api-bearer-token" title="Link to this heading"></a></h5>
<p id="index-16">Selecting this credential type allows you to create instance groups that point to a Kubernetes or OpenShift container. For more information about this concept, refer to <a class="reference internal" href="index.html#ag-ext-exe-env"><span class="std std-ref">Container and Instance Groups</span></a>.</p>
<p><img alt="Credentials - create Containers credential form" src="_images/credentials-create-containers-credential.png" /></p>
<p>Container credentials have the following inputs:</p>
<ul class="simple">
<li><p><strong>OpenShift or Kubernetes API Endpoint</strong> (required): the endpoint to be used to connect to an OpenShift or Kubernetes container</p></li>
<li><p><strong>API Authentication Bearer Token</strong> (required): The token to use to authenticate the connection</p></li>
<li><p><strong>Verify SSL</strong>: Optionally you can check this option to verify the server’s SSL certificate is valid and trusted. Environments that use internal or private CA’s should leave this option unchecked to disable verification.</p></li>
<li><p><strong>Certificate Authority Data</strong>: include the <code class="docutils literal notranslate"><span class="pre">BEGIN</span> <span class="pre">CERTIFICATE</span></code> and <code class="docutils literal notranslate"><span class="pre">END</span> <span class="pre">CERTIFICATE</span></code> lines when pasting the certificate, if provided</p></li>
</ul>
<p>A <code class="docutils literal notranslate"><span class="pre">ContainerGroup</span></code> is a type of <code class="docutils literal notranslate"><span class="pre">InstanceGroup</span></code> that has an associated Credential that allows for connecting to an OpenShift cluster. To set up a container group, you must first have the following:</p>
<ul class="simple">
<li><p>A namespace you can launch into (every cluster has a “default” namespace, but you may want to use a specific namespace)</p></li>
<li><p>A service account that has the roles that allow it to launch and manage Pods in this namespace</p></li>
<li><p>If you will be using execution environments in a private registry, and have a Container Registry credential associated to them in AWX, the service account also needs the roles to get, create, and delete secrets in the namespace. If you do not want to give these roles to the service account, you can pre-create the <code class="docutils literal notranslate"><span class="pre">ImagePullSecrets</span></code> and specify them on the pod spec for the ContainerGroup. In this case, the execution environment should NOT have a Container Registry credential associated, or AWX will attempt to create the secret for you in the namespace.</p></li>
<li><p>A token associated with that service account (OpenShift or Kubernetes Bearer Token)</p></li>
<li><p>A CA certificate associated with the cluster</p></li>
</ul>
<p>This section describes creating a Service Account in an Openshift cluster (or K8s) in order to be used to run jobs in a container group via AWX. After the Service Account is created, its credentials are provided to AWX in the form of an Openshift or Kubernetes API bearer token credential. Below describes how to create a service account and collect the needed information for configuring AWX.</p>
<p>To configure AWX:</p>
<ol class="arabic">
<li><p>To create a service account, you may download and use this sample service account, <a class="reference download internal" download="" href="_downloads/c0241c5d30477cf767908e8b663d5fec/containergroup-sa.yml"><code class="xref download docutils literal notranslate"><span class="pre">containergroup</span> <span class="pre">sa</span></code></a> and modify it as needed to obtain the above credentials.</p></li>
<li><p>Apply the configuration from <code class="docutils literal notranslate"><span class="pre">containergroup-sa.yml</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">oc apply -f containergroup-sa.yml</span>
</pre></div>
</div>
</li>
<li><p>Get the secret name associated with the service account:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">export SA_SECRET=$(oc get sa containergroup-service-account -o json | jq &#39;.secrets[0].name&#39; | tr -d &#39;&quot;&#39;)</span>
</pre></div>
</div>
</li>
<li><p>Get the token from the secret:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">oc get secret $(echo ${SA_SECRET}) -o json | jq &#39;.data.token&#39; | xargs | base64 --decode &gt; containergroup-sa.token</span>
</pre></div>
</div>
</li>
<li><p>Get the CA cert:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">oc get secret $SA_SECRET -o json | jq &#39;.data[&quot;ca.crt&quot;]&#39; | xargs | base64 --decode &gt; containergroup-ca.crt</span>
</pre></div>
</div>
</li>
<li><p>Use the contents of <code class="docutils literal notranslate"><span class="pre">containergroup-sa.token</span></code> and <code class="docutils literal notranslate"><span class="pre">containergroup-ca.crt</span></code> to provide the information for the <a class="reference internal" href="#ug-credentials-ocp-k8s"><span class="std std-ref">OpenShift or Kubernetes API Bearer Token</span></a> required for the container group.</p></li>
</ol>
</section>
<section id="openstack">
<h5><a class="toc-backref" href="#id20" role="doc-backlink"><span class="section-number">10.4.20. </span>OpenStack</a><a class="headerlink" href="#openstack" title="Link to this heading"></a></h5>
<p id="index-17">Selecting this credential type enables synchronization of cloud inventory with OpenStack.</p>
<p><img alt="Credentials - create OpenStack credential form" src="_images/credentials-create-openstack-credential.png" /></p>
<p>OpenStack credentials have the following inputs that are required:</p>
<ul class="simple">
<li><p><strong>Username</strong>: The username to use to connect to OpenStack.</p></li>
<li><p><strong>Password (API Key)</strong>: The password or API key to use to connect to OpenStack.</p></li>
<li><p><strong>Host (Authentication URL)</strong>: The host to be used for authentication.</p></li>
<li><p><strong>Project (Tenant Name)</strong>: The Tenant name or Tenant ID used for OpenStack. This value is usually the same as the username.</p></li>
<li><p><strong>Project (Domain Name)</strong>: Optionally provide the project name associated with your domain.</p></li>
<li><p><strong>Domain name</strong>: Optionally provide the FQDN to be used to connect to OpenStack.</p></li>
</ul>
<p>If you are interested in using OpenStack Cloud Credentials, refer to <a class="reference internal" href="index.html#ug-cloudcredentials"><span class="std std-ref">Utilizing Cloud Credentials</span></a> in this guide for more information, including a sample playbook.</p>
</section>
<section id="red-hat-ansible-automation-platform">
<h5><a class="toc-backref" href="#id21" role="doc-backlink"><span class="section-number">10.4.21. </span>Red Hat Ansible Automation Platform</a><a class="headerlink" href="#red-hat-ansible-automation-platform" title="Link to this heading"></a></h5>
<p id="index-18">Selecting this credential allows you to access a Red Hat Ansible Automation Platform instance.</p>
<img alt="Credentials - create Red Hat Ansible Automation Platform credential form" src="_images/credentials-create-at-credential.png" />
<p>The Red Hat Ansible Automation Platform credentials have the following inputs that are required:</p>
<ul class="simple">
<li><p><strong>Red Hat Ansible Automation Platform</strong>: The base URL or IP address of the other instance to connect to.</p></li>
<li><p><strong>Username</strong>: The username to use to connect to it.</p></li>
<li><p><strong>Password</strong>: The password to use to connect to it.</p></li>
<li><p><strong>Oauth Token</strong>: If username and password is not used, provide an OAuth token to use to authenticate.</p></li>
</ul>
</section>
<section id="red-hat-satellite-6">
<h5><a class="toc-backref" href="#id22" role="doc-backlink"><span class="section-number">10.4.22. </span>Red Hat Satellite 6</a><a class="headerlink" href="#red-hat-satellite-6" title="Link to this heading"></a></h5>
<p id="index-19">Selecting this credential type enables synchronization of cloud inventory with Red Hat Satellite 6.</p>
<p>AWX writes a Satellite configuration file based on fields prompted in the user interface. The absolute path to the file is set in the following environment variable:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">FOREMAN_INI_PATH</span>
</pre></div>
</div>
<p><img alt="Credentials - create Red Hat Satellite 6 credential form" src="_images/credentials-create-rh-sat-credential.png" /></p>
<p>Satellite credentials have the following inputs that are required:</p>
<ul class="simple">
<li><p><strong>Satellite 6 URL</strong>: The Satellite 6 URL or IP address to connect to.</p></li>
<li><p><strong>Username</strong>: The username to use to connect to Satellite 6.</p></li>
<li><p><strong>Password</strong>: The password to use to connect to Satellite 6.</p></li>
</ul>
</section>
<section id="red-hat-virtualization">
<h5><a class="toc-backref" href="#id23" role="doc-backlink"><span class="section-number">10.4.23. </span>Red Hat Virtualization</a><a class="headerlink" href="#red-hat-virtualization" title="Link to this heading"></a></h5>
<p id="index-20">This credential allows AWX to access Ansible’s <code class="docutils literal notranslate"><span class="pre">oVirt4.py</span></code> dynamic inventory plugin, which is managed by Red Hat Virtualization (RHV).</p>
<p>AWX uses the following environment variables for Red Hat Virtualization credentials and are fields in the user interface:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">OVIRT_URL</span>
<span class="l l-Scalar l-Scalar-Plain">OVIRT_USERNAME</span>
<span class="l l-Scalar l-Scalar-Plain">OVIRT_PASSWORD</span>
</pre></div>
</div>
<p><img alt="Credentials - create Red Hat Virtualization credential form" src="_images/credentials-create-rhv-credential.png" /></p>
<p>RHV credentials have the following inputs that are required:</p>
<ul class="simple">
<li><p><strong>Host (Authentication URL)</strong>: The host URL or IP address to connect to. In order to sync with the inventory, the credential URL needs to include the <code class="docutils literal notranslate"><span class="pre">ovirt-engine/api</span></code> path.</p></li>
<li><p><strong>Username</strong>: The username to use to connect to oVirt4. This needs to include the domain profile to succeed, for example <code class="docutils literal notranslate"><span class="pre">username&#64;ovirt.host.com</span></code>.</p></li>
<li><p><strong>Password</strong>: The password to use to connect to it.</p></li>
<li><p><strong>CA File</strong>: Optionally provide an absolute path to the oVirt certificate file (it may end in <code class="docutils literal notranslate"><span class="pre">.pem</span></code>, <code class="docutils literal notranslate"><span class="pre">.cer</span></code> and <code class="docutils literal notranslate"><span class="pre">.crt</span></code> extensions, but preferably <code class="docutils literal notranslate"><span class="pre">.pem</span></code> for consistency)</p></li>
</ul>
</section>
<section id="source-control">
<h5><a class="toc-backref" href="#id24" role="doc-backlink"><span class="section-number">10.4.24. </span>Source Control</a><a class="headerlink" href="#source-control" title="Link to this heading"></a></h5>
<p id="index-21">SCM (source control) credentials are used with Projects to clone and update local source code repositories from a remote revision control system such as Git or Subversion.</p>
<p><img alt="Credentials - create SCM credential form" src="_images/credentials-create-scm-credential.png" /></p>
<p>Source Control credentials have several attributes that may be configured:</p>
<ul class="simple">
<li><p><strong>Username</strong>: The username to use in conjunction with the source control system.</p></li>
<li><p><strong>Password</strong>:  The password to use in conjunction with the source control system.</p></li>
<li><p><strong>SCM Private Key</strong>: Copy or drag-and-drop the actual SSH Private Key to be used to authenticate the user to the source control system via SSH.</p></li>
<li><p><strong>Private Key Passphrase</strong>: If the SSH Private Key used is protected by a passphrase, you may configure a Key Passphrase for the private key.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Source Control credentials cannot be configured as “<strong>Prompt on launch</strong>”.
If you are using a GitHub account for a Source Control credential and you have 2FA (Two Factor Authentication) enabled on your account, you will need to use your Personal Access Token in the password field rather than your account password.</p>
</div>
</section>
<section id="terraform-backend-configuration">
<span id="ug-credentials-terraform"></span><h5><a class="toc-backref" href="#id25" role="doc-backlink"><span class="section-number">10.4.25. </span>Terraform backend configuration</a><a class="headerlink" href="#terraform-backend-configuration" title="Link to this heading"></a></h5>
<p id="index-22">Terraform is a HashiCorp tool used to automate various infrastructure tasks. Select this credential type to enable synchronization with the Terraform inventory source.</p>
<p>The Terraform credential requires the <strong>Backend configuration</strong> attribute which should contain the data from a <a class="reference external" href="https://developer.hashicorp.com/terraform/language/settings/backends/configuration">Terraform backend block</a>. You can paste, drag a file, browse to upload a file, or click the (<img alt="Credentials - create Terraform backend configuration credential form" src="_images/key-mgmt-button.png" />) button to populate the field from an external <a class="reference internal" href="index.html#ug-credential-plugins"><span class="std std-ref">Secret Management System</span></a>. An example configuration for an S3 backend:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">bucket = &quot;my-terraform-state-bucket&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">key = &quot;path/to/terraform-state-file&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">region = &quot;us-east-1&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">access_key = &quot;my-aws-access-key&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">secret_key = &quot;my-aws-secret-access-key&quot;</span>
</pre></div>
</div>
<p><img alt="Credentials - create Terraform backend configuration credential form" src="_images/credentials-create-terraform-credential.png" /></p>
<p>Saving it stores the file path to the backend configuration in an environment variable <code class="docutils literal notranslate"><span class="pre">TF_BACKEND_CONFIG_FILE</span></code> that is made available to any job with the credential attached.</p>
</section>
<section id="thycotic-devops-secrets-vault">
<h5><a class="toc-backref" href="#id26" role="doc-backlink"><span class="section-number">10.4.26. </span>Thycotic DevOps Secrets Vault</a><a class="headerlink" href="#thycotic-devops-secrets-vault" title="Link to this heading"></a></h5>
<p>This is considered part of the secret management capability. See <a class="reference internal" href="index.html#ug-credentials-thycoticvault"><span class="std std-ref">Thycotic DevOps Secrets Vault</span></a> for more detail.</p>
</section>
<section id="thycotic-secret-server">
<h5><a class="toc-backref" href="#id27" role="doc-backlink"><span class="section-number">10.4.27. </span>Thycotic Secret Server</a><a class="headerlink" href="#thycotic-secret-server" title="Link to this heading"></a></h5>
<p>This is considered part of the secret management capability. See <a class="reference internal" href="index.html#ug-credentials-thycoticserver"><span class="std std-ref">Thycotic Secret Server</span></a> for more detail.</p>
</section>
<section id="vault">
<h5><a class="toc-backref" href="#id28" role="doc-backlink"><span class="section-number">10.4.28. </span>Vault</a><a class="headerlink" href="#vault" title="Link to this heading"></a></h5>
<p id="index-23">Selecting this credential type enables synchronization of inventory with Ansible Vault.</p>
<p><img alt="Credentials - create Vault credential form" src="_images/credentials-create-vault-credential.png" /></p>
<p>Vault credentials require the <strong>Vault Password</strong> and an optional <strong>Vault Identifier</strong> if applying multi-Vault credentialing. For more information on AWX Multi-Vault support, refer to the <a class="reference internal" href="index.html#ag-multi-vault"><span class="std std-ref">Multi-Vault Credentials</span></a> section of the <em>AWX Administration Guide</em>.</p>
<p>You may configure AWX to ask the user for the password at launch time by selecting <strong>Prompt on launch</strong>. In these cases, a dialog opens when the job is launched, promoting the user to enter the password and password confirmation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Credentials which are used in <em>Scheduled Jobs</em> must not be configured as “<strong>Prompt on launch</strong>”.</p>
</div>
<p>For more information about Ansible Vault, refer to: <a class="reference external" href="http://docs.ansible.com/ansible/playbooks_vault.html">http://docs.ansible.com/ansible/playbooks_vault.html</a></p>
</section>
<section id="vmware-vcenter">
<h5><a class="toc-backref" href="#id29" role="doc-backlink"><span class="section-number">10.4.29. </span>VMware vCenter</a><a class="headerlink" href="#vmware-vcenter" title="Link to this heading"></a></h5>
<p id="index-24">Selecting this credential type enables synchronization of inventory with VMware vCenter.</p>
<p>AWX uses the following environment variables for VMware vCenter credentials and are fields prompted in the user interface:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">VMWARE_HOST</span>
<span class="l l-Scalar l-Scalar-Plain">VMWARE_USER</span>
<span class="l l-Scalar l-Scalar-Plain">VMWARE_PASSWORD</span>
<span class="l l-Scalar l-Scalar-Plain">VMWARE_VALIDATE_CERTS</span>
</pre></div>
</div>
<p><img alt="Credentials - create VMware credential form" src="_images/credentials-create-vmware-credential.png" /></p>
<p>VMware credentials have the following inputs that are required:</p>
<ul class="simple">
<li><p><strong>vCenter Host</strong>: The vCenter hostname or IP address to connect to.</p></li>
<li><p><strong>Username</strong>: The username to use to connect to vCenter.</p></li>
<li><p><strong>Password</strong>: The password to use to connect to vCenter.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the VMware guest tools are not running on the instance, VMware inventory sync may not return an IP address for that instance.</p>
</div>
</section>
</section>
</section>
<span id="document-userguide/credential_types"></span><section id="custom-credential-types">
<span id="ug-credential-types"></span><h3><span class="section-number">11. </span>Custom Credential Types<a class="headerlink" href="#custom-credential-types" title="Link to this heading"></a></h3>
<p id="index-0">As an administrator with superuser access, you can define a custom credential type in a standard format using a YAML/JSON-like definition, allowing the assignment of new credential types to jobs and inventory updates. This allows you to define a custom credential type that works in ways similar to existing credential types. For example, you could create a custom credential type that injects an API token for a third-party web service into an environment variable, which your playbook or custom inventory script could consume.</p>
<p>Custom credentials support the following ways of injecting their authentication information:</p>
<ul class="simple">
<li><p>Environment variables</p></li>
<li><p>Ansible extra variables</p></li>
<li><p>File-based templating (i.e., generating <code class="docutils literal notranslate"><span class="pre">.ini</span></code> or <code class="docutils literal notranslate"><span class="pre">.conf</span></code> files that contain credential values)</p></li>
</ul>
<p>You can attach one SSH and multiple cloud credentials to a Job Template. Each cloud credential must be of a different type. In other words, only one AWS credential, one GCE credential, etc., are allowed. Vault credentials and machine credentials are separate entities.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When creating a new credential type, you are responsible for avoiding collisions in the <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code>, <code class="docutils literal notranslate"><span class="pre">env</span></code>, and file namespaces. Also, avoid environment variable or extra variable names that start with <code class="docutils literal notranslate"><span class="pre">ANSIBLE_</span></code> because they are reserved. You must have Superuser permissions to be able to create and edit a credential type (<code class="docutils literal notranslate"><span class="pre">CredentialType</span></code>) and to be able to view the <code class="docutils literal notranslate"><span class="pre">CredentialType.injection</span></code> field.</p>
</div>
<section id="content-sourcing-from-collections">
<h4><span class="section-number">11.1. </span>Content sourcing from collections<a class="headerlink" href="#content-sourcing-from-collections" title="Link to this heading"></a></h4>
<p>A “managed” credential type of <code class="docutils literal notranslate"><span class="pre">kind=galaxy</span></code> represents a content source for fetching collections defined in <code class="docutils literal notranslate"><span class="pre">requirements.yml</span></code> when project updates are run (e.g., galaxy.ansible.com, cloud.redhat.com, on-premise Automation Hub). This new type will represent a URL and (optional) authentication details necessary to construct the environment variables when a project update runs <code class="docutils literal notranslate"><span class="pre">ansible-galaxy</span> <span class="pre">collection</span> <span class="pre">install</span></code> as described in the Ansible documentation, <a class="reference external" href="https://docs.ansible.com/ansible/latest/user_guide/collections_using.html#configuring-the-ansible-galaxy-client">Configuring the ansible-galaxy client</a>. It has fields which map directly to the configuration options exposed to the Ansible Galaxy CLI, e.g., per-server. An endpoint in the API reflects an ordered list of these credentials at the Organization level:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">/api/v2/organizations/N/galaxy_credentials/</span>
</pre></div>
</div>
<p>Installations of AWX migrates existing Galaxy-oriented setting values in such a way that post-upgrade, proper credentials are created and attached to every Organization. After upgrading to the latest version, every organization that existed prior to upgrade now has a list of (one or more) “Galaxy” credentials associated with it.</p>
<p>Additionally, post-upgrade, these settings are not be visible (or editable) from the <code class="docutils literal notranslate"><span class="pre">/api/v2/settings/jobs/</span></code> endpoint.</p>
<p>AWX should still continue to fetch roles directly from public Galaxy even if galaxy.ansible.com is not the first credential in the list for the Organization. The global “Galaxy” settings are no longer configured at the jobs level, but at the Organization level in the User Interface. The Organization’s Add and Edit windows have an optional <strong>Credential</strong> lookup field for credentials of <code class="docutils literal notranslate"><span class="pre">kind=galaxy</span></code>.</p>
<img alt="Create a new Organization with Galaxy Credentials" src="_images/organizations-galaxy-credentials.png" />
<p>It is very important to specify the order of these credentials as order sets precedence for the sync and lookup of the content.
For more information, see <a class="reference internal" href="index.html#ug-organizations-create"><span class="std std-ref">Creating a New Organization</span></a>.
For detail on how to set up a project using collections, see <a class="reference internal" href="index.html#ug-collections-usage"><span class="std std-ref">Using Collections via Hub</span></a>.</p>
</section>
<section id="backwards-compatible-api-considerations">
<h4><span class="section-number">11.2. </span>Backwards-Compatible API Considerations<a class="headerlink" href="#backwards-compatible-api-considerations" title="Link to this heading"></a></h4>
<p id="index-1">Support for version 2 of the API (<code class="docutils literal notranslate"><span class="pre">api/v2/</span></code>) means a one-to-many relationship for Job Templates to credentials (including multi-cloud support). Credentials can be filtered using the v2 API:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ curl &quot;https://awx.example.org/api/v2/credentials/?credential_type__namespace=aws&quot;</span>
</pre></div>
</div>
<p>In the V2 CredentialType model, the relationships are defined as follows:</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Machine</p></td>
<td><p>SSH</p></td>
</tr>
<tr class="row-even"><td><p>Vault</p></td>
<td><p>Vault</p></td>
</tr>
<tr class="row-odd"><td><p>Network</p></td>
<td><p>Sets environment variables (e.g., <code class="docutils literal notranslate"><span class="pre">ANSIBLE_NET_AUTHORIZE</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p>SCM</p></td>
<td><p>Source Control</p></td>
</tr>
<tr class="row-odd"><td><p>Cloud</p></td>
<td><p>EC2, AWS</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Lots of others</p></td>
</tr>
<tr class="row-odd"><td><p>Insights</p></td>
<td><p>Insights</p></td>
</tr>
<tr class="row-even"><td><p>Galaxy</p></td>
<td><p>galaxy.ansible.com, cloud.redhat.com</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>on-premise Automation Hub</p></td>
</tr>
</tbody>
</table>
</section>
<section id="content-verification">
<span id="ug-content-verification"></span><h4><span class="section-number">11.3. </span>Content verification<a class="headerlink" href="#content-verification" title="Link to this heading"></a></h4>
<p>AWX uses GNU Privacy Guard (GPG) to verify content. For more information, refer to <a class="reference external" href="https://www.gnupg.org/gph/en/manual/c14.html#:~:text=GnuPG%20uses%20public%2Dkey%20cryptography,the%20user%20wants%20to%20communicate">The GNU Privacy Handbook</a>.</p>
</section>
<section id="getting-started-with-credential-types">
<h4><span class="section-number">11.4. </span>Getting Started with Credential Types<a class="headerlink" href="#getting-started-with-credential-types" title="Link to this heading"></a></h4>
<p id="index-2">Access the Credentials from clicking <strong>Credential Types</strong> from the left navigation bar. If no custom credential types have been created, the Credential Types view will not have any to display and will prompt you to add one:</p>
<p><img alt="Credential Types view without any credential types populated" src="_images/credential-types-home-empty.png" /></p>
<p>If credential types have been created, this page displays a list of all existing and available Credential Types.</p>
<p><img alt="Credential Types list view with example credential types" src="_images/credential-types-home-with-example-types.png" /></p>
<p>To view more information about a credential type, click on its name or the Edit (<img alt="Edit button" src="_images/edit-button.png" />) button from the <strong>Actions</strong> column.</p>
<p>Each credential type displays its own unique configurations in the <strong>Input Configuration</strong> field and the <strong>Injector Configuration</strong> field, if applicable. Both YAML and JSON formats are supported in the configuration fields.</p>
</section>
<section id="create-a-new-credential-type">
<h4><span class="section-number">11.5. </span>Create a New Credential Type<a class="headerlink" href="#create-a-new-credential-type" title="Link to this heading"></a></h4>
<p id="index-3">To create a new credential type:</p>
<ol class="arabic simple">
<li><p>Click the <strong>Add</strong> button in the <strong>Credential Types</strong> screen.</p></li>
</ol>
<p><img alt="Create new credential type form" src="_images/credential-types-create-new.png" /></p>
<ol class="arabic simple" start="2">
<li><p>Enter the appropriate details in the <strong>Name</strong> and <strong>Description</strong> field.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When creating a new credential type, do not use reserved variable names that start with <code class="docutils literal notranslate"><span class="pre">ANSIBLE_</span></code> for the <strong>INPUT</strong> and <strong>INJECTOR</strong> names and IDs, as they are invalid for custom credential types.</p>
</div>
<ol class="arabic simple" start="3">
<li><p>In the <strong>Input Configuration</strong> field, specify an input schema which defines a set of ordered fields for that type. The format can be in YAML or JSON, as shown:</p></li>
</ol>
<blockquote>
<div><p><strong>YAML</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">fields</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">    </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">username</span>
<span class="w">    </span><span class="nt">label</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Username</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">    </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password</span>
<span class="w">    </span><span class="nt">label</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Password</span>
<span class="w">    </span><span class="nt">secret</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">required</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">username</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password</span>
</pre></div>
</div>
<p><strong>JSON</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="nt">&quot;fields&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;username&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Username&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;secret&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;password&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Password&quot;</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w"> </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;password&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The configuration in JSON format below show each field and how they are used:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{
  &quot;fields&quot;: [{
    &quot;id&quot;: &quot;api_token&quot;,               # required - a unique name used to
                                     # reference the field value

    &quot;label&quot;: &quot;API Token&quot;,            # required - a unique label for the
                                     # field

    &quot;help_text&quot;: &quot;User-facing short text describing the field.&quot;,

    &quot;type&quot;: (&quot;string&quot; | &quot;boolean&quot;)   # defaults to &#39;string&#39;

    &quot;choices&quot;: [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;]       # (only applicable to `type=string`)

    &quot;format&quot;: &quot;ssh_private_key&quot;      # optional, can be used to enforce data
                                     # format validity for SSH private key
                                     # data (only applicable to `type=string`)

    &quot;secret&quot;: true,                  # if true, the field value will be encrypted

    &quot;multiline&quot;: false               # if true, the field should be rendered
                                     # as multi-line for input entry
                                     # (only applicable to `type=string`)
},{
    # field 2...
},{
    # field 3...
}],

&quot;required&quot;: [&quot;api_token&quot;]            # optional; one or more fields can be marked as required
},
</pre></div>
</div>
</div></blockquote>
<p>When <code class="docutils literal notranslate"><span class="pre">type=string</span></code>, fields can optionally specify multiple choice options:</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{
  &quot;fields&quot;: [{
      &quot;id&quot;: &quot;api_token&quot;,          # required - a unique name used to reference the field value
      &quot;label&quot;: &quot;API Token&quot;,       # required - a unique label for the field
      &quot;type&quot;: &quot;string&quot;,
      &quot;choices&quot;: [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;]
  }]
},
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>In the <strong>Injector Configuration</strong> field, enter environment variables or extra variables that specify the values a credential type can inject. The format can be in YAML or JSON (see examples in the previous step). The configuration in JSON format below show each field and how they are used:</p></li>
</ol>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;file&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;template&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;[mycloud]\ntoken={{ api_token }}&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;env&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;THIRD_PARTY_CLOUD_API_TOKEN&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{ api_token }}&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;extra_vars&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;some_extra_var&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{ username }}:{{ password }}&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Credential Types can also generate temporary files to support .ini files or certificate/key data:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;file&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;template&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;[mycloud]\ntoken={{ api_token }}&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;env&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;MY_CLOUD_INI_FILE&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{ awx.filename }}&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this example, AWX will write a temporary file that contains:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[mycloud]\ntoken=SOME_TOKEN_VALUE
</pre></div>
</div>
<p>The absolute file path to the generated file will be stored in an environment variable named <code class="docutils literal notranslate"><span class="pre">MY_CLOUD_INI_FILE</span></code>.</p>
<p>An example of referencing multiple files in a custom credential template is as follows:</p>
<p><strong>Inputs</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;fields&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cert&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Certificate&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">  </span><span class="p">},{</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;key&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Key&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span>
<span class="w">  </span><span class="p">}]</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Injectors</strong></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;file&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;template.cert_file&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;[mycert]\n{{ cert }}&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;template.key_file&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;[mykey]\n{{ key }}&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;env&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;MY_CERT_INI_FILE&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{ awx.filename.cert_file }}&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;MY_KEY_INI_FILE&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{ awx.filename.key_file }}&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Click <strong>Save</strong> when done.</p></li>
<li><p>Scroll down to the bottom of the screen and your newly created credential type appears on the list of credential types:</p></li>
</ol>
<p><img alt="Credential Types list view with newly created credential type shown" src="_images/credential-types-new-listed.png" /></p>
<p>Click <img alt="Edit button" src="_images/edit-button.png" /> to modify the credential type options under the Actions column.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the Edit screen, you can modify the details or delete the credential. If the <strong>Delete</strong> button is grayed out, it is indication that the credential type that is being used by a credential, and you must delete the credential type from all the credentials that use it before you can delete it. Below is an example of such a message:</p>
<img alt="Credential type delete confirmation" src="_images/credential-types-delete-confirmation.png" />
</div>
<ol class="arabic simple" start="7">
<li><p>Verify that the newly created credential type can be selected from the <strong>Credential Type</strong> selection window when creating a new credential:</p></li>
</ol>
<p><img alt="Newly created credential type selected from the credentials drop-down menu" src="_images/credential-types-new-listed-verify.png" /></p>
<p>For details on how to create a new credential, see <a class="reference internal" href="index.html#ug-credentials"><span class="std std-ref">Credentials</span></a>.</p>
</section>
</section>
<span id="document-userguide/credential_plugins"></span><section id="secret-management-system">
<span id="ug-credential-plugins"></span><h3><span class="section-number">12. </span>Secret Management System<a class="headerlink" href="#secret-management-system" title="Link to this heading"></a></h3>
<p id="index-0">Users and admins upload machine and cloud credentials so that automation can access machines and external services on their behalf. By default, sensitive credential values (such as SSH passwords, SSH private keys, API tokens for cloud services) are stored in the database after being encrypted. With external credentials backed by credential plugins, you can map credential fields (like a password or an SSH Private key) to values stored in a <a class="reference internal" href="index.html#term-Secret-Management-System"><span class="xref std std-term">secret management system</span></a> instead of providing them to AWX directly. AWX provides a secret management system that include integrations for:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#ug-credentials-aws-lookup"><span class="std std-ref">AWS Secrets Manager Lookup</span></a></p></li>
<li><p><a class="reference internal" href="#ug-credentials-centrify"><span class="std std-ref">Centrify Vault Credential Provider Lookup</span></a></p></li>
<li><p><a class="reference internal" href="#ug-credentials-cyberarkccp"><span class="std std-ref">CyberArk Central Credential Provider (CCP) Lookup</span></a></p></li>
<li><p><a class="reference internal" href="#ug-credentials-cyberarkconjur"><span class="std std-ref">CyberArk Conjur Secrets Manager Lookup</span></a></p></li>
<li><p><a class="reference internal" href="#ug-credentials-hashivault"><span class="std std-ref">HashiCorp Vault Secret Lookup</span></a> (KV)</p></li>
<li><p><a class="reference internal" href="#ug-credentials-hashivaultssh"><span class="std std-ref">HashiCorp Vault Signed SSH</span></a></p></li>
<li><p><a class="reference internal" href="#ug-credentials-azurekeyvault"><span class="std std-ref">Microsoft Azure Key Vault</span></a> (KMS)</p></li>
<li><p><a class="reference internal" href="#ug-credentials-thycoticvault"><span class="std std-ref">Thycotic DevOps Secrets Vault</span></a></p></li>
<li><p><a class="reference internal" href="#ug-credentials-thycoticserver"><span class="std std-ref">Thycotic Secret Server</span></a></p></li>
</ul>
<p>These external secret values will be fetched prior to running a playbook that needs them. For more information on specifying these credentials in the User Interface, see <a class="reference internal" href="index.html#ug-credentials"><span class="std std-ref">Credentials</span></a>.</p>
<section id="configure-and-link-secret-lookups">
<h4><span class="section-number">12.1. </span>Configure and link secret lookups<a class="headerlink" href="#configure-and-link-secret-lookups" title="Link to this heading"></a></h4>
<p>When configuring AWX to pull a secret from a 3rd-party system, it is in essence linking credential fields to external systems. To link a credential field to a value stored in an external system, select the external credential corresponding to that system and provide <a class="reference internal" href="index.html#term-Metadata"><span class="xref std std-term">metadata</span></a> to look up the desired value. The metadata input fields are part of the <a class="reference internal" href="index.html#term-External-Credential-Type"><span class="xref std std-term">external credential type</span></a> definition of the <a class="reference internal" href="index.html#term-Source-Credential"><span class="xref std std-term">source credential</span></a>.</p>
<p>AWX provides a <a class="reference internal" href="index.html#term-Credential-Plugin"><span class="xref std std-term">credential plugin</span></a> interface for developers, integrators, admins, and power-users with the ability to add new external credential types to extend it to support other secret management systems. For more detail, see the <a class="reference external" href="https://github.com/ansible/awx/blob/devel/docs/credentials/credential_plugins.md">development docs for credential plugins</a>.</p>
<p>Use the AWX User Interface to configure and use each of the supported 3-party secret management systems.</p>
<ol class="arabic simple">
<li><p>First, create an external credential for authenticating with the secret management system. At minimum, provide a name for the external credential and select one of the following for the <strong>Credential Type</strong>:</p></li>
</ol>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#aws-secrets-manager-lookup" id="id4">AWS Secrets Manager Lookup</a></p></li>
<li><p><a class="reference internal" href="#centrify-vault-credential-provider-lookup" id="id5">Centrify Vault Credential Provider Lookup</a></p></li>
<li><p><a class="reference internal" href="#cyberark-central-credential-provider-ccp-lookup" id="id6">CyberArk Central Credential Provider (CCP) Lookup</a></p></li>
<li><p><a class="reference internal" href="#cyberark-conjur-secrets-manager-lookup" id="id7">CyberArk Conjur Secrets Manager Lookup</a></p></li>
<li><p><a class="reference internal" href="#hashicorp-vault-secret-lookup" id="id8">HashiCorp Vault Secret Lookup</a></p></li>
<li><p><a class="reference internal" href="#hashicorp-vault-signed-ssh" id="id9">HashiCorp Vault Signed SSH</a></p></li>
<li><p><a class="reference internal" href="#microsoft-azure-key-vault" id="id10">Microsoft Azure Key Vault</a></p></li>
<li><p><a class="reference internal" href="#thycotic-devops-secrets-vault" id="id11">Thycotic DevOps Secrets Vault</a></p></li>
<li><p><a class="reference internal" href="#thycotic-secret-server" id="id12">Thycotic Secret Server</a></p></li>
</ul>
</nav>
<ol class="arabic simple" start="2">
<li><p>Navigate to the credential form of the target credential and link one or more input fields to the external credential along with metadata for locating the secret in the external system. In this example, the <em>Demo Credential</em> is the target credential.</p></li>
</ol>
<ol class="arabic simple" id="ag-credential-plugins-link-step" start="3">
<li><p>For any of the fields below the <strong>Type Details</strong> area that you want to link to the external credential, click the <img alt="Icon for managing external credentials" src="_images/key-mgmt-button.png" /> button of the input field. You are prompted to set the input source to use to retrieve your secret information.</p></li>
</ol>
<img alt="Credential section of the external secret management system dialog" src="_images/credentials-link-credential-prompt.png" />
<ol class="arabic simple" start="4">
<li><p>Select the credential you want to link to, and click <strong>Next</strong>. This takes you to the <strong>Metadata</strong> tab of the input source. Metadata is specific to the input source you select:</p></li>
</ol>
<table class="docutils align-default" style="width: 1400px">
<colgroup>
<col style="width: 22%" />
<col style="width: 22%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Input Source</p></th>
<th class="head"><p>Metadata</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>AWS Secrets Manager</em></p></td>
<td><p>AWS Secrets Manager Region (required)</p></td>
<td><p>The region where the secrets manager is located.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>AWS Secret Name (Required)</p></td>
<td><p>Specify the AWS secret name that was generated by the AWS access key.</p></td>
</tr>
<tr class="row-even"><td><p><em>Centrify Vault Credential Provider Lookup</em></p></td>
<td><p>Account Name (Required)</p></td>
<td><p>Name of the system account or domain associated with Centrify Vault.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>System Name</p></td>
<td><p>Specify the name used by the Centrify portal.</p></td>
</tr>
<tr class="row-even"><td><p><em>CyberArk Central Credential Provider Lookup</em></p></td>
<td><p>Object Query (Required)</p></td>
<td><p>Lookup query for the object.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Object Query Format</p></td>
<td><p>Select <code class="docutils literal notranslate"><span class="pre">Exact</span></code> for a specific secret name, or <code class="docutils literal notranslate"><span class="pre">Regexp</span></code> for a secret that has a dynamically generated name.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Object Property</p></td>
<td><p>Specifies the name of the property to return (e.g., <code class="docutils literal notranslate"><span class="pre">UserName</span></code>, <code class="docutils literal notranslate"><span class="pre">Address</span></code>, etc.) other than the default of <code class="docutils literal notranslate"><span class="pre">Content</span></code>.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Reason</p></td>
<td><p>If required per the object’s policy, supply a reason for checking out the secret, as CyberArk logs those.</p></td>
</tr>
<tr class="row-even"><td><p><em>CyberArk Conjur Secrets Lookup</em></p></td>
<td><p>Secret Identifier</p></td>
<td><p>The identifier for the secret.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Secret Version</p></td>
<td><p>Specify a version of the secret, if necessary, otherwise, leave it empty to use the latest version.</p></td>
</tr>
<tr class="row-even"><td><p><em>HashiVault Secret Lookup</em></p></td>
<td><p>Name of Secret Backend</p></td>
<td><p>Specify the name of the KV backend to use. Leave it blank to use the first path segment of the <strong>Path to Secret</strong> field instead.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Path to Secret (required)</p></td>
<td><p>Specify the path to where the secret information is stored; for example, <code class="docutils literal notranslate"><span class="pre">/path/username</span></code>.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Key Name (required)</p></td>
<td><p>Specify the name of the key to look up the secret information.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Secret Version (V2 Only)</p></td>
<td><p>Specify a version if necessary, otherwise, leave it empty to use the latest version.</p></td>
</tr>
<tr class="row-even"><td><p><em>HashiCorp Signed SSH</em></p></td>
<td><p>Unsigned Public Key (required)</p></td>
<td><p>Specify the public key of the cert you want to get signed. It needs to be present in the authorized keys file of the target host(s).</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Path to Secret (required)</p></td>
<td><p>Specify the path to where the secret information is stored; for example, <code class="docutils literal notranslate"><span class="pre">/path/username</span></code>.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Role Name (required)</p></td>
<td><p>A role is a collection of SSH settings and parameters that are stored in Hashi vault. Typically, you can specify a couple of them with different privileges, timeouts, etc. So you could have a role that is allowed to get a cert signed for root, and other less privileged ones, for example.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Valid Principals</p></td>
<td><p>Specify a user (or users) other than the default, that you are requesting vault to authorize the cert for the stored key. Hashi vault has a default user for whom it signs (e.g., ec2-user).</p></td>
</tr>
<tr class="row-even"><td><p><em>Azure KMS</em></p></td>
<td><p>Secret Name (required)</p></td>
<td><p>The actual name of the secret as it is referenced in Azure’s Key vault app.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Secret Version</p></td>
<td><p>Specify a version of the secret, if necessary, otherwise, leave it empty to use the latest version.</p></td>
</tr>
<tr class="row-even"><td><p><em>Thycotic DevOps Secrets Vault</em></p></td>
<td><p>Secret Path (required)</p></td>
<td><p>Specify the path to where the secret information is stored (e.g., /path/username).</p></td>
</tr>
<tr class="row-odd"><td><p><em>Thycotic Secret Server</em></p></td>
<td><p>Secret ID (required)</p></td>
<td><p>The identifier for the secret.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Secret Field</p></td>
<td><p>Specify the field to be used from the secret.</p></td>
</tr>
</tbody>
</table>
<p>This example shows the Metadata prompt for HashiVault Secret Lookup.</p>
<img alt="Metadata section of the external secret management system dialog" src="_images/credentials-link-metadata-prompt.png" />
<ol class="arabic simple" start="5">
<li><p>Click <strong>Test</strong> to verify connection to the secret management system. If the lookup is unsuccessful, an error message like this one displays:</p></li>
</ol>
<img alt="Example exception dialog for credentials lookup" src="_images/credentials-link-metadata-test-error.png" />
<ol class="arabic simple" start="6">
<li><p>When done, click <strong>OK</strong>. This closes the prompt window and returns you to the Details screen of your target credential. <strong>Repeat these steps</strong>, starting with <a class="reference internal" href="#ag-credential-plugins-link-step"><span class="std std-ref">step 3 above</span></a> to complete the remaining input fields for the target credential. By linking the information in this manner, AWX retrieves sensitive information, such as username, password, keys, certificates, and tokens from the 3rd-party management systems and populates that data into the remaining fields of the target credential form.</p></li>
<li><p>If necessary, supply any information manually for those fields that do not use linking as a way of retrieving sensitive information. Refer to the appropriate <a class="reference internal" href="index.html#ug-credentials-cred-types"><span class="std std-ref">Credential Types</span></a> for more detail about each of the fields.</p></li>
<li><p>Click <strong>Save</strong> when done.</p></li>
</ol>
<section id="aws-secrets-manager-lookup">
<span id="ug-credentials-aws-lookup"></span><h5><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">12.1.1. </span>AWS Secrets Manager Lookup</a><a class="headerlink" href="#aws-secrets-manager-lookup" title="Link to this heading"></a></h5>
<p id="index-1">This plugin allows AWS to be used as a credential input source to pull secrets from AWS SecretsManager. <a class="reference external" href="https://aws.amazon.com/secrets-manager/">AWS Secrets Manager</a> provides similar service to <a class="reference internal" href="#ug-credentials-azurekeyvault"><span class="std std-ref">Microsoft Azure Key Vault</span></a>, and the AWS collection provides a lookup plugin for it.</p>
<p>When <strong>AWS Secrets Manager lookup</strong> is selected for <strong>Credential Type</strong>, provide the following attributes to properly configure your lookup:</p>
<ul class="simple">
<li><p><strong>AWS Access Key</strong> (required): provide the access key used for communicating with AWS’ key management system</p></li>
<li><p><strong>AWS Secret Key</strong> (required): provide the secret as obtained by the AWS IAM console</p></li>
</ul>
<p>Below shows an example of a configured AWS Secret Manager credential.</p>
<a class="reference internal image-reference" href="_images/credentials-create-aws-secret-credential.png"><img alt="Example new AWS Secret Manager credential lookup dialog" src="_images/credentials-create-aws-secret-credential.png" style="width: 1400px;" /></a>
</section>
<section id="centrify-vault-credential-provider-lookup">
<span id="ug-credentials-centrify"></span><h5><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">12.1.2. </span>Centrify Vault Credential Provider Lookup</a><a class="headerlink" href="#centrify-vault-credential-provider-lookup" title="Link to this heading"></a></h5>
<p id="index-2">You need the Centrify Vault web service running to store secrets in order for this integration to work. When <strong>Centrify Vault Credential Provider Lookup</strong> is selected for <strong>Credential Type</strong>, provide the following attributes to properly configure your lookup:</p>
<ul class="simple">
<li><p><strong>Centrify Tenant URL</strong> (required): provide the URL used for communicating with Centrify’s secret management system</p></li>
<li><p><strong>Centrify API User</strong> (required): provide the username</p></li>
<li><p><strong>Centrify API Password</strong> (required): provide the password</p></li>
<li><p><strong>OAuth2 Application ID</strong> : specify the identifier given associated with the OAuth2 client</p></li>
<li><p><strong>OAuth2 Scope</strong> : specify the scope of the OAuth2 client</p></li>
</ul>
<p>Below shows an example of a configured CyberArk AIM credential.</p>
<img alt="Example new centrify vault credential lookup dialog" src="_images/credentials-create-centrify-vault-credential.png" />
</section>
<section id="cyberark-central-credential-provider-ccp-lookup">
<span id="ug-credentials-cyberarkccp"></span><h5><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">12.1.3. </span>CyberArk Central Credential Provider (CCP) Lookup</a><a class="headerlink" href="#cyberark-central-credential-provider-ccp-lookup" title="Link to this heading"></a></h5>
<p id="index-3">You need the CyberArk Central Credential Provider web service running to store secrets in order for this integration to work. When <strong>CyberArk Central Credential Provider Lookup</strong> is selected for <strong>Credential Type</strong>, provide the following attributes to properly configure your lookup:</p>
<ul class="simple">
<li><p><strong>CyberArk CCP URL</strong> (required): provide the URL used for communicating with CyberArk CCP’s secret management system; must include URL scheme (http, https, etc.)</p></li>
<li><p><strong>Web Service ID</strong>: optionally specify the identifier for the web service; leaving it blank defaults to AIMWebService</p></li>
<li><p><strong>Application ID</strong> (required): specify the identifier given by CyberArk CCP services</p></li>
<li><p><strong>Client Key</strong>: paste the client key if provided by CyberArk</p></li>
<li><p><strong>Client Certificate</strong>: include the <code class="docutils literal notranslate"><span class="pre">BEGIN</span> <span class="pre">CERTIFICATE</span></code> and <code class="docutils literal notranslate"><span class="pre">END</span> <span class="pre">CERTIFICATE</span></code> lines when pasting the certificate, if provided by CyberArk</p></li>
<li><p><strong>Verify SSL Certificates</strong>: this option is only available when the URL uses HTTPS. Check this option to verify the server’s SSL certificate is valid and trusted. Environments that use internal or private CA’s should leave this option unchecked to disable verification.</p></li>
</ul>
<p>Below shows an example of a configured CyberArk CCP credential.</p>
<img alt="Example new CyberArk vault credential lookup dialog" src="_images/credentials-create-cyberark-ccp-credential.png" />
</section>
<section id="cyberark-conjur-secrets-manager-lookup">
<span id="ug-credentials-cyberarkconjur"></span><h5><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">12.1.4. </span>CyberArk Conjur Secrets Manager Lookup</a><a class="headerlink" href="#cyberark-conjur-secrets-manager-lookup" title="Link to this heading"></a></h5>
<p id="index-4">With a Conjur Cloud tenant available to target, configure the CyberArk Conjur Secrets Lookup external management system credential plugin as documented.</p>
<p>When <strong>CyberArk Conjur Secrets Manager Lookup</strong> is selected for <strong>Credential Type</strong>, provide the following attributes to properly configure your lookup:</p>
<ul class="simple">
<li><p><strong>Conjur URL</strong> (required): provide the URL used for communicating with CyberArk Conjur’s secret management system; must include URL scheme (http, https, etc.)</p></li>
<li><p><strong>API Key</strong> (required): provide the key given by your Conjur admin</p></li>
<li><p><strong>Account</strong> (required): the organization’s account name</p></li>
<li><p><strong>Username</strong> (required): the specific authenticated user for this service</p></li>
<li><p><strong>Public Key Certificate</strong>: include the <code class="docutils literal notranslate"><span class="pre">BEGIN</span> <span class="pre">CERTIFICATE</span></code> and <code class="docutils literal notranslate"><span class="pre">END</span> <span class="pre">CERTIFICATE</span></code> lines when pasting the public key, if provided by CyberArk</p></li>
</ul>
<p>Below shows an example of a configured CyberArk Conjur credential.</p>
<img alt="Example new CyberArk Conjur Secret lookup dialog" src="_images/credentials-create-cyberark-conjur-credential.png" />
</section>
<section id="hashicorp-vault-secret-lookup">
<span id="ug-credentials-hashivault"></span><h5><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">12.1.5. </span>HashiCorp Vault Secret Lookup</a><a class="headerlink" href="#hashicorp-vault-secret-lookup" title="Link to this heading"></a></h5>
<p id="index-5">When <strong>HashiCorp Vault Secret Lookup</strong> is selected for <strong>Credential Type</strong>, provide the following attributes to properly configure your lookup:</p>
<ul class="simple">
<li><p><strong>Server URL</strong> (required): provide the URL used for communicating with HashiCorp Vault’s secret management system</p></li>
<li><p><strong>Token</strong>: specify the access token used to authenticate HashiCorp’s server</p></li>
<li><p><strong>CA Certificate</strong>: specify the CA certificate used to verify HashiCorp’s server</p></li>
<li><p><strong>Approle Role_ID</strong>: specify the ID if using Approle for authentication</p></li>
<li><p><strong>Approle Secret_ID</strong>: specify the corresponding secret ID for Approle authentication</p></li>
<li><p><strong>Client Certificate</strong>: specify a PEM-encoded client certificate when using the TLS auth method including any required intermediate certificates expected by Vault</p></li>
<li><p><strong>Client Certificate Key</strong>: specify a PEM-encoded certificate private key when using the TLS auth method</p></li>
<li><p><strong>TLS Authentication Role</strong>: specify the role or certificate name in Vault that corresponds to your client certificate when using the TLS auth method. If it is not provided, Vault will attempt to match the certificate automatically</p></li>
<li><p><strong>Namespace name</strong> specify the namespace name (Vault Enterprise only)</p></li>
<li><p><strong>Kubernetes role</strong> specify the role name when using Kubernetes authentication</p></li>
<li><p><strong>Username</strong>: enter the username of the user to be used to authenticate this service</p></li>
<li><p><strong>Password</strong>: enter the password associated with the user to authenticate this service</p></li>
<li><p><strong>Path to Auth</strong>: specify a path if other than the default path of <code class="docutils literal notranslate"><span class="pre">/approle</span></code></p></li>
<li><p><strong>API Version</strong> (required): select v1 for static lookups and v2 for versioned lookups</p></li>
</ul>
<p>For more detail about the Approle auth method and its fields, refer to the <a class="reference external" href="https://developer.hashicorp.com/vault/docs/auth/approle">Vault documentation for Approle Auth Method</a>.</p>
<p>LDAP authentication requires LDAP to be configured in HashiCorp’s Vault UI. A policy may be added to the user if they want access to a specific engine created. As long as the bind is set properly, the user should be able to successfully authenticate. Cubbyhole is the name of the default secret mount. If you have proper permissions, you can create other mounts and write key values to those. For more detail about the LDAP auth method and its fields, refer to the <a class="reference external" href="https://developer.hashicorp.com/vault/docs/auth/ldap">Vault documentation for LDAP auth method</a>.</p>
<p>For more detail about the userpass auth method and its fields, refer to the <a class="reference external" href="https://developer.hashicorp.com/vault/docs/auth/userpass">Vault documentation for userpass auth method</a>.</p>
<p>For more detail about the Kubernetes auth method and its fields, refer to the <a class="reference external" href="https://developer.hashicorp.com/vault/docs/auth/kubernetes">Vault documentation for Kubernetes auth method</a>.</p>
<p>For more detail about the TLS certificate auth method and its fields, refer to the <a class="reference external" href="https://developer.hashicorp.com/vault/docs/auth/cert">Vault documentation for TLS certificates auth method</a>.</p>
<p>Below shows an example of a configured HashiCorp Vault Secret Lookup  credential for LDAP.</p>
<img alt="Example new HashiCorp Vault Secret lookup dialog" src="_images/credentials-create-hashicorp-kv-credential.png" />
<p>To test the lookup, create another credential that uses the HashiCorp Vault lookup. The example below shows the attributes for a machine credential configured to look up HashiCorp Vault secret credentials:</p>
<img alt="Example machine credential lookup metadata for HashiCorp Vault." src="_images/credentials-machine-test-hashicorp-metadata.png" />
</section>
<section id="hashicorp-vault-signed-ssh">
<span id="ug-credentials-hashivaultssh"></span><h5><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">12.1.6. </span>HashiCorp Vault Signed SSH</a><a class="headerlink" href="#hashicorp-vault-signed-ssh" title="Link to this heading"></a></h5>
<p id="index-6">When <strong>HashiCorp Vault Signed SSH</strong> is selected for <strong>Credential Type</strong>, provide the following attributes to properly configure your lookup:</p>
<ul class="simple">
<li><p><strong>Server URL</strong> (required): provide the URL used for communicating with HashiCorp Signed SSH’s secret management system</p></li>
<li><p><strong>Token</strong>: specify the access token used to authenticate HashiCorp’s server</p></li>
<li><p><strong>CA Certificate</strong>: specify the CA certificate used to verify HashiCorp’s server</p></li>
<li><p><strong>Approle Role_ID</strong>: specify the ID for Approle authentication</p></li>
<li><p><strong>Approle Secret_ID</strong>: specify the corresponding secret ID for Approle authentication</p></li>
<li><p><strong>Client Certificate</strong>: specify a PEM-encoded client certificate when using the TLS auth method including any required intermediate certificates expected by Vault</p></li>
<li><p><strong>Client Certificate Key</strong>: specify a PEM-encoded certificate private key when using the TLS auth method</p></li>
<li><p><strong>TLS Authentication Role</strong>: specify the role or certificate name in Vault that corresponds to your client certificate when using the TLS auth method. If it is not provided, Vault will attempt to match the certificate automatically</p></li>
<li><p><strong>Namespace name</strong> specify the namespace name (Vault Enterprise only)</p></li>
<li><p><strong>Kubernetes role</strong> specify the role name when using Kubernetes authentication</p></li>
<li><p><strong>Username</strong>: enter the username of the user to be used to authenticate this service</p></li>
<li><p><strong>Password</strong>: enter the password associated with the user to authenticate this service</p></li>
<li><p><strong>Path to Auth</strong>: specify a path if other than the default path of <code class="docutils literal notranslate"><span class="pre">/approle</span></code></p></li>
</ul>
<p>For more detail about the Approle auth method and its fields, refer to the <a class="reference external" href="https://developer.hashicorp.com/vault/docs/auth/approle">Vault documentation for Approle Auth Method</a>.</p>
<p>For more detail about the Kubernetes auth method and its fields, refer to the <a class="reference external" href="https://developer.hashicorp.com/vault/docs/auth/kubernetes">Vault documentation for Kubernetes auth method</a>.</p>
<p>For more detail about the TLS certificate auth method and its fields, refer to the <a class="reference external" href="https://developer.hashicorp.com/vault/docs/auth/cert">Vault documentation for TLS certificates auth method</a>.</p>
<p>Below shows an example of a configured HashiCorp SSH Secrets Engine credential.</p>
<img alt="Example new HashiCorp Vault Signed SSH credential lookup dialog" src="_images/credentials-create-hashicorp-ssh-credential.png" />
</section>
<section id="microsoft-azure-key-vault">
<span id="ug-credentials-azurekeyvault"></span><h5><a class="toc-backref" href="#id10" role="doc-backlink"><span class="section-number">12.1.7. </span>Microsoft Azure Key Vault</a><a class="headerlink" href="#microsoft-azure-key-vault" title="Link to this heading"></a></h5>
<p id="index-7">When <strong>Microsoft Azure Key Vault</strong> is selected for <strong>Credential Type</strong>, provide the following attributes to properly configure your lookup:</p>
<ul class="simple">
<li><p><strong>Vault URL (DNS Name)</strong> (required): provide the URL used for communicating with MS Azure’s key management system</p></li>
<li><p><strong>Client ID</strong> (required): provide the identifier as obtained by the Azure Active Directory</p></li>
<li><p><strong>Client Secret</strong> (required): provide the secret as obtained by the Azure Active Directory</p></li>
<li><p><strong>Tenant ID</strong> (required): provide the unique identifier that is associated with an Azure Active Directory instance within an Azure subscription</p></li>
<li><p><strong>Cloud Environment</strong>: select the applicable cloud environment to apply</p></li>
</ul>
<p>Below shows an example of a configured Microsoft Azure KMS credential.</p>
<img alt="Example new Microsoft Azure Key Vault credential lookup dialog" src="_images/credentials-create-azure-kms-credential.png" />
</section>
<section id="thycotic-devops-secrets-vault">
<span id="ug-credentials-thycoticvault"></span><h5><a class="toc-backref" href="#id11" role="doc-backlink"><span class="section-number">12.1.8. </span>Thycotic DevOps Secrets Vault</a><a class="headerlink" href="#thycotic-devops-secrets-vault" title="Link to this heading"></a></h5>
<p id="index-8">When <strong>Thycotic DevOps Secrets Vault</strong> is selected for <strong>Credential Type</strong>, provide the following attributes to properly configure your lookup:</p>
<ul class="simple">
<li><p><strong>Tenant</strong> (required): provide the URL used for communicating with Thycotic’s secret management system</p></li>
<li><p><strong>Top-level Domain (TLD)</strong> : provide the top-level domain designation (e.g., com, edu, org) associated with the secret vault you want to integrate</p></li>
<li><p><strong>Client ID</strong> (required): provide the identifier as obtained by the Thycotic secret management system</p></li>
<li><p><strong>Client Secret</strong> (required): provide the secret as obtained by the Thycotic secret management system</p></li>
</ul>
<p>Below shows an example of a configured Thycotic DevOps Secrets Vault credential.</p>
<img alt="Example new Thycotic DevOps Secrets Vault credential lookup dialog" src="_images/credentials-create-thycotic-devops-credential.png" />
</section>
<section id="thycotic-secret-server">
<span id="ug-credentials-thycoticserver"></span><h5><a class="toc-backref" href="#id12" role="doc-backlink"><span class="section-number">12.1.9. </span>Thycotic Secret Server</a><a class="headerlink" href="#thycotic-secret-server" title="Link to this heading"></a></h5>
<p id="index-9">When <strong>Thycotic Secrets Server</strong> is selected for <strong>Credential Type</strong>, provide the following attributes to properly configure your lookup:</p>
<ul class="simple">
<li><p><strong>Secret Server URL</strong> (required): provide the URL used for communicating with the Thycotic Secrets Server management system</p></li>
<li><p><strong>Username</strong> (required): specify the authenticated user for this service</p></li>
<li><p><strong>Password</strong> (required): provide the password associated with the user</p></li>
</ul>
<p>Below shows an example of a configured Thycotic Secret Server credential.</p>
<img alt="Example new Thycotic Secret Server credential lookup dialog" src="_images/credentials-create-thycotic-server-credential.png" />
</section>
</section>
</section>
<span id="document-userguide/applications_auth"></span><section id="applications">
<span id="ug-applications-auth"></span><h3><span class="section-number">13. </span>Applications<a class="headerlink" href="#applications" title="Link to this heading"></a></h3>
<p id="index-0">Creating and configuring token-based authentication for external applications makes it easier for external applications such as ServiceNow and Jenkins to integrate with AWX. OAuth 2 allows you to use tokens to share certain data with an application without disclosing login information, and furthermore, these tokens can be scoped as “read-only”.  You create an application that is representative of the external application you are integrating with, then use it to create tokens for that application to use on behalf of the users of the external application.</p>
<p>Having these tokens associated to an application resource gives you the ability to manage all tokens issued for a particular application more easily. By separating token issuance under Applications, you can revoke all tokens based on the Application without having to revoke all tokens in the system.</p>
<p>When integrating an external web app with AWX that web app may need to create OAuth2 Tokens on behalf of users in that other web app. Creating an application with the Authorization Code grant type is the preferred way to do this because:</p>
<ul class="simple">
<li><p>external applications can obtain a token for users, using their credentials</p></li>
<li><p>compartmentalized tokens issued for a particular application, allows those tokens to be easily managed (revoke all tokens associated with that application, for example)</p></li>
</ul>
<section id="getting-started-with-applications">
<h4><span class="section-number">13.1. </span>Getting Started with Applications<a class="headerlink" href="#getting-started-with-applications" title="Link to this heading"></a></h4>
<p id="index-1">Access the Applications page by clicking <strong>Applications</strong> from the left navigation bar. The Applications page displays a search-able list of all available Applications currently managed by AWX and can be sorted by <strong>Name</strong>.</p>
<p><img alt="Applications list view" src="_images/apps-list-view-examples.png" /></p>
<p>If no other applications exist, only a gray box with a message to add applications displays.</p>
<img alt="No applications found in the list view" src="_images/apps-list-view-empty.png" />
</section>
<section id="create-a-new-application">
<span id="ug-applications-auth-create"></span><h4><span class="section-number">13.2. </span>Create a new application<a class="headerlink" href="#create-a-new-application" title="Link to this heading"></a></h4>
<p id="index-2">Token-based authentication for users can be configured in the Applications window.</p>
<ol class="arabic simple">
<li><p>In the AWX User Interface, click <strong>Applications</strong> from the left navigation bar.</p></li>
</ol>
<p>The Applications window opens.</p>
<ol class="arabic simple" start="2">
<li><p>Click the <strong>Add</strong> button located in the upper right corner of the Applications window.</p></li>
</ol>
<p>The New Application window opens.</p>
<p><img alt="Create new application dialog" src="_images/apps-create-new.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Enter the following details in <strong>Create New Application</strong> window:</p></li>
</ol>
<ul class="simple">
<li><p><strong>Name</strong> (required): provide a name for the application you want to create</p></li>
<li><p><strong>Description</strong>: optionally provide a short description for your application</p></li>
<li><p><strong>Organization</strong> (required): provide an organization for which this application is associated</p></li>
<li><p><strong>Authorization Grant Type</strong> (required): Select from one of the grant types to use in order for the user to acquire tokens for this application. Refer to <a class="reference internal" href="index.html#ag-oauth2-token-auth-grant-types"><span class="std std-ref">grant types</span></a> in the Applications section of the <em>AWX Administration Guide</em>.</p></li>
<li><p><strong>Redirect URIS</strong>: Provide a list of allowed URIs, separated by spaces. This is required if you specified the grant type to be <strong>Authorization code</strong>.</p></li>
<li><p><strong>Client Type</strong> (required): Select the level of security of the client device</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p>When done, click <strong>Save</strong> or <strong>Cancel</strong> to abandon your changes. Upon saving, the client ID displays in a pop-up window.</p></li>
</ol>
<img alt="Client ID popup" src="_images/apps-client-id-popup.png" />
<section id="applications-tokens">
<h5><span class="section-number">13.2.1. </span>Applications - Tokens<a class="headerlink" href="#applications-tokens" title="Link to this heading"></a></h5>
<p id="index-3">Selecting the <strong>Tokens</strong> view displays a list of the users that have tokens to access the application.</p>
<p><img alt="Application tokens list view" src="_images/apps-tokens-list-view-examples.png" /></p>
<p>Tokens can only access resources that its associated user can access, and can be limited further by specifying the scope of the token.</p>
<section id="add-tokens">
<span id="ug-tokens-auth-create"></span><h6><span class="section-number">13.2.1.1. </span>Add Tokens<a class="headerlink" href="#add-tokens" title="Link to this heading"></a></h6>
<p>Tokens are added through the Users screen and can be associated with an application at that time. Specifying an application can be performed directly in the User’s token settings. You can create a token for <em>your</em> user in the Tokens configuration tab, meaning only you can create and see your tokens in your own user screen. To add a token:</p>
<ol class="arabic simple">
<li><p>Access the Users list view by clicking <strong>Users</strong> from the left navigation bar then click on your user to configure your OAuth 2 tokens.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can only create OAuth 2 Tokens for your user via the API or UI, which means you can only access your own user profile in order to configure or view your tokens. If you are an admin and need to create or remove tokens for other users, see the revoke and create commands in the <a class="reference internal" href="index.html#ag-token-utility"><span class="std std-ref">Token and session management</span></a> section of the <em>AWX Administration Guide</em>.</p>
</div>
<ol class="arabic simple" start="2">
<li><p>Click the <strong>Tokens</strong> tab from your user’s profile.</p></li>
</ol>
<p>When no tokens are present, the Tokens screen prompts you to add them:</p>
<img alt="_images/users-tokens-empty.png" src="_images/users-tokens-empty.png" />
<ol class="arabic simple" start="3">
<li><p>Click the <strong>Add</strong> button, which opens the Create Token window.</p></li>
<li><p>Enter the following details in Create Token window:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p><strong>Application</strong>: enter the name of the application with which you want to associate your token. Alternatively, you can search for it by clicking the <img alt="search" src="_images/search-button.png" /> button. This opens a separate window that allows you to choose from the available options. Use the Search bar to filter by name if the list is extensive. Leave this field blank if you want to create a Personal Access Token (PAT) that is not linked to any application.</p></li>
<li><p><strong>Description</strong>: optionally provide a short description for your token.</p></li>
<li><p><strong>Scope</strong> (required): specify the level of access you want this token to have.</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>When done, click <strong>Save</strong> or <strong>Cancel</strong> to abandon your changes.</p></li>
</ol>
<p>After the token is saved, the newly created token for the user displays with the token information and when it expires.</p>
<img alt="_images/users-token-information-example.png" src="_images/users-token-information-example.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the only time the token value and associated refresh token value will ever be shown.</p>
</div>
<p>In the user’s profile, the application for which it is assigned to and its expiration displays in the token list view.</p>
<img alt="_images/users-token-assignment-example.png" src="_images/users-token-assignment-example.png" />
<p>To verify the application in the example above now shows the user with the appropriate token, go to the <strong>Tokens</strong> tab of the Applications window:</p>
<img alt="Verifying a specific user application token" src="_images/apps-tokens-list-view-example2.png" />
</section>
</section>
</section>
</section>
<span id="document-userguide/execution_environments"></span><section id="execution-environments">
<span id="ug-execution-environments"></span><h3><span class="section-number">14. </span>Execution Environments<a class="headerlink" href="#execution-environments" title="Link to this heading"></a></h3>
<p id="index-0">The ability to build and deploy Python virtual environments for automation has been replaced by Ansible execution environments. Unlike legacy virtual environments, execution environments are container images that make it possible to incorporate system-level dependencies and collection-based content. Each execution environment allows you to have a customized image to run jobs, and each of them contain only what you need when running the job, nothing more.</p>
<section id="building-an-execution-environment">
<span id="ug-build-ees"></span><h4><span class="section-number">14.1. </span>Building an Execution Environment<a class="headerlink" href="#building-an-execution-environment" title="Link to this heading"></a></h4>
<p>The <a class="reference external" href="https://ansible.readthedocs.io/en/latest/getting_started_ee/index.html">Getting started with Execution Environments guide</a> will give you a brief technology overview and show you how to build and test your first execution environment in a few easy steps.</p>
</section>
<section id="use-an-execution-environment-in-jobs">
<h4><span class="section-number">14.2. </span>Use an execution environment in jobs<a class="headerlink" href="#use-an-execution-environment-in-jobs" title="Link to this heading"></a></h4>
<p>In order to use an execution environment in a job, a few components are required:</p>
<ul class="simple">
<li><p>Use the AWX user interface to specify the execution environment you <a class="reference internal" href="#ug-build-ees"><span class="std std-ref">build</span></a> to use in your job templates.</p></li>
<li><p>Depending on whether an execution environment is made available for global use or tied to an organization, you must have the appropriate level of administrator privileges in order to use an execution environment in a job. Execution environments tied to an organization require Organization administrators to be able to run jobs with those execution environments.</p></li>
<li><p>Before running a job or job template that uses an execution environment that has a credential assigned to it, be sure that the credential contains a username, host, and password.</p></li>
</ul>
<ol class="arabic simple">
<li><p>Click <strong>Execution Environments</strong> from the left navigation bar of the AWX user interface.</p></li>
<li><p>Add an execution environment by selecting the <strong>Add</strong> button.</p></li>
<li><p>Enter the appropriate details into the following fields:</p></li>
</ol>
<ul class="simple">
<li><p><strong>Name</strong>: Enter a name for the execution environment (required).</p></li>
<li><p><strong>Image</strong>: Enter the image name (required). The image name requires its full location (repo), the registry, image name, and version tag in the example format of <code class="docutils literal notranslate"><span class="pre">quay.io/ansible/awx-ee:latestrepo/project/image-name:tag</span></code>.</p></li>
<li><p><strong>Pull</strong>: optionally choose the type of pull when running jobs:</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><strong>Always pull container before running</strong>: Pulls the latest image file for the container.</p></li>
<li><p><strong>Only pull the image if not present before running</strong>: Only pulls latest image if none specified.</p></li>
<li><p><strong>Never pull container before running</strong>: Never pull the latest version of the container image.</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><strong>Description</strong>: optional.</p></li>
<li><p><strong>Organization</strong>: optionally assign the organization to specifically use this execution environment. To make the execution environment available for use across multiple organizations, leave this field blank.</p></li>
<li><p><strong>Registry credential</strong>: If the image has a protected container registry, provide the credential to access it.</p></li>
</ul>
<img alt="Create new Execution Environment form" src="_images/ee-new-ee-form-filled.png" />
<ol class="arabic simple" start="4">
<li><p>Click <strong>Save</strong>.</p></li>
</ol>
<p>Now your newly added execution environment is ready to be used in a job template. To add an execution environment to a job template, specify it in the <strong>Execution Environment</strong> field of the job template, as shown in the example below. For more information on setting up a job template, see <a class="reference internal" href="index.html#ug-jobtemplates"><span class="std std-ref">Job Templates</span></a> in the <em>AWX User Guide</em>.</p>
<img alt="Job template using newly created Execution Environment" src="_images/job-template-with-example-ee-selected.png" />
<p>Once you added an execution environment to a job template, you can see those templates listed in the <strong>Templates</strong> tab of the execution environment:</p>
<img alt="Templates tab of the Execution Environment showing one job associated with it" src="_images/ee-details-templates-list.png" />
</section>
<section id="execution-environment-mount-options">
<h4><span class="section-number">14.3. </span>Execution environment mount options<a class="headerlink" href="#execution-environment-mount-options" title="Link to this heading"></a></h4>
<span class="target" id="index-1"></span><p>Rebuilding an execution environment is one way to add certs, but inheriting certs from the host provides a more convenient solution.</p>
<p>Additionally, you may customize execution environment mount options and mount paths in the <strong>Paths to expose to isolated jobs</strong> field of the Job Settings page, where it supports podman-style volume mount syntax. Refer to the <a class="reference external" href="https://docs.podman.io/en/latest/markdown/podman-run.1.html#volume-v-source-volume-host-dir-container-dir-options">Podman documentation</a> for detail.</p>
<p>In some cases where the <code class="docutils literal notranslate"><span class="pre">/etc/ssh/*</span></code> files were added to the execution environment image due to customization of an execution environment, an SSH error may occur. For example, exposing the <code class="docutils literal notranslate"><span class="pre">/etc/ssh/ssh_config.d:/etc/ssh/ssh_config.d:O</span></code> path allows the container to be mounted, but the ownership permissions are not mapped correctly.</p>
<p>If you encounter this error, or have upgraded from an older version of AWX, perform the following steps:</p>
<ol class="arabic simple">
<li><p>Change the container ownership on the mounted volume  to <code class="docutils literal notranslate"><span class="pre">root</span></code>.</p></li>
<li><p>In the <strong>Paths to expose to isolated jobs</strong> field of the Job Settings page, using the current example, expose the path as such:</p></li>
</ol>
<img alt="Jobs Settings page showing Paths to expose to isolated jobs field with defaults" src="_images/settings-paths2expose-iso-jobs.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">:O</span></code> option is only supported for directories. It is highly recommended that you be as specific as possible, especially when specifying system paths. Mounting <code class="docutils literal notranslate"><span class="pre">/etc</span></code> or <code class="docutils literal notranslate"><span class="pre">/usr</span></code> directly have impact that make it difficult to troubleshoot.</p>
</div>
<p>This informs podman to run a command similar to the example below, where the configuration is mounted and the <code class="docutils literal notranslate"><span class="pre">ssh</span></code> command works as expected.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">podman run -v /ssh_config:/etc/ssh/ssh_config.d/:O ...</span>
</pre></div>
</div>
<p>To expose isolated paths in OpenShift or Kubernetes containers as HostPath, assume the following configuration:</p>
<img alt="Jobs Settings page showing Paths to expose to isolated jobs field with assumed configuration and Expose host paths for Container Group toggle enabled" src="_images/settings-paths2expose-iso-jobs-mount-containers.png" />
<p>Use the <strong>Expose host paths for Container Groups</strong> toggle to enable it.</p>
<p>Once the playbook runs, the resulting Pod spec will display similar to the example below. Note the details of the <code class="docutils literal notranslate"><span class="pre">volumeMounts</span></code> and <code class="docutils literal notranslate"><span class="pre">volumes</span></code> sections.</p>
<img alt="Pod spec for the playbook run showing volumeMounts and volumes details" src="_images/mount-containers-playbook-run-podspec.png" />
</section>
</section>
<span id="document-userguide/ee_reference"></span><section id="execution-environment-setup-reference">
<h3><span class="section-number">15. </span>Execution Environment Setup Reference<a class="headerlink" href="#execution-environment-setup-reference" title="Link to this heading"></a></h3>
<p>For detailed information about the execution environment definition,
refer to the <a class="reference external" href="https://ansible.readthedocs.io/projects/builder/en/latest/definition/#execution-environment-definition">Ansible Builder documentation</a>.</p>
<section id="default-execution-environment-for-awx">
<h4><span class="section-number">15.1. </span>Default execution environment for AWX<a class="headerlink" href="#default-execution-environment-for-awx" title="Link to this heading"></a></h4>
<p>The example in <code class="docutils literal notranslate"><span class="pre">test/data/pytz</span></code> requires the <code class="docutils literal notranslate"><span class="pre">awx.awx</span></code> collection in the execution environment definition. The lookup plugin <code class="docutils literal notranslate"><span class="pre">awx.awx.tower_schedule_rrule</span></code> requires the PyPI <code class="docutils literal notranslate"><span class="pre">pytz</span></code> and another library to work. If <code class="docutils literal notranslate"><span class="pre">test/data/pytz/execution-environment.yml</span></code> file is provided to the <code class="docutils literal notranslate"><span class="pre">ansible-builder</span> <span class="pre">build</span></code> command, then it will install the collection inside the image, read the <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file inside of the collection, and then install <code class="docutils literal notranslate"><span class="pre">pytz</span></code> into the image.</p>
<p>The image produced can be used inside of an <code class="docutils literal notranslate"><span class="pre">ansible-runner</span></code> project by placing these variables inside the <code class="docutils literal notranslate"><span class="pre">env/settings</span></code> file, inside of the private data directory.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">container_image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image-name</span>
<span class="nt">process_isolation_executable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">podman</span><span class="w"> </span><span class="c1"># or docker</span>
<span class="nt">process_isolation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">awx.awx</span></code> collection is a subset of content included in the default AWX execution environment. More details can be found in the <a class="reference external" href="https://github.com/ansible/awx-ee">awx-ee repository</a>.</p>
</section>
</section>
<span id="document-userguide/projects"></span><section id="projects">
<span id="ug-projects"></span><h3><span class="section-number">16. </span>Projects<a class="headerlink" href="#projects" title="Link to this heading"></a></h3>
<p id="index-0">A <a class="reference internal" href="index.html#term-Project"><span class="xref std std-term">Project</span></a> is a logical collection of Ansible playbooks.</p>
<p>You can manage playbooks and playbook directories by either placing them manually under the Project Base Path on your server, or by placing your playbooks into a source code management (SCM) system supported by AWX, including Git, Subversion, and Red Hat Insights. To create a Red Hat Insights project, refer to <a class="reference internal" href="index.html#insights"><span class="std std-ref">Setting up Insights Remediations</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, the Project Base Path is <code class="docutils literal notranslate"><span class="pre">/var/lib/awx/projects</span></code>, but this may have been modified by the administrator. It is configured in <code class="docutils literal notranslate"><span class="pre">/etc/awx/conf.d/custom.py</span></code>. Use caution when editing this file, as incorrect settings can disable your installation.</p>
</div>
<p>The Projects page displays the list of the projects that are currently available. The default view is collapsed (<strong>Compact</strong>) with project name and its status, but you can use the arrow next to each entry to expand for more information.</p>
<p><img alt="Compact Projects list view with two projects shown." src="_images/projects-list-all.png" /></p>
<img alt="Projects list view showing arrows used to expand and collapse projects in the view." src="_images/projects-list-all-expanded.png" />
<p>For each project listed, you can get the latest SCM revision (<img alt="Refresh button" src="_images/refresh-gray.png" />), edit the project (<img alt="edit button" src="_images/edit-button.png" />), or copy the project attributes (<img alt="copy button" src="_images/copy-button.png" />), using the respective icons next to each project. Projects are allowed to be updated while a related job is running.  In cases where you have a big project (around 10 GB), disk space on <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> may be an issue.</p>
<p><strong>Status</strong> indicates the state of the project and may be one of the following (note that you can also filter your view by specific status types):</p>
<ul class="simple">
<li><p><strong>Pending</strong> - The source control update has been created, but not queued or started yet. Any job (not just source control updates) will stay in pending until it’s actually ready to be run by the system. Reasons for it not being ready because it has dependencies that are currently running so it has to wait until they are done, or there is not enough capacity to run in the locations it is configured to.</p></li>
<li><p><strong>Waiting</strong> - The source control update is in the queue waiting to be executed.</p></li>
<li><p><strong>Running</strong> - The source control update is currently in progress.</p></li>
<li><p><strong>Successful</strong> - The last source control update for this project succeeded.</p></li>
<li><p><strong>Failed</strong> - The last source control update for this project failed.</p></li>
<li><p><strong>Error</strong> - The last source control update job failed to run at all. (To be deprecated.)</p></li>
<li><p><strong>Canceled</strong> - The last source control update for the project was canceled.</p></li>
<li><p><strong>Never updated</strong> - The project is configured for source control, but has never been updated.</p></li>
<li><p><strong>OK</strong> - The project is not configured for source control, and is correctly in place. (To be deprecated.)</p></li>
<li><p><strong>Missing</strong> - Projects are absent from the project base path of <code class="docutils literal notranslate"><span class="pre">/var/lib/awx/projects</span></code> (applicable for manual or source control managed projects).</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Projects of credential type Manual cannot update or schedule source control-based actions without being reconfigured as an SCM type credential.</p>
</div>
<blockquote id="deletion-warning">
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>If deleting items that are used by other work items, a message opens listing the items are affected by the deletion and prompts you to confirm the deletion. Some screens will contain items that are invalid or previously deleted, so they will fail to run. Below is an example of such a message:</p>
<img alt="_images/warning-deletion-dependencies.png" src="_images/warning-deletion-dependencies.png" />
</div>
</div></blockquote>
<section id="add-a-new-project">
<span id="ug-projects-add"></span><h4><span class="section-number">16.1. </span>Add a new project<a class="headerlink" href="#add-a-new-project" title="Link to this heading"></a></h4>
<p id="index-1">To create a new project:</p>
<ol class="arabic simple">
<li><p>Click the <strong>Add</strong> button, which launches the <strong>Create Project</strong> window.</p></li>
</ol>
<p><img alt="Create New Project form" src="_images/projects-create-new-project.png" /></p>
<ol class="arabic simple" start="2">
<li><p>Enter the appropriate details into the following required fields:</p></li>
</ol>
<ul class="simple">
<li><p><strong>Name</strong></p></li>
<li><p><strong>Description</strong> (optional)</p></li>
<li><p><strong>Organization</strong> - A project must have at least one organization. Pick one organization now to create the project, and then after the project is created you can add additional organizations.</p></li>
<li><p><strong>Execution Environment</strong> (optional) - Enter the name of the execution environment or search from a list of existing ones to run this project. See <a class="reference internal" href="index.html#upgrade-venv"><span class="std std-ref">Upgrading to Execution Environments</span></a> in the <em>AWX Upgrade and Migration Guide</em> for more information.</p></li>
<li><p><strong>Source Control Type</strong> - Select from the drop-down menu list an SCM type associated with this project. The options in the subsequent section become available depend on the type you choose. Refer to <a class="reference internal" href="#ug-manual"><span class="std std-ref">Manage playbooks manually</span></a> or <a class="reference internal" href="#ug-projects-scm-types"><span class="std std-ref">Manage playbooks using source control</span></a> in the subsequent sections for more detail.</p></li>
<li><p><strong>Content Signature Validation Credential</strong> - Use this optional field to enable content verification. Specify the GPG key to use for validating content signature during project sync. If the content has been tampered with, the job will not run. See <a class="reference internal" href="index.html#ug-content-signing"><span class="std std-ref">Project Signing and Verification</span></a> for more detail.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Click <strong>Save</strong> when done.</p></li>
</ol>
<p>The following describes ways projects are sourced in AWX:</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#manage-playbooks-manually" id="id2">Manage playbooks manually</a></p></li>
<li><p><a class="reference internal" href="#manage-playbooks-using-source-control" id="id3">Manage playbooks using source control</a></p>
<ul>
<li><p><a class="reference internal" href="#scm-types-git-and-subversion" id="id4">SCM Types - Git and Subversion</a></p></li>
<li><p><a class="reference internal" href="#scm-type-red-hat-insights" id="id5">SCM Type - Red Hat Insights</a></p></li>
<li><p><a class="reference internal" href="#scm-type-remote-archive" id="id6">SCM Type - Remote Archive</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="manage-playbooks-manually">
<span id="ug-manual"></span><h5><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">16.1.1. </span>Manage playbooks manually</a><a class="headerlink" href="#manage-playbooks-manually" title="Link to this heading"></a></h5>
<ul class="simple" id="index-2">
<li><p>Create one or more directories to store playbooks under the Project Base Path (for example, /var/lib/awx/projects/).</p></li>
<li><p>Create or copy playbook files into the playbook directory.</p></li>
<li><p>Ensure that the playbook directory and files are owned by the same UNIX user and group that the AWX service runs as.</p></li>
<li><p>Ensure that the permissions are appropriate for the playbook directories and files.</p></li>
</ul>
<p>If adding a manual project, each project path inside of the project root folder can only be assigned to one project. If you receive the following message, ensure that you have not already assigned the project path to an existing project:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">All</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">project</span> <span class="pre">paths</span> <span class="pre">have</span> <span class="pre">been</span> <span class="pre">assigned</span> <span class="pre">to</span> <span class="pre">existing</span> <span class="pre">projects,</span> <span class="pre">or</span> <span class="pre">there</span> <span class="pre">are</span> <span class="pre">no</span> <span class="pre">directories</span> <span class="pre">found</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">base</span> <span class="pre">path.</span></code>
<code class="docutils literal notranslate"><span class="pre">You</span> <span class="pre">will</span> <span class="pre">need</span> <span class="pre">to</span> <span class="pre">add</span> <span class="pre">a</span> <span class="pre">project</span> <span class="pre">path</span> <span class="pre">before</span> <span class="pre">creating</span> <span class="pre">a</span> <span class="pre">new</span> <span class="pre">project.</span></code></p>
</div></blockquote>
<p>If you have trouble adding a project path, check the permissions and SELinux context settings for the project directory and files.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you have not added any Ansible playbook directories to the base project path, you will receive the following message:</p>
<p><img alt="Create New Project form showing warning associated with selecting Source Control Credential Type of Manual" src="_images/projects-create-manual-warning.png" /></p>
<p>Correct this issue by creating the appropriate playbook directories and checking out playbooks from your SCM or otherwise copying playbooks into the appropriate playbook directories.</p>
</div>
</section>
<section id="manage-playbooks-using-source-control">
<span id="ug-projects-scm-types"></span><h5><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">16.1.2. </span>Manage playbooks using source control</a><a class="headerlink" href="#manage-playbooks-using-source-control" title="Link to this heading"></a></h5>
<nav class="contents local" id="id1">
<span id="index-3"></span><ul class="simple">
<li><p><a class="reference internal" href="#scm-types-git-and-subversion" id="id7">SCM Types - Git and Subversion</a></p></li>
<li><p><a class="reference internal" href="#scm-type-red-hat-insights" id="id8">SCM Type - Red Hat Insights</a></p></li>
<li><p><a class="reference internal" href="#scm-type-remote-archive" id="id9">SCM Type - Remote Archive</a></p></li>
</ul>
</nav>
<section id="scm-types-git-and-subversion">
<h6><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">16.1.2.1. </span>SCM Types - Git and Subversion</a><a class="headerlink" href="#scm-types-git-and-subversion" title="Link to this heading"></a></h6>
<p>To configure playbooks to use source control, in the Project <strong>Details</strong> tab:</p>
<ol class="arabic simple">
<li><p>Select the appropriate option (Git or Subversion) from the <strong>SCM Type</strong> drop-down menu list.</p></li>
</ol>
<blockquote>
<div><p><img alt="Create New Project form for Git Source Control Credential Type." src="_images/projects-create-scm-project.png" /></p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Enter the appropriate details into the following fields:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p><strong>SCM URL</strong> - See an example in the tooltip <img alt="tooltips icon" src="_images/tooltips-icon.png" />.</p></li>
</ul>
<ul class="simple">
<li><p><strong>SCM Branch/Tag/Commit</strong> - Optionally enter the SCM branch, tags, commit hashes, arbitrary refs, or revision number (if applicable) from the source control (Git or Subversion) to checkout. Some commit hashes and refs may not be available unless you also provide a custom refspec in the next field. If left blank, the default is HEAD which is the last checked out Branch/Tag/Commit for this project.</p></li>
<li><p><strong>SCM Refspec</strong> - This field is an option specific to git source control and only advanced users familiar and comfortable with git should specify which references to download from the remote repository. For more detail, see <a class="reference internal" href="index.html#ug-job-branching"><span class="std std-ref">job branch overriding</span></a>.</p></li>
<li><p><strong>Source Control Credential</strong> - If authentication is required, select the appropriate source control credential</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>In the <strong>SCM Update Options</strong>, optionally select the launch behavior, if applicable.</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p><strong>Clean</strong> - Removes any local modifications prior to performing an update.</p></li>
<li><p><strong>Delete</strong> - Deletes the local repository in its entirety prior to performing an update. Depending on the size of the repository this may significantly increase the amount of time required to complete an update.</p></li>
<li><p><strong>Track submodules</strong> - Tracks the latest commit. See more details in the tooltip <img alt="tooltips icon" src="_images/tooltips-icon.png" />.</p></li>
<li><p><strong>Update Revision on Launch</strong> - Updates the revision of the project to the current revision in the remote source control, as well as cache the roles directory from <a class="reference internal" href="#ug-galaxy"><span class="std std-ref">Galaxy</span></a> or <a class="reference internal" href="#ug-collections"><span class="std std-ref">Collections</span></a>. AWX ensures that the local revision matches and that the roles and collections are up-to-date with the last update. Also, to avoid job overflows if jobs are spawned faster than the project can sync, selecting this allows you to configure a Cache Timeout to cache prior project syncs for a certain number of seconds.</p></li>
<li><p><strong>Allow Branch Override</strong> - Allows a job template or an inventory source that uses this project to launch with a specified SCM branch or revision other than that of the project’s. For more detail, see <a class="reference internal" href="index.html#ug-job-branching"><span class="std std-ref">job branch overriding</span></a>.</p></li>
</ul>
<blockquote>
<div><img alt="create scm project branch override checked" src="_images/projects-create-scm-project-branch-override-checked.png" />
</div></blockquote>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Click <strong>Save</strong> to save your project.</p></li>
</ol>
<blockquote>
<div><div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Using a GitHub link offers an easy way to use a playbook. To help get you started, use the <code class="docutils literal notranslate"><span class="pre">helloworld.yml</span></code> file available at: <a class="reference external" href="https://github.com/ansible/tower-example.git">https://github.com/ansible/tower-example.git</a></p>
<p>This link offers a very similar playbook to the one created manually in the instructions found in the <a class="reference internal" href="index.html#qs-start"><span class="std std-ref">AWX Quickstart</span></a>. Using it will not alter or harm your system in anyway.</p>
</div>
</div></blockquote>
</section>
<section id="scm-type-red-hat-insights">
<h6><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">16.1.2.2. </span>SCM Type - Red Hat Insights</a><a class="headerlink" href="#scm-type-red-hat-insights" title="Link to this heading"></a></h6>
<p id="index-4">To configure playbooks to use Red Hat Insights, in the Project <strong>Details</strong> tab:</p>
<ol class="arabic simple">
<li><p>Select <strong>Red Hat Insights</strong> from the <strong>SCM Type</strong> drop-down menu list.</p></li>
<li><p>Red Hat Insights requires a credential for authentication. Select from the <strong>Credential</strong> field the appropriate credential for use with Insights.</p></li>
<li><p>In the <strong>SCM Update Options</strong>, optionally select the launch behavior, if applicable.</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p><strong>Clean</strong> - Removes any local modifications prior to performing an update.</p></li>
<li><p><strong>Delete</strong> - Deletes the local repository in its entirety prior to performing an update. Depending on the size of the repository this may significantly increase the amount of time required to complete an update.</p></li>
<li><p><strong>Update Revision on Launch</strong> - Updates the revision of the project to the current revision in the remote source control, as well as cache the roles directory from <a class="reference internal" href="#ug-galaxy"><span class="std std-ref">Galaxy</span></a> or <a class="reference internal" href="#ug-collections"><span class="std std-ref">Collections</span></a>. AWX ensures that the local revision matches and that the roles and collections are up-to-date with the last update. Also, to avoid job overflows if jobs are spawned faster than the project can sync, selecting this allows you to configure a Cache Timeout to cache prior project syncs for a certain number of seconds.</p></li>
</ul>
<img alt="Create New Project form for Red Hat Insights Source Control Credential Type." src="_images/projects-create-scm-insights.png" />
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Click <strong>Save</strong> to save your project.</p></li>
</ol>
</section>
<section id="scm-type-remote-archive">
<h6><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">16.1.2.3. </span>SCM Type - Remote Archive</a><a class="headerlink" href="#scm-type-remote-archive" title="Link to this heading"></a></h6>
<p id="index-5">Playbooks using a remote archive allow projects to be provided based on a build process that produces a versioned artifact, or release, containing all the requirements for that project in a single archive.</p>
<p>To configure playbooks to use a remote archive, in the Project <strong>Details</strong> tab:</p>
<ol class="arabic simple">
<li><p>Select <strong>Remote Archive</strong> from the <strong>SCM Type</strong> drop-down menu list.</p></li>
<li><p>Enter the appropriate details into the following fields:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p><strong>SCM URL</strong> - requires a URL to a remote archive, such as a <em>GitHub Release</em> or a build artifact stored in <em>Artifactory</em> and unpacks it into the project path for use</p></li>
<li><p><strong>SCM Credential</strong> - If authentication is required, select the appropriate SCM credential</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>In the <strong>SCM Update Options</strong>, optionally select the launch behavior, if applicable.</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p><strong>Clean</strong> - Removes any local modifications prior to performing an update.</p></li>
<li><p><strong>Delete</strong> - Deletes the local repository in its entirety prior to performing an update. Depending on the size of the repository this may significantly increase the amount of time required to complete an update.</p></li>
<li><p><strong>Update Revision on Launch</strong> - Not recommended, as this option updates the revision of the project to the current revision in the remote source control, as well as cache the roles directory from <a class="reference internal" href="#ug-galaxy"><span class="std std-ref">Galaxy</span></a> or <a class="reference internal" href="#ug-collections"><span class="std std-ref">Collections</span></a>.</p></li>
<li><p><strong>Allow Branch Override</strong> - Not recommended, as this option allows a job template that uses this project to launch with a specified SCM branch or revision other than that of the project’s.</p></li>
</ul>
<img alt="Create New Project form for Remote Archive Source Control Credential Type." src="_images/projects-create-scm-rm-archive.png" />
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since this SCM type is intended to support the concept of unchanging artifacts, it is advisable to disable Galaxy integration (for roles, at minimum).</p>
</div>
<ol class="arabic simple" start="4">
<li><p>Click <strong>Save</strong> to save your project.</p></li>
</ol>
</section>
</section>
</section>
<section id="updating-projects-from-source-control">
<h4><span class="section-number">16.2. </span>Updating projects from source control<a class="headerlink" href="#updating-projects-from-source-control" title="Link to this heading"></a></h4>
<ol class="arabic simple" id="index-6">
<li><p>Update an existing SCM-based project by selecting the project and clicking the <img alt="Refresh button" src="_images/refresh-gray.png" /> button.</p></li>
</ol>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please note that immediately after adding a project setup to use source control, a “Sync” starts that fetches the project details from the configured source control.</p>
</div>
</div></blockquote>
<p><img alt="Projects list view with the latest revision information of the projects that synched." src="_images/projects-list-all.png" /></p>
<ol class="arabic simple" start="2">
<li><p>Click on project’s status under the <strong>Status</strong> column to get further details about the update process.</p></li>
</ol>
<img alt="Projects list view with example project with a successful status." src="_images/projects-list-status-more.png" />
<p><img alt="Example project with real-time standard output details." src="_images/projects-update-status.png" /></p>
</section>
<section id="work-with-permissions">
<h4><span class="section-number">16.3. </span>Work with Permissions<a class="headerlink" href="#work-with-permissions" title="Link to this heading"></a></h4>
<p id="index-7">The set of permissions assigned to this project (role-based access controls) that provide the ability to read, modify, and administer projects, inventories, job templates, and other AWX elements are Privileges.</p>
<p>You can access the project permissions via the <strong>Access</strong> tab next to the <strong>Details</strong> tab. This screen displays a list of users that currently have permissions to this project. The list may be sorted and searched by <strong>Username</strong>, <strong>First Name</strong>, or <strong>Last Name</strong>.</p>
<p><img alt="Access tab of a sample project that shows list of users who have permissions to this project." src="_images/projects-permissions-example.png" /></p>
<section id="add-permissions">
<h5><span class="section-number">16.3.1. </span>Add Permissions<a class="headerlink" href="#add-permissions" title="Link to this heading"></a></h5>
<blockquote>
<div></div></blockquote>
<ol class="arabic simple" id="ug-permissions">
<li><p>In the <strong>Access</strong> tab, click the <strong>Add</strong> button.</p></li>
<li><p>Select a user or team to add and click <strong>Next</strong></p></li>
<li><p>Select one or more users or teams from the list by clicking the check box(es) next to the name(s) to add them as members and click <strong>Next</strong>.</p></li>
</ol>
<img alt="_images/organizations-add-users-for-example-organization.png" src="_images/organizations-add-users-for-example-organization.png" />
<p>In this example, two users have been selected to be added.</p>
<ol class="arabic simple" start="4">
<li><p>Select the role(s) you want the selected user(s) or team(s) to have. Be sure to scroll down for a complete list of roles. Different resources have different options available.</p></li>
</ol>
<blockquote>
<div><img alt="_images/organizations-add-users-roles.png" src="_images/organizations-add-users-roles.png" />
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Click the <strong>Save</strong> button to apply the roles to the selected user(s) or team(s) and to add them as members.</p></li>
</ol>
<p>The Add Users/Teams window closes to display the updated roles assigned for each user and team.</p>
<img alt="Permissions tab with Role Assignments" src="_images/permissions-tab-roles-assigned.png" />
<p>To remove roles for a particular user, click the disassociate (x) button next to its resource.</p>
<img alt="_images/permissions-disassociate.png" src="_images/permissions-disassociate.png" />
<p>This launches a confirmation dialog, asking you to confirm the disassociation.</p>
<img alt="_images/permissions-disassociate-confirm.png" src="_images/permissions-disassociate-confirm.png" />
</section>
</section>
<section id="work-with-notifications">
<h4><span class="section-number">16.4. </span>Work with Notifications<a class="headerlink" href="#work-with-notifications" title="Link to this heading"></a></h4>
<p>Clicking the <strong>Notifications</strong> tab allows you to review any notification integrations you have setup.</p>
<img alt="List of notifications configured for this project." src="_images/projects-notifications-example-list.png" />
<p>Use the toggles to enable or disable the notifications to use with your particular project. For more detail, see <a class="reference internal" href="index.html#ug-notifications-on-off"><span class="std std-ref">Enable and Disable Notifications</span></a>.</p>
<p>If no notifications have been set up, you can configure them from the  <strong>Notifications</strong> link from the left navigation bar to create a new notification.</p>
<img alt="Notifications Templates page with no notification templates found." src="_images/project-notifications-empty.png" />
<p>Refer to <a class="reference internal" href="index.html#ug-notifications-types"><span class="std std-ref">Notification Types</span></a> for additional details on configuring various notification types.</p>
</section>
<section id="work-with-job-templates">
<h4><span class="section-number">16.5. </span>Work with Job Templates<a class="headerlink" href="#work-with-job-templates" title="Link to this heading"></a></h4>
<p>Clicking on <strong>Job Templates</strong> allows you to add and review any job templates or workflow templates associated with this project.</p>
<img alt="List of job templates associated with this project." src="_images/projects-templates-example-list.png" />
<p>Click on the recent jobs that ran using that template to see its details and other useful information. You can sort this list by various criteria, and perform a search to filter the templates of interest.</p>
<img alt="Job Templates tab of the project showing an example drop-down menu that can be used to filter your search." src="_images/projects-templates-search-dropdown.png" />
<p>From this view, you can also launch (<img alt="launch button" src="_images/launch-button.png" />),  edit (<img alt="edit button" src="_images/edit-button.png" />), or copy (<img alt="copy button" src="_images/copy-button.png" />) the template configuration.</p>
</section>
<section id="work-with-schedules">
<h4><span class="section-number">16.6. </span>Work with Schedules<a class="headerlink" href="#work-with-schedules" title="Link to this heading"></a></h4>
<p id="index-8">Clicking on <strong>Schedules</strong> allows you to review any schedules set up for this project.</p>
<img alt="List of configured schedules that may be used with this project." src="_images/generic-schedules-list-configured.png" />
<section id="schedule-a-project">
<h5><span class="section-number">16.6.1. </span>Schedule a Project<a class="headerlink" href="#schedule-a-project" title="Link to this heading"></a></h5>
<p>To schedule a project run, click the <strong>Schedules</strong> tab.</p>
<ul class="simple">
<li><p>If schedules are already set up; review, edit, or enable/disable your schedule preferences.</p></li>
<li><p>If schedules have not been set up, refer to <a class="reference internal" href="index.html#ug-scheduling"><span class="std std-ref">Schedules</span></a> for more information.</p></li>
</ul>
</section>
</section>
<section id="ansible-galaxy-support">
<span id="ug-galaxy"></span><h4><span class="section-number">16.7. </span>Ansible Galaxy Support<a class="headerlink" href="#ansible-galaxy-support" title="Link to this heading"></a></h4>
<p id="index-9">At the end of a Project update, AWX searches for a file called <code class="docutils literal notranslate"><span class="pre">requirements.yml</span></code> in the <code class="docutils literal notranslate"><span class="pre">roles</span></code> directory, located at <code class="docutils literal notranslate"><span class="pre">&lt;project-top-level-directory&gt;/roles/requirements.yml</span></code>. If this file is found, the following command automatically runs:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ansible-galaxy role install -r roles/requirements.yml -p &lt;project-specific cache location&gt;/requirements_roles -vvv</span>
</pre></div>
</div>
<p>This file allows you to reference Galaxy roles or roles within other repositories which can be checked out in conjunction with your own project. The addition of this Ansible Galaxy support eliminates the need to create git submodules for achieving this result. Given that SCM projects (along with roles/collections) are pulled into and executed from a private job environment, a &lt;private job directory&gt; specific to the project within <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> is created by default. However, you can specify another <strong>Job Execution Path</strong> based on your environment in the Jobs Settings tab of the Settings window:</p>
<img alt="Job Settings page showing where to configure the Job execution path." src="_images/configure-awx-jobs-execution-path.png" />
<p>The cache directory is a subdirectory inside the global projects folder. The content may be copied from the cache location to <code class="docutils literal notranslate"><span class="pre">&lt;job</span> <span class="pre">private</span> <span class="pre">directory&gt;/requirements_roles</span></code> location.</p>
<p>By default, AWX has a system-wide setting that allows roles to be dynamically downloaded from the <code class="docutils literal notranslate"><span class="pre">roles/requirements.yml</span></code> file for SCM projects. You may turn off this setting in the <strong>Jobs settings</strong> screen of the Settings menu by switching the <strong>Enable Role Download</strong> toggle button to <strong>OFF</strong>.</p>
<img alt="Job Settings page showing the option to Enable Role Download." src="_images/configure-awx-jobs-download-roles.png" />
<p>Whenever a project sync runs, AWX determines if the project source and any roles from Galaxy and/or Collections are out of date with the project. Project updates will download the roles inside the update.</p>
<p>If jobs need to pick up a change made to an upstream role, updating the project will ensure this happens. A change to the role means that a new commit was pushed to the <em>provision-role</em> source control. To make this change take effect in a job, you do not need to push a new commit to the <em>playbooks</em> repo, but you <strong>do need</strong> to update the project, which downloads roles to a local cache. For instance, say you have two git repositories in source control. The first one is <em>playbooks</em> and the project in AWX points to this URL. The second one is <em>provision-role</em> and it is referenced by the <code class="docutils literal notranslate"><span class="pre">roles/requirements.yml</span></code> file inside of the <em>playbooks</em> git repo.</p>
<p>In short, jobs would download the most recent roles before every job run. Roles and collections are locally cached for performance reasons, and you will need to select <strong>Update Revision on Launch</strong> in the project SCM Update Options to ensure that the upstream role is re-downloaded before each job run:</p>
<p><img alt="SCM update options Update Revision on Launch checked." src="_images/projects-scm-update-options-update-on-launch-checked.png" /></p>
<p>The update happens much earlier in the process than the sync, so this surfaces errors and details faster and in a more logic place.</p>
<p>For more information and examples on the syntax of the <code class="docutils literal notranslate"><span class="pre">requirements.yml</span></code> file, refer to the <a class="reference external" href="https://docs.ansible.com/ansible/latest/galaxy/user_guide.html#installing-multiple-roles-from-a-file">role requirements section</a> in the Ansible documentation.</p>
<p>If there are any directories that should specifically be exposed, you can specify those in the Jobs section of the Settings screen in the <strong>Paths to Expose to Isolated Jobs</strong> or by updating the following entry in the settings file:</p>
<p><code class="docutils literal notranslate"><span class="pre">AWX_ISOLATION_SHOW_PATHS</span> <span class="pre">=</span> <span class="pre">['/list/of/',</span> <span class="pre">'/paths']</span></code></p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The primary file you may want to add to <code class="docutils literal notranslate"><span class="pre">AWX_ISOLATION_SHOW_PATHS</span></code> is <code class="docutils literal notranslate"><span class="pre">/var/lib/awx/.ssh</span></code>, if your playbooks need to use keys or settings defined there.</p>
</div>
</div></blockquote>
<p>If you made changes in the settings file, be sure to restart services with the <code class="docutils literal notranslate"><span class="pre">awx-service</span> <span class="pre">restart</span></code> command after your changes have been saved.</p>
<p>In the User Interface, you can configure these settings in the Jobs settings window.</p>
<img alt="Job Settings page showing example paths to expose to isolated jobs." src="_images/configure-awx-jobs-path-to-expose.png" />
</section>
<section id="collections-support">
<span id="ug-collections"></span><h4><span class="section-number">16.8. </span>Collections Support<a class="headerlink" href="#collections-support" title="Link to this heading"></a></h4>
<p id="index-10">AWX supports project-specific <a class="reference external" href="https://docs.ansible.com/ansible/latest/collections_guide/index.html">Ansible collections</a> in job runs. If you specify a collections requirements file in the SCM at <code class="docutils literal notranslate"><span class="pre">collections/requirements.yml</span></code>, AWX will install collections in that file in the implicit project sync before a job run.</p>
<p>By default, AWX has a system-wide setting that allows collections to be dynamically downloaded from the <code class="docutils literal notranslate"><span class="pre">collections/requirements.yml</span></code> file for SCM projects. You may turn off this setting in the <strong>Jobs settings</strong> tab of the Settings menu by switching the <strong>Enable Collections Download</strong> toggle button to <strong>OFF</strong>.</p>
<blockquote>
<div><img alt="Job Settings page showing where to enable collection(s) download." src="_images/configure-awx-jobs-download-collections.png" />
</div></blockquote>
<p>Roles and collections are locally cached for performance reasons, and you will need to select <strong>Update Revision on Launch</strong> in the project SCM Update Options to ensure this:</p>
<p><img alt="SCM update options Update Revision on Launch checked." src="_images/projects-scm-update-options-update-on-launch-checked.png" /></p>
<section id="using-collections-via-hub">
<span id="ug-collections-usage"></span><h5><span class="section-number">16.8.1. </span>Using Collections via Hub<a class="headerlink" href="#using-collections-via-hub" title="Link to this heading"></a></h5>
<p>Before AWX can use Automation Hub as the default source for collections content, you need to create an API token in the Automation Hub UI so that it could be specified in AWX. You may connect to a private Automation Hub or a public Automation Hub collection, the only difference is which URL you specify.</p>
<ol class="arabic simple">
<li><p>Navigate to <a class="reference external" href="https://cloud.redhat.com/ansible/automation-hub/token">https://cloud.redhat.com/ansible/automation-hub/token</a> and click <strong>Load token</strong>.</p></li>
<li><p>Click the copy icon to copy the API token to the clipboard.</p></li>
</ol>
<img alt="Connect to Hub page showing where to copy the offline token." src="_images/projects-ah-loaded-token-shown.png" />
<ol class="arabic simple" start="3">
<li><p>To use the public Automation Hub, create an Automation Hub credential using the copied token and pointing to the URLs shown in the <strong>Server URL</strong> and <strong>SSO URL</strong> fields of the token page:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p><strong>Galaxy Server URL</strong> = <code class="docutils literal notranslate"><span class="pre">https://cloud.redhat.com/api/automation-hub/</span></code></p></li>
<li><p><strong>AUTH SEVER URL</strong> = <code class="docutils literal notranslate"><span class="pre">https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/token</span></code></p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>To use a private Automation Hub, create an Automation Hub credential using a token retrieved from the Repo Management dashboard of your local Automation Hub and pointing to the published repo URL as shown:</p></li>
</ol>
<img alt="The Repo Management dashboard of your local Automation Hub." src="_images/projects-ah-repo-mgmt-get-token.png" />
<img alt="The Get token button next to the published repo URL in the Repo Management dashboard of your local Automation Hub." src="_images/projects-ah-repo-mgmt-repos-published.png" />
<p>You can create different repos with different namespaces/collections in them. But for each repo in Automation Hub you need to create a different Automation Hub credential. Copy the <strong>Ansible CLI URL</strong> from the Automation Hub UI in the format of <code class="docutils literal notranslate"><span class="pre">https://$&lt;hub_url&gt;/api/galaxy/content/&lt;repo</span> <span class="pre">you</span> <span class="pre">want</span> <span class="pre">to</span> <span class="pre">pull</span> <span class="pre">from&gt;</span></code> into the <strong>Galaxy Server URL</strong> field of the <em>Create Credential</em> form:</p>
<img alt="Create New Credential form for Ansible Galaxy/Automation Hub API Token Credential Type." src="_images/projects-create-ah-credential.png" />
<ol class="arabic simple" start="5">
<li><p>Navigate to the organization for which you want to be able to sync content from Automation Hub and add the new Automation Hub credential to the organization. This step allows you to associate each organization with the Automation Hub credential (i.e. repo) that you want to be able to use content from.</p></li>
</ol>
<img alt="Edit example default organizations form with Ansible Galaxy and Automation Hub credentials." src="_images/projects-organizations-add-ah-credential.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Suppose you have two repos:</p>
<ul class="simple">
<li><p><em>Prod</em>: <code class="docutils literal notranslate"><span class="pre">Namespace</span> <span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">Namespace</span> <span class="pre">2</span></code>, each with collection <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> so: <code class="docutils literal notranslate"><span class="pre">namespace1.collectionA:v2.0.0</span></code> and <code class="docutils literal notranslate"><span class="pre">namespace2.collectionB:v2.0.0</span></code></p></li>
<li><p><em>Stage</em>: <code class="docutils literal notranslate"><span class="pre">Namespace</span> <span class="pre">1</span></code> with only collection <code class="docutils literal notranslate"><span class="pre">A</span></code> so: <code class="docutils literal notranslate"><span class="pre">namespace1.collectionA:v1.5.0</span></code> on Automation Hub, you will have a repo URL for <em>Prod</em> and <em>Stage</em>.</p></li>
</ul>
<p>You can create an Automation Hub credential for each one. Then you can assign different levels of access to different organizations. For example, you can create a Developers organization has access to both repos, while an Operations organization just has access to the Automation Hub <strong>Prod</strong> repo only.</p>
</div>
<ol class="arabic simple" start="6">
<li><p>If the Automation Hub has self-signed certificates, click the toggle to enable the setting <strong>Ignore Ansible Galaxy SSL Certificate Verification</strong>. For <strong>public Automation Hub</strong>, which uses a signed certificate, click the toggle to disable it instead. Note this is a global setting:</p></li>
</ol>
<img alt="Job Settings page showing where to enable the option to ignore Ansible Galaxy SSL Certificate Verification." src="_images/settings-jobs-ignore-galaxy-certs.png" />
<ol class="arabic simple" start="7">
<li><p>Create a project, where the source repository specifies the necessary collections in a requirements file located in the <code class="docutils literal notranslate"><span class="pre">collections/requirements.yml</span></code> file. Refer to the syntax described in the corresponding <a class="reference external" href="https://docs.ansible.com/ansible/latest/user_guide/collections_using.html#install-multiple-collections-with-a-requirements-file">Ansible documentation</a>.</p></li>
</ol>
<img alt="The URL for the Source Control URL in the Type Details section of the Create New Project form." src="_images/projects-add-ah-source-repo.png" />
<ol class="arabic simple" start="8">
<li><p>In the Projects list view, click <img alt="Refresh button." src="_images/refresh-gray.png" /> to run an update against this project. AWX fetches the Galaxy collections from the <code class="docutils literal notranslate"><span class="pre">collections/requirements.yml</span></code> file and report it as changed; and the collections will now be installed for any job template using this project.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If updates are needed from Galaxy or Collections, a sync is performed that downloads the required roles, consuming that much more space in your /tmp file. In cases where you have a big project (around 10 GB), disk space on <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> may be an issue.</p>
</div>
<p>For more information on collections, refer to <a class="reference external" href="https://docs.ansible.com/ansible/latest/user_guide/collections_using.html">Using Collections</a>.</p>
</section>
</section>
</section>
<span id="document-userguide/project-sign"></span><section id="project-signing-and-verification">
<span id="ug-content-signing"></span><h3><span class="section-number">17. </span>Project Signing and Verification<a class="headerlink" href="#project-signing-and-verification" title="Link to this heading"></a></h3>
<p id="index-0">Project signing and verification provides the ability to sign files in your project directory and then verify whether or not that content has changed in any way, or files have been added or removed from the project unexpectedly. To accomplish this, a private key for signing and a matching public key for verifying are needed.</p>
<p>For project maintainers, the supported way to perform content signing is to use a utility called, <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code>, through the command-line interface (CLI) that comes with it.</p>
<p>The CLI aims to make it easy to use cryptographic technology like GNU Privacy Guard (GPG) to validate that specified files within a project have not been tampered with in any way. Currently, GPG is the only supported means of signing and validation.</p>
<p>AWX is used to verify the signed content. After a matching public key has been associated with the signed project, AWX will verify that the files included during signing have not changed, and that files have been added or removed unexpectedly. If the signature is not valid or a file has changed, the project will fail to update, and no jobs making use of the project will be able to launch. Verification status of the project ensures that only secure, untampered content is run in jobs.</p>
<p>Assuming that the repository has already been configured for signing and verification (see below), the usual workflow for altering the project becomes the following:</p>
<ol class="arabic simple">
<li><p>User has a project repository set up already and wants to make a change to a file.</p></li>
<li><p>User makes the change, runs <code class="docutils literal notranslate"><span class="pre">ansible-sign</span> <span class="pre">project</span> <span class="pre">gpg-sign</span> <span class="pre">/path/to/project</span></code>,  which updates a checksum manifest and signs it.</p></li>
<li><p>User commits the change and the updated checksum manifest and the signature to the repository.</p></li>
<li><p>When the user syncs the project, AWX (already configured, in this scenario) pulls in the new changes, checks that the public key associated with the project in AWX matches the private key that the checksum manifest was signed with (this prevents tampering with the checksum manifest itself), then re-calculates checksums of each file in the manifest to ensure that the checksum matches (and thus that no file has changed). It also looks to ensure that all files are accounted for: They must have been either included in, or excluded from, the <code class="docutils literal notranslate"><span class="pre">MANIFEST.in</span></code> file discussed below; if files have been added or removed unexpectedly, verification will fail.</p></li>
</ol>
<img alt="Content signing process diagram" src="_images/content-sign-diagram.png" />
<section id="prerequisites">
<h4><span class="section-number">17.1. </span>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>A valid GPG public/private keypair is required for signing content. Refer to <a class="reference external" href="https://www.redhat.com/sysadmin/creating-gpg-keypairs">How to create GPG keypairs</a> for details.</p></li>
</ul>
<blockquote>
<div><p>Visit the <a class="reference external" href="https://www.gnupg.org/documentation/index.html">GnuPG documentation</a> for more information regarding GPG keys.</p>
<p>You can verify that you have a valid GPG keypair and in your default GnuPG keyring, with the following command:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ gpg --list-secret-keys</span>
</pre></div>
</div>
<p>If the above command produces no output, or one line of output that states, <code class="docutils literal notranslate"><span class="pre">trustdb</span> <span class="pre">was</span> <span class="pre">created</span></code>, then you do not have a secret key in your default keyring. In this case, refer to <a class="reference external" href="https://www.redhat.com/sysadmin/creating-gpg-keypairs">How to create GPG keypairs</a> to learn how to create a new keypair before proceeding. If it produces output other than that, you have a valid secret key and are ready to move on to using <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code>.</p>
</div></blockquote>
</section>
<section id="add-a-gpg-key-to-awx">
<h4><span class="section-number">17.2. </span>Add a GPG key to AWX<a class="headerlink" href="#add-a-gpg-key-to-awx" title="Link to this heading"></a></h4>
<p>In order to use the GPG key for content singing and validation in AWX, you must add it running the following command in the CLI:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ gpg --list-keys</span>
<span class="l l-Scalar l-Scalar-Plain">$ gpg --export --armour &lt;key fingerprint&gt; &gt; my_public_key.asc</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>In the AWX user interface, click <strong>Credentials</strong> from the left side navigation menu then click the <strong>Add</strong> button.</p></li>
<li><p>Provide the new credential a meaningful name (for example, “Infrastructure team public GPG key”)</p></li>
<li><p>In the Credential Type field, select <strong>GPG Public Key</strong>.</p></li>
<li><p>Click <strong>Browse</strong> to locate and select the public key file (e.g., <code class="docutils literal notranslate"><span class="pre">my_public_key.asc</span></code>)</p></li>
<li><p>Click <strong>Save</strong> when done.</p></li>
</ol>
<img alt="Example GPG credential details" src="_images/credentials-gpg-details.png" />
<p>This credential can now be selected in <a class="reference internal" href="index.html#ug-projects-add"><span class="std std-ref">projects</span></a>, and content verification will automatically take place on future project syncs.</p>
<img alt="Create project with example GPG credentials" src="_images/project-create-with-gpg-creds.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use the project cache SCM timeout to control how often you want AWX to re-validate the signed content. When a project is configured to update on launch (of any job template configured to use that project), you can enable the cache timeout setting, which tells it to update after N seconds have passed since the last update. If validation is running too frequently, you can slow down how often project updates occur by specifying the time in the <strong>Cache Timeout</strong> field of the Option Details pane of the project.</p>
<img alt="Checked Update Revision on Launch option with Cache Timeout value specified from the Create new project page" src="_images/project-update-launch-cache-timeout.png" />
</div>
</section>
<section id="access-the-ansible-sign-cli-utility">
<h4><span class="section-number">17.3. </span>Access the <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code> CLI utility<a class="headerlink" href="#access-the-ansible-sign-cli-utility" title="Link to this heading"></a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code> utility provide options for the user to sign and verify whether the project is signed.</p>
<ol class="arabic simple">
<li><p>Run the following command to install <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code>:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ dnf install ansible-sign</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Verify that <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code> was successfully installed:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ ansible-sign --version</span>
</pre></div>
</div>
<p>Output similar to the following displays (possibly with a different version number):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ansible-sign 0.1</span>
</pre></div>
</div>
<p>This indicates you have successfully installed <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code>.</p>
</section>
<section id="signing-your-project">
<h4><span class="section-number">17.4. </span>Signing your project<a class="headerlink" href="#signing-your-project" title="Link to this heading"></a></h4>
<p>As the name suggests, signing a project involves an Ansible project directory. Refer to the <a class="reference external" href="https://docs.ansible.com/ansible/latest/user_guide/sample_setup.html">Ansible documentation</a> for more sophisticated examples of project directory structures.</p>
<p>The following sample project has a very simple structure. An inventory file, and two small playbooks under a playbooks directory:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ cd sample-project/</span>
<span class="l l-Scalar l-Scalar-Plain">$ tree -a .</span>
<span class="l l-Scalar l-Scalar-Plain">.</span>
<span class="l l-Scalar l-Scalar-Plain">├── inventory</span>
<span class="l l-Scalar l-Scalar-Plain">└── playbooks</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">└── get_uptime.yml</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">└── hello.yml</span>

<span class="l l-Scalar l-Scalar-Plain">1 directory, 3 files</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The commands used in this section assume that your working directory is the root of your project. As a rule, <code class="docutils literal notranslate"><span class="pre">ansible-sign</span> <span class="pre">project</span></code> commands always take the project root directory as their last argument, and therefore, we use <code class="docutils literal notranslate"><span class="pre">.</span></code> to indicate the current working directory.</p>
</div>
<p>The way that <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code> protects content from tampering is by taking checksums (SHA256) of all of the secured files in the project, compiling those into a checksum manifest file, and then finally signing that manifest file.</p>
<p>The first step toward signing content is to create a file that tells <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code> which files to protect. This file should be called <code class="docutils literal notranslate"><span class="pre">MANIFEST.in</span></code> and reside in the project root directory.</p>
<p>Internally, <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code> makes use of the <code class="docutils literal notranslate"><span class="pre">distlib.manifest</span></code> module of Python’s distlib library, and thus <code class="docutils literal notranslate"><span class="pre">MANIFEST.in</span></code> must follow the syntax that this library specifies. See the <a class="reference external" href="https://packaging.python.org/en/latest/guides/using-manifest-in/#manifest-in-commands">Python Packaging User Guide</a> for an explanation of the <code class="docutils literal notranslate"><span class="pre">MANIFEST.in</span></code> file directives.</p>
<p>In the sample project, included are two directives, resulting in a <code class="docutils literal notranslate"><span class="pre">MANIFEST.in</span></code> file that looks like this:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">include inventory</span>
<span class="l l-Scalar l-Scalar-Plain">recursive-include playbooks *.yml</span>
</pre></div>
</div>
<p>With this file in place, generate your checksum manifest file and sign it. Both of these steps are achieved in a single <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code> command:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ ansible-sign project gpg-sign .</span>
<span class="l l-Scalar l-Scalar-Plain">[OK   ] GPG signing successful!</span>
<span class="l l-Scalar l-Scalar-Plain">[NOTE ] Checksum manifest</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./.ansible-sign/sha256sum.txt</span>
<span class="p p-Indicator">[</span><span class="nv">NOTE</span><span class="w"> </span><span class="p p-Indicator">]</span><span class="w"> </span><span class="nt">GPG summary</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">signature created</span>
</pre></div>
</div>
<p>Now the project has been signed.</p>
<p>Notice that the <code class="docutils literal notranslate"><span class="pre">gpg-sign</span></code> subcommand resides under the <code class="docutils literal notranslate"><span class="pre">project</span></code> subcommand. For signing project content, every command will start with <code class="docutils literal notranslate"><span class="pre">ansible-sign</span> <span class="pre">project</span></code>. As noted above, as a rule, every <code class="docutils literal notranslate"><span class="pre">ansible-sign</span> <span class="pre">project</span></code> command takes the project root directory as its final argument.</p>
<p>As mentioned earlier, <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code> by default makes use of your default keyring and looks for the first available secret key that it can find, to sign your project. You can specify a specific secret key to use with the <code class="docutils literal notranslate"><span class="pre">--fingerprint</span></code> option, or even a completely independent GPG home directory with the <code class="docutils literal notranslate"><span class="pre">--gnupg-home</span></code> option.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are using a desktop environment, GnuPG will automatically prompt you for your secret key’s passphrase. If this functionality does not work, or you are working without a desktop environment (e.g., via SSH), you can use the <code class="docutils literal notranslate"><span class="pre">-p/--prompt-passphrase</span></code> flag after <code class="docutils literal notranslate"><span class="pre">gpg-sign</span></code> in the above command, which will cause <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code> to prompt for the password instead.</p>
</div>
<p>Upon viewing the structure of the project directory, notice that a new <code class="docutils literal notranslate"><span class="pre">.ansible-sign</span></code> directory was created. This directory contains the checksum manifest and a detached GPG signature for it.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ tree -a .</span>
<span class="l l-Scalar l-Scalar-Plain">.</span>
<span class="l l-Scalar l-Scalar-Plain">├── .ansible-sign</span>
<span class="l l-Scalar l-Scalar-Plain">│   ├── sha256sum.txt</span>
<span class="l l-Scalar l-Scalar-Plain">│   └── sha256sum.txt.sig</span>
<span class="l l-Scalar l-Scalar-Plain">├── inventory</span>
<span class="l l-Scalar l-Scalar-Plain">├── MANIFEST.in</span>
<span class="l l-Scalar l-Scalar-Plain">└── playbooks</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">├── get_uptime.yml</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">└── hello.yml</span>
</pre></div>
</div>
</section>
<section id="verifying-your-project">
<h4><span class="section-number">17.5. </span>Verifying your project<a class="headerlink" href="#verifying-your-project" title="Link to this heading"></a></h4>
<p>If you want to verify that a signed Ansible project has not been altered, you can use <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code> to check whether the signature is valid and that the checksums of the files match what the checksum manifest says they should be. In particular, the <code class="docutils literal notranslate"><span class="pre">ansible-sign</span> <span class="pre">project</span> <span class="pre">gpg-verify</span></code> command can be used to automatically verify both of these conditions.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ ansible-sign project gpg-verify .</span>
<span class="l l-Scalar l-Scalar-Plain">[OK   ] GPG signature verification succeeded.</span>
<span class="l l-Scalar l-Scalar-Plain">[OK   ] Checksum validation succeeded.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code> makes use of your default GPG keyring to look for a matching public key. You can specify a keyring file with the <code class="docutils literal notranslate"><span class="pre">--keyring</span></code> option, or a different GPG home with the <code class="docutils literal notranslate"><span class="pre">--gnugpg-home</span></code> option.</p>
</div>
<p>If verification fails for any reason, information will be displayed to help you debug the cause. More verbosity can be enabled by passing the global <code class="docutils literal notranslate"><span class="pre">--debug</span></code> flag, immediately after <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code> in your commands.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When a GPG credential is used in a project, content verification will automatically take place on future project syncs.</p>
</div>
</section>
<section id="automate-signing">
<h4><span class="section-number">17.6. </span>Automate signing<a class="headerlink" href="#automate-signing" title="Link to this heading"></a></h4>
<p>In environments with highly-trusted CI environments (e.g., OpenShift, Jenkins, etc.), it is possible to automate the signing process. For example, you could store your GPG private key in a CI platform of choice as a secret, and import that into GnuPG in the CI environment. You could then run through the signing workflow above within the normal CI workflow/container/environment.</p>
<p>When signing a project using GPG, the environment variable <code class="docutils literal notranslate"><span class="pre">ANSIBLE_SIGN_GPG_PASSPHRASE</span></code> can be set to the passphrase of the signing key. This can be injected (and masked/secured) in a CI pipeline.</p>
<p>Depending on the scenario at hand, <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code> will return with a different exit-code, during both signing and verification. This can also be useful in the context of CI and automation, as a CI environment can act differently based on the failure (for example, sending alerts for some errors but silently failing for others).</p>
<p>These are the exit codes used in <code class="docutils literal notranslate"><span class="pre">ansible-sign</span></code> currently, which can be considered stable:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 33%" />
<col style="width: 53%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Exit code</p></th>
<th class="head"><p>Approximate meaning</p></th>
<th class="head"><p>Example scenarios</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Success</p></td>
<td><ul class="simple">
<li><p>Signing was successful</p></li>
<li><p>Verification was successful</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>General failure</p></td>
<td><ul class="simple">
<li><p>The checksum manifest file contained a syntax error during verification</p></li>
<li><p>The signature file did not exist during verification</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MANIFEST.in</span></code> did not exist during signing</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Checksum verification failure</p></td>
<td><ul class="simple">
<li><p>The checksum hashes calculated during verification differed from what
was in the signed checksum manifest (e.g., a project file was changed but the signing process was not re-completed)</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Signature verification failure</p></td>
<td><ul class="simple">
<li><p>The signer’s public key was not in the user’s GPG keyring</p></li>
<li><p>The wrong GnuPG home directory or keyring file was specified</p></li>
<li><p>The signed checksum manifest file was modified in some way</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>Signing process failure</p></td>
<td><ul class="simple">
<li><p>The signer’s private key was not found in the GPG keyring</p></li>
<li><p>The wrong GnuPG home directory or keyring file was specified</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
</section>
<span id="document-userguide/inventories"></span><section id="inventories">
<span id="ug-inventories"></span><h3><span class="section-number">18. </span>Inventories<a class="headerlink" href="#inventories" title="Link to this heading"></a></h3>
<p id="index-0">An <a class="reference internal" href="index.html#term-Inventory"><span class="xref std std-term">Inventory</span></a> is a collection of hosts against which jobs may be launched, the same as an Ansible inventory file. Inventories are divided into groups and these groups contain the actual hosts. Groups may be sourced manually, by entering host names into AWX, or from one of its supported cloud providers.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have a custom dynamic inventory script, or a cloud provider that is not yet supported natively in AWX, you can also import that into AWX. Refer to <a class="reference internal" href="index.html#ag-inv-import"><span class="std std-ref">Inventory File Importing</span></a> in the <em>AWX Administration Guide</em>.</p>
</div>
<p>The Inventories window displays a list of the inventories that are currently available. The inventory list may be sorted by name and searched type, organization, description, owners and modifiers of the inventory, or additional criteria as needed.</p>
<p><img alt="Inventories - home with examples" src="_images/inventories-home-with-examples.png" /></p>
<p>The list of Inventory details includes:</p>
<ul class="simple">
<li><p><strong>Name</strong>: The inventory name. Clicking the Inventory name navigates to the properties screen for the selected inventory, which shows the inventory’s groups and hosts. (This view is also accessible from the <img alt="edit button" src="_images/edit-button.png" /> icon.)</p></li>
</ul>
<ul class="simple">
<li><p><strong>Status</strong></p></li>
</ul>
<p>The statuses are:</p>
<ul class="simple">
<li><p><strong>Success</strong>: when the inventory source sync completed successfully</p></li>
<li><p><strong>Disabled</strong>: no inventory source added to the inventory</p></li>
<li><p><strong>Error</strong>: when the inventory source sync completed with error</p></li>
</ul>
<p>An example of inventories of various states, including one with detail for a disabled state:</p>
<img alt="_images/inventories-home-with-status.png" src="_images/inventories-home-with-status.png" />
<ul>
<li><p><strong>Type</strong>: Identifies whether it is a standard inventory, a Smart inventory, or a constructed inventory.</p></li>
<li><p><strong>Organization</strong>: The organization to which the inventory belongs.</p></li>
<li><p><strong>Actions</strong>: The following actions are available for the selected inventory:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Edit</strong> (<img alt="edit button" src="_images/edit-button.png" />): Edit the properties for the selected inventory</p></li>
<li><p><strong>Copy</strong> (<img alt="copy" src="_images/copy-button.png" />): Makes a copy of an existing inventory as a template for creating a new one</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<section id="smart-inventories">
<span id="ug-inventories-smart"></span><h4><span class="section-number">18.1. </span>Smart Inventories<a class="headerlink" href="#smart-inventories" title="Link to this heading"></a></h4>
<p id="index-1">A Smart Inventory is a collection of hosts defined by a stored search that can be viewed like a standard inventory and made to be easily used with job runs. Organization administrators have admin permission to inventories in their organization and can create a Smart Inventories. A Smart Inventory is identified by <code class="docutils literal notranslate"><span class="pre">KIND=smart</span></code>. You can define a Smart Inventory using the same method being used with Search. <code class="docutils literal notranslate"><span class="pre">InventorySource</span></code> is directly associated with an Inventory.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Smart inventories are deprecated and will be removed in a future release. Users are encouraged to consider moving to constructed inventory for enhancements and replacement.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Inventory</span></code> model has the following new fields that are blank by default but are set accordingly for Smart Inventories:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">kind</span></code> is set to <code class="docutils literal notranslate"><span class="pre">smart</span></code> for Smart Inventories</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">host_filter</span></code> is set AND <code class="docutils literal notranslate"><span class="pre">kind</span></code> is set to <code class="docutils literal notranslate"><span class="pre">smart</span></code> for Smart Inventories.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">host</span></code> model has a related endpoint, <code class="docutils literal notranslate"><span class="pre">smart_inventories</span></code> that identifies a set of all the Smart Inventory a host is associated with. The membership table is updated every time a job runs against a smart inventory.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To update the memberships more frequently, you can change the file-based setting <code class="docutils literal notranslate"><span class="pre">AWX_REBUILD_SMART_MEMBERSHIP</span></code> to <strong>True</strong> (default is False). This will update memberships in the following events:</p>
<ul class="simple">
<li><p>a new host is added</p></li>
<li><p>an existing host is modified (updated or deleted)</p></li>
<li><p>a new Smart Inventory is added</p></li>
<li><p>an existing Smart Inventory is modified (updated or deleted)</p></li>
</ul>
</div>
<p>You can view actual inventories without being editable:</p>
<ul class="simple">
<li><p>Names of Host and Group created as a result of an inventory source sync</p></li>
<li><p>Group records cannot be edited or moved</p></li>
</ul>
<p>You cannot create hosts from a Smart Inventory host endpoint (<code class="docutils literal notranslate"><span class="pre">/inventories/N/hosts/</span></code>) as with a normal inventory. The administrator of a Smart Inventory has permission to edit fields such as the name, description, variables, and the ability to delete, but does not have the permission to modify the <code class="docutils literal notranslate"><span class="pre">host_filter</span></code>, because that will affect which hosts (that have a primary membership inside another inventory) are included in the smart inventory. Note, <code class="docutils literal notranslate"><span class="pre">host_filter</span></code> only apply to hosts inside of inventories inside of the Smart Inventory’s organization.</p>
<p>In order to modify the <code class="docutils literal notranslate"><span class="pre">host_filter</span></code>, you need to be the organization administrator of the inventory’s organization. Organization admins already have implicit “admin” access to all inventories inside the organization, therefore, this does not convey any permissions they did not already possess.</p>
<p>Administrators of the Smart Inventory can grant other users (who are not also admins of your organization) permissions like “use” “adhoc” to the smart inventory, and these will allow the actions indicate by the role, just like other standard inventories. However, this will not give them any special permissions to hosts (which live in a different inventory). It will not allow them direct read permission to hosts, or permit them to see additional hosts under <code class="docutils literal notranslate"><span class="pre">/#/hosts/</span></code>, although they can still view the hosts under the smart inventory host list.</p>
<p>In some situations, you can modify the following:</p>
<ul class="simple">
<li><p>A new Host manually created on Inventory w/ inventory sources</p></li>
<li><p>In Groups that were created as a result of inventory source syncs</p></li>
</ul>
<p>Hosts associated with the Smart Inventory are manifested at view time. If the results of a Smart Inventory contains more than one host with identical hostnames, only one of the matching hosts will be included as part of the Smart Inventory, ordered by Host ID.</p>
<p>Variables on Host and Group are not changeable even as the local system admin user.</p>
<section id="smart-host-filter">
<span id="ug-host-filters"></span><h5><span class="section-number">18.1.1. </span>Smart Host Filter<a class="headerlink" href="#smart-host-filter" title="Link to this heading"></a></h5>
<p>You can use a search filter to populate hosts for an inventory. This feature utilized the capability of the fact searching feature.</p>
<p>Facts generated by an Ansible playbook during a Job Template run are stored by AWX| into the database whenever <code class="docutils literal notranslate"><span class="pre">use_fact_cache=True</span></code> is set per-Job Template. New facts are merged with existing facts and are per-host. These stored facts can be used to filter hosts via the <code class="docutils literal notranslate"><span class="pre">/api/v2/hosts</span></code> endpoint, using the <code class="docutils literal notranslate"><span class="pre">GET</span></code> query parameter <code class="docutils literal notranslate"><span class="pre">host_filter</span></code> For example: <code class="docutils literal notranslate"><span class="pre">/api/v2/hosts?host_filter=ansible_facts__ansible_processor_vcpus=8</span></code></p>
<p>The <code class="docutils literal notranslate"><span class="pre">host_filter</span></code> parameter allows for:</p>
<ul class="simple">
<li><p>grouping via ()</p></li>
<li><p>use of the boolean and operator:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">__</span></code> to reference related fields in relational fields</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__</span></code> is used on ansible_facts to separate keys in a JSON key path</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[]</span></code> is used to denote a json array in the path specification</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> can be used in the value when spaces are wanted in the value</p></li>
</ul>
</li>
<li><p>“classic” Django queries may be embedded in the <code class="docutils literal notranslate"><span class="pre">host_filter</span></code></p></li>
</ul>
<p>Examples:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">/api/v2/hosts/?host_filter=name=localhost</span>
<span class="l l-Scalar l-Scalar-Plain">/api/v2/hosts/?host_filter=ansible_facts__ansible_date_time__weekday_number=&quot;3&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">/api/v2/hosts/?host_filter=ansible_facts__ansible_processor[]=&quot;GenuineIntel&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">/api/v2/hosts/?host_filter=ansible_facts__ansible_lo__ipv6[]__scope=&quot;host&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">/api/v2/hosts/?host_filter=ansible_facts__ansible_processor_vcpus=8</span>
<span class="l l-Scalar l-Scalar-Plain">/api/v2/hosts/?host_filter=ansible_facts__ansible_env__PYTHONUNBUFFERED=&quot;true&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">/api/v2/hosts/?host_filter=(name=localhost or name=database) and (groups__name=east or groups__name=&quot;west coast&quot;) and ansible_facts__an</span>
</pre></div>
</div>
<p>You can search <code class="docutils literal notranslate"><span class="pre">host_filter</span></code> by host name, group name, and Ansible facts.</p>
<p>The format for a group search is:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">groups.name:groupA</span>
</pre></div>
</div>
<p>The format for a fact search is:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ansible_facts.ansible_fips:false</span>
</pre></div>
</div>
<p>You can also perform Smart Search searches, which consist a host name and host description.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">host_filter=name=my_host</span>
</pre></div>
</div>
<p>If a search term in <code class="docutils literal notranslate"><span class="pre">host_filter</span></code> is of string type, to make the value a number (e.g. <code class="docutils literal notranslate"><span class="pre">2.66</span></code>), or a JSON keyword (e.g. <code class="docutils literal notranslate"><span class="pre">null</span></code>, <code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>) valid, add double quotations around the value to prevent AWX from mistakenly parsing it as a non-string:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">host_filter=ansible_facts__packages__dnsmasq[]__version=&quot;2.66&quot;</span>
</pre></div>
</div>
</section>
<section id="define-host-filter-with-ansible-facts">
<span id="ug-host-filter-facts"></span><h5><span class="section-number">18.1.2. </span>Define host filter with ansible_facts<a class="headerlink" href="#define-host-filter-with-ansible-facts" title="Link to this heading"></a></h5>
<p>To use <code class="docutils literal notranslate"><span class="pre">ansible_facts</span></code> to define the host filter when creating Smart Inventories, perform the following steps:</p>
<ol class="arabic simple">
<li><p>In the <em>Create new smart inventory screen</em>, click the <img alt="search" src="_images/search-button.png" /> button next to the <strong>Smart host filter</strong> field to open a pop-up window to filter hosts for this inventory.</p></li>
</ol>
<img alt="_images/inventories-smart-create-filter-highlighted.png" src="_images/inventories-smart-create-filter-highlighted.png" />
<ol class="arabic simple" start="2">
<li><p>In the search pop-up window, change the search criteria from <strong>Name</strong> to <strong>Advanced</strong> and select <strong>ansible_facts</strong> from the <strong>Key</strong> field.</p></li>
</ol>
<img alt="_images/inventories-smart-define-host-filter.png" src="_images/inventories-smart-define-host-filter.png" />
<p>If you wanted to add an ansible fact of</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">/api/v2/hosts/?host_filter=ansible_facts__ansible_processor[]=&quot;GenuineIntel&quot;</span>
</pre></div>
</div>
<p>In the search field, enter <code class="docutils literal notranslate"><span class="pre">ansible_processor[]=&quot;GenuineIntel&quot;</span></code> (no extra spaces or <code class="docutils literal notranslate"><span class="pre">__</span></code> before the value) and press <strong>[Enter]</strong>.</p>
<img alt="_images/inventories-smart-define-host-filter-facts.png" src="_images/inventories-smart-define-host-filter-facts.png" />
<p>The resulting search criteria for the specified ansible fact populates in the lower part of the window.</p>
<img alt="_images/inventories-smart-define-host-filter-facts2.png" src="_images/inventories-smart-define-host-filter-facts2.png" />
<ol class="arabic simple" start="3">
<li><p>Click <strong>Select</strong> to add it to the <strong>Smart host filter</strong> field.</p></li>
</ol>
<img alt="_images/inventories-smart-create-filter-added.png" src="_images/inventories-smart-create-filter-added.png" />
<ol class="arabic simple" start="4">
<li><p>Click <strong>Save</strong> to save the new Smart Inventory.</p></li>
</ol>
<p>The Details tab of the new Smart Inventory opens and displays the specified ansible facts in the <strong>Smart host filter</strong> field.</p>
<img alt="_images/inventories-smart-create-details.png" src="_images/inventories-smart-create-details.png" />
<ol class="arabic simple" start="5">
<li><p>From the Details view, you can edit the <strong>Smart host filter</strong> field by clicking <strong>Edit</strong> and delete existing filter(s), clear all existing filters, or add new ones.</p></li>
</ol>
<img alt="_images/inventories-smart-define-host-filter-facts-group.png" src="_images/inventories-smart-define-host-filter-facts-group.png" />
</section>
</section>
<section id="constructed-inventories">
<span id="ug-inventories-constructed"></span><h4><span class="section-number">18.2. </span>Constructed Inventories<a class="headerlink" href="#constructed-inventories" title="Link to this heading"></a></h4>
<p id="index-2">As a platform user, this feature allows creation of a new inventory (called a constructed inventory) from a list of input inventories. The constructed inventory contains copies of hosts and groups in its input inventories, allowing jobs to target groups of servers across multiple inventories. Groups and hostvars can be added to the inventory content, and hosts can be filtered to limit the size of the constructed inventory. Constructed inventories address some limitations of the Smart Inventories host filtering model and makes use of the <a class="reference external" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/constructed_inventory.html#ansible-builtin-constructed-inventory-uses-jinja2-to-construct-vars-and-groups-based-on-existing-inventory">Ansible core constructed inventory model</a>.</p>
<p>The key factors that distinguish a constructed inventory from a Smart Inventory are:</p>
<ul class="simple">
<li><p>the normal Ansible hostvars namespace is available</p></li>
<li><p>they provide groups</p></li>
</ul>
<p>Smart inventories take a <code class="docutils literal notranslate"><span class="pre">host_filter</span></code> as input and create a resultant inventory with hosts from inventories in its organization. Constructed inventories take <code class="docutils literal notranslate"><span class="pre">source_vars</span></code> and <code class="docutils literal notranslate"><span class="pre">limit</span></code> as inputs and transform its <code class="docutils literal notranslate"><span class="pre">input_inventories</span></code> into a new inventory, complete with groups. Groups (existing or constructed) can then be referenced in the <code class="docutils literal notranslate"><span class="pre">limit</span></code> field to reduce the number of hosts produced.</p>
<p>For instance, you can construct groups based on these host properties:</p>
<ul class="simple">
<li><p>RHEL major/minor versions</p></li>
<li><p>Windows hosts</p></li>
<li><p>Cloud based instances tagged in a certain region</p></li>
<li><p>other</p></li>
</ul>
<p>These examples described in the subsequent sections are organized by the structure of the input inventories.</p>
<section id="group-name-and-variables-filtering">
<h5><span class="section-number">18.2.1. </span>Group name and variables filtering<a class="headerlink" href="#group-name-and-variables-filtering" title="Link to this heading"></a></h5>
<p>Two different conditions are demonstrated here to describe the input inventory content:</p>
<ul class="simple">
<li><p>First condition is that the <code class="docutils literal notranslate"><span class="pre">state</span></code> variable defined on the host is set to <code class="docutils literal notranslate"><span class="pre">shutdown</span></code></p></li>
<li><p>Second condition is membership in a group with <code class="docutils literal notranslate"><span class="pre">account_alias</span></code> variable set to <code class="docutils literal notranslate"><span class="pre">product_dev</span></code></p></li>
</ul>
<p>The variable <code class="docutils literal notranslate"><span class="pre">account_alias</span></code> is used to demonstrate a group variable. In this hypothetical, each account has its own group, with group variables giving metadata about those accounts, which is common in cloud-source inventories. These variables are shown in the general hostvars namespace in Ansible, which is why it has no special treatment in <code class="docutils literal notranslate"><span class="pre">source_vars</span></code>.</p>
<p>The hosts inside the input inventory will fit one condition, the other condition,
neither, or both. This results in four hosts total for demonstration purposes.</p>
<img alt="_images/inventories-constructed-inventory-venn.png" src="_images/inventories-constructed-inventory-venn.png" />
<p>This folder defines the inventory as an ini type named <code class="docutils literal notranslate"><span class="pre">two_conditions.ini</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="nv">account_1234</span><span class="p p-Indicator">]</span>
<span class="l l-Scalar l-Scalar-Plain">host1</span>
<span class="l l-Scalar l-Scalar-Plain">host2 state=shutdown</span>

<span class="l l-Scalar l-Scalar-Plain">[account_4321]</span>
<span class="l l-Scalar l-Scalar-Plain">host3</span>
<span class="l l-Scalar l-Scalar-Plain">host4 state=shutdown</span>

<span class="l l-Scalar l-Scalar-Plain">[account_1234:vars]</span>
<span class="l l-Scalar l-Scalar-Plain">account_alias=product_dev</span>

<span class="l l-Scalar l-Scalar-Plain">[account_4321:vars]</span>
<span class="l l-Scalar l-Scalar-Plain">account_alias=sustaining</span>
</pre></div>
</div>
<p>The goal here is to return only shutdown hosts that are present in the group with the <code class="docutils literal notranslate"><span class="pre">account_alias</span></code> variable of <code class="docutils literal notranslate"><span class="pre">product_dev</span></code>.
There are two approaches to this, both shown in yaml format. The first one suggested is recommended.</p>
<ol class="arabic simple" id="constr-inv-example">
<li><p><strong>Construct 2 groups, limit to intersection</strong></p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">source_vars</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">constructed</span>
<span class="nt">strict</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">groups</span><span class="p">:</span>
<span class="w">  </span><span class="nt">is_shutdown</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">state | default(&quot;running&quot;) == &quot;shutdown&quot;</span>
<span class="w">  </span><span class="nt">product_dev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account_alias == &quot;product_dev&quot;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">limit</span></code>: <code class="docutils literal notranslate"><span class="pre">is_shutdown:&amp;product_dev</span></code></p>
<p>This constructed inventory input creates a group for both of the categories and uses the <code class="docutils literal notranslate"><span class="pre">limit</span></code> (host pattern) to only return hosts that are in the intersection of those two groups, which is documented in <a class="reference external" href="https://docs.ansible.com/ansible/latest/inventory_guide/intro_patterns.html">host patterns in Ansible</a>.</p>
<p>Also, when a variable may or may not be defined (depending on the host), you can give a default, like with <code class="docutils literal notranslate"><span class="pre">|</span> <span class="pre">default(&quot;running&quot;)</span></code> if you know what value it should have when it is not defined. This helps with debugging, as described in the <a class="reference internal" href="#constr-inv-debugging"><span class="std std-ref">Debugging tips</span></a> section.</p>
<ol class="arabic simple" start="2">
<li><p><strong>Construct 1 group, limit to group</strong></p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">source_vars</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">constructed</span>
<span class="nt">strict</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">groups</span><span class="p">:</span>
<span class="w">  </span><span class="nt">shutdown_in_product_dev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">state | default(&quot;running&quot;) == &quot;shutdown&quot; and account_alias == &quot;product_dev&quot;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">limit</span></code>: <code class="docutils literal notranslate"><span class="pre">shutdown_in_product_dev</span></code></p>
<p>This input creates one group that only includes hosts that match both criteria. The limit is then just the group name by itself, returning just <strong>host2</strong>, same as the previous approach.</p>
<section id="debugging-tips">
<span id="constr-inv-debugging"></span><h6><span class="section-number">18.2.1.1. </span>Debugging tips<a class="headerlink" href="#debugging-tips" title="Link to this heading"></a></h6>
<p>It is very important to set the <code class="docutils literal notranslate"><span class="pre">strict</span></code> parameter to <code class="docutils literal notranslate"><span class="pre">True</span></code> so that you can debug problems with your templates. If the template fails to render, you will get an error in the associated inventory update for that constructed inventory.</p>
<p>When encountering errors, increase verbosity to get more details.</p>
<p>Giving a default, like with <code class="docutils literal notranslate"><span class="pre">|</span> <span class="pre">default(&quot;running&quot;)</span></code> is a generic use of Jinja2 templates in Ansible. Doing this avoids errors from the particular template when you set <code class="docutils literal notranslate"><span class="pre">strict:</span> <span class="pre">true</span></code>. You could also set <code class="docutils literal notranslate"><span class="pre">strict:</span> <span class="pre">false</span></code>, and allow the template to produce an error, which results in the host not getting included in that group. However, doing so makes it difficult to debug issues in the future if your templates continue to grow in complexity.</p>
<p>However, you may still have to debug the intended function of the templates if they are not producing the expected inventory content. For example, if a <code class="docutils literal notranslate"><span class="pre">groups</span></code> group has a complex filter (like <code class="docutils literal notranslate"><span class="pre">shutdown_in_product_dev</span></code>) but does not contain any hosts in the resultant constructed inventory, then use the <code class="docutils literal notranslate"><span class="pre">compose</span></code> parameter to help debug. Like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">source_vars</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">constructed</span>
<span class="nt">strict</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">groups</span><span class="p">:</span>
<span class="w">  </span><span class="nt">shutdown_in_product_dev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">state | default(&quot;running&quot;) == &quot;shutdown&quot; and account_alias == &quot;product_dev&quot;</span>
<span class="nt">compose</span><span class="p">:</span>
<span class="w">  </span><span class="nt">resolved_state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">state | default(&quot;running&quot;)</span>
<span class="w">  </span><span class="nt">is_in_product_dev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">account_alias == &quot;product_dev&quot;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">limit</span></code>: ``</p>
<p>Running with a blank <code class="docutils literal notranslate"><span class="pre">limit</span></code> will return all hosts. You can use this to inspect specific variables on specific hosts, giving insight into where problems in the <code class="docutils literal notranslate"><span class="pre">groups</span></code> lie.</p>
</section>
</section>
<section id="nested-groups">
<h5><span class="section-number">18.2.2. </span>Nested groups<a class="headerlink" href="#nested-groups" title="Link to this heading"></a></h5>
<p>The inventory contents of two groups where one is a child of the other is used here to demonstrate nested groups. The child group has a host inside of it, and the parent group has a variable defined. Due to how Ansible core works, the variable of the parent group will be available in the namespace as a playbook is running, and can be used for filtering.</p>
<p>Define the inventory file in a yaml format named <code class="docutils literal notranslate"><span class="pre">nested.yml</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">all</span><span class="p">:</span>
<span class="w">  </span><span class="nt">children</span><span class="p">:</span>
<span class="w">    </span><span class="nt">groupA</span><span class="p">:</span>
<span class="w">      </span><span class="nt">vars</span><span class="p">:</span>
<span class="w">        </span><span class="nt">filter_var</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">filter_val</span>
<span class="w">      </span><span class="nt">children</span><span class="p">:</span>
<span class="w">        </span><span class="nt">groupB</span><span class="p">:</span>
<span class="w">          </span><span class="nt">hosts</span><span class="p">:</span>
<span class="w">            </span><span class="nt">host1</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="w">    </span><span class="nt">ungrouped</span><span class="p">:</span>
<span class="w">      </span><span class="nt">hosts</span><span class="p">:</span>
<span class="w">        </span><span class="nt">host2</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
<p>The goal here is to filter hosts based on indirect membership in a group (because <code class="docutils literal notranslate"><span class="pre">host1</span></code> is in <code class="docutils literal notranslate"><span class="pre">groupB</span></code>, it is also in <code class="docutils literal notranslate"><span class="pre">groupA</span></code>).</p>
<section id="filter-on-nested-group-names">
<h6><span class="section-number">18.2.2.1. </span>Filter on nested group names<a class="headerlink" href="#filter-on-nested-group-names" title="Link to this heading"></a></h6>
<p>Use the following yaml format to filter on nested group names:</p>
<p><code class="docutils literal notranslate"><span class="pre">source_vars</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">constructed</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">limit</span></code>: <code class="docutils literal notranslate"><span class="pre">groupA</span></code></p>
</section>
<section id="filter-on-nested-group-property">
<h6><span class="section-number">18.2.2.2. </span>Filter on nested group property<a class="headerlink" href="#filter-on-nested-group-property" title="Link to this heading"></a></h6>
<p>This shows how you can filter on a group variable, even if the host is indirectly a member of that group.</p>
<p>In the inventory contents, you can see that <code class="docutils literal notranslate"><span class="pre">host2</span></code> is not expected to have the variable <code class="docutils literal notranslate"><span class="pre">filter_var</span></code> defined, because it is not in any of the groups. Because of using <code class="docutils literal notranslate"><span class="pre">strict:</span> <span class="pre">true</span></code>, use a default value so that hosts without that variable defined. With this, <code class="docutils literal notranslate"><span class="pre">host2</span></code>, will return <code class="docutils literal notranslate"><span class="pre">False</span></code> from the expression, as opposed to producing an error. <code class="docutils literal notranslate"><span class="pre">host1</span></code> will inherit the variable from its groups, and will be returned.</p>
<p><code class="docutils literal notranslate"><span class="pre">source_vars</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">constructed</span>
<span class="nt">strict</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">groups</span><span class="p">:</span>
<span class="w">  </span><span class="nt">filter_var_is_filter_val</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">filter_var | default(&quot;&quot;) == &quot;filter_val&quot;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">limit</span></code>: <code class="docutils literal notranslate"><span class="pre">filter_var_is_filter_val</span></code></p>
</section>
</section>
<section id="ansible-facts">
<h5><span class="section-number">18.2.3. </span>Ansible facts<a class="headerlink" href="#ansible-facts" title="Link to this heading"></a></h5>
<p>To create an inventory with Ansible facts, you need to run a playbook against the inventory that has <code class="docutils literal notranslate"><span class="pre">gather_facts:</span> <span class="pre">true</span></code>. The actual facts will differ system-to-system. The following example problems exemplify some example cases and are not intended to address all known scenarios.</p>
<section id="filter-on-environment-variables">
<h6><span class="section-number">18.2.3.1. </span>Filter on environment variables<a class="headerlink" href="#filter-on-environment-variables" title="Link to this heading"></a></h6>
<p>An example problem is demonstrated here that involves filtering on env vars using the yaml format:</p>
<p><code class="docutils literal notranslate"><span class="pre">source_vars</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">constructed</span>
<span class="nt">strict</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">groups</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hosts_using_xterm</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ansible_env.TERM == &quot;xterm&quot;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">limit</span></code>: <code class="docutils literal notranslate"><span class="pre">hosts_using_xterm</span></code></p>
</section>
<section id="filter-hosts-by-processor-type">
<h6><span class="section-number">18.2.3.2. </span>Filter hosts by processor type<a class="headerlink" href="#filter-hosts-by-processor-type" title="Link to this heading"></a></h6>
<p>An example problem is demonstrated here that involves filtering hosts by processor type (Intel) using the yaml format:</p>
<p><code class="docutils literal notranslate"><span class="pre">source_vars</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">constructed</span>
<span class="nt">strict</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">groups</span><span class="p">:</span>
<span class="w">  </span><span class="nt">intel_hosts</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GenuineIntel&quot;</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in ansible_processor</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">limit</span></code>: <code class="docutils literal notranslate"><span class="pre">intel_hosts</span></code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Like with Smart Inventories, hosts in constructed inventories are not counted against your license allotment because they are referencing the original inventory host. Also, hosts that are disabled in the original inventories will not be included in the constructed inventory.</p>
</div>
<p>An inventory update ran via <code class="docutils literal notranslate"><span class="pre">ansible-inventory</span></code> creates the constructed inventory contents. This is always configured to update-on-launch before a job, but you can still select a cache timeout value in case this takes too long.</p>
<p>When creating a constructed inventory, the API enforces that it always has one inventory source associated with it. All inventory updates have an associated inventory source, and the fields needed for constructed inventory (<code class="docutils literal notranslate"><span class="pre">source_vars</span></code> and <code class="docutils literal notranslate"><span class="pre">limit</span></code>) are fields already present on the inventory source model.</p>
</section>
</section>
<section id="user-interface">
<h5><span class="section-number">18.2.4. </span>User interface<a class="headerlink" href="#user-interface" title="Link to this heading"></a></h5>
<p>Follow the procedure described in the subsequent section, <a class="reference internal" href="#ug-inventories-add"><span class="std std-ref">Add a new inventory</span></a> to create a new constructed inventory.</p>
<p>Example of a constructed inventory details view:</p>
<img alt="_images/inventories-constructed-inventory-details.png" src="_images/inventories-constructed-inventory-details.png" />
</section>
</section>
<section id="inventory-plugins">
<span id="ug-inventories-plugins"></span><h4><span class="section-number">18.3. </span>Inventory Plugins<a class="headerlink" href="#inventory-plugins" title="Link to this heading"></a></h4>
<p id="index-3">Inventory updates use dynamically-generated YAML files which are parsed by their respective inventory plugin. Users can provide the new style inventory plugin config directly to AWX via the inventory source <code class="docutils literal notranslate"><span class="pre">source_vars</span></code> for all the following inventory sources:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#ug-source-ec2"><span class="std std-ref">Amazon Web Services EC2</span></a></p></li>
<li><p><a class="reference internal" href="#ug-source-gce"><span class="std std-ref">Google Compute Engine</span></a></p></li>
<li><p><a class="reference internal" href="#ug-source-azure"><span class="std std-ref">Microsoft Azure Resource Manager</span></a></p></li>
<li><p><a class="reference internal" href="#ug-source-vmvcenter"><span class="std std-ref">VMware vCenter</span></a></p></li>
<li><p><a class="reference internal" href="#ug-source-satellite"><span class="std std-ref">Red Hat Satellite 6</span></a></p></li>
<li><p><a class="reference internal" href="#ug-source-insights"><span class="std std-ref">Red Hat Insights</span></a></p></li>
<li><p><a class="reference internal" href="#ug-source-openstack"><span class="std std-ref">OpenStack</span></a></p></li>
<li><p><a class="reference internal" href="#ug-source-rhv"><span class="std std-ref">Red Hat Virtualization</span></a></p></li>
<li><p><a class="reference internal" href="#ug-source-rhaap"><span class="std std-ref">Red Hat Ansible Automation Platform</span></a></p></li>
<li><p><a class="reference internal" href="#ug-source-terraform"><span class="std std-ref">Terraform State</span></a></p></li>
<li><p><a class="reference internal" href="#ug-source-ocpv"><span class="std std-ref">OpenShift Virtualization</span></a></p></li>
</ul>
<p>Newly created configurations for inventory sources will contain the default plugin configuration values. If you want your newly created inventory sources to match the output of legacy sources, you must apply a specific set of configuration values for that source. To ensure backward compatibility, AWX uses “templates” for each of these sources to force the output of inventory plugins into the legacy format. Refer to <a class="reference internal" href="index.html#ir-inv-plugin-templates-reference"><span class="std std-ref">Supported Inventory Plugin Templates</span></a> section of this guide for each source and their respective templates to help you migrate to the new style inventory plugin output.</p>
<p><code class="docutils literal notranslate"><span class="pre">source_vars</span></code> that contain <code class="docutils literal notranslate"><span class="pre">plugin:</span> <span class="pre">foo.bar.baz</span></code> as a top-level key will be replaced with the appropriate fully-qualified inventory plugin name at runtime based on the <code class="docutils literal notranslate"><span class="pre">InventorySource</span></code> source. For example, if ec2 is selected for the <code class="docutils literal notranslate"><span class="pre">InventorySource</span></code> then, at run-time, plugin will be set to <code class="docutils literal notranslate"><span class="pre">amazon.aws.aws_ec2</span></code>.</p>
</section>
<section id="add-a-new-inventory">
<span id="ug-inventories-add"></span><h4><span class="section-number">18.4. </span>Add a new inventory<a class="headerlink" href="#add-a-new-inventory" title="Link to this heading"></a></h4>
<p id="index-4">Adding a new inventory involves several components:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#ug-inventories-add-permissions"><span class="std std-ref">Add permissions</span></a></p></li>
<li><p><a class="reference internal" href="#ug-inventories-add-groups"><span class="std std-ref">Add groups</span></a></p></li>
<li><p><a class="reference internal" href="#ug-inventories-add-host"><span class="std std-ref">Add hosts</span></a></p></li>
<li><p><a class="reference internal" href="#ug-inventories-add-source"><span class="std std-ref">Add source</span></a></p></li>
<li><p><a class="reference internal" href="#ug-inventories-view-completed-jobs"><span class="std std-ref">View completed jobs</span></a></p></li>
</ul>
<p>To create a new standard inventory, Smart inventory, or constructed inventory:</p>
<ol class="arabic simple">
<li><p>Click the <strong>Add</strong> button, and select the type of inventory to create.</p></li>
</ol>
<p>The type of inventory is identified at the top of the create form.</p>
<p><img alt="Inventories_create_new - create new inventory" src="_images/inventories-create-new-inventory.png" /></p>
<ol class="arabic simple" start="2">
<li><p>Enter the appropriate details into the following fields:</p></li>
</ol>
<ul>
<li><p><strong>Name</strong>: Enter a name appropriate for this inventory.</p></li>
<li><p><strong>Description</strong>: Enter an arbitrary description as appropriate (optional).</p></li>
<li><p><strong>Organization</strong>: Required. Choose among the available organizations.</p></li>
<li><p><strong>Smart Host Filter</strong>: (Only applicable to Smart Inventories) Click the <img alt="search" src="_images/search-button.png" /> button to open a separate window to filter hosts for this inventory. These options are based on the organization you chose.</p>
<p>Filters are similar to tags in that tags are used to filter certain hosts that contain those names. Therefore, to populate the <strong>Smart Host Filter</strong> field, you are specifying a tag that contains the hosts you want, not actually selecting the hosts themselves. Enter the tag in the <strong>Search</strong> field and press [Enter]. Filters are case-sensitive. Refer to the <a class="reference internal" href="#ug-host-filters"><span class="std std-ref">Smart Host Filter</span></a> section for more information.</p>
</li>
<li><p><strong>Instance Groups</strong>: Click the <img alt="search" src="_images/search-button.png" /> button to open a separate window. Choose the instance group(s) for this inventory to run on. If the list is extensive, use the search to narrow the options. You may select multiple instance groups and sort them in the order you want them ran.</p></li>
</ul>
<img alt="_images/select-instance-groups-modal.png" src="_images/select-instance-groups-modal.png" />
<ul class="simple">
<li><p><strong>Labels</strong>: Optionally supply labels that describe this inventory, so they can be used to group and filter inventories and jobs.</p></li>
<li><p><strong>Input inventories</strong>: (Only applicable to constructed inventories) Specify the source inventories to include in this constructed inventory. Click the <img alt="search" src="_images/search-button.png" /> button to select from available inventories. Empty groups from input inventories will be copied into the constructed inventory.</p></li>
<li><p><strong>Cached timeout (seconds)</strong>: (Only applicable to constructed inventories) Optionally set the length of time you want the cache plugin data to timeout.</p></li>
<li><p><strong>Verbosity</strong>: (Only applicable to constructed inventories) Control the level of output Ansible produces as the playbook executes related to inventory sources associated with constructed inventories. Choose the verbosity from Normal to various Verbose or Debug settings. This only appears in the “details” report view. Verbose logging includes the output of all commands. Debug logging is exceedingly verbose and includes information on SSH operations that can be useful in certain support instances. Most users do not need to see debug mode output.</p></li>
<li><p><strong>Limit</strong>: (Only applicable to constructed inventories) Restricts the number of returned hosts for the inventory source associated with the constructed inventory. You can paste a group name into the limit field to only include hosts in that group. See <a class="reference internal" href="#constr-inv-source-vars"><span class="std std-ref">Source vars</span></a> for more detail.</p></li>
<li><p><strong>Options</strong>: Check the <strong>Prevent Instance Group Fallback</strong> option (only applicable to standard inventories) to allow only the instance groups listed in the <strong>Instance Groups</strong> field above to execute the job. If unchecked, all available instances in the execution pool will be used based on the hierarchy described in <a class="reference internal" href="index.html#ag-instance-groups-control-where-job-runs"><span class="std std-ref">Control Where a Job Runs</span></a>. Click the <img alt="help" src="_images/tooltips-icon.png" /> icon for additional information.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Set the <code class="docutils literal notranslate"><span class="pre">prevent_instance_group_fallback</span></code> option for Smart Inventories through the API.</p>
</div>
<ul class="simple" id="constr-inv-source-vars">
<li><p><strong>Variables</strong> (<strong>Source vars</strong> for constructed inventories):</p>
<ul>
<li><p><strong>Variables</strong> Variable definitions and values to be applied to all hosts in this inventory. Enter variables using either JSON or YAML syntax. Use the radio button to toggle between the two.</p></li>
<li><p><strong>Source vars</strong> for constructed inventories creates groups, specifically under the <code class="docutils literal notranslate"><span class="pre">groups</span></code> key of the data. It accepts Jinja2 template syntax, renders it for every host, makes a <code class="docutils literal notranslate"><span class="pre">True</span></code>/<code class="docutils literal notranslate"><span class="pre">False</span></code> evaluation, and includes the host in the group (from key of the entry) if the result is <code class="docutils literal notranslate"><span class="pre">True</span></code>. This is particularly useful because you can paste that group name into the limit field to only include hosts in that group. See an example <a class="reference internal" href="#constr-inv-example"><span class="std std-ref">here</span></a>.</p></li>
</ul>
</li>
</ul>
<p><img alt="Inventories_create_new_saved - create new inventory" src="_images/inventories-create-new-saved-inventory.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Click <strong>Save</strong> when done.</p></li>
</ol>
<p>After saving the new inventory, you can proceed with configuring permissions, groups, hosts, sources, and view completed jobs, if applicable to the type of inventory. For more instructions, refer to the subsequent sections.</p>
<section id="add-permissions">
<span id="ug-inventories-add-permissions"></span><h5><span class="section-number">18.4.1. </span>Add permissions<a class="headerlink" href="#add-permissions" title="Link to this heading"></a></h5>
<blockquote>
<div></div></blockquote>
<ol class="arabic simple" id="ug-permissions">
<li><p>In the <strong>Access</strong> tab, click the <strong>Add</strong> button.</p></li>
<li><p>Select a user or team to add and click <strong>Next</strong></p></li>
<li><p>Select one or more users or teams from the list by clicking the check box(es) next to the name(s) to add them as members and click <strong>Next</strong>.</p></li>
</ol>
<img alt="_images/organizations-add-users-for-example-organization.png" src="_images/organizations-add-users-for-example-organization.png" />
<p>In this example, two users have been selected to be added.</p>
<ol class="arabic simple" start="4">
<li><p>Select the role(s) you want the selected user(s) or team(s) to have. Be sure to scroll down for a complete list of roles. Different resources have different options available.</p></li>
</ol>
<blockquote>
<div><img alt="_images/organizations-add-users-roles.png" src="_images/organizations-add-users-roles.png" />
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Click the <strong>Save</strong> button to apply the roles to the selected user(s) or team(s) and to add them as members.</p></li>
</ol>
<p>The Add Users/Teams window closes to display the updated roles assigned for each user and team.</p>
<img alt="Permissions tab with Role Assignments" src="_images/permissions-tab-roles-assigned.png" />
<p>To remove roles for a particular user, click the disassociate (x) button next to its resource.</p>
<img alt="_images/permissions-disassociate.png" src="_images/permissions-disassociate.png" />
<p>This launches a confirmation dialog, asking you to confirm the disassociation.</p>
<img alt="_images/permissions-disassociate-confirm.png" src="_images/permissions-disassociate-confirm.png" />
</section>
<section id="add-groups">
<span id="ug-inventories-add-groups"></span><h5><span class="section-number">18.4.2. </span>Add groups<a class="headerlink" href="#add-groups" title="Link to this heading"></a></h5>
<p id="index-5">Inventories are divided into groups, which may contain hosts and other groups, and hosts. Groups are only applicable to standard inventories and is not a configurable directly through a Smart Inventory. You can associate an existing group through host(s) that are used with standard inventories. There are several actions available for standard inventories:</p>
<ul class="simple">
<li><p>Create a new Group</p></li>
<li><p>Create a new Host</p></li>
<li><p>Run a command on the selected Inventory</p></li>
<li><p>Edit Inventory properties</p></li>
<li><p>View activity streams for Groups and Hosts</p></li>
<li><p>Obtain help building your Inventory</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Inventory sources are not associated with groups. Spawned groups are top-level and may still have child groups, and all of these spawned groups may have hosts.</p>
</div>
<p>To create a new group for an inventory:</p>
<ol class="arabic simple">
<li><p>Click the <strong>Add</strong> button to open the <strong>Create Group</strong> window.</p></li>
</ol>
<p><img alt="Inventories_manage_group_add" src="_images/inventories-add-group-new.png" /></p>
<ol class="arabic simple" start="2">
<li><p>Enter the appropriate details into the required and optional fields:</p></li>
</ol>
<ul class="simple">
<li><p><strong>Name</strong>: Required</p></li>
<li><p><strong>Description</strong>: Enter an arbitrary description as appropriate (optional)</p></li>
<li><p><strong>Variables</strong>: Enter definitions and values to be applied to all hosts in this group. Enter variables using either JSON or YAML syntax. Use the radio button to toggle between the two.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>When done, click <strong>Save</strong>.</p></li>
</ol>
<section id="add-groups-within-groups">
<h6><span class="section-number">18.4.2.1. </span>Add groups within groups<a class="headerlink" href="#add-groups-within-groups" title="Link to this heading"></a></h6>
<p>To add groups within groups:</p>
<ol class="arabic simple">
<li><p>Click the <strong>Related Groups</strong> tab.</p></li>
<li><p>Click the <strong>Add</strong> button, and select whether to add a group that already exists in your configuration or create a new group.</p></li>
<li><p>If creating a new group, enter the appropriate details into the required and optional fields:</p></li>
</ol>
<ul class="simple">
<li><p><strong>Name</strong>: Required</p></li>
<li><p><strong>Description</strong>: Enter an arbitrary description as appropriate (optional)</p></li>
<li><p><strong>Variables</strong>: Enter definitions and values to be applied to all hosts in this group. Enter variables using either JSON or YAML syntax. Use the radio button to toggle between the two.</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p>When done, click <strong>Save</strong>.</p></li>
</ol>
<p>The <strong>Create Group</strong> window closes and the newly created group displays as an entry in the list of groups associated with the group that it was created for.</p>
<p><img alt="Inventories add group subgroup" src="_images/inventories-add-group-subgroup-added.png" /></p>
<p>If you chose to add an existing group, available groups will appear in a separate selection window.</p>
<p><img alt="Inventories add group existing subgroup" src="_images/inventories-add-group-existing-subgroup.png" /></p>
<p>Once a group is selected, it displays as an entry in the list of groups associated with the group.</p>
<p>5. To configure additional groups and hosts under the subgroup, click on the name of the subgroup from the
list of groups and repeat the same steps described in this section.</p>
</section>
<section id="view-or-edit-inventory-groups">
<h6><span class="section-number">18.4.2.2. </span>View or edit inventory groups<a class="headerlink" href="#view-or-edit-inventory-groups" title="Link to this heading"></a></h6>
<p>The list view displays all your inventory groups at once, or you can filter it to only display the root group(s). An inventory group is considered a root group if it is not a subset of another group.</p>
<p>You may be able to delete a subgroup without concern for dependencies, since AWX will look for dependencies such as any child groups or hosts. If any exists, a confirmation dialog displays for you to choose whether to delete the root group and all of its subgroups and hosts; or promote the subgroup(s) so they become the top-level inventory group(s), along with their host(s).</p>
<img alt="_images/inventories-groups-delete-root-with-children.png" src="_images/inventories-groups-delete-root-with-children.png" />
</section>
</section>
<section id="add-hosts">
<span id="ug-inventories-add-host"></span><h5><span class="section-number">18.4.3. </span>Add hosts<a class="headerlink" href="#add-hosts" title="Link to this heading"></a></h5>
<p>You can configure hosts for the inventory as well as for groups and groups within groups. To configure hosts:</p>
<ol class="arabic simple">
<li><p>Click the <strong>Hosts</strong> tab.</p></li>
<li><p>Click the <strong>Add</strong> button, and select whether to add a host that already exists in your configuration or create a new host.</p></li>
<li><p>If creating a new host, select the <img alt="toggle button" src="_images/on-off-toggle-button.png" /> button to specify whether or not to include this host while running jobs.</p></li>
</ol>
<ol class="arabic simple" start="4">
<li><p>Enter the appropriate details into the required and optional fields:</p></li>
</ol>
<ul class="simple">
<li><p><strong>Host Name</strong>: Required</p></li>
<li><p><strong>Description</strong>: Enter an arbitrary description as appropriate (optional)</p></li>
<li><p><strong>Variables</strong>: Enter definitions and values to be applied to all hosts in this group. Enter variables using either JSON or YAML syntax. Use the radio button to toggle between the two.</p></li>
</ul>
<ol class="arabic simple" start="5">
<li><p>When done, click <strong>Save</strong>.</p></li>
</ol>
<p>The <strong>Create Host</strong> window closes and the newly created host displays as an entry in the list of hosts associated with the group that it was created for.</p>
<p><img alt="Inventories add group host" src="_images/inventories-add-group-host-added.png" /></p>
<p>If you chose to add an existing host, available hosts will appear in a separate selection window.</p>
<p><img alt="Inventories add existing host" src="_images/inventories-add-existing-host.png" /></p>
<p>Once a host is selected, it displays as an entry in the list of hosts associated with the group. You can disassociate a host from this screen by selecting the host and click the <strong>Disassociate</strong> button.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You may also run ad hoc commands from this screen. Refer to <a class="reference internal" href="#ug-inventories-run-ad-hoc"><span class="std std-ref">Running Ad Hoc Commands</span></a> for more detail.</p>
</div>
<p>6. To configure additional groups for the host, click on the name of the host from the
list of hosts.</p>
<p><img alt="Inventories add group host emphasized" src="_images/inventories-add-group-host-added-emphasized.png" /></p>
<p>This opens the Details tab of the selected host.</p>
<p><img alt="Inventories add group host details" src="_images/inventories-add-group-host-details.png" /></p>
<ol class="arabic simple" start="7">
<li><p>Click the <strong>Groups</strong> tab to configure groups for the host.</p></li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Click the <strong>Add</strong> button to associate the host with an existing group.</p></li>
</ol>
<blockquote>
<div><p>Available groups appear in a separate selection window.</p>
<img alt="_images/inventories-add-group-hosts-add-groups.png" src="_images/inventories-add-group-hosts-add-groups.png" />
</div></blockquote>
<ol class="loweralpha simple" start="2">
<li><p>Click to select the group(s) to associate with the host and click <strong>Save</strong>.</p></li>
</ol>
<p>Once a group is associated, it displays as an entry in the list of groups associated with the host.</p>
</div></blockquote>
<ol class="arabic simple" start="8">
<li><p>If a host was used to run a job, you can view details about those jobs in the <strong>Completed Jobs</strong> tab of the host and click <strong>Expanded</strong> to view details about each job.</p></li>
</ol>
<img alt="_images/inventories-add-host-view-completed-jobs.png" src="_images/inventories-add-host-view-completed-jobs.png" />
<div class="admonition note" id="ug-inventories-add-host-bulk-api">
<p class="admonition-title">Note</p>
<p>You may create hosts in bulk using the newly added endpoint in the API, <code class="docutils literal notranslate"><span class="pre">/api/v2/bulk/host_create</span></code>. This endpoint accepts JSON and you can specify the target inventory and a list of hosts to add to the inventory. These hosts must be unique within the inventory. Either all hosts are added, or an error is returned indicating why the operation was not able to complete. Use the <strong>OPTIONS</strong> request to return relevant schema. For more information, see the <a class="reference external" href="https://docs.ansible.com/automation-controller/latest/html/controllerapi/api_ref.html#/Bulk">Bulk endpoint</a> of the <em>Reference</em> section of the <em>AWX API Guide</em>.</p>
</div>
</section>
<section id="add-source">
<span id="ug-inventories-add-source"></span><h5><span class="section-number">18.4.4. </span>Add source<a class="headerlink" href="#add-source" title="Link to this heading"></a></h5>
<p>Inventory sources are not associated with groups. Spawned groups are top-level and may still have child groups, and all of these spawned groups may have hosts. Adding a source to an inventory only applies to standard inventories. Smart inventories inherit their source from the standard inventories they are associated with. To configure the source for the inventory:</p>
<ol class="arabic simple">
<li><p>In the inventory you want to add a source, click the <strong>Sources</strong> tab.</p></li>
<li><p>Click the <strong>Add</strong> button.</p></li>
</ol>
<p>This opens the Create Source window.</p>
<p><img alt="Inventories create source" src="_images/inventories-create-source.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Enter the appropriate details into the required and optional fields:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p><strong>Name</strong>: Required</p></li>
<li><p><strong>Description</strong>: Enter an arbitrary description as appropriate (optional)</p></li>
<li><p><strong>Execution Environment</strong>: Optionally search (<img alt="search" src="_images/search-button.png" />) or enter the name of the execution environment with which you want to run your inventory imports. Refer to the <a class="reference internal" href="index.html#ug-execution-environments"><span class="std std-ref">Execution Environments</span></a> section for details on building an execution environment.</p></li>
<li><p><strong>Source</strong>: Choose a source for your inventory. Refer to the <a class="reference internal" href="#ug-inventory-sources"><span class="std std-ref">Inventory Sources</span></a> section for more information about each source and details for entering the appropriate information.</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" id="ug-add-inv-common-fields" start="4">
<li><p>After completing the required information for your chosen <a class="reference internal" href="#ug-inventory-sources"><span class="std std-ref">inventory source</span></a>, you can continue to optionally specify other common parameters, such as verbosity, host filters, and variables.</p></li>
<li><p>Select the appropriate level of output on any inventory source’s update jobs from the <strong>Verbosity</strong> drop-down menu.</p></li>
<li><p>Use the <strong>Host Filter</strong> field to specify only matching host names to be imported into AWX.</p></li>
<li><p>In the <strong>Enabled Variable</strong>, specify AWX to retrieve the enabled state from the given dictionary of host variables. The enabled variable may be specified using dot notation as ‘foo.bar’, in which case the lookup will traverse into nested dicts, equivalent to: <code class="docutils literal notranslate"><span class="pre">from_dict.get('foo',</span> <span class="pre">{}).get('bar',</span> <span class="pre">default)</span></code>.</p></li>
<li><p>If you specified a dictionary of host variables in the <strong>Enabled Variable</strong> field, you can provide a value to enable on import. For example, if <code class="docutils literal notranslate"><span class="pre">enabled_var='status.power_state'</span></code> and <code class="docutils literal notranslate"><span class="pre">enabled_value='powered_on'</span></code> with the following host variables, the host would be marked enabled:</p></li>
</ol>
<blockquote>
<div><div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="s">&quot;status&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="s">&quot;power_state&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;powered_on&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;created&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;2020-08-04T18:13:04+00:00&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;healthy&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span>
<span class="p p-Indicator">},</span>
<span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;foobar&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;ip_address&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;192.168.2.1&quot;</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">power_state</span></code> were any value other than <code class="docutils literal notranslate"><span class="pre">powered_on</span></code>, then the host would be disabled when imported into AWX. If the key is not found, then the host will be enabled.</p>
</div></blockquote>
<ol class="arabic simple" start="9">
<li><p>All cloud inventory sources have the following update options:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p><strong>Overwrite</strong>: If checked, any hosts and groups that were previously present on the external source but are now removed, will be removed from AWX inventory. Hosts and groups that were not managed by the inventory source will be promoted to the next manually created group, or if there is no manually created group to promote them into, they will be left in the “all” default group for the inventory.</p></li>
</ul>
<blockquote>
<div><p>When not checked, local child hosts and groups not found on the external source will remain untouched by the inventory update process.</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>Overwrite Variables</strong>: If checked, all variables for child groups and hosts will be removed and replaced by those found on the external source. When not checked, a merge will be performed, combining local variables with those found on the external source.</p></li>
<li><p><strong>Update on Launch</strong>: Each time a job runs using this inventory, refresh the inventory from the selected source before executing job tasks. To avoid job overflows if jobs are spawned faster than the inventory can sync, selecting this allows you to configure a <strong>Cache Timeout</strong> to cache prior inventory syncs for a certain number of seconds.</p></li>
</ul>
<blockquote>
<div><p>The “Update on Launch” setting refers to a dependency system for projects and inventory, and it will not specifically exclude two jobs from running at the same time. If a cache timeout is specified, then the dependencies for the second job is created and it uses the project and inventory update that the first job spawned. Both jobs then wait for that project and/or inventory update to finish before proceeding. If they are different job templates, they can then both start and run at the same time, if the system has the capacity to do so. If you intend to use AWX’s provisioning callback feature with a dynamic inventory source, <strong>Update on Launch</strong> should be set for the inventory group.</p>
<p>If you sync an inventory source that uses a project that has <strong>Update On Launch</strong> set, then the project may automatically update (according to cache timeout rules) before the inventory update starts.</p>
<p>You can create a job template that uses an inventory that sources from the same project that the template uses. In this case, the project will update and then the inventory will update (if updates are not already in-progress, or if the cache timeout has not already expired).</p>
</div></blockquote>
</div></blockquote>
<ol class="arabic simple" start="10">
<li><p>Review your entries and selections and click <strong>Save</strong> when done. This allows you to configure additional details, such as schedules and notifications.</p></li>
<li><p>To configure schedules associated with this inventory source, click the <strong>Schedules</strong> tab.</p></li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>If schedules are already set up; review, edit, or enable/disable your schedule preferences.</p></li>
<li><p>if schedules have not been set up, refer to <a class="reference internal" href="index.html#ug-scheduling"><span class="std std-ref">Schedules</span></a> for more information.</p></li>
</ol>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <strong>Notifications</strong> tab is only present after you save the newly-created source.</p>
<img alt="_images/inventories-create-source-with-notifications-tab.png" src="_images/inventories-create-source-with-notifications-tab.png" />
</div>
<ol class="arabic simple" start="12">
<li><p>To configure notifications for the source, click the <strong>Notifications</strong> tab.</p></li>
</ol>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>If notifications are already set up, use the toggles to enable or disable the notifications to use with your particular source. For more detail, see <a class="reference internal" href="index.html#ug-notifications-on-off"><span class="std std-ref">Enable and Disable Notifications</span></a>.</p></li>
<li><p>if notifications have not been set up, refer to <a class="reference internal" href="index.html#ug-notifications"><span class="std std-ref">Notifications</span></a> for more information.</p></li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="13">
<li><p>Review your entries and selections and click <strong>Save</strong> when done.</p></li>
</ol>
<p>Once a source is defined, it displays as an entry in the list of sources associated with the inventory. From the <strong>Sources</strong> tab you can perform a sync on a single source, or sync all of them at once. You can also perform additional actions such as scheduling a sync process, and edit or delete the source.</p>
<p><img alt="Inventories view sources" src="_images/inventories-view-sources.png" /></p>
<section id="inventory-sources">
<span id="ug-inventory-sources"></span><h6><span class="section-number">18.4.4.1. </span>Inventory Sources<a class="headerlink" href="#inventory-sources" title="Link to this heading"></a></h6>
<p>Choose a source which matches the inventory type against which a host can be entered:</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#sourced-from-a-project" id="id3">Sourced from a Project</a></p></li>
<li><p><a class="reference internal" href="#amazon-web-services-ec2" id="id4">Amazon Web Services EC2</a></p></li>
<li><p><a class="reference internal" href="#google-compute-engine" id="id5">Google Compute Engine</a></p></li>
<li><p><a class="reference internal" href="#microsoft-azure-resource-manager" id="id6">Microsoft Azure Resource Manager</a></p></li>
<li><p><a class="reference internal" href="#vmware-vcenter" id="id7">VMware vCenter</a></p></li>
<li><p><a class="reference internal" href="#red-hat-satellite-6" id="id8">Red Hat Satellite 6</a></p></li>
<li><p><a class="reference internal" href="#red-hat-insights" id="id9">Red Hat Insights</a></p></li>
<li><p><a class="reference internal" href="#openstack" id="id10">OpenStack</a></p></li>
<li><p><a class="reference internal" href="#red-hat-virtualization" id="id11">Red Hat Virtualization</a></p></li>
<li><p><a class="reference internal" href="#red-hat-ansible-automation-platform" id="id12">Red Hat Ansible Automation Platform</a></p></li>
<li><p><a class="reference internal" href="#terraform-state" id="id13">Terraform State</a></p></li>
<li><p><a class="reference internal" href="#openshift-virtualization" id="id14">OpenShift Virtualization</a></p></li>
</ul>
</nav>
<section id="sourced-from-a-project">
<h6 aria-level="7"><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">18.4.4.1.1. </span>Sourced from a Project</a><a class="headerlink" href="#sourced-from-a-project" title="Link to this heading"></a></h6>
<p id="index-6">An inventory that is sourced from a project means that is uses the SCM type from the project it is tied to. For example, if the project’s source is from GitHub, then the inventory will use the same source.</p>
<ol class="arabic simple">
<li><p>To configure a project-sourced inventory, select <strong>Sourced from a Project</strong> from the Source field.</p></li>
<li><p>The Create Source window expands with additional fields. Enter the following details:</p></li>
</ol>
<blockquote>
<div><ul>
<li><p><strong>Source Control Branch/Tag/Commit</strong>: Optionally enter the SCM branch, tags, commit hashes, arbitrary refs, or revision number (if applicable) from the source control (Git or Subversion) to checkout. Some commit hashes and refs may not be available unless you also provide a custom refspec in the next field. If left blank, the default is HEAD which is the last checked out Branch/Tag/Commit for this project.</p>
<p>This field only displays if the sourced project has the <strong>Allow Branch Override</strong> option checked:</p>
<img alt="_images/projects-create-scm-project-branch-override-checked.png" src="_images/projects-create-scm-project-branch-override-checked.png" />
</li>
<li><p><strong>Credential</strong>: Optionally specify the credential to use for this source.</p></li>
<li><p><strong>Project</strong>: Required. Pre-populates with a default project, otherwise, specify the project this inventory is using as its source. Click the <img alt="search" src="_images/search-button.png" /> button to choose from a list of projects. If the list is extensive, use the search to narrow the options.</p></li>
<li><p><strong>Inventory File</strong>: Required. Select an inventory file associated with the sourced project. If not already populated, you can type it into the text field within the drop down menu to filter the extraneous file types. In addition to a flat file inventory, you can point to a directory or an inventory script.</p>
<img alt="_images/inventories-create-source-sourced-from-project-filter.png" src="_images/inventories-create-source-sourced-from-project-filter.png" />
</li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>You can optionally specify the verbosity, host filter, enabled variable/value, and update options as described in the main procedure for <a class="reference internal" href="#ug-add-inv-common-fields"><span class="std std-ref">adding a source</span></a>.</p></li>
<li><p>In order to pass to the custom inventory script, you can optionally set environment variables in the <strong>Environment Variables</strong> field. You may also place inventory scripts in source control and then run it from a project. See <a class="reference internal" href="index.html#ag-inv-import"><span class="std std-ref">Inventory File Importing</span></a> in the <em>AWX Administration Guide</em> for detail.</p></li>
</ol>
<p><img alt="Inventories - create source - sourced from project example" src="_images/inventories-create-source-sourced-from-project-example.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are executing a custom inventory script from SCM, please make sure you set the execution bit (i.e. <code class="docutils literal notranslate"><span class="pre">chmod</span> <span class="pre">+x</span></code>) on the script in your upstream source control. If you do not, AWX will throw a <code class="docutils literal notranslate"><span class="pre">[Errno</span> <span class="pre">13]</span> <span class="pre">Permission</span> <span class="pre">denied</span></code> error upon execution.</p>
</div>
</section>
<section id="amazon-web-services-ec2">
<span id="ug-source-ec2"></span><h6 aria-level="7"><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">18.4.4.1.2. </span>Amazon Web Services EC2</a><a class="headerlink" href="#amazon-web-services-ec2" title="Link to this heading"></a></h6>
<ol class="arabic simple" id="index-7">
<li><p>To configure an AWS EC2-sourced inventory, select <strong>Amazon EC2</strong> from the Source field.</p></li>
<li><p>The Create Source window expands with additional fields. Enter the following details:</p></li>
</ol>
<blockquote>
<div><ul>
<li><p><strong>Credential</strong>: Optionally choose from an existing AWS credential (for more information, refer to <a class="reference internal" href="index.html#ug-credentials"><span class="std std-ref">Credentials</span></a>).</p>
<p>If AWX is running on an EC2 instance with an assigned IAM Role, the credential may be omitted, and the security credentials from the instance metadata will be used instead. For more information on using IAM Roles, refer to the <a class="reference external" href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html">IAM_Roles_for_Amazon_EC2_documentation_at_Amazon</a>.</p>
</li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>You can optionally specify the verbosity, host filter, enabled variable/value, and update options as described in the main procedure for <a class="reference internal" href="#ug-add-inv-common-fields"><span class="std std-ref">adding a source</span></a>.</p></li>
<li><p>Use the <strong>Source Variables</strong> field to override variables used by the <code class="docutils literal notranslate"><span class="pre">aws_ec2</span></code> inventory plugin. Enter variables using either JSON or YAML syntax. Use the radio button to toggle between the two. For a detailed description of these variables, view the <a class="reference external" href="https://cloud.redhat.com/ansible/automation-hub/repo/published/amazon/aws/content/inventory/aws_ec2">aws_ec2 inventory plugin documentation</a>.</p></li>
</ol>
<p><img alt="Inventories - create source - AWS EC2 example" src="_images/inventories-create-source-AWS-example.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you only use <code class="docutils literal notranslate"><span class="pre">include_filters</span></code>, the AWS plugin always returns all the hosts. To use this properly, the first condition on the <code class="docutils literal notranslate"><span class="pre">or</span></code> must be on <code class="docutils literal notranslate"><span class="pre">filters</span></code> and then build the rest of the <code class="docutils literal notranslate"><span class="pre">OR</span></code> conditions on a list of <code class="docutils literal notranslate"><span class="pre">include_filters</span></code>.</p>
</div>
</section>
<section id="google-compute-engine">
<span id="ug-source-gce"></span><h6 aria-level="7"><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">18.4.4.1.3. </span>Google Compute Engine</a><a class="headerlink" href="#google-compute-engine" title="Link to this heading"></a></h6>
<ol class="arabic simple" id="index-8">
<li><p>To configure a Google-sourced inventory, select <strong>Google Compute Engine</strong> from the Source field.</p></li>
<li><p>The Create Source window expands with the required <strong>Credential</strong> field. Choose from an existing GCE Credential. For more information, refer to <a class="reference internal" href="index.html#ug-credentials"><span class="std std-ref">Credentials</span></a>.</p></li>
</ol>
<p><img alt="Inventories - create source - GCE example" src="_images/inventories-create-source-GCE-example.png" /></p>
<ol class="arabic simple" start="3">
<li><p>You can optionally specify the verbosity, host filter, enabled variable/value, and update options as described in the main procedure for <a class="reference internal" href="#ug-add-inv-common-fields"><span class="std std-ref">adding a source</span></a>.</p></li>
<li><p>Use the <strong>Source Variables</strong> field to override variables used by the <code class="docutils literal notranslate"><span class="pre">gcp_compute</span></code> inventory plugin. Enter variables using either JSON or YAML syntax. Use the radio button to toggle between the two. For a detailed description of these variables, view the <a class="reference external" href="https://cloud.redhat.com/ansible/automation-hub/repo/published/google/cloud/content/inventory/gcp_compute">gcp_compute inventory plugin documentation</a>.</p></li>
</ol>
</section>
<section id="microsoft-azure-resource-manager">
<span id="ug-source-azure"></span><h6 aria-level="7"><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">18.4.4.1.4. </span>Microsoft Azure Resource Manager</a><a class="headerlink" href="#microsoft-azure-resource-manager" title="Link to this heading"></a></h6>
<ol class="arabic simple" id="index-9">
<li><p>To configure a Azure Resource Manager-sourced inventory, select <strong>Microsoft Azure Resource Manager</strong> from the Source field.</p></li>
<li><p>The Create Source window expands with the required <strong>Credential</strong> field. Choose from an existing Azure Credential. For more information, refer to <a class="reference internal" href="index.html#ug-credentials"><span class="std std-ref">Credentials</span></a>.</p></li>
<li><p>You can optionally specify the verbosity, host filter, enabled variable/value, and update options as described in the main procedure for <a class="reference internal" href="#ug-add-inv-common-fields"><span class="std std-ref">adding a source</span></a>.</p></li>
<li><p>Use the <strong>Source Variables</strong> field to override variables used by the  <code class="docutils literal notranslate"><span class="pre">azure_rm</span></code> inventory plugin. Enter variables using either JSON or YAML syntax. Use the radio button to toggle between the two. For a detailed description of these variables, view the <a class="reference external" href="https://cloud.redhat.com/ansible/automation-hub/repo/published/azure/azcollection/content/inventory/azure_rm">azure_rm inventory plugin documentation</a>.</p></li>
</ol>
<p><img alt="Inventories - create source - Azure RM example" src="_images/inventories-create-source-azurerm-example.png" /></p>
</section>
<section id="vmware-vcenter">
<span id="ug-source-vmvcenter"></span><h6 aria-level="7"><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">18.4.4.1.5. </span>VMware vCenter</a><a class="headerlink" href="#vmware-vcenter" title="Link to this heading"></a></h6>
<ol class="arabic simple" id="index-10">
<li><p>To configure a VMWare-sourced inventory, select <strong>VMware vCenter</strong> from the Source field.</p></li>
<li><p>The Create Source window expands with the required <strong>Credential</strong> field. Choose from an existing VMware Credential. For more information, refer to <a class="reference internal" href="index.html#ug-credentials"><span class="std std-ref">Credentials</span></a>.</p></li>
<li><p>You can optionally specify the verbosity, host filter, enabled variable/value, and update options as described in the main procedure for <a class="reference internal" href="#ug-add-inv-common-fields"><span class="std std-ref">adding a source</span></a>.</p></li>
<li><p>Use the <strong>Source Variables</strong> field to override variables used by the <code class="docutils literal notranslate"><span class="pre">vmware_inventory</span></code> inventory plugin. Enter variables using either JSON or YAML syntax. Use the radio button to toggle between the two. For a detailed description of these variables, view the <a class="reference external" href="https://github.com/ansible-collections/community.vmware/blob/main/plugins/inventory/vmware_vm_inventory.py">vmware_inventory inventory plugin</a>.</p></li>
</ol>
<blockquote>
<div><p>Starting with Ansible 2.9, VMWare properties have changed from lower case to camelCase. AWX provides aliases for the top-level keys, but lower case keys in nested properties have been discontinued.
For a list of valid and supported properties starting with Ansible 2.9, refer to <a class="reference external" href="https://docs.ansible.com/ansible/latest/collections/community/vmware/docsite/vmware_scenarios/vmware_inventory_vm_attributes.html">virtual machine attributes in the VMware dynamic inventory plugin</a>.</p>
</div></blockquote>
<p><img alt="Inventories - create source - VMWare example" src="_images/inventories-create-source-vmware-example.png" /></p>
</section>
<section id="red-hat-satellite-6">
<span id="ug-source-satellite"></span><h6 aria-level="7"><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">18.4.4.1.6. </span>Red Hat Satellite 6</a><a class="headerlink" href="#red-hat-satellite-6" title="Link to this heading"></a></h6>
<ol class="arabic simple" id="index-11">
<li><p>To configure a Red Hat Satellite-sourced inventory, select <strong>Red Hat Satellite</strong> from the Source field.</p></li>
<li><p>The Create Source window expands with the required <strong>Credential</strong> field. Choose from an existing Satellite Credential. For more information, refer to <a class="reference internal" href="index.html#ug-credentials"><span class="std std-ref">Credentials</span></a>.</p></li>
<li><p>You can optionally specify the verbosity, host filter, enabled variable/value, and update options as described in the main procedure for <a class="reference internal" href="#ug-add-inv-common-fields"><span class="std std-ref">adding a source</span></a>.</p></li>
<li><p>Use the <strong>Source Variables</strong> field to specify parameters used by the foreman inventory source. Enter variables using either JSON or YAML syntax. Use the radio button to toggle between the two. For a detailed description of these variables, refer to the <a class="reference external" href="https://docs.ansible.com/ansible/latest/collections/theforeman/foreman/foreman_inventory.html">theforeman.foreman.foreman – Foreman inventory source</a> in the Ansible documentation.</p></li>
</ol>
<p><img alt="Inventories - create source - RH Satellite example" src="_images/inventories-create-source-rhsat6-example.png" /></p>
<p>If you encounter an issue with AWX inventory not having the “related groups” from Satellite, you might need to define these variables in the inventory source. See the inventory plugins template example for <a class="reference internal" href="index.html#ir-plugin-satellite"><span class="std std-ref">Red Hat Satellite 6</span></a> in the <em>AWX Installation and Reference Guide</em> for detail.</p>
</section>
<section id="red-hat-insights">
<span id="ug-source-insights"></span><h6 aria-level="7"><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">18.4.4.1.7. </span>Red Hat Insights</a><a class="headerlink" href="#red-hat-insights" title="Link to this heading"></a></h6>
<ol class="arabic simple" id="index-12">
<li><p>To configure a Red Hat Insights-sourced inventory, select <strong>Red Hat Insights</strong> from the Source field.</p></li>
<li><p>The Create Source window expands with the required <strong>Credential</strong> field. Choose from an existing Insights Credential. For more information, refer to <a class="reference internal" href="index.html#ug-credentials"><span class="std std-ref">Credentials</span></a>.</p></li>
<li><p>You can optionally specify the verbosity, host filter, enabled variable/value, and update options as described in the main procedure for <a class="reference internal" href="#ug-add-inv-common-fields"><span class="std std-ref">adding a source</span></a>.</p></li>
<li><p>Use the <strong>Source Variables</strong> field to override variables used by the <code class="docutils literal notranslate"><span class="pre">insights</span></code> inventory plugin. Enter variables using either JSON or YAML syntax. Use the radio button to toggle between the two. For a detailed description of these variables, view the <a class="reference external" href="https://cloud.redhat.com/ansible/automation-hub/repo/published/redhat/insights/content/inventory/insights">insights inventory plugin</a>.</p></li>
</ol>
<p><img alt="Inventories - create source - RH Insights example" src="_images/inventories-create-source-insights-example.png" /></p>
</section>
<section id="openstack">
<span id="ug-source-openstack"></span><h6 aria-level="7"><a class="toc-backref" href="#id10" role="doc-backlink"><span class="section-number">18.4.4.1.8. </span>OpenStack</a><a class="headerlink" href="#openstack" title="Link to this heading"></a></h6>
<ol class="arabic simple" id="index-13">
<li><p>To configure an OpenStack-sourced inventory, select <strong>OpenStack</strong> from the Source field.</p></li>
<li><p>The Create Source window expands with the required <strong>Credential</strong> field. Choose from an existing OpenStack Credential. For more information, refer to <a class="reference internal" href="index.html#ug-credentials"><span class="std std-ref">Credentials</span></a>.</p></li>
<li><p>You can optionally specify the verbosity, host filter, enabled variable/value, and update options as described in the main procedure for <a class="reference internal" href="#ug-add-inv-common-fields"><span class="std std-ref">adding a source</span></a>.</p></li>
<li><p>Use the <strong>Source Variables</strong> field to override variables used by the <code class="docutils literal notranslate"><span class="pre">openstack</span></code> inventory plugin. Enter variables using either JSON or YAML syntax. Use the radio button to toggle between the two. For a detailed description of these variables, view the <a class="reference external" href="https://docs.ansible.com/ansible/latest/collections/openstack/cloud/openstack_inventory.html">openstack inventory plugin</a> in the Ansible collections documentation.</p></li>
</ol>
<p><img alt="Inventories - create source - OpenStack example" src="_images/inventories-create-source-openstack-example.png" /></p>
</section>
<section id="red-hat-virtualization">
<span id="ug-source-rhv"></span><h6 aria-level="7"><a class="toc-backref" href="#id11" role="doc-backlink"><span class="section-number">18.4.4.1.9. </span>Red Hat Virtualization</a><a class="headerlink" href="#red-hat-virtualization" title="Link to this heading"></a></h6>
<ol class="arabic simple" id="index-14">
<li><p>To configure a Red Hat Virtualization-sourced inventory, select <strong>Red Hat Virtualization</strong> from the Source field.</p></li>
<li><p>The Create Source window expands with the required <strong>Credential</strong> field. Choose from an existing Red Hat Virtualization Credential. For more information, refer to <a class="reference internal" href="index.html#ug-credentials"><span class="std std-ref">Credentials</span></a>.</p></li>
<li><p>You can optionally specify the verbosity, host filter, enabled variable/value, and update options as described in the main procedure for <a class="reference internal" href="#ug-add-inv-common-fields"><span class="std std-ref">adding a source</span></a>.</p></li>
<li><p>Use the <strong>Source Variables</strong> field to override variables used by the <code class="docutils literal notranslate"><span class="pre">ovirt</span></code> inventory plugin. Enter variables using either JSON or YAML syntax. Use the radio button to toggle between the two. For a detailed description of these variables, view the <a class="reference external" href="https://cloud.redhat.com/ansible/automation-hub/repo/published/redhat/rhv/content/inventory/ovirt">ovirt inventory plugin</a>.</p></li>
</ol>
<p><img alt="Inventories - create source - RHV example" src="_images/inventories-create-source-rhv-example.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Red Hat Virtualization (ovirt) inventory source requests are secure by default. To change this default setting, set the key <code class="docutils literal notranslate"><span class="pre">ovirt_insecure</span></code> to <strong>true</strong> in <code class="docutils literal notranslate"><span class="pre">source_variables</span></code>, which is only available from the API details of the inventory source at the <code class="docutils literal notranslate"><span class="pre">/api/v2/inventory_sources/N/</span></code> endpoint.</p>
</div>
</section>
<section id="red-hat-ansible-automation-platform">
<span id="ug-source-rhaap"></span><h6 aria-level="7"><a class="toc-backref" href="#id12" role="doc-backlink"><span class="section-number">18.4.4.1.10. </span>Red Hat Ansible Automation Platform</a><a class="headerlink" href="#red-hat-ansible-automation-platform" title="Link to this heading"></a></h6>
<ol class="arabic simple" id="index-15">
<li><p>To configure this type of sourced inventory, select <strong>Red Hat Ansible Automation Platform</strong> from the Source field.</p></li>
<li><p>The Create Source window expands with the required <strong>Credential</strong> field. Choose from an existing Ansible Automation Platform Credential. For more information, refer to <a class="reference internal" href="index.html#ug-credentials"><span class="std std-ref">Credentials</span></a>.</p></li>
<li><p>You can optionally specify the verbosity, host filter, enabled variable/value, and update options as described in the main procedure for <a class="reference internal" href="#ug-add-inv-common-fields"><span class="std std-ref">adding a source</span></a>.</p></li>
</ol>
<blockquote>
<div><img alt="_images/inventories-create-source-rhaap-example.png" src="_images/inventories-create-source-rhaap-example.png" />
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Use the <strong>Source Variables</strong> field to override variables used by the <code class="docutils literal notranslate"><span class="pre">controller</span></code> inventory plugin. Enter variables using either JSON or YAML syntax. Use the radio button to toggle between the two.</p></li>
</ol>
</section>
<section id="terraform-state">
<span id="ug-source-terraform"></span><h6 aria-level="7"><a class="toc-backref" href="#id13" role="doc-backlink"><span class="section-number">18.4.4.1.11. </span>Terraform State</a><a class="headerlink" href="#terraform-state" title="Link to this heading"></a></h6>
<p id="index-16">This inventory source uses the <a class="reference external" href="https://github.com/ansible-collections/cloud.terraform/blob/main/docs/cloud.terraform.terraform_state_inventory.rst">terraform_state</a> inventory plugin from the <a class="reference external" href="https://github.com/ansible-collections/cloud.terraform">cloud.terraform</a> collection. The plugin will parse a terraform state file and add hosts for AWS EC2, GCE, and Azure instances.</p>
<ol class="arabic simple">
<li><p>To configure this type of sourced inventory, select <strong>Terraform State</strong> from the Source field.</p></li>
<li><p>The Create new source window expands with the required <strong>Credential</strong> field. Choose from an existing Terraform backend credential. For more information, refer to <a class="reference internal" href="index.html#ug-credentials-terraform"><span class="std std-ref">Terraform backend configuration</span></a>.</p></li>
<li><p>You can optionally specify the verbosity, host filter, enabled variable/value, and update options as described in the main procedure for <a class="reference internal" href="#ug-add-inv-common-fields"><span class="std std-ref">adding a source</span></a>. For Terraform, enable <strong>Overwrite</strong> and <strong>Update on launch</strong> options.</p></li>
<li><p>Use the <strong>Source Variables</strong> field to override variables used by the <code class="docutils literal notranslate"><span class="pre">terraform</span></code> inventory plugin. Enter variables using either JSON or YAML syntax. Use the radio button to toggle between the two. For more information on these variables, see the <a class="reference external" href="https://github.com/ansible-collections/cloud.terraform/blob/main/docs/cloud.terraform.terraform_state_inventory.rst">terraform_state</a> file for detail.</p></li>
</ol>
<blockquote>
<div><p>The <code class="docutils literal notranslate"><span class="pre">backend_type</span></code> variable is required by the Terraform state inventory plugin. This should match the remote backend configured in the Terraform backend credential, here is an example for an Amazon S3 backend:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">backend_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Enter an execution environment in the <strong>Execution Environment</strong> field that contains a Terraform binary. This is required for the inventory plugin to run the Terraform commands that read inventory data from the Terraform state file. Refer to the <a class="reference external" href="https://github.com/ansible-cloud/terraform_ee">Terraform EE readme</a> that contains an example execution environment configuration with a Terraform binary.</p></li>
</ol>
<blockquote>
<div><img alt="_images/inventories-create-source-terraform-example.png" src="_images/inventories-create-source-terraform-example.png" />
</div></blockquote>
<ol class="arabic simple" start="6">
<li><p>To add hosts for AWS EC2, GCE, and Azure instances, the Terraform state file in the backend must contain state for resources already deployed to EC2, GCE, or Azure. Refer to each of the Terraform providers’ respective documentation to provision instances.</p></li>
</ol>
</section>
<section id="openshift-virtualization">
<span id="ug-source-ocpv"></span><h6 aria-level="7"><a class="toc-backref" href="#id14" role="doc-backlink"><span class="section-number">18.4.4.1.12. </span>OpenShift Virtualization</a><a class="headerlink" href="#openshift-virtualization" title="Link to this heading"></a></h6>
<p id="index-17">This inventory source uses a cluster that is able to deploy OpenShift (OCP) virtualization. In order to configure an OCP virtualization requires a virtual machine deployed in a specific namespace and an OpenShift or Kubernetes API Bearer Token credential.</p>
<ol class="arabic simple">
<li><p>To configure this type of sourced inventory, select <strong>OpenShift Virtualization</strong> from the Source field.</p></li>
<li><p>The Create new source window expands with the required <strong>Credential</strong> field. Choose from an existing Kubernetes API Bearer Token credential. For more information, refer to <a class="reference internal" href="index.html#ug-credentials-ocp-k8s"><span class="std std-ref">OpenShift or Kubernetes API Bearer Token</span></a>. In this example, the <code class="docutils literal notranslate"><span class="pre">cmv2.engineering.redhat.com</span></code> credential is used.</p></li>
<li><p>You can optionally specify the verbosity, host filter, enabled variable/value, and update options as described in the main procedure for <a class="reference internal" href="#ug-add-inv-common-fields"><span class="std std-ref">adding a source</span></a>.</p></li>
<li><p>Use the <strong>Source Variables</strong> field to override variables used by the <code class="docutils literal notranslate"><span class="pre">kubernetes</span></code> inventory plugin. Enter variables using either JSON or YAML syntax. Use the radio button to toggle between the two. For more information on these variables, see the <a class="reference external" href="https://kubevirt.io/kubevirt.core/main/plugins/kubevirt.html#parameters">kubevirt.core.kubevirt inventory source</a> documentation for detail.</p></li>
</ol>
<blockquote>
<div><p>In the example below, the <code class="docutils literal notranslate"><span class="pre">connections</span></code> variable is used to specify access to a particular namespace in a cluster.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">connections</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">namespaces</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hao-test</span>
</pre></div>
</div>
<img alt="_images/inventories-create-source-ocpvirt-example.png" src="_images/inventories-create-source-ocpvirt-example.png" />
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Save the configuration and click the <strong>Sync</strong> button to sync the inventory.</p></li>
</ol>
</section>
</section>
<section id="export-old-inventory-scripts">
<span id="ug-customscripts"></span><h6><span class="section-number">18.4.4.2. </span>Export old inventory scripts<a class="headerlink" href="#export-old-inventory-scripts" title="Link to this heading"></a></h6>
<p id="index-18">Despite the removal of the custom inventory scripts API, the scripts are still saved in the database. The commands described in this section allows you to recover the scripts in a format that is suitable for you to subsequently check into source control. Usage looks like this:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ awx-manage export_custom_scripts --filename=my_scripts.tar</span>
<span class="l l-Scalar l-Scalar-Plain">Dump of old custom inventory scripts at my_scripts.tar</span>
</pre></div>
</div>
<p>Making use of the output:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ mkdir my_scripts</span>
<span class="l l-Scalar l-Scalar-Plain">$ tar -xf my_scripts.tar -C my_scripts</span>
</pre></div>
</div>
<p>The naming of the scripts is <code class="docutils literal notranslate"><span class="pre">_&lt;pk&gt;__&lt;name&gt;</span></code>. This is the naming scheme used for project folders.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ ls my_scripts</span>
<span class="l l-Scalar l-Scalar-Plain">_10__inventory_script_rawhook             _19__                                       _30__inventory_script_listenhospital</span>
<span class="l l-Scalar l-Scalar-Plain">_11__inventory_script_upperorder          _1__inventory_script_commercialinternet45   _4__inventory_script_whitestring</span>
<span class="l l-Scalar l-Scalar-Plain">_12__inventory_script_eastplant           _22__inventory_script_pinexchange           _5__inventory_script_literaturepossession</span>
<span class="l l-Scalar l-Scalar-Plain">_13__inventory_script_governmentculture   _23__inventory_script_brainluck             _6__inventory_script_opportunitytelephone</span>
<span class="l l-Scalar l-Scalar-Plain">_14__inventory_script_bottomguess         _25__inventory_script_buyerleague           _7__inventory_script_letjury</span>
<span class="l l-Scalar l-Scalar-Plain">_15__inventory_script_wallisland          _26__inventory_script_lifesport             _8__random_inventory_script_</span>
<span class="l l-Scalar l-Scalar-Plain">_16__inventory_script_wallisland          _27__inventory_script_exchangesomewhere     _9__random_inventory_script_</span>
<span class="l l-Scalar l-Scalar-Plain">_17__inventory_script_bidstory            _28__inventory_script_boxchild</span>
<span class="l l-Scalar l-Scalar-Plain">_18__p                                    _29__inventory_script_wearstress</span>
</pre></div>
</div>
<p>Each file contains a script. Scripts can be <code class="docutils literal notranslate"><span class="pre">bash/python/ruby/more</span></code>, so the extension is not included. They are all directly executable (assuming the scripts worked). If you execute the script, it dumps the inventory data.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./my_scripts/_11__inventory_script_upperorder
<span class="o">{</span><span class="s2">&quot;group_\ud801\udcb0\uc20e\u7b0e\ud81c\udfeb\ub12b\ub4d0\u9ac6\ud81e\udf07\u6ff9\uc17b&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;hosts&quot;</span>:
<span class="o">[</span><span class="s2">&quot;host_\ud821\udcad\u68b6\u7a51\u93b4\u69cf\uc3c2\ud81f\uddbe\ud820\udc92\u3143\u62c7&quot;</span>,
<span class="s2">&quot;host_\u6057\u3985\u1f60\ufefb\u1b22\ubd2d\ua90c\ud81a\udc69\u1344\u9d15&quot;</span>,
<span class="s2">&quot;host_\u78a0\ud820\udef3\u925e\u69da\ua549\ud80c\ude7e\ud81e\udc91\ud808\uddd1\u57d6\ud801\ude57&quot;</span>,
<span class="s2">&quot;host_\ud83a\udc2d\ud7f7\ua18a\u779a\ud800\udf8b\u7903\ud820\udead\u4154\ud808\ude15\u9711&quot;</span>,
<span class="s2">&quot;host_\u18a1\u9d6f\u08ac\u74c2\u54e2\u740e\u5f02\ud81d\uddee\ufbd6\u4506&quot;</span><span class="o">]</span>,<span class="w"> </span><span class="s2">&quot;vars&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;ansible_host&quot;</span>:<span class="w"> </span><span class="s2">&quot;127.0.0.1&quot;</span>,<span class="w"> </span><span class="s2">&quot;ansible_connection&quot;</span>:
<span class="s2">&quot;local&quot;</span><span class="o">}}}</span>
</pre></div>
</div>
<p>You can verify functionality with <code class="docutils literal notranslate"><span class="pre">ansible-inventory</span></code>. This should give the same data, but reformatted.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ansible-inventory<span class="w"> </span>-i<span class="w"> </span>./my_scripts/_11__inventory_script_upperorder<span class="w"> </span>--list<span class="w"> </span>--export
</pre></div>
</div>
<p>In the above example, you could <code class="docutils literal notranslate"><span class="pre">cd</span></code> into <code class="docutils literal notranslate"><span class="pre">my_scripts</span></code> and then issue a <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">init</span></code> command, add the scripts you want, push it to source control, and then create an SCM inventory source in the AWX user interface.</p>
<p>For more information on syncing or using custom inventory scripts, refer to <a class="reference internal" href="index.html#ag-inv-import"><span class="std std-ref">Inventory File Importing</span></a> in the <em>AWX Administration Guide</em>.</p>
</section>
</section>
<section id="view-completed-jobs">
<span id="ug-inventories-view-completed-jobs"></span><h5><span class="section-number">18.4.5. </span>View completed jobs<a class="headerlink" href="#view-completed-jobs" title="Link to this heading"></a></h5>
<p>If an inventory was used to run a job, you can view details about those jobs in the <strong>Completed Jobs</strong> tab of the inventory and click <strong>Expanded</strong> to view details about each job.</p>
<p><img alt="Inventories view completed jobs" src="_images/inventories-view-completed-jobs.png" /></p>
</section>
</section>
<section id="running-ad-hoc-commands">
<span id="ug-inventories-run-ad-hoc"></span><h4><span class="section-number">18.5. </span>Running Ad Hoc Commands<a class="headerlink" href="#running-ad-hoc-commands" title="Link to this heading"></a></h4>
<p id="index-19">To run an ad hoc command:</p>
<ol class="arabic simple">
<li><p>Select an inventory source from the list of hosts or groups. The inventory source can be a single group or host, a selection of multiple hosts, or a selection of multiple groups.</p></li>
</ol>
<p><img alt="ad hoc-commands-inventory-home" src="_images/inventories-add-group-host-added.png" /></p>
<ol class="arabic simple" start="2">
<li><p>Click the <strong>Run Command</strong> button.</p></li>
</ol>
<p>The Run command window opens.</p>
<img alt="_images/ad-hoc-run-execute-command.png" src="_images/ad-hoc-run-execute-command.png" />
<ol class="arabic simple" start="3">
<li><p>Enter the details for the following fields:</p></li>
</ol>
<ul>
<li><p><strong>Module</strong>: Select one of the modules that AWX supports running commands against.</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>command</p></td>
<td><p>apt_repository</p></td>
<td><p>mount</p></td>
<td><p>win_service</p></td>
</tr>
<tr class="row-even"><td><p>shell</p></td>
<td><p>apt_rpm</p></td>
<td><p>ping</p></td>
<td><p>win_updates</p></td>
</tr>
<tr class="row-odd"><td><p>yum</p></td>
<td><p>service</p></td>
<td><p>selinux</p></td>
<td><p>win_group</p></td>
</tr>
<tr class="row-even"><td><p>apt</p></td>
<td><p>group</p></td>
<td><p>setup</p></td>
<td rowspan="2"><p>win_user</p></td>
</tr>
<tr class="row-odd"><td><p>apt_key</p></td>
<td><p>user</p></td>
<td><p>win_ping</p></td>
</tr>
</tbody>
</table>
</li>
<li><p><strong>Arguments</strong>: Provide arguments to be used with the module you selected.</p></li>
<li><p><strong>Limit</strong>: Enter the limit used to target hosts in the inventory. To target all hosts in the inventory enter <code class="docutils literal notranslate"><span class="pre">all</span></code> or <code class="docutils literal notranslate"><span class="pre">*</span></code>, or leave the field blank. This is automatically populated with whatever was selected in the previous view prior to clicking the launch button.</p></li>
<li><p><strong>Machine Credential</strong>: Select the credential to use when accessing the remote hosts to run the command. Choose the credential containing the username and SSH key or password that Ansbile needs to log into the remote hosts.</p></li>
<li><p><strong>Verbosity</strong>: Select a verbosity level for the standard output.</p></li>
<li><p><strong>Forks</strong>: If needed, select the number of parallel or simultaneous processes to use while executing the command.</p></li>
<li><p><strong>Show Changes</strong>: Select to enable the display of Ansible changes in the standard output. The default is OFF.</p></li>
<li><p><strong>Enable Privilege Escalation</strong>: If enabled, the playbook is run with administrator privileges. This is the equivalent of passing the <code class="docutils literal notranslate"><span class="pre">--become</span></code> option to the <code class="docutils literal notranslate"><span class="pre">ansible</span></code> command.</p></li>
<li><p><strong>Extra Variables</strong>: Provide extra command line variables to be applied when running this inventory. Enter variables using either JSON or YAML syntax. Use the radio button to toggle between the two.</p></li>
</ul>
<p><img alt="ad hoc-commands-inventory-run-command" src="_images/ad-hoc-commands-inventory-run-command.png" /></p>
<ol class="arabic simple" start="4">
<li><p>Click <strong>Next</strong> to choose the execution environment you want the ad-hoc command to be run against.</p></li>
</ol>
<img alt="_images/ad-hoc-commands-inventory-run-command-ee.png" src="_images/ad-hoc-commands-inventory-run-command-ee.png" />
<ol class="arabic simple" start="5">
<li><p>Click <strong>Next</strong> to choose the credential you want to use and click the <strong>Launch</strong> button.</p></li>
</ol>
<p>The results display in the <strong>Output</strong> tab of the module’s job window.</p>
<p><img alt="ad hoc-commands-inventory-results-example" src="_images/ad-hoc-commands-inventory-results-example.png" /></p>
</section>
</section>
<span id="document-userguide/inventory_plugins_templates"></span><section id="supported-inventory-plugin-templates">
<span id="ir-inv-plugin-templates-reference"></span><h3><span class="section-number">19. </span>Supported Inventory Plugin Templates<a class="headerlink" href="#supported-inventory-plugin-templates" title="Link to this heading"></a></h3>
<p id="index-0">Upon upgrades, existing configurations will be migrated to the new format that will produce a backwards compatible inventory output. Use the templates below to help aid in migrating your inventories to the new style inventory plugin output.</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#amazon-web-services-ec2" id="id1">Amazon Web Services EC2</a></p></li>
<li><p><a class="reference internal" href="#google-compute-engine" id="id2">Google Compute Engine</a></p></li>
<li><p><a class="reference internal" href="#microsoft-azure-resource-manager" id="id3">Microsoft Azure Resource Manager</a></p></li>
<li><p><a class="reference internal" href="#vmware-vcenter" id="id4">VMware vCenter</a></p></li>
<li><p><a class="reference internal" href="#red-hat-satellite-6" id="id5">Red Hat Satellite 6</a></p></li>
<li><p><a class="reference internal" href="#openstack" id="id6">OpenStack</a></p></li>
<li><p><a class="reference internal" href="#red-hat-virtualization" id="id7">Red Hat Virtualization</a></p></li>
<li><p><a class="reference internal" href="#red-hat-ansible-automation-platform" id="id8">Red Hat Ansible Automation Platform</a></p></li>
</ul>
</nav>
<section id="amazon-web-services-ec2">
<h4><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">19.1. </span>Amazon Web Services EC2</a><a class="headerlink" href="#amazon-web-services-ec2" title="Link to this heading"></a></h4>
<div class="highlight-YAML+Jinja notranslate" id="index-1"><div class="highlight"><pre><span></span><span class="nt">compose</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">public_ip_address</span>
<span class="w">  </span><span class="nt">ec2_account_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">owner_id</span>
<span class="w">  </span><span class="nt">ec2_ami_launch_index</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ami_launch_index | string</span>
<span class="w">  </span><span class="nt">ec2_architecture</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">architecture</span>
<span class="w">  </span><span class="nt">ec2_block_devices</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dict(block_device_mappings | map(attribute=&#39;device_name&#39;) | list | zip(block_device_mappings | map(attribute=&#39;ebs.volume_id&#39;) | list))</span>
<span class="w">  </span><span class="nt">ec2_client_token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">client_token</span>
<span class="w">  </span><span class="nt">ec2_dns_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">public_dns_name</span>
<span class="w">  </span><span class="nt">ec2_ebs_optimized</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ebs_optimized</span>
<span class="w">  </span><span class="nt">ec2_eventsSet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">events | default(&quot;&quot;)</span>
<span class="w">  </span><span class="nt">ec2_group_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">placement.group_name</span>
<span class="w">  </span><span class="nt">ec2_hypervisor</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hypervisor</span>
<span class="w">  </span><span class="nt">ec2_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance_id</span>
<span class="w">  </span><span class="nt">ec2_image_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image_id</span>
<span class="w">  </span><span class="nt">ec2_instance_profile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iam_instance_profile | default(&quot;&quot;)</span>
<span class="w">  </span><span class="nt">ec2_instance_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance_type</span>
<span class="w">  </span><span class="nt">ec2_ip_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">public_ip_address</span>
<span class="w">  </span><span class="nt">ec2_kernel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kernel_id | default(&quot;&quot;)</span>
<span class="w">  </span><span class="nt">ec2_key_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">key_name</span>
<span class="w">  </span><span class="nt">ec2_launch_time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">launch_time | regex_replace(&quot; &quot;, &quot;T&quot;) | regex_replace(&quot;(\+)(\d\d):(\d)(\d)$&quot;, &quot;.\g&lt;2&gt;\g&lt;3&gt;Z&quot;)</span>
<span class="w">  </span><span class="nt">ec2_monitored</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">monitoring.state in [&#39;enabled&#39;, &#39;pending&#39;]</span>
<span class="w">  </span><span class="nt">ec2_monitoring_state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">monitoring.state</span>
<span class="w">  </span><span class="nt">ec2_persistent</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">persistent | default(false)</span>
<span class="w">  </span><span class="nt">ec2_placement</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">placement.availability_zone</span>
<span class="w">  </span><span class="nt">ec2_platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">platform | default(&quot;&quot;)</span>
<span class="w">  </span><span class="nt">ec2_private_dns_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">private_dns_name</span>
<span class="w">  </span><span class="nt">ec2_private_ip_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">private_ip_address</span>
<span class="w">  </span><span class="nt">ec2_public_dns_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">public_dns_name</span>
<span class="w">  </span><span class="nt">ec2_ramdisk</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ramdisk_id | default(&quot;&quot;)</span>
<span class="w">  </span><span class="nt">ec2_reason</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">state_transition_reason</span>
<span class="w">  </span><span class="nt">ec2_region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">placement.region</span>
<span class="w">  </span><span class="nt">ec2_requester_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">requester_id | default(&quot;&quot;)</span>
<span class="w">  </span><span class="nt">ec2_root_device_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">root_device_name</span>
<span class="w">  </span><span class="nt">ec2_root_device_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">root_device_type</span>
<span class="w">  </span><span class="nt">ec2_security_group_ids</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security_groups | map(attribute=&#39;group_id&#39;) | list |  join(&#39;,&#39;)</span>
<span class="w">  </span><span class="nt">ec2_security_group_names</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security_groups | map(attribute=&#39;group_name&#39;) | list |  join(&#39;,&#39;)</span>
<span class="w">  </span><span class="nt">ec2_sourceDestCheck</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">source_dest_check | default(false) | lower | string</span>
<span class="w">  </span><span class="nt">ec2_spot_instance_request_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">spot_instance_request_id | default(&quot;&quot;)</span>
<span class="w">  </span><span class="nt">ec2_state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">state.name</span>
<span class="w">  </span><span class="nt">ec2_state_code</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">state.code</span>
<span class="w">  </span><span class="nt">ec2_state_reason</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">state_reason.message if state_reason is defined else &quot;&quot;</span>
<span class="w">  </span><span class="nt">ec2_subnet_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">subnet_id | default(&quot;&quot;)</span>
<span class="w">  </span><span class="nt">ec2_tag_Name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tags.Name</span>
<span class="w">  </span><span class="nt">ec2_virtualization_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">virtualization_type</span>
<span class="w">  </span><span class="nt">ec2_vpc_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc_id | default(&quot;&quot;)</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="w">  </span><span class="nt">instance-state-name</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">running</span>
<span class="nt">groups</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ec2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">hostnames</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network-interface.addresses.association.public-ip</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dns-name</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">private-dns-name</span>
<span class="nt">keyed_groups</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image_id | regex_replace(&quot;[^A-Za-z0-9\_]&quot;, &quot;_&quot;)</span>
<span class="w">    </span><span class="nt">parent_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">images</span>
<span class="w">    </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">    </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">placement.availability_zone</span>
<span class="w">    </span><span class="nt">parent_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zones</span>
<span class="w">    </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">    </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2_account_id | regex_replace(&quot;[^A-Za-z0-9\_]&quot;, &quot;_&quot;)</span>
<span class="w">    </span><span class="nt">parent_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">accounts</span>
<span class="w">    </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">    </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ec2_state | regex_replace(&quot;[^A-Za-z0-9\_]&quot;, &quot;_&quot;)</span>
<span class="w">    </span><span class="nt">parent_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance_states</span>
<span class="w">    </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance_state</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">platform | default(&quot;undefined&quot;) | regex_replace(&quot;[^A-Za-z0-9\_]&quot;, &quot;_&quot;)</span>
<span class="w">    </span><span class="nt">parent_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">platforms</span>
<span class="w">    </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">platform</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">instance_type | regex_replace(&quot;[^A-Za-z0-9\_]&quot;, &quot;_&quot;)</span>
<span class="w">    </span><span class="nt">parent_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">types</span>
<span class="w">    </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">key_name | regex_replace(&quot;[^A-Za-z0-9\_]&quot;, &quot;_&quot;)</span>
<span class="w">    </span><span class="nt">parent_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">keys</span>
<span class="w">    </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">key</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">placement.region</span>
<span class="w">    </span><span class="nt">parent_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">regions</span>
<span class="w">    </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">    </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security_groups | map(attribute=&quot;group_name&quot;) | map(&quot;regex_replace&quot;, &quot;[^A-Za-z0-9\_]&quot;, &quot;_&quot;) | list</span>
<span class="w">    </span><span class="nt">parent_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security_groups</span>
<span class="w">    </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security_group</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dict(tags.keys() | map(&quot;regex_replace&quot;, &quot;[^A-Za-z0-9\_]&quot;, &quot;_&quot;) | list | zip(tags.values()</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">| map(&quot;regex_replace&quot;, &quot;[^A-Za-z0-9\_]&quot;, &quot;_&quot;) | list))</span>
<span class="w">    </span><span class="nt">parent_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tags</span>
<span class="w">    </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tags.keys() | map(&quot;regex_replace&quot;, &quot;[^A-Za-z0-9\_]&quot;, &quot;_&quot;) | list</span>
<span class="w">    </span><span class="nt">parent_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tags</span>
<span class="w">    </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc_id | regex_replace(&quot;[^A-Za-z0-9\_]&quot;, &quot;_&quot;)</span>
<span class="w">    </span><span class="nt">parent_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpcs</span>
<span class="w">    </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc_id</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">placement.availability_zone</span>
<span class="w">    </span><span class="nt">parent_group</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;</span><span class="cp">{{</span> <span class="nv">placement.region</span> <span class="cp">}}</span><span class="s">&#39;</span>
<span class="w">    </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">    </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">amazon.aws.aws_ec2</span>
<span class="nt">use_contrib_script_compatible_sanitization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</section>
<section id="google-compute-engine">
<h4><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">19.2. </span>Google Compute Engine</a><a class="headerlink" href="#google-compute-engine" title="Link to this heading"></a></h4>
<div class="highlight-YAML+Jinja notranslate" id="index-2"><div class="highlight"><pre><span></span><span class="nt">auth_kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">serviceaccount</span>
<span class="nt">compose</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ansible_ssh_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networkInterfaces[0].accessConfigs[0].natIP | default(networkInterfaces[0].networkIP)</span>
<span class="w">  </span><span class="nt">gce_description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">description if description else None</span>
<span class="w">  </span><span class="nt">gce_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">id</span>
<span class="w">  </span><span class="nt">gce_image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image</span>
<span class="w">  </span><span class="nt">gce_machine_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">machineType</span>
<span class="w">  </span><span class="nt">gce_metadata</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metadata.get(&quot;items&quot;, []) | items2dict(key_name=&quot;key&quot;, value_name=&quot;value&quot;)</span>
<span class="w">  </span><span class="nt">gce_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name</span>
<span class="w">  </span><span class="nt">gce_network</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networkInterfaces[0].network.name</span>
<span class="w">  </span><span class="nt">gce_private_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networkInterfaces[0].networkIP</span>
<span class="w">  </span><span class="nt">gce_public_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networkInterfaces[0].accessConfigs[0].natIP | default(None)</span>
<span class="w">  </span><span class="nt">gce_status</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status</span>
<span class="w">  </span><span class="nt">gce_subnetwork</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networkInterfaces[0].subnetwork.name</span>
<span class="w">  </span><span class="nt">gce_tags</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tags.get(&quot;items&quot;, [])</span>
<span class="w">  </span><span class="nt">gce_zone</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zone</span>
<span class="nt">hostnames</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">public_ip</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">private_ip</span>
<span class="nt">keyed_groups</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gce_subnetwork</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gce_private_ip</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gce_public_ip</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">machineType</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zone</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gce_tags</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status | lower</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">google.cloud.gcp_compute</span>
<span class="nt">retrieve_image_info</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">use_contrib_script_compatible_sanitization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</section>
<section id="microsoft-azure-resource-manager">
<h4><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">19.3. </span>Microsoft Azure Resource Manager</a><a class="headerlink" href="#microsoft-azure-resource-manager" title="Link to this heading"></a></h4>
<div class="highlight-YAML+Jinja notranslate" id="index-3"><div class="highlight"><pre><span></span><span class="nt">conditional_groups</span><span class="p">:</span>
<span class="w">  </span><span class="nt">azure</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">default_host_filters</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="nt">fail_on_template_errors</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">hostvar_expressions</span><span class="p">:</span>
<span class="w">  </span><span class="nt">computer_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name</span>
<span class="w">  </span><span class="nt">private_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">private_ipv4_addresses[0] if private_ipv4_addresses else None</span>
<span class="w">  </span><span class="nt">provisioning_state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">provisioning_state | title</span>
<span class="w">  </span><span class="nt">public_ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">public_ipv4_addresses[0] if public_ipv4_addresses else None</span>
<span class="w">  </span><span class="nt">public_ip_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">public_ip_id if public_ip_id is defined else None</span>
<span class="w">  </span><span class="nt">public_ip_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">public_ip_name if public_ip_name is defined else None</span>
<span class="w">  </span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tags if tags else None</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resource_type</span>
<span class="nt">keyed_groups</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">location</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tags.keys() | list if tags else []</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security_group</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resource_group</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">os_disk.operating_system_type</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dict(tags.keys() | map(&quot;regex_replace&quot;, &quot;^(.*)$&quot;, &quot;\1_&quot;) | list | zip(tags.values() | list)) if tags else []</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="nt">plain_host_names</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">azure.azcollection.azure_rm</span>
<span class="nt">use_contrib_script_compatible_sanitization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</section>
<section id="vmware-vcenter">
<h4><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">19.4. </span>VMware vCenter</a><a class="headerlink" href="#vmware-vcenter" title="Link to this heading"></a></h4>
<div class="highlight-YAML+Jinja notranslate" id="index-4"><div class="highlight"><pre><span></span><span class="nt">compose</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">guest.ipAddress</span>
<span class="w">  </span><span class="nt">ansible_ssh_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">guest.ipAddress</span>
<span class="w">  </span><span class="nt">ansible_uuid</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">99999999 | random | to_uuid</span>
<span class="w">  </span><span class="nt">availablefield</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">availableField</span>
<span class="w">  </span><span class="nt">configissue</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">configIssue</span>
<span class="w">  </span><span class="nt">configstatus</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">configStatus</span>
<span class="w">  </span><span class="nt">customvalue</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">customValue</span>
<span class="w">  </span><span class="nt">effectiverole</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">effectiveRole</span>
<span class="w">  </span><span class="nt">guestheartbeatstatus</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">guestHeartbeatStatus</span>
<span class="w">  </span><span class="nt">layoutex</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">layoutEx</span>
<span class="w">  </span><span class="nt">overallstatus</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overallStatus</span>
<span class="w">  </span><span class="nt">parentvapp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parentVApp</span>
<span class="w">  </span><span class="nt">recenttask</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">recentTask</span>
<span class="w">  </span><span class="nt">resourcepool</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resourcePool</span>
<span class="w">  </span><span class="nt">rootsnapshot</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rootSnapshot</span>
<span class="w">  </span><span class="nt">triggeredalarmstate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">triggeredAlarmState</span>
<span class="nt">filters</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runtime.powerState == &quot;poweredOn&quot;</span>
<span class="nt">keyed_groups</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config.guestId</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&quot;templates&quot;</span><span class="nv"> </span><span class="s">if</span><span class="nv"> </span><span class="s">config.template</span><span class="nv"> </span><span class="s">else</span><span class="nv"> </span><span class="s">&quot;guests&quot;&#39;</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">community.vmware.vmware_vm_inventory</span>
<span class="nt">properties</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">availableField</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">configIssue</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">configStatus</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">customValue</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">datastore</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">effectiveRole</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">guestHeartbeatStatus</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">layout</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">layoutEx</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">network</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overallStatus</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">parentVApp</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">permission</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">recentTask</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">resourcePool</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rootSnapshot</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">snapshot</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">triggeredAlarmState</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">capability</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">guest</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">runtime</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">storage</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">summary</span>
<span class="nt">strict</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">with_nested_properties</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</section>
<section id="red-hat-satellite-6">
<span id="ir-plugin-satellite"></span><h4><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">19.5. </span>Red Hat Satellite 6</a><a class="headerlink" href="#red-hat-satellite-6" title="Link to this heading"></a></h4>
<div class="highlight-YAML+Jinja notranslate" id="index-5"><div class="highlight"><pre><span></span><span class="nt">group_prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foreman_</span>
<span class="nt">keyed_groups</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foreman[&#39;environment_name&#39;] | lower | regex_replace(&#39; &#39;, &#39;&#39;) | regex_replace(&#39;[^A-Za-z0-9_]&#39;, &#39;_&#39;) | regex_replace(&#39;none&#39;, &#39;&#39;)</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foreman_environment_</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foreman[&#39;location_name&#39;] | lower | regex_replace(&#39; &#39;, &#39;&#39;) | regex_replace(&#39;[^A-Za-z0-9_]&#39;, &#39;_&#39;)</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foreman_location_</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foreman[&#39;organization_name&#39;] | lower | regex_replace(&#39; &#39;, &#39;&#39;) | regex_replace(&#39;[^A-Za-z0-9_]&#39;, &#39;_&#39;)</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foreman_organization_</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foreman[&#39;content_facet_attributes&#39;][&#39;lifecycle_environment_name&#39;] | lower | regex_replace(&#39; &#39;, &#39;&#39;) | regex_replace(&#39;[^A-Za-z0-9_]&#39;, &#39;_&#39;)</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foreman_lifecycle_environment_</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foreman[&#39;content_facet_attributes&#39;][&#39;content_view_name&#39;] | lower | regex_replace(&#39; &#39;, &#39;&#39;) | regex_replace(&#39;[^A-Za-z0-9_]&#39;, &#39;_&#39;)</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">foreman_content_view_</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;&#39;</span>
<span class="nt">legacy_hostvars</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">theforeman.foreman.foreman</span>
<span class="nt">validate_certs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">want_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">want_hostcollections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">want_params</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</section>
<section id="openstack">
<h4><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">19.6. </span>OpenStack</a><a class="headerlink" href="#openstack" title="Link to this heading"></a></h4>
<div class="highlight-YAML+Jinja notranslate" id="index-6"><div class="highlight"><pre><span></span><span class="nt">expand_hostvars</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">fail_on_errors</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">inventory_hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">uuid</span>
<span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openstack.cloud.openstack</span>
</pre></div>
</div>
</section>
<section id="red-hat-virtualization">
<h4><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">19.7. </span>Red Hat Virtualization</a><a class="headerlink" href="#red-hat-virtualization" title="Link to this heading"></a></h4>
<div class="highlight-YAML+Jinja notranslate" id="index-7"><div class="highlight"><pre><span></span><span class="nt">compose</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">(devices.values() | list)[0][0] if devices else None</span>
<span class="nt">keyed_groups</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cluster</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cluster</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">_</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">_</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tags</span>
<span class="w">  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag</span>
<span class="w">  </span><span class="nt">separator</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">_</span>
<span class="nt">ovirt_hostname_preference</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">name</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fqdn</span>
<span class="nt">ovirt_insecure</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ovirt.ovirt.ovirt</span>
</pre></div>
</div>
</section>
<section id="red-hat-ansible-automation-platform">
<h4><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">19.8. </span>Red Hat Ansible Automation Platform</a><a class="headerlink" href="#red-hat-ansible-automation-platform" title="Link to this heading"></a></h4>
<div class="highlight-YAML+Jinja notranslate" id="index-8"><div class="highlight"><pre><span></span><span class="nt">include_metadata</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">inventory_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;inventory_id or url_quoted_named_url&gt;</span>
<span class="nt">plugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">awx.awx.tower</span>
<span class="nt">validate_certs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;true or false&gt;</span>
</pre></div>
</div>
</section>
</section>
<span id="document-userguide/job_templates"></span><section id="job-templates">
<span id="ug-jobtemplates"></span><h3><span class="section-number">20. </span>Job Templates<a class="headerlink" href="#job-templates" title="Link to this heading"></a></h3>
<p id="index-0">A <a class="reference internal" href="index.html#term-Job-Template"><span class="xref std std-term">job template</span></a> is a definition and set of parameters for running an Ansible job. Job templates are useful to execute the same job many times. Job templates also encourage the reuse of Ansible playbook content and collaboration between teams.</p>
<p>The <strong>Templates</strong> menu opens a list of the job templates that are currently available. The default view is collapsed (Compact), showing the template name, template type, and the timestamp of last job that ran using that template. You can click <strong>Expanded</strong> (arrow next to each entry) to expand to view more information. This list is sorted alphabetically by name, but you can sort by other criteria, or search by various fields and attributes of a template.</p>
<p><img alt="Job templates - home with example job template" src="_images/job-templates-home-with-example-job-template.png" /></p>
<p>From this screen, you can launch (<img alt="Launch button" src="_images/launch-button.png" />), edit (<img alt="Edit button" src="_images/edit-button.png" />), and copy (<img alt="Copy button" src="_images/copy-button.png" />) a job template. To delete a job template, you must select one or more templates and click the <strong>Delete</strong> button. Before deleting a job template, be sure it is not used in a workflow job template.</p>
<blockquote id="deletion-warning">
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>If deleting items that are used by other work items, a message opens listing the items are affected by the deletion and prompts you to confirm the deletion. Some screens will contain items that are invalid or previously deleted, so they will fail to run. Below is an example of such a message:</p>
<img alt="_images/warning-deletion-dependencies.png" src="_images/warning-deletion-dependencies.png" />
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Job templates can be used to build a workflow template. For templates that show the Workflow Visualizer (<img alt="Workflow Visualizer icon" src="_images/wf-viz-icon.png" />) icon next to them are workflow templates. Clicking it allows you to graphically build a workflow. Many parameters in a job template allow you to enable <strong>Prompt on Launch</strong> that can be modified at the workflow level, and do not affect the values assigned at the job template level. For instructions, see the <a class="reference internal" href="index.html#ug-wf-editor"><span class="std std-ref">Workflow Visualizer</span></a> section.</p>
</div>
<section id="create-a-job-template">
<h4><span class="section-number">20.1. </span>Create a Job Template<a class="headerlink" href="#create-a-job-template" title="Link to this heading"></a></h4>
<p>To create a new job template:</p>
<ol class="arabic simple">
<li><p>Click the <strong>Add</strong> button then select <strong>Job Template</strong> from the menu list.</p></li>
<li><p>Enter the appropriate details into the following fields:</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a field has the <strong>Prompt on launch</strong> checkbox selected, launching the job will prompt you for the value for that field upon launch. Most prompted values will override any values set in the job template; exceptions are noted below.</p>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 53%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Options</p></th>
<th class="head"><p>Prompt on Launch</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Name</strong></p></td>
<td><p>Enter a name for the job.</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>Enter an arbitrary description as appropriate (optional).</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td><p><strong>Job Type</strong></p></td>
<td><dl class="simple">
<dt>Choose a job type:</dt><dd><ul class="simple">
<li><p><strong>Run</strong>: Execute the playbook when launched, running Ansible tasks on the selected hosts.</p></li>
<li><p><strong>Check</strong>: Perform a “dry run” of the playbook and report changes that would be made without actually making them. Tasks that do not support check mode will be skipped and will not report potential changes.</p></li>
</ul>
</dd>
</dl>
<p>More information on job types can be found in the <a class="reference external" href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_intro.html#playbook-execution">Playbook execution</a> section of the Ansible documentation.</p>
</td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Inventory</strong></p></td>
<td><p>Choose the inventory to be used with this job template from the inventories available to the currently logged in user. A System Administrator must grant you or your team permissions to be able to use certain inventories in a job template.</p></td>
<td><p>Yes. Inventory prompts will show up as its own step in a subsequent prompt window.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Project</strong></p></td>
<td><p>Choose the project to be used with this job template from the projects available to the currently logged in user.</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><td><p><strong>SCM Branch</strong></p></td>
<td><p>This field is only present if you chose a project that allows branch override. Specify the overriding branch to use in your job run. If left blank, the specified SCM branch (or commit hash or tag) from the project is used. For more detail, see <a class="reference internal" href="index.html#ug-job-branching"><span class="std std-ref">job branch overriding</span></a>.</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><strong>Execution Environment</strong></p></td>
<td><p>Select the container image to be used to run this job. A project must be selected before you can select an execution environment.</p></td>
<td><p>Yes. Execution environment prompts will show up as its own step in a subsequent prompt window.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Playbook</strong></p></td>
<td><p>Choose the playbook to be launched with this job template from the available playbooks. This field automatically populates with the names of the playbooks found in the project base path for the selected project. Alternatively, you can enter the name of the playbook if it is not listed, such as the name of a file (like <code class="docutils literal notranslate"><span class="pre">foo.yml</span></code>) you want to use to run with that playbook. If you enter a filename that is not valid, the template will display an error, or cause the job to fail.</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td><p><strong>Credentials</strong></p></td>
<td><p>Click the <img alt="Search button" src="_images/search-button.png" /> button to open a separate window. Choose the credential from the available options to be used with this job template. Use the drop-down menu list to filter by credential type if the list is extensive. Some credential types are not listed because they do not apply to certain job templates.</p></td>
<td><ul class="simple">
<li><p>If selected, upon launching a job template that has a default credential and supplying another credential will replace the default credential if it is the same type. Example of such a message:</p></li>
</ul>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">Job Template default credentials must be replaced</span>
<span class="l l-Scalar l-Scalar-Plain">with one of the same type. Please select a credential</span>
<span class="l l-Scalar l-Scalar-Plain">for the following types in order to proceed</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Machine.</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Alternatively, you can add more credentials as you see fit.</p></li>
<li><p>Credential prompts will show up as its own step in a subsequent prompt window.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Labels</strong></p></td>
<td><ul class="simple">
<li><p>Optionally supply labels that describe this job template, such as “dev” or “test”. Labels can be used to group and filter job templates and completed jobs in the display.</p></li>
<li><p>Labels are created when they are added to the Job Template. Labels are associated to a single Organization using the Project that is provided in the Job Template. Members of the Organization can create labels on a Job Template if they have edit permissions (such as admin role).</p></li>
<li><p>Once the Job Template is saved, the labels appear in the Job Templates overview in the <em>Expanded</em> view.</p></li>
<li><p>Click the (<img alt="X button" src="_images/x-button.png" />) beside a label to remove it. When a label is removed, it is no longer associated with that particular Job or Job Template, but it will remain associated with any other jobs that reference it.</p></li>
<li><p>Jobs inherit labels from the Job Template at the time of launch. If a label is deleted from a Job Template, it is also deleted from the Job.</p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>If selected, even if a default value is supplied, you will be prompted upon launch to supply additional labels if needed.</p></li>
<li><p>You will not be able to delete existing labels - clicking (<img alt="Delete button" src="_images/x-delete-button.png" />) only removes the newly added labels, not existing default labels.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><strong>Variables</strong></p></td>
<td><ul class="simple">
<li><p>Pass extra command line variables to the playbook. This is the “-e” or “–extra-vars” command line parameter for ansible-playbook that is documented in the Ansible documentation at <a class="reference external" href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_variables.html#defining-variables-at-runtime">Defining variables at runtime</a>.</p></li>
<li><p>Provide key/value pairs using either YAML or JSON. These variables have a maximum value of precedence and overrides other variables specified elsewhere. An example value might be:</p></li>
</ul>
<blockquote>
<div><div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">git_branch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">production</span>
<span class="nt">release_version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.5</span>
</pre></div>
</div>
</div></blockquote>
</td>
<td><p>Yes. If you want to be able to specify <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code> on a schedule, you must select <strong>Prompt on Launch</strong> for <strong>Variables</strong> on the job template, or a enable a survey on the job template, then those answered survey questions become <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Forks</strong></p></td>
<td><p>The number of parallel or simultaneous processes to use while executing the playbook. A value of zero uses the Ansible default setting, which is 5 parallel processes unless overridden in <code class="docutils literal notranslate"><span class="pre">/etc/ansible/ansible.cfg</span></code>.</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><strong>Limit</strong></p></td>
<td><p>A host pattern to further constrain the list of hosts managed or affected by the playbook. Multiple patterns can be separated by colons (<code class="docutils literal notranslate"><span class="pre">:</span></code>). As with core Ansible, <code class="docutils literal notranslate"><span class="pre">a:b</span></code> means “in group a or b”, <code class="docutils literal notranslate"><span class="pre">a:b:&amp;c</span></code> means “in a or b but must be in c”, and <code class="docutils literal notranslate"><span class="pre">a:!b</span></code> means “in a, and definitely not in b”. For more information and examples refer to <a class="reference external" href="https://docs.ansible.com/ansible/latest/inventory_guide/intro_patterns.html">Patterns</a> in the Ansible documentation.</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Verbosity</strong></p></td>
<td><p>Control the level of output Ansible produces as the playbook executes. Choose the verbosity from Normal to various Verbose or Debug settings. This only appears in the “details” report view. Verbose logging includes the output of all commands. Debug logging is exceedingly verbose and includes information on SSH operations that can be useful in certain support instances. Most users do not need to see debug mode output.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Verbosity 5 causes AWX to block heavily when jobs are running, which could delay reporting that the job has finished (even though it has) and can cause the browser tab to lock up.</p>
</div>
</td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><strong>Job Slicing</strong></p></td>
<td><p>Specify the number of slices you want this job template to run. Each slice will run the same tasks against a portion of the inventory. For more information about job slices, see <a class="reference internal" href="index.html#ug-job-slice"><span class="std std-ref">Job Slicing</span></a>.</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Timeout</strong></p></td>
<td><dl class="simple">
<dt>Allows you to specify the length of time (in seconds) that the job may run before it is canceled. Some caveats for setting the timeout value:</dt><dd><ul class="simple">
<li><p>There is a global timeout defined in the settings which defaults to 0, indicating no timeout.</p></li>
<li><p>A negative timeout (&lt;0) on a job template is a true “no timeout” on the job.</p></li>
<li><p>A timeout of 0 on a job template defaults the job to the global timeout (which is no timeout by default).</p></li>
<li><p>A positive timeout sets the timeout for that job template.</p></li>
</ul>
</dd>
</dl>
</td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><strong>Show Changes</strong></p></td>
<td><p>Allows you to see the changes made by Ansible tasks.</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Instance Groups</strong></p></td>
<td><p>Choose <a class="reference internal" href="index.html#ag-instance-groups"><span class="std std-ref">Instance Groups</span></a> to associate with this job template. If the list is extensive, use the <img alt="Search button" src="_images/search-button.png" /> to narrow the options. Note, job template instance groups contribute to the job scheduling criteria, see <a class="reference internal" href="index.html#ag-instance-groups-job-runtime-behavior"><span class="std std-ref">Job Runtime Behavior</span></a> and <a class="reference internal" href="index.html#ag-instance-groups-control-where-job-runs"><span class="std std-ref">Control Where a Job Runs</span></a> for rules. A System Administrator must grant you or your team permissions to be able to use an instance group in a job template. Use of a container group requires admin rights.</p></td>
<td><ul class="simple">
<li><p>Yes. If selected, you are providing the jobs preferred instance groups in order of preference. If the first group is out of capacity, subsequent groups in the list will be considered until one with capacity is available, at which point that will be selected to run the job.</p></li>
<li><p>If you prompt for an instance group, what you enter replaces the normal instance group hierarchy and overrides all of the organizations’ and inventories’ instance groups.</p></li>
<li><p>Instance Groups prompts will show up as its own step in a subsequent prompt window.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><strong>Job Tags</strong></p></td>
<td><p>Begin typing and selecting the <strong>Create x</strong> drop-down to specify which parts of the playbook should be executed. For more information and examples refer to <a class="reference external" href="https://https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_tags.html">Tags</a> in the Ansible documentation.</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Skip Tags</strong></p></td>
<td><p>Begin typing and selecting the <strong>Create x</strong> drop-down to specify certain tasks or parts of the playbook to skip. For more information and examples refer to <a class="reference external" href="https://https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_tags.html">Tags</a> in the Ansible documentation.</p></td>
<td><p>Yes</p></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="3">
<li><p><strong>Options</strong>: Specify options for launching this template, if necessary.</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p><strong>Privilege Escalation</strong>: If checked, you enable this playbook to run as an administrator. This is the equivalent of passing the <code class="docutils literal notranslate"><span class="pre">--become</span></code> option to the <code class="docutils literal notranslate"><span class="pre">ansible-playbook</span></code> command.</p></li>
<li><p><strong>Provisioning Callbacks</strong>: If checked, you enable a host to call back to AWX via the REST API and invoke the launch of a job from this job template. Refer to <a class="reference internal" href="#ug-provisioning-callbacks"><span class="std std-ref">Provisioning Callbacks</span></a> for additional information.</p></li>
<li><p><strong>Enable Webhook</strong>: Turns on the ability to interface with a predefined SCM system web service that is used to launch a job template. Currently supported SCM systems are GitHub and GitLab.</p></li>
</ul>
</div></blockquote>
<blockquote id="ug-jt-enable-webhooks">
<div><p>If you enable webhooks, other fields display, prompting for additional information:</p>
<blockquote>
<div><img alt="Job templates - options - webhooks" src="_images/job-templates-options-webhooks.png" />
<ul class="simple">
<li><p><strong>Webhook Service</strong>: Select which service to listen for webhooks from</p></li>
<li><p><strong>Webhook URL</strong>: Automatically populated with the URL for the webhook service to POST requests to.</p></li>
<li><p><strong>Webhook Key</strong>: Generated shared secret to be used by the webhook service to sign payloads sent to AWX. This must be configured in the settings on the webhook service in order for AWX to accept webhooks from this service.</p></li>
<li><p><strong>Webhook Credential</strong>: Optionally, provide a GitHub or GitLab personal access token (PAT) as a credential to use to send status updates back to the webhook service. Before you can select it, the credential must exist. See <a class="reference internal" href="index.html#ug-credentials-cred-types"><span class="std std-ref">Credential Types</span></a> to create one.</p></li>
</ul>
<p>For additional information on setting up webhooks, see <a class="reference internal" href="index.html#ug-webhooks"><span class="std std-ref">Working with Webhooks</span></a>.</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>Concurrent Jobs</strong>: If checked, you are allowing jobs in the queue to run simultaneously if not dependent on one another. Check this box if you want to run job slices simultaneously. Refer to <a class="reference internal" href="index.html#ug-job-concurrency"><span class="std std-ref">AWX Capacity Determination and Job Impact</span></a> for additional information.</p></li>
<li><p><strong>Enable Fact Storage</strong>: When checked, AWX will store gathered facts for all hosts in an inventory related to the job running.</p></li>
<li><p><strong>Prevent Instance Group Fallback</strong>: Check this option to allow only the instance groups listed in the <strong>Instance Groups</strong> field above to execute the job. If unchecked, all available instances in the execution pool will be used based on the hierarchy described in <a class="reference internal" href="index.html#ag-instance-groups-control-where-job-runs"><span class="std std-ref">Control Where a Job Runs</span></a>.  Click the <img alt="Tooltip" src="_images/tooltips-icon.png" /> icon for more information.</p></li>
</ul>
</div></blockquote>
<p><img alt="Job templates - create new job template" src="_images/job-templates-create-new-job-template.png" /></p>
<ol class="arabic simple" start="4">
<li><p>When you have completed configuring the details of the job template, click <strong>Save</strong>.</p></li>
</ol>
<p>Saving the template does not exit the job template page but advances to the Job Template Details tab for viewing. After saving the template, you can click <strong>Launch</strong> to launch the job, or click <strong>Edit</strong> to add or change the attributes of the template, such as permissions, notifications, view completed jobs, and add a survey (if the job type is not a scan). You must first save the template prior to launching, otherwise, the <strong>Launch</strong> button remains grayed-out.</p>
<img alt="Job templates - job template details" src="_images/job-templates-job-template-details.png" />
<p>You can verify the template is saved when the newly created template appears on the Templates list view.</p>
</section>
<section id="add-permissions">
<h4><span class="section-number">20.2. </span>Add Permissions<a class="headerlink" href="#add-permissions" title="Link to this heading"></a></h4>
<blockquote>
<div></div></blockquote>
<ol class="arabic simple" id="ug-permissions">
<li><p>In the <strong>Access</strong> tab, click the <strong>Add</strong> button.</p></li>
<li><p>Select a user or team to add and click <strong>Next</strong></p></li>
<li><p>Select one or more users or teams from the list by clicking the check box(es) next to the name(s) to add them as members and click <strong>Next</strong>.</p></li>
</ol>
<img alt="_images/organizations-add-users-for-example-organization.png" src="_images/organizations-add-users-for-example-organization.png" />
<p>In this example, two users have been selected to be added.</p>
<ol class="arabic simple" start="4">
<li><p>Select the role(s) you want the selected user(s) or team(s) to have. Be sure to scroll down for a complete list of roles. Different resources have different options available.</p></li>
</ol>
<blockquote>
<div><img alt="_images/organizations-add-users-roles.png" src="_images/organizations-add-users-roles.png" />
</div></blockquote>
<ol class="arabic simple" start="5">
<li><p>Click the <strong>Save</strong> button to apply the roles to the selected user(s) or team(s) and to add them as members.</p></li>
</ol>
<p>The Add Users/Teams window closes to display the updated roles assigned for each user and team.</p>
<img alt="Permissions tab with Role Assignments" src="_images/permissions-tab-roles-assigned.png" />
<p>To remove roles for a particular user, click the disassociate (x) button next to its resource.</p>
<img alt="_images/permissions-disassociate.png" src="_images/permissions-disassociate.png" />
<p>This launches a confirmation dialog, asking you to confirm the disassociation.</p>
<img alt="_images/permissions-disassociate-confirm.png" src="_images/permissions-disassociate-confirm.png" />
</section>
<section id="work-with-notifications">
<h4><span class="section-number">20.3. </span>Work with Notifications<a class="headerlink" href="#work-with-notifications" title="Link to this heading"></a></h4>
<p>Clicking the <strong>Notifications</strong> tab allows you to review any notification integrations you have setup and their statuses, if they have ran.</p>
<img alt="Job templates - completed notifications view" src="_images/job-template-completed-notifications-view.png" />
<p>Use the toggles to enable or disable the notifications to use with your particular template. For more detail, see <a class="reference internal" href="index.html#ug-notifications-on-off"><span class="std std-ref">Enable and Disable Notifications</span></a>.</p>
<p>If no notifications have been set up, click the <strong>Add</strong> button to create a new notification. Refer to <a class="reference internal" href="index.html#ug-notifications-types"><span class="std std-ref">Notification Types</span></a> for additional details on configuring various notification types and extended messaging.</p>
</section>
<section id="view-completed-jobs">
<h4><span class="section-number">20.4. </span>View Completed Jobs<a class="headerlink" href="#view-completed-jobs" title="Link to this heading"></a></h4>
<p>The <strong>Completed Jobs</strong> tab provides the list of job templates that have ran. Click <strong>Expanded</strong> to view details of each job, including its status, ID, and name; type of job, time started and completed, who started the job; and which template, inventory, project, and credential were used. You can filter the list of completed jobs using any of these criteria.</p>
<img alt="Job templates - completed jobs view" src="_images/job-template-completed-jobs-view.png" />
<p>Sliced jobs that display on this list are labeled accordingly, with the number of sliced jobs that have run:</p>
<img alt="Sliced job shown in jobs list view" src="_images/sliced-job-shown-jobs-list-view.png" />
</section>
<section id="scheduling">
<h4><span class="section-number">20.5. </span>Scheduling<a class="headerlink" href="#scheduling" title="Link to this heading"></a></h4>
<p id="index-1">Access the schedules for a particular job template from the <strong>Schedules</strong> tab.</p>
<p><img alt="Job Templates - schedule launch" src="_images/job-templates-schedules.png" /></p>
<section id="schedule-a-job-template">
<h5><span class="section-number">20.5.1. </span>Schedule a Job Template<a class="headerlink" href="#schedule-a-job-template" title="Link to this heading"></a></h5>
<p id="index-2">To schedule a job template run, click the <strong>Schedules</strong> tab.</p>
<ul class="simple">
<li><p>If schedules are already set up; review, edit, or enable/disable your schedule preferences.</p></li>
<li><p>If schedules have not been set up, refer to <a class="reference internal" href="index.html#ug-scheduling"><span class="std std-ref">Schedules</span></a> for more information.</p></li>
</ul>
<p>If <strong>Prompt on Launch</strong> was selected for the <strong>Credentials</strong> field, and you create or edit scheduling information for your job template, a <strong>Prompt</strong> button displays at the bottom of the Schedules form. You will not be able to remove the default machine credential in the Prompt dialog without replacing it with another machine credential before you can save it. Below is an example of such a message:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To able to set <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code> on schedules, you must select <strong>Prompt on Launch</strong> for <strong>Variables</strong> on the job template, or a configure and enable a survey on the job template, then those answered survey questions become <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code>.</p>
</div>
</section>
</section>
<section id="surveys">
<span id="ug-surveys"></span><h4><span class="section-number">20.6. </span>Surveys<a class="headerlink" href="#surveys" title="Link to this heading"></a></h4>
<p id="index-3">Job types of Run or Check will provide a way to set up surveys in the Job Template creation or editing screens. Surveys set extra variables for the playbook similar to ‘Prompt for Extra Variables’ does, but in a user-friendly question and answer way. Surveys also allow for validation of user input. Click the <strong>Survey</strong> tab to create a survey.</p>
<p>Use cases for surveys are numerous. An example might be if operations wanted to give developers a “push to stage” button they could run without advanced Ansible knowledge. When launched, this task could prompt for answers to questions such as, “What tag should we release?”</p>
<p>Many types of questions can be asked, including multiple-choice questions.</p>
<section id="create-a-survey">
<span id="ug-surveys-create"></span><h5><span class="section-number">20.6.1. </span>Create a Survey<a class="headerlink" href="#create-a-survey" title="Link to this heading"></a></h5>
<p id="index-4">To create a survey:</p>
<ol class="arabic simple">
<li><p>Click the <strong>Survey</strong> tab and click the <strong>Add</strong> button.</p></li>
<li><p>A survey can consist of any number of questions. For each question, enter the following information:</p></li>
</ol>
<ul class="simple">
<li><p><strong>Question</strong>: The question to ask the user</p></li>
<li><p><strong>Description</strong>: (optional) A description of what’s being asked of the user.</p></li>
<li><p><strong>Answer Variable Name</strong>: The Ansible variable name to store the user’s response in. This is the variable to be used by the playbook. Variable names cannot contain spaces.</p></li>
<li><p><strong>Answer Type</strong>: Choose from the following question types.</p>
<ul>
<li><p><em>Text</em>: A single line of text. You can set the minimum and maximum length (in characters) for this answer.</p></li>
<li><p><em>Textarea</em>: A multi-line text field. You can set the minimum and maximum length (in characters) for this answer.</p></li>
<li><p><em>Password</em>: Responses are treated as sensitive information, much like an actual password is treated. You can set the minimum and maximum length (in characters) for this answer.</p></li>
<li><p><em>Multiple Choice (single select)</em>: A list of options, of which only one can be selected at a time. Enter the options, one per line, in the <strong>Multiple Choice Options</strong> box.</p></li>
<li><p><em>Multiple Choice (multiple select)</em>: A list of options, any number
of which can be selected at a time. Enter the options, one per
line, in the <strong>Multiple Choice Options</strong> box.</p></li>
<li><p><em>Integer</em>: An integer number. You can set the minimum and maximum length (in characters) for this answer.</p></li>
<li><p><em>Float</em>: A decimal number. You can set the minimum and maximum length (in characters) for this answer.</p></li>
</ul>
</li>
<li><p><strong>Required</strong>: Whether or not an answer to this question is required from the user.</p></li>
<li><p><strong>Minimum length</strong> and <strong>Maximum length</strong>: Specify if a certain length in the answer is required.</p></li>
<li><p><strong>Default answer</strong>: The default answer to the question. This value is pre-filled in the interface and is used if the answer is not provided by the user.</p></li>
</ul>
<img alt="Job templates - create survey" src="_images/job-template-create-survey.png" />
<ol class="arabic simple" start="3">
<li><p>Once you have entered the question information, click <strong>Save</strong> to add the question.</p></li>
</ol>
<p>The survey question displays in the Survey list. For any question, you can click <img alt="Edit button" src="_images/edit-button.png" /> to edit the question, or check the box next to each question and click <strong>Delete</strong> to delete the question, or use the toggle button at the top of the screen to enable or disable the survey prompt(s).</p>
<p><img alt="Job templates - completed survey" src="_images/job-template-completed-survey.png" /></p>
<p>If you have more than one survey question, use the <strong>Edit Order</strong> button to rearrange the order of the questions by clicking and dragging on the grid icon.</p>
<img alt="Job templates - rearrange survey" src="_images/job-template-rearrange-survey.png" />
<ol class="arabic simple" start="4">
<li><p>To add more questions, click the <strong>Add</strong> button to add additional questions.</p></li>
</ol>
</section>
<section id="optional-survey-questions">
<h5><span class="section-number">20.6.2. </span>Optional Survey Questions<a class="headerlink" href="#optional-survey-questions" title="Link to this heading"></a></h5>
<p id="index-5">The <strong>Required</strong> setting on a survey question determines whether the answer is optional or not for the user interacting with it.</p>
<p>Behind the scenes, optional survey variables can be passed to the playbook in <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code>, even when they aren’t filled in.</p>
<ul class="simple">
<li><p>If a non-text variable (input type) is marked as optional, and is not filled in, no survey <code class="docutils literal notranslate"><span class="pre">extra_var</span></code> is passed to the playbook.</p></li>
<li><p>If a text input or text area input is marked as optional, is not filled in, and has a minimum <code class="docutils literal notranslate"><span class="pre">length</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>, no survey <code class="docutils literal notranslate"><span class="pre">extra_var</span></code> is passed to the playbook.</p></li>
<li><p>If a text input or text area input is marked as optional, is not filled in, and has a minimum <code class="docutils literal notranslate"><span class="pre">length</span> <span class="pre">===</span> <span class="pre">0</span></code>, that survey <code class="docutils literal notranslate"><span class="pre">extra_var</span></code> is passed to the playbook, with the value set to an empty string ( “” ).</p></li>
</ul>
</section>
</section>
<section id="launch-a-job-template">
<h4><span class="section-number">20.7. </span>Launch a Job Template<a class="headerlink" href="#launch-a-job-template" title="Link to this heading"></a></h4>
<p id="index-6">A major benefit of AWX is the push-button deployment of Ansible playbooks. You can easily configure a template to store all parameters you would normally pass to the ansible-playbook on the command line–not just the playbooks, but the inventory, credentials, extra variables, and all options and settings you can specify on the command line.</p>
<p>Easier deployments drive consistency, by running your playbooks the same way each time, and allow you to delegate responsibilities–even users who aren’t Ansible experts can run playbooks written by others.</p>
<p>Launch a job template by any of the following ways:</p>
<ul class="simple">
<li><p>Access the job template list from the <strong>Templates</strong> menu on the left navigation bar or while in the Job Template Details view, scroll to the bottom to access the <img alt="Launch button" src="_images/launch-button.png" /> button from the list of templates.</p></li>
</ul>
<img alt="Job templates - home with example job template - launch" src="_images/job-templates-home-with-example-job-template-launch.png" />
<ul class="simple">
<li><p>While in the Job Template Details view of the job template you want to launch, click <strong>Launch</strong>.</p></li>
</ul>
<p>A job may require additional information to run. The following data may be requested at launch:</p>
<ul class="simple">
<li><p>Credentials that were setup</p></li>
<li><p>The option <code class="docutils literal notranslate"><span class="pre">Prompt</span> <span class="pre">on</span> <span class="pre">Launch</span></code> is selected for any parameter</p></li>
<li><p>Passwords or passphrases that have been set to <strong>Ask</strong></p></li>
<li><p>A survey, if one has been configured for the job templates</p></li>
<li><p>Extra variables, if requested by the job template</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a job has user-provided values, then those are respected upon relaunch. If the user did not specify a value, then the job uses the default value from the job template. Jobs are not relaunched as-is. They are relaunched with the user prompts re-applied to the job template.</p>
</div>
<p>Below is an example job launch that prompts for Job Tags, and runs the example survey created in <a class="reference internal" href="#ug-surveys"><span class="std std-ref">Surveys</span></a>.</p>
<p><img alt="Job launch with prompt job tags" src="_images/job-launch-with-prompt-at-launch-jobtags.png" /></p>
<p><img alt="Job launch with prompt survey" src="_images/job-launch-with-prompt-at-launch-survey.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Providing values on one tab, and going back to a previous tab, and then continuing on to the next tab will result in having to re-provide values on the rest of the tabs. Make sure you fill in the tabs in the order the prompts appear to avoid this.</p>
</div>
<p>Along with any extra variables set in the job template and survey, AWX automatically adds the following variables to the job environment. Also note, <code class="docutils literal notranslate"><span class="pre">awx_``*</span> <span class="pre">variables</span> <span class="pre">are</span> <span class="pre">defined</span> <span class="pre">by</span> <span class="pre">the</span> <span class="pre">system</span> <span class="pre">and</span> <span class="pre">cannot</span> <span class="pre">be</span> <span class="pre">overridden.</span> <span class="pre">Variables</span> <span class="pre">about</span> <span class="pre">the</span> <span class="pre">job</span> <span class="pre">context,</span> <span class="pre">like</span> <span class="pre">``awx_job_template_name</span></code> are not affected if they are set in <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">awx_job_id</span></code>: The Job ID for this job run</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_job_launch_type</span></code>: The description to indicate how the job was started:</p>
<ul>
<li><p><strong>manual</strong>: Job was started manually by a user.</p></li>
<li><p><strong>relaunch</strong>: Job was started via relaunch.</p></li>
<li><p><strong>callback</strong>: Job was started via host callback.</p></li>
<li><p><strong>scheduled</strong>: Job was started from a schedule.</p></li>
<li><p><strong>dependency</strong>: Job was started as a dependency of another job.</p></li>
<li><p><strong>workflow</strong>: Job was started from a workflow job.</p></li>
<li><p><strong>sync</strong>: Job was started from a project sync.</p></li>
<li><p><strong>scm</strong>: Job was created as an Inventory SCM sync.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_job_template_id</span></code>: The Job Template ID that this job run uses</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_job_template_name</span></code>: The Job Template name that this job uses</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_execution_node</span></code>: The Execution Node name that launched this job</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_project_revision</span></code>: The revision identifier for the source tree that this particular job uses (it is also the same as the job’s field <code class="docutils literal notranslate"><span class="pre">scm_revision</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_project_scm_branch</span></code>: The configured default project SCM branch for the project the job template uses</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_job_scm_branch</span></code> If the SCM Branch is overwritten by the job, the value is shown here</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_user_email</span></code>: The user email of the AWX user that started this job. This is not available for callback or scheduled jobs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_user_first_name</span></code>: The user’s first name of the AWX user that started this job. This is not available for callback or scheduled jobs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_user_id</span></code>: The user ID of the AWX user that started this job. This is not available for callback or scheduled jobs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_user_last_name</span></code>: The user’s last name of the AWX user that started this job. This is not available for callback or scheduled jobs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_user_name</span></code>: The user name of the AWX user that started this job. This is not available for callback or scheduled jobs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_schedule_id</span></code>: If applicable, the ID of the schedule that launched this job</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_schedule_name</span></code>: If applicable, the name of the schedule that launched this job</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_workflow_job_id</span></code>: If applicable, the ID of the workflow job that launched this job</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_workflow_job_name</span></code>: If applicable, the name of the workflow job that launched this job. Note this is also the same as the workflow job template.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_inventory_id</span></code>: If applicable, the ID of the inventory this job uses</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_inventory_name</span></code>: If applicable, the name of the inventory this job uses</p></li>
</ul>
<p>For compatibility, all variables are also given an “awx” prefix, for example, <code class="docutils literal notranslate"><span class="pre">awx_job_id</span></code>.</p>
<p>Upon launch, AWX automatically redirects the web browser to the Job Status page for this job under the <strong>Jobs</strong> tab.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can re-launch the most recent job from the list view to re-run on all hosts or just failed hosts in the specified inventory. Refer to <a class="reference internal" href="index.html#ug-jobs"><span class="std std-ref">Jobs</span></a> in the <em>AWX User Guide</em> for more detail.</p>
</div>
<p>When slice jobs are running, job lists display the workflow and job slices, as well as a link to view their details individually.</p>
<img alt="Sliced job shown in jobs list view" src="_images/sliced-job-shown-jobs-list-view.png" />
<div class="admonition note" id="ug-jobtemplates-bulk-api">
<p class="admonition-title">Note</p>
<p>You may launch jobs in bulk using the newly added endpoint in the API, <code class="docutils literal notranslate"><span class="pre">/api/v2/bulk/job_launch</span></code>. This endpoint accepts JSON and you can specify a list of unified job templates (such as job templates, project updates, etc) to launch. The user must have the appropriate permission to launch all the jobs. Either all jobs are launched, or an error is returned indicating why the operation was not able to complete. Use the <strong>OPTIONS</strong> request to return relevant schema. For more information, see the <a class="reference external" href="https://docs.ansible.com/automation-controller/latest/html/controllerapi/api_ref.html#/Bulk">Bulk endpoint</a> of the <em>Reference</em> section of the <em>AWX API Guide</em>.</p>
</div>
</section>
<section id="copy-a-job-template">
<h4><span class="section-number">20.8. </span>Copy a Job Template<a class="headerlink" href="#copy-a-job-template" title="Link to this heading"></a></h4>
<p>If you choose to copy Job Template, it <strong>does not</strong> copy any associated schedule, notifications, or permissions. Schedules and notifications must be recreated by the user or admin creating the copy of the Job Template. The user copying the Job Template will be granted the admin permission, but no permissions are assigned (copied) to the Job Template.</p>
<ol class="arabic simple">
<li><p>Access the job template list from the <strong>Templates</strong> menu on the left navigation bar or while in the Job Template Details view, scroll to the bottom to access it from the list of templates.</p></li>
</ol>
<p><img alt="Job templates - home with example job template" src="_images/job-templates-home-with-example-job-template.png" /></p>
<ol class="arabic simple" start="2">
<li><p>Click the <img alt="Copy button" src="_images/copy-button.png" /> button associated with the template you want to copy.</p></li>
</ol>
<p>The new template with the name of the template from which you copied and a timestamp displays in the list of templates.</p>
<ol class="arabic simple" start="3">
<li><p>Click to open the new template and click <strong>Edit</strong>.</p></li>
<li><p>Replace the contents of the <strong>Name</strong> field with a new name, and provide or modify the entries in the other fields to complete this page.</p></li>
<li><p>Click <strong>Save</strong> when done.</p></li>
</ol>
<section id="fact-scan-playbooks">
<span id="ug-jobtemplates-scanjobs"></span><h5><span class="section-number">20.8.1. </span>Fact Scan Playbooks<a class="headerlink" href="#fact-scan-playbooks" title="Link to this heading"></a></h5>
<p id="index-7">The scan job playbook, <code class="docutils literal notranslate"><span class="pre">scan_facts.yml</span></code>, contains invocations of three <code class="docutils literal notranslate"><span class="pre">fact</span> <span class="pre">scan</span> <span class="pre">modules</span></code> - packages, services, and files, along with Ansible’s standard fact gathering. The <code class="docutils literal notranslate"><span class="pre">scan_facts.yml</span></code> playbook file looks like the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">hosts</span><span class="p">:</span> <span class="nb">all</span>
  <span class="nb">vars</span><span class="p">:</span>
    <span class="n">scan_use_checksum</span><span class="p">:</span> <span class="n">false</span>
    <span class="n">scan_use_recursive</span><span class="p">:</span> <span class="n">false</span>
  <span class="n">tasks</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">scan_packages</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">scan_services</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">scan_files</span><span class="p">:</span>
        <span class="n">paths</span><span class="p">:</span> <span class="s1">&#39;{{ scan_file_paths }}&#39;</span>
        <span class="n">get_checksum</span><span class="p">:</span> <span class="s1">&#39;{{ scan_use_checksum }}&#39;</span>
        <span class="n">recursive</span><span class="p">:</span> <span class="s1">&#39;{{ scan_use_recursive }}&#39;</span>
      <span class="n">when</span><span class="p">:</span> <span class="n">scan_file_paths</span> <span class="ow">is</span> <span class="n">defined</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">scan_files</span></code> fact module is the only module that accepts parameters, passed via <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code> on the scan job template.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scan_file_paths</span><span class="p">:</span> <span class="s1">&#39;/tmp/&#39;</span>
<span class="n">scan_use_checksum</span><span class="p">:</span> <span class="n">true</span>
<span class="n">scan_use_recursive</span><span class="p">:</span> <span class="n">true</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">scan_file_paths</span></code> parameter may have multiple settings (such as <code class="docutils literal notranslate"><span class="pre">/tmp/</span></code> or <code class="docutils literal notranslate"><span class="pre">/var/log</span></code>).</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">scan_use_checksum</span></code> and <code class="docutils literal notranslate"><span class="pre">scan_use_recursive</span></code> parameters may also be set to false or omitted. An omission is the same as a false setting.</p></li>
</ul>
<p>Scan job templates should enable <code class="docutils literal notranslate"><span class="pre">become</span></code> and use credentials for which <code class="docutils literal notranslate"><span class="pre">become</span></code> is a possibility. You can enable become by checking the <strong>Enable Privilege Escalation</strong> from the Options menu:</p>
<img alt="Job template with Privilege Escalation checked from the Options field." src="_images/job-templates-create-new-job-template-become.png" />
</section>
<section id="supported-oses-for-scan-facts-yml">
<h5><span class="section-number">20.8.2. </span>Supported OSes for <code class="docutils literal notranslate"><span class="pre">scan_facts.yml</span></code><a class="headerlink" href="#supported-oses-for-scan-facts-yml" title="Link to this heading"></a></h5>
<p>If you use the <code class="docutils literal notranslate"><span class="pre">scan_facts.yml</span></code> playbook with use fact cache, ensure that your OS is supported:</p>
<ul class="simple">
<li><p>Red Hat Enterprise Linux 5, 6, &amp; 7</p></li>
<li><p>OEL 6 &amp; 7</p></li>
<li><p>SLES 11 &amp; 12</p></li>
<li><p>Debian 6, 7, 8</p></li>
<li><p>Fedora 22, 23, 24</p></li>
<li><p>Amazon Linux 2016.03</p></li>
<li><p>Windows Server 2008 and later</p></li>
</ul>
<p>Note that some of these operating systems may require initial configuration in order to be able to run python and/or have access to the python packages (such as <code class="docutils literal notranslate"><span class="pre">python-apt</span></code>) that the scan modules depend on.</p>
</section>
<section id="pre-scan-setup">
<h5><span class="section-number">20.8.3. </span>Pre-scan Setup<a class="headerlink" href="#pre-scan-setup" title="Link to this heading"></a></h5>
<p>The following are examples of playbooks that configure certain distributions so that scan jobs can be run against them.</p>
<p><strong>Bootstrap Fedora (23, 24)</strong></p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Get Fedora ready</span>
<span class="w w-Error"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="w"> </span><span class="nt">sudo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="w"> </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no</span>

<span class="w"> </span><span class="nt">tasks</span><span class="p">:</span>

<span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">install python-simplejson</span>
<span class="w">   </span><span class="nt">raw</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sudo dnf -y update</span>
<span class="w">   </span><span class="nt">raw</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sudo dnf -y install python-simplejson</span>
<span class="w">   </span><span class="nt">raw</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sudo dnf -y install rpm-python</span>
</pre></div>
</div>
</section>
<section id="custom-fact-scans">
<h5><span class="section-number">20.8.4. </span>Custom Fact Scans<a class="headerlink" href="#custom-fact-scans" title="Link to this heading"></a></h5>
<p id="index-8">A playbook for a custom fact scan is similar to the example of the Fact Scan Playbook above. As an example, a playbook that only uses a custom <code class="docutils literal notranslate"><span class="pre">scan_foo</span></code> Ansible fact module would look like this:</p>
<p><em>scan_custom.yml</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">hosts</span><span class="p">:</span> <span class="nb">all</span>
  <span class="n">gather_facts</span><span class="p">:</span> <span class="n">false</span>
  <span class="n">tasks</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">scan_foo</span><span class="p">:</span>
</pre></div>
</div>
<p><em>scan_foo.py</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">module</span> <span class="o">=</span> <span class="n">AnsibleModule</span><span class="p">(</span>
        <span class="n">argument_spec</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">())</span>

    <span class="n">foo</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;hello&quot;</span><span class="p">:</span> <span class="s2">&quot;world&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="s2">&quot;bar&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
    <span class="n">results</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ansible_facts</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">foo</span><span class="o">=</span><span class="n">foo</span><span class="p">))</span>
    <span class="n">module</span><span class="o">.</span><span class="n">exit_json</span><span class="p">(</span><span class="o">**</span><span class="n">results</span><span class="p">)</span>

<span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>To use a custom fact module, ensure that it lives in the <code class="docutils literal notranslate"><span class="pre">/library/</span></code> subdirectory of the Ansible project used in the scan job template. This fact scan module is very simple, returning a hard-coded set of facts:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
   <span class="p">{</span>
     <span class="s2">&quot;hello&quot;</span><span class="p">:</span> <span class="s2">&quot;world&quot;</span>
   <span class="p">},</span>
   <span class="p">{</span>
     <span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="s2">&quot;bar&quot;</span>
   <span class="p">}</span>
 <span class="p">]</span>
</pre></div>
</div>
<p>Refer to the <a class="reference external" href="https://docs.ansible.com/ansible/latest/dev_guide/developing_modules_general.html#creating-an-info-or-a-facts-module">Creating an info or a facts module</a> section of the Ansible documentation for more information.</p>
</section>
</section>
<section id="fact-caching">
<span id="ug-fact-caching"></span><h4><span class="section-number">20.9. </span>Fact Caching<a class="headerlink" href="#fact-caching" title="Link to this heading"></a></h4>
<p id="index-9">AWX can store and retrieve facts on a per-host basis through an Ansible Fact Cache plugin. This behavior is configurable on a per-job template basis. Fact caching is turned off by default but can be enabled to serve fact requests for all hosts in an inventory related to the job running. This allows you to use job templates with <code class="docutils literal notranslate"><span class="pre">--limit</span></code> while still having access to the entire inventory of host facts. A global timeout setting that the plugin enforces per-host, can be specified (in seconds) through the Jobs settings menu:</p>
<img alt="Jobs Settings window showing the location of the Per-Host Ansible Fact Cache Timeout parameter from the Edit Details screen." src="_images/configure-awx-jobs-fact-cache-timeout.png" />
<p>Upon launching a job that uses fact cache (<code class="docutils literal notranslate"><span class="pre">use_fact_cache=True</span></code>), AWX will store all <code class="docutils literal notranslate"><span class="pre">ansible_facts</span></code> associated with each host in the inventory associated with the job.  The Ansible Fact Cache plugin that ships with AWX will only be enabled on jobs with fact cache enabled (<code class="docutils literal notranslate"><span class="pre">use_fact_cache=True</span></code>).</p>
<p>When a job that has fact cache enabled (<code class="docutils literal notranslate"><span class="pre">use_fact_cache=True</span></code>) finishes running, AWX will restore all records for the hosts in the inventory.  Any records with update times <em>newer</em> than the currently stored facts per-host will be updated in the database.</p>
<p>New and changed facts will be logged via AWX’s logging facility. Specifically, to the <code class="docutils literal notranslate"><span class="pre">system_tracking</span></code> namespace or logger. The logging payload will include the fields:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">host_name</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inventory_id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ansible_facts</span></code></p></li>
</ul>
</div></blockquote>
<p>where <code class="docutils literal notranslate"><span class="pre">ansible_facts</span></code> is a dictionary of all Ansible facts for <code class="docutils literal notranslate"><span class="pre">host_name</span></code> in the AWX inventory, <code class="docutils literal notranslate"><span class="pre">inventory_id</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a hostname includes a forward slash (<code class="docutils literal notranslate"><span class="pre">/</span></code>), fact cache will not work for that host. If you have an inventory with 100 hosts and one host has a <code class="docutils literal notranslate"><span class="pre">/</span></code> in the name, 99 of those hosts will still collect facts.</p>
</div>
<section id="benefits-of-fact-caching">
<h5><span class="section-number">20.9.1. </span>Benefits of Fact Caching<a class="headerlink" href="#benefits-of-fact-caching" title="Link to this heading"></a></h5>
<p>Fact caching saves a significant amount of time over running fact gathering. If you have a playbook in a job that runs against a thousand hosts and forks, you could easily spend 10 minutes gathering facts across all of those hosts. But if you run a job on a regular basis, the first run of it caches these facts and the next run will just pull them from the database. This cuts the runtime of jobs against large inventories, including Smart Inventories, by an enormous magnitude.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Do not modify the <code class="docutils literal notranslate"><span class="pre">ansible.cfg</span></code> file to apply fact caching. Custom fact caching could conflict with AWX’s fact caching feature. It is recommended to use the fact caching module that comes with AWX.</p>
</div>
<p>You can choose to use cached facts in your job by enabling it in the <strong>Options</strong> field of the Job Templates window.</p>
<img alt="Job templates - options - use factcache" src="_images/job-templates-options-use-factcache.png" />
<p>To clear facts, you need to run the Ansible <code class="docutils literal notranslate"><span class="pre">clear_facts</span></code> <a class="reference external" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/meta_module.html#examples">meta task</a>. Below is an example playbook that uses the Ansible <code class="docutils literal notranslate"><span class="pre">clear_facts</span></code> meta task.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Clear gathered facts from all currently targeted hosts</span>
<span class="w">      </span><span class="nt">meta</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">clear_facts</span>
</pre></div>
</div>
<p>You can find the API endpoint for fact caching at:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">http://&lt;awx server name&gt;/api/v2/hosts/x/ansible_facts</span>
</pre></div>
</div>
</section>
</section>
<section id="utilizing-cloud-credentials">
<span id="ug-cloudcredentials"></span><h4><span class="section-number">20.10. </span>Utilizing Cloud Credentials<a class="headerlink" href="#utilizing-cloud-credentials" title="Link to this heading"></a></h4>
<p id="index-10">Cloud Credentials can be used when syncing a respective cloud inventory. Cloud Credentials may also be associated with a Job Template and included in the runtime environment for use by a playbook. Cloud Credentials currently supported:</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#openstack" id="id2">OpenStack</a></p></li>
<li><p><a class="reference internal" href="#amazon-web-services" id="id3">Amazon Web Services</a></p></li>
<li><p><a class="reference internal" href="#google" id="id4">Google</a></p></li>
<li><p><a class="reference internal" href="#azure" id="id5">Azure</a></p></li>
<li><p><a class="reference internal" href="#vmware" id="id6">VMware</a></p></li>
</ul>
</nav>
<section id="openstack">
<h5><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">20.10.1. </span>OpenStack</a><a class="headerlink" href="#openstack" title="Link to this heading"></a></h5>
<p id="index-11">The sample playbook below invokes the <code class="docutils literal notranslate"><span class="pre">nova_compute</span></code> Ansible OpenStack cloud module and requires credentials to do anything meaningful, and specifically requires the following information: <code class="docutils literal notranslate"><span class="pre">auth_url</span></code>, <code class="docutils literal notranslate"><span class="pre">username</span></code>, <code class="docutils literal notranslate"><span class="pre">password</span></code>, and <code class="docutils literal notranslate"><span class="pre">project_name</span></code>. These fields are made available to the playbook via the environmental variable <code class="docutils literal notranslate"><span class="pre">OS_CLIENT_CONFIG_FILE</span></code>, which points to a YAML file written by AWX based on the contents of the cloud credential. This sample playbook loads the YAML file into the Ansible variable space.</p>
<p><code class="docutils literal notranslate"><span class="pre">OS_CLIENT_CONFIG_FILE</span></code> example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">clouds</span><span class="p">:</span>
<span class="w">  </span><span class="nt">devstack</span><span class="p">:</span>
<span class="w">    </span><span class="nt">auth</span><span class="p">:</span>
<span class="w">      </span><span class="nt">auth_url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://devstack.yoursite.com:5000/v2.0/</span>
<span class="w">      </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">admin</span>
<span class="w">      </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">your_password_here</span>
<span class="w">      </span><span class="nt">project_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">demo</span>
</pre></div>
</div>
<p>Playbook example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
<span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">vars</span><span class="p">:</span>
<span class="w">    </span><span class="nt">config_file</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;env&#39;</span><span class="o">,</span> <span class="s1">&#39;OS_CLIENT_CONFIG_FILE&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
<span class="w">    </span><span class="nt">nova_tenant_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">demo</span>
<span class="w">    </span><span class="nt">nova_image_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;cirros-0.3.2-x86_64-uec&quot;</span>
<span class="w">    </span><span class="nt">nova_instance_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">autobot</span>
<span class="w">    </span><span class="nt">nova_instance_state</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;present&#39;</span>
<span class="w">    </span><span class="nt">nova_flavor_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">m1.nano</span>

<span class="w">    </span><span class="nt">nova_group</span><span class="p">:</span>
<span class="w">      </span><span class="nt">group_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">antarctica</span>
<span class="w">      </span><span class="nt">instance_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">deceptacon</span>
<span class="w">      </span><span class="nt">instance_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">debug</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span> <span class="nv">config_file</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">stat</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">path=&quot;</span><span class="cp">{{</span> <span class="nv">config_file</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>
<span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">st</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">include_vars</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">config_file</span> <span class="cp">}}</span><span class="s">&quot;</span>
<span class="w">      </span><span class="nt">when</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">st.stat.exists and st.stat.isreg</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Print</span><span class="nv"> </span><span class="s">out</span><span class="nv"> </span><span class="s">clouds</span><span class="nv"> </span><span class="s">variable&quot;</span>
<span class="w">      </span><span class="nt">debug</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">msg=&quot;</span><span class="cp">{{</span> <span class="nv">clouds</span><span class="o">|</span><span class="nf">default</span><span class="o">(</span><span class="s1">&#39;No clouds found&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">&quot;</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Setting</span><span class="nv"> </span><span class="s">nova</span><span class="nv"> </span><span class="s">instance</span><span class="nv"> </span><span class="s">state</span><span class="nv"> </span><span class="s">to:</span><span class="nv"> </span><span class="cp">{{</span> <span class="nv">nova_instance_state</span> <span class="cp">}}</span><span class="s">&quot;</span>
<span class="w">      </span><span class="nt">local_action</span><span class="p">:</span>
<span class="w">        </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nova_compute</span>
<span class="w">        </span><span class="nt">login_username</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">clouds.devstack.auth.username</span> <span class="cp">}}</span><span class="s">&quot;</span>
<span class="w">        </span><span class="nt">login_password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">clouds.devstack.auth.password</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
</section>
<section id="amazon-web-services">
<h5><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">20.10.2. </span>Amazon Web Services</a><a class="headerlink" href="#amazon-web-services" title="Link to this heading"></a></h5>
<p id="index-12">Amazon Web Services cloud credentials are exposed as the following environment variables during playbook execution (in the job template, choose the cloud credential needed for your setup):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">AWS_ACCESS_KEY_ID</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AWS_SECRET_ACCESS_KEY</span></code></p></li>
</ul>
<p>All of the AWS modules will implicitly use these credentials when run via AWX without having to set the <code class="docutils literal notranslate"><span class="pre">aws_access_key_id</span></code> or <code class="docutils literal notranslate"><span class="pre">aws_secret_access_key</span></code> module options.</p>
</section>
<section id="google">
<h5><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">20.10.3. </span>Google</a><a class="headerlink" href="#google" title="Link to this heading"></a></h5>
<p id="index-13">Google cloud credentials are exposed as the following environment variables during playbook execution (in the job template, choose the cloud credential needed for your setup):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GCE_EMAIL</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GCE_PROJECT</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GCE_CREDENTIALS_FILE_PATH</span></code></p></li>
</ul>
<p>All of the Google modules will implicitly use these credentials when run via AWX without having to set the <code class="docutils literal notranslate"><span class="pre">service_account_email</span></code>, <code class="docutils literal notranslate"><span class="pre">project_id</span></code>, or <code class="docutils literal notranslate"><span class="pre">pem_file</span></code> module options.</p>
</section>
<section id="azure">
<h5><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">20.10.4. </span>Azure</a><a class="headerlink" href="#azure" title="Link to this heading"></a></h5>
<p id="index-14">Azure cloud credentials are exposed as the following environment variables during playbook execution (in the job template, choose the cloud credential needed for your setup):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">AZURE_SUBSCRIPTION_ID</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AZURE_CERT_PATH</span></code></p></li>
</ul>
<p>All of the Azure modules implicitly use these credentials when run via AWX without having to set the <code class="docutils literal notranslate"><span class="pre">subscription_id</span></code> or <code class="docutils literal notranslate"><span class="pre">management_cert_path</span></code> module options.</p>
</section>
<section id="vmware">
<h5><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">20.10.5. </span>VMware</a><a class="headerlink" href="#vmware" title="Link to this heading"></a></h5>
<p id="index-15">VMware cloud credentials are exposed as the following environment variables during playbook execution (in the job template, choose the cloud credential needed for your setup):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">VMWARE_USER</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VMWARE_PASSWORD</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VMWARE_HOST</span></code></p></li>
</ul>
<p>The sample playbook below demonstrates usage of these credentials:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">vsphere_guest</span><span class="p">:</span>
<span class="w">    </span><span class="nt">vcenter_hostname</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;env&#39;</span><span class="o">,</span> <span class="s1">&#39;VMWARE_HOST&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
<span class="w">    </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;env&#39;</span><span class="o">,</span> <span class="s1">&#39;VMWARE_USER&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
<span class="w">    </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">lookup</span><span class="o">(</span><span class="s1">&#39;env&#39;</span><span class="o">,</span> <span class="s1">&#39;VMWARE_PASSWORD&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="s">&quot;</span>
<span class="w">    </span><span class="nt">guest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">newvm001</span>
<span class="w">    </span><span class="nt">from_template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
<span class="w">    </span><span class="nt">template_src</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">linuxTemplate</span>
<span class="w">    </span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MainCluster</span>
<span class="w">    </span><span class="nt">resource_pool</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/Resources&quot;</span>
<span class="w">    </span><span class="nt">vm_extra_config</span><span class="p">:</span>
<span class="w">      </span><span class="nt">folder</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MyFolder</span>
</pre></div>
</div>
</section>
</section>
<section id="provisioning-callbacks">
<span id="ug-provisioning-callbacks"></span><h4><span class="section-number">20.11. </span>Provisioning Callbacks<a class="headerlink" href="#provisioning-callbacks" title="Link to this heading"></a></h4>
<p id="index-16">Provisioning callbacks are a feature of AWX that allow a host to initiate a playbook run against itself, rather than waiting for a user to launch a job to manage the host from the AWX UI. Please note that provisioning callbacks are <em>only</em> used to run playbooks on the calling host. Provisioning callbacks are meant for cloud bursting (i.e. new instances with a need for client to server communication for configuration (such as transmitting an authorization key)), not to run a job against another host. This provides for automatically configuring a system after it has been provisioned by another system (such as AWS auto-scaling, or a OS provisioning system like kickstart or preseed) or for launching a job programmatically without invoking the AWX API directly. The Job Template launched only runs against the host requesting the provisioning.</p>
<p>Frequently this would be accessed via a firstboot type script, or from cron.</p>
<p>To enable callbacks, check the <em>Provisioning Callbacks</em> checkbox in the Job Template. This displays the <strong>Provisioning Callback URL</strong> for this job template.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you intend to use AWX’s provisioning callback feature with a dynamic inventory, Update on Launch should be set for the inventory group used in the Job Template.</p>
</div>
<img alt="Provisioning callbacks config" src="_images/provisioning-callbacks-config.png" />
<p>Callbacks also require a Host Config Key, to ensure that foreign hosts with the URL cannot request configuration. Please provide a custom value for Host Config Key. The host key may be reused across multiple hosts to apply this job template against multiple hosts. Should you wish to control what hosts are able to request configuration, the key may be changed at any time.</p>
<p>To callback manually via REST, look at the callback URL in the UI, which is of the form:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">https://&lt;AWX_SERVER_NAME&gt;/api/v2/job_templates/7/callback/</span>
</pre></div>
</div>
<p>The ‘7’ in this sample URL is the job template ID in AWX.</p>
<p>The request from the host must be a POST. Here is an example using curl (all on a single line):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-k<span class="w"> </span>-f<span class="w"> </span>-i<span class="w"> </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type:application/json&#39;</span><span class="w"> </span>-XPOST<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;host_config_key&quot;: &quot;redhat&quot;}&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">                 </span>https://&lt;AWX_SERVER_NAME&gt;/api/v2/job_templates/7/callback/
</pre></div>
</div>
<p>The requesting host must be defined in your inventory for the callback to succeed. If AWX fails to locate the host either by name or IP address in one of your defined inventories, the request is denied. When running a Job Template in this way, the host initiating the playbook run against itself must be in the inventory. If the host is missing from the inventory, the Job Template will fail with a “No Hosts Matched” type error message.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your host is not in inventory and <code class="docutils literal notranslate"><span class="pre">Update</span> <span class="pre">on</span> <span class="pre">Launch</span></code> is set for the inventory group, AWX attempts to update cloud based inventory source before running the callback.</p>
</div>
<p>Successful requests result in an entry on the Jobs tab, where the results and history can be viewed.</p>
<p>While the callback can be accessed via REST, the suggested method of using the callback is to use one of the example scripts that ships with AWX - <code class="docutils literal notranslate"><span class="pre">/usr/share/awx/request_awx_configuration.sh</span></code> (Linux/UNIX) or <code class="docutils literal notranslate"><span class="pre">/usr/share/awx/request_awx_configuration.ps1</span></code> (Windows). Usage is described in the source code of the file by passing the <code class="docutils literal notranslate"><span class="pre">-h</span></code> flag, as shown below:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">./request_awx_configuration.sh -h</span>
<span class="l l-Scalar l-Scalar-Plain">Usage</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./request_awx_configuration.sh &lt;options&gt;</span>

<span class="l l-Scalar l-Scalar-Plain">Request server configuration from AWX.</span>

<span class="nt">OPTIONS</span><span class="p">:</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-h      Show this message</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-s      AWX server (e.g. https://ac.example.com) (required)</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-k      Allow insecure SSL connections and transfers</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-c      Host config key (required)</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-t      Job template ID (required)</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">-e      Extra variables</span>
</pre></div>
</div>
<p>This script has some intelligence, it knows how to retry commands and is therefore a more robust way to use callbacks than a simple curl request. As written, the script retries once per minute for up to ten minutes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please note that this is an example script. You should edit this script if you need more dynamic behavior when detecting failure scenarios, as any non-200 error code may not be a transient error requiring retry.</p>
</div>
<p>Most likely you will use callbacks with dynamic inventory in AWX, such as pulling cloud inventory from one of the supported cloud providers. In these cases, along with setting <em>Update On Launch</em>, be sure to configure an inventory cache timeout for the inventory source, to avoid hammering of your Cloud’s API endpoints. Since the <code class="docutils literal notranslate"><span class="pre">request_awx_configuration.sh</span></code> script polls once per minute for up to ten minutes, a suggested cache invalidation time for inventory (configured on the inventory source itself) would be one or two minutes.</p>
<p>While we recommend against running the <code class="docutils literal notranslate"><span class="pre">request_awx_configuration.sh</span></code> script from a cron job, a suggested cron interval would be perhaps every 30 minutes. Repeated configuration can be easily handled by scheduling in AWX, so the primary use of callbacks by most users is to enable a base image that is bootstrapped into the latest configuration upon coming online. To do so, running at first boot is a better practice. First boot scripts are just simple init scripts that typically self-delete, so you would set up an init script that called a copy of the <code class="docutils literal notranslate"><span class="pre">request_awx_configuration.sh</span></code> script and make that into an autoscaling image.</p>
<section id="passing-extra-variables-to-provisioning-callbacks">
<h5><span class="section-number">20.11.1. </span>Passing Extra Variables to Provisioning Callbacks<a class="headerlink" href="#passing-extra-variables-to-provisioning-callbacks" title="Link to this heading"></a></h5>
<p id="index-17">Just as you can pass <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code> in a regular Job Template, you can also pass them to provisioning callbacks. To pass <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code>, the data sent must be part of the body of the POST request as application/json (as the content type). Use the following JSON format as an example when adding your own <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code> to be passed:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="s">&#39;{&quot;extra_vars&quot;:</span><span class="nv"> </span><span class="s">{&quot;variable1&quot;:&quot;value1&quot;,&quot;variable2&quot;:&quot;value2&quot;,...}}&#39;</span>
</pre></div>
</div>
<p>You can also pass extra variables to the Job Template call using <code class="docutils literal notranslate"><span class="pre">curl</span></code>, such as is shown in the following example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">.. code-block:</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bash</span>
</pre></div>
</div>
<blockquote>
<div><dl class="simple">
<dt><a class="reference external" href="mailto:root&#37;&#52;&#48;localhost">root<span>&#64;</span>localhost</a>:~$ curl -f -H ‘Content-Type: application/json’ -XPOST </dt><dd><p>-d ‘{“host_config_key”: “redhat”, “extra_vars”: “{&quot;foo&quot;: &quot;bar&quot;}”}’ <a class="reference external" href="https:/">https:/</a>/&lt;AWX_SERVER_NAME&gt;/api/v2/job_templates/7/callback</p>
</dd>
</dl>
</div></blockquote>
<p>For more information, refer to <a class="reference internal" href="index.html#launch-jobs-curl"><span class="std std-ref">Launching Jobs with Curl</span></a>.</p>
</section>
</section>
<section id="extra-variables">
<span id="ug-jobtemplates-extravars"></span><h4><span class="section-number">20.12. </span>Extra Variables<a class="headerlink" href="#extra-variables" title="Link to this heading"></a></h4>
<div class="admonition note" id="index-18">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">extra_vars</span></code> passed to the job launch API are only honored if one of the following is true:</p>
<ul class="simple">
<li><p>They correspond to variables in an enabled survey</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ask_variables_on_launch</span></code> is set to True</p></li>
</ul>
</div>
<p>When you pass survey variables, they are passed as extra variables (<code class="docutils literal notranslate"><span class="pre">extra_vars</span></code>) within AWX. This can be tricky, as passing extra variables to a job template (as you would do with a survey) can override other variables being passed from the inventory and project.</p>
<p>By default, <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code> are marked as <code class="docutils literal notranslate"><span class="pre">!unsafe</span></code> unless you specify them on the job template’s Extra Variables section. These are trusted, because they can only be added by users with enough privileges to add or edit a Job Template. For example, nested variables do not expand when entered as a prompt, as the Jinja brackets are treated as a string. For more information about unsafe variables, see <a class="reference external" href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_advanced_syntax.html#unsafe-or-raw-strings">unsafe or raw strings</a>.</p>
<p>For example, say that you have a defined variable for an inventory for <code class="docutils literal notranslate"><span class="pre">debug</span> <span class="pre">=</span> <span class="pre">true</span></code>. It is entirely possible that this variable, <code class="docutils literal notranslate"><span class="pre">debug</span> <span class="pre">=</span> <span class="pre">true</span></code>, can be overridden in a job template survey.</p>
<p>To ensure that the variables you need to pass are not overridden, ensure they are included by redefining them in the survey. Keep in mind that extra variables can be defined at the inventory, group, and host levels.</p>
<p>If specifying the <code class="docutils literal notranslate"><span class="pre">ALLOW_JINJA_IN_EXTRA_VARS</span></code> parameter, refer to the <a class="reference internal" href="index.html#ag-tips-jinja-extravars"><span class="std std-ref">AWX Tips and Tricks</span></a> section of the <em>AWX Administration Guide</em> to configure it in the Jobs Settings screen of the AWX UI.</p>
<div class="admonition note" id="index-19">
<p class="admonition-title">Note</p>
<p>The Job Template extra variables dictionary is merged with the Survey variables.</p>
</div>
<p>Here are some simplified examples of <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code> in YAML and JSON formats:</p>
<p>The configuration in YAML format:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">launch_to_orbit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">satellites</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sputnik</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">explorer</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">satcom</span>
</pre></div>
</div>
<p>The configuration in JSON format:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w">  </span><span class="s">&quot;launch_to_orbit&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;satellites&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;sputnik&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;explorer&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;satcom&quot;</span><span class="p p-Indicator">]</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>The following table notes the behavior (hierarchy) of variable precedence in AWX as it compares to variable precedence in Ansible.</p>
<p><strong>AWX Variable Precedence Hierarchy (last listed wins)</strong></p>
<img alt="AWX Variable Precedence Hierarchy" src="_images/Architecture-AWX_Variable_Precedence_Hierarchy.png" />
<section id="relaunching-job-templates">
<h5><span class="section-number">20.12.1. </span>Relaunching Job Templates<a class="headerlink" href="#relaunching-job-templates" title="Link to this heading"></a></h5>
<p id="index-20">Instead of manually relaunching a job, a relaunch is denoted by setting <code class="docutils literal notranslate"><span class="pre">launch_type</span></code> to <code class="docutils literal notranslate"><span class="pre">relaunch</span></code>. The relaunch behavior deviates from the launch behavior in that it <strong>does not</strong> inherit <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code>.</p>
<p>Job relaunching does not go through the inherit logic. It uses the same <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code> that were calculated for the job being relaunched.</p>
<p>For example, say that you launch a Job Template with no <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code> which results in the creation of a Job called <strong>j1</strong>. Next, say that you edit the Job Template and add in some <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code> (such as adding <code class="docutils literal notranslate"><span class="pre">&quot;{</span> <span class="pre">&quot;hello&quot;:</span> <span class="pre">&quot;world&quot;</span> <span class="pre">}&quot;</span></code>).</p>
<p>Relaunching <strong>j1</strong> results in the creation of <strong>j2</strong>, but because there is no inherit logic and <strong>j1</strong> had no <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code>, <strong>j2</strong> will not have any <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code>.</p>
<p>To continue upon this example, if you launched the Job Template with the <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code> you added after the creation of <strong>j1</strong>, the relaunch job created (<strong>j3</strong>) will include the <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code>. And relaunching <strong>j3</strong> results in the creation of <strong>j4</strong>, which would also include <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code>.</p>
</section>
</section>
</section>
<span id="document-userguide/job_slices"></span><section id="job-slicing">
<span id="ug-job-slice"></span><h3><span class="section-number">21. </span>Job Slicing<a class="headerlink" href="#job-slicing" title="Link to this heading"></a></h3>
<p id="index-0">A <a class="reference internal" href="index.html#term-Sliced-Job"><span class="xref std std-term">sliced job</span></a> refers to the concept of a distributed job. Distributed jobs are used for running a job across a very large number of hosts, allowing you to run multiple ansible-playbooks, each on a subset of an inventory, that can be scheduled in parallel across a cluster.</p>
<p>By default, Ansible runs jobs from a single control instance. For jobs that do not require cross-host orchestration, job slicing takes advantage of AWX’s ability to distribute work to multiple nodes in a cluster. Job slicing works by adding a Job Template field <code class="docutils literal notranslate"><span class="pre">job_slice_count</span></code>, which specifies the number of jobs into which to slice the Ansible run. When this number is greater than 1, AWX will generate a workflow from a job template instead of a job. The inventory will be distributed evenly amongst the slice jobs. The workflow job is then started, and proceeds as though it were a normal workflow. When launching a job, the API will return either a job resource (if <code class="docutils literal notranslate"><span class="pre">job_slice_count</span> <span class="pre">=</span> <span class="pre">1</span></code>) or a workflow job resource. The corresponding User Interface will redirect to the appropriate screen to display the status of the run.</p>
<section id="job-slice-considerations">
<h4><span class="section-number">21.1. </span>Job slice considerations<a class="headerlink" href="#job-slice-considerations" title="Link to this heading"></a></h4>
<p>Consider the following when setting up job slices:</p>
<ul class="simple">
<li><p>A sliced job creates a workflow job, and then that creates jobs.</p></li>
<li><p>A job slice consists of a job template, an inventory, and a slice count.</p></li>
<li><p>When executed, a sliced job splits each inventory into a number of “slice size” chunks. It then queues jobs of ansible-playbook runs on each chunk of the appropriate inventory. The inventory fed into ansible-playbook is a pared-down version of the original inventory that only contains the hosts in that particular slice. The completed sliced job that displays on the Jobs list are labeled accordingly, with the number of sliced jobs that have run:</p></li>
</ul>
<img alt="Sliced job shown in Jobs list view" src="_images/sliced-job-shown-jobs-list-view.png" />
<ul class="simple">
<li><p>These sliced jobs follow normal scheduling behavior (number of forks, queuing due to capacity, assignation to instance groups based on inventory mapping).</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Job slicing is intended to scale job executions horizontally. Enabling job slicing on a job template divides an inventory to be acted upon in the number of slices configured at launch time and then starts a job for each slice.</p>
<p>It is expected that the number of slices will be equal to or less than the number of controller nodes. Setting an extremely high number of job slices (e.g., thousands), while allowed, can cause performance degradation as the job scheduler is not designed to schedule simultaneously thousands of workflow nodes, which are what the sliced jobs become.</p>
</div>
<ul class="simple">
<li><p>Sliced job templates with prompts and/or extra variables behave the same as standard job templates, applying all variables and limits to the entire set of slice jobs in the resulting workflow job. However, when passing a limit to a Sliced Job, if the limit causes slices to have no hosts assigned, those slices will fail, causing the overall job to fail.</p></li>
<li><p>A job slice job status of a distributed job is calculated in the same manner as workflow jobs; failure if there are any unhandled failures in its sub-jobs.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Any job that intends to orchestrate across hosts (rather than just applying changes to individual hosts) should not be configured as a slice job. Any job that does, may fail, and AWX will not attempt to discover or account for playbooks that fail when run as slice jobs.</p>
</div>
</section>
<section id="job-slice-execution-behavior">
<span id="ug-job-slice-execution"></span><h4><span class="section-number">21.2. </span>Job slice execution behavior<a class="headerlink" href="#job-slice-execution-behavior" title="Link to this heading"></a></h4>
<p>When jobs are sliced, they can run on any node and some may not run at the same time (insufficient capacity in the system, for example). When slice jobs are running, job details display the workflow and job slice(s) currently running, as well as a link to view their details individually.</p>
<img alt="Sliced job shown in Jobs output view" src="_images/sliced-job-shown-jobs-output-view.png" />
<p>By default, job templates are not normally configured to execute simultaneously (<code class="docutils literal notranslate"><span class="pre">allow_simultaneous</span></code> must be checked in the API or <strong>Enable Concurrent Jobs</strong> in the UI). Slicing overrides this behavior and implies <code class="docutils literal notranslate"><span class="pre">allow_simultaneous</span></code> even if that setting is unchecked. See <a class="reference internal" href="index.html#ug-jobtemplates"><span class="std std-ref">Job Templates</span></a> for information on how to specify this, as well as the number of job slices on your job template configuration.</p>
<p>The <a class="reference internal" href="index.html#ug-jobtemplates"><span class="std std-ref">Job Templates</span></a> section provides additional detail on performing the following operations in the User Interface:</p>
<ul class="simple">
<li><p>Launch workflow jobs with a job template that has a slice number greater than one</p></li>
<li><p>Cancel the whole workflow or individual jobs after launching a slice job template</p></li>
<li><p>Relaunch the whole workflow or individual jobs after slice jobs finish running</p></li>
<li><p>View the details about the workflow and slice jobs after a launching a job template</p></li>
<li><p>Search slice jobs specifically after you create them (see subsequent section, <a class="reference internal" href="#ug-job-slice-search"><span class="std std-ref">Search job slices</span></a>)</p></li>
</ul>
</section>
<section id="search-job-slices">
<span id="ug-job-slice-search"></span><h4><span class="section-number">21.3. </span>Search job slices<a class="headerlink" href="#search-job-slices" title="Link to this heading"></a></h4>
<p>To make it easier to find slice jobs, use the Search functionality to apply a search filter to:</p>
<ul class="simple">
<li><p>job lists to show only slice jobs</p></li>
<li><p>job lists to show only parent workflow jobs of job slices</p></li>
<li><p>job templates lists to only show job templates that produce slice jobs</p></li>
</ul>
<p>To show only slice jobs in job lists, as with most cases, you can filter either on the type (jobs here) or <code class="docutils literal notranslate"><span class="pre">unified_jobs</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">/api/v2/jobs/?job_slice_count__gt=1</span>
</pre></div>
</div>
<p>To show only parent workflow jobs of job slices:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">/api/v2/workflow_jobs/?job_template__isnull=false</span>
</pre></div>
</div>
<p>To show only job templates that produce slice jobs:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">/api/v2/job_templates/?job_slice_count__gt=1</span>
</pre></div>
</div>
</section>
</section>
<span id="document-userguide/workflows"></span><section id="workflows">
<span id="ug-workflows"></span><h3><span class="section-number">22. </span>Workflows<a class="headerlink" href="#workflows" title="Link to this heading"></a></h3>
<p id="index-0">Workflows allow you to configure a sequence of disparate job templates (or workflow templates) that may or may not share inventory, playbooks, or permissions. However, workflows have ‘admin’ and ‘execute’ permissions, similar to job templates. A workflow accomplishes the task of tracking the full set of jobs that were part of the release process as a single unit.</p>
<p>Job or workflow templates are linked together using a graph-like structure called nodes. These nodes can be jobs, project syncs, or inventory syncs. A template can be part of different workflows or used multiple times in the same workflow. A copy of the graph structure is saved to a workflow job when you launch the workflow.</p>
<p>The example below shows a workflow that contains all three, as well as a workflow job template:</p>
<img alt="Workflow Node All Scenarios" src="_images/wf-node-all-scenarios-wf-in-wf.png" />
<p>As the workflow runs, jobs are spawned from the node’s linked template. Nodes linking to a job template which has prompt-driven fields (<code class="docutils literal notranslate"><span class="pre">job_type</span></code>, <code class="docutils literal notranslate"><span class="pre">job_tags</span></code>, <code class="docutils literal notranslate"><span class="pre">skip_tags</span></code>, <code class="docutils literal notranslate"><span class="pre">limit</span></code>) can contain those fields, and will not be prompted on launch. Job templates with promptable credential and/or inventory, WITHOUT defaults, will not be available for inclusion in a workflow.</p>
<section id="workflow-scenarios-and-considerations">
<h4><span class="section-number">22.1. </span>Workflow scenarios and considerations<a class="headerlink" href="#workflow-scenarios-and-considerations" title="Link to this heading"></a></h4>
<p>Consider the following scenarios for building workflows:</p>
<ul class="simple">
<li><p>A root node is set to ALWAYS by default and it not editable.</p></li>
</ul>
<img alt="Root Node Always" src="_images/wf-root-node-always.png" />
<ul class="simple">
<li><p>A node can have multiple parents and children may be linked to any of the states of success, failure, or always. If always, then the state is neither success or failure. States apply at the node level, not at the workflow job template level. A workflow job will be marked as successful unless it is canceled or encounters an error.</p></li>
</ul>
<img alt="Sibling Nodes All Edge Types" src="_images/wf-sibling-nodes-all-edge-types.png" />
<ul class="simple">
<li><p>If you remove a job or workflow template within the workflow, the node(s) previously connected to those deleted, automatically get connected upstream and retains its edge type as in the example below:</p></li>
</ul>
<img alt="Node Delete Scenario" src="_images/wf-node-delete-scenario.png" />
<ul class="simple">
<li><p>You could have a convergent workflow, where multiple jobs converge into one. In this scenario, any of the jobs or all of them must complete before the next one runs, as shown in the example below:</p></li>
</ul>
<img alt="Node Convergence" src="_images/wf-node-convergence.png" />
<p>In the example provided, AWX runs the first two job templates in parallel. When they both finish and succeed as specified, the 3rd downstream (<a class="reference internal" href="index.html#convergence-node"><span class="std std-ref">convergence node</span></a>), will trigger.</p>
<ul class="simple">
<li><p>Prompts for inventory and surveys will apply to workflow nodes in workflow job templates.</p></li>
<li><p>If you launch from the API, running a <code class="docutils literal notranslate"><span class="pre">get</span></code> command displays a list of warnings and highlights missing components. The basic workflow for a workflow job template is illustrated below.</p></li>
</ul>
<img alt="Workflow Diagram" src="_images/workflow-diagram.png" />
<ul class="simple">
<li><p>It is possible to launch several workflows simultaneously, and set a schedule for when to launch them. You can set notifications on workflows, such as when a job completes, similar to that of job templates.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Job slicing is intended to scale job executions horizontally. Enabling job slicing on a job template divides an inventory to be acted upon in the number of slices configured at launch time and then starts a job for each slice.</p>
<p>It is expected that the number of slices will be equal to or less than the number of controller nodes. Setting an extremely high number of job slices (e.g., thousands), while allowed, can cause performance degradation as the job scheduler is not designed to schedule simultaneously thousands of workflow nodes, which are what the sliced jobs become.</p>
</div>
<ul class="simple">
<li><p>You can build a recursive workflow, but if AWX detects an error, it will stop at the time the nested workflow attempts to run.</p></li>
<li><p>Artifacts gathered in jobs in the sub-workflow will be passed to downstream nodes.</p></li>
<li><p>An inventory can be set at the workflow level, or prompt for inventory on launch.</p></li>
<li><p>When launched, all job templates in the workflow that have <code class="docutils literal notranslate"><span class="pre">ask_inventory_on_launch=true</span></code> will use the workflow level inventory.</p></li>
<li><p>Job templates that do not prompt for inventory will ignore the workflow inventory and run against their own inventory.</p></li>
<li><p>If a workflow prompts for inventory, schedules and other workflow nodes may provide the inventory.</p></li>
<li><p>In a workflow convergence scenario, <code class="docutils literal notranslate"><span class="pre">set_stats</span></code> data will be merged in an undefined way, so it is recommended that you set unique keys.</p></li>
</ul>
</section>
<section id="extra-variables">
<h4><span class="section-number">22.2. </span>Extra Variables<a class="headerlink" href="#extra-variables" title="Link to this heading"></a></h4>
<p id="index-1">Also similar to job templates, workflows use surveys to specify variables to be used in the playbooks in the workflow, called extra_vars. Survey variables are combined with extra_vars defined on the workflow job template, and saved to the workflow job extra_vars. extra_vars in the workflow job are combined with job template variables when spawning jobs within the workflow.</p>
<p>Workflows utilize the same behavior (hierarchy) of variable precedence as Job Templates with the exception of three additional variables. Refer to the Variable Precedence Hierarchy in the <a class="reference internal" href="index.html#ug-jobtemplates-extravars"><span class="std std-ref">Extra Variables</span></a> section of the Job Templates chapter of this guide. The three additional variables include:</p>
<img alt="Variable Precedence Hierarchy" src="_images/Architecture-AWX_Variable_Precedence_Hierarchy-Workflows.png" />
<p>Workflows included in a workflow will follow the same variable precedence - they will only inherit variables if they are specifically prompted for, or defined as part of a survey.</p>
<p>In addition to the workflow <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code>, jobs and workflows ran as part of a workflow can inherit variables in the artifacts dictionary of a parent job in the workflow (also combining with ancestors further upstream in its branch). These can be defined by the <code class="docutils literal notranslate"><span class="pre">set_stats</span></code> <a class="reference external" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/set_stats_module.html">Ansible module</a>.</p>
<p>If you use the <code class="docutils literal notranslate"><span class="pre">set_stats</span></code> module in your playbook, you can produce results that can be consumed downstream by another job, for example, notify users as to the success or failure of an integration run. In this example, there are two playbooks that can be combined in a workflow to exercise artifact passing:</p>
<ul class="simple">
<li><p><strong>invoke_set_stats.yml</strong>: first playbook in the workflow:</p></li>
</ul>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">localhost</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Artifact</span><span class="nv"> </span><span class="s">integration</span><span class="nv"> </span><span class="s">test</span><span class="nv"> </span><span class="s">results</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">web&quot;</span>
<span class="w">      </span><span class="nt">local_action</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;shell</span><span class="nv"> </span><span class="s">curl</span><span class="nv"> </span><span class="s">-F</span><span class="nv"> </span><span class="s">&quot;file=@integration_results.txt&quot;</span><span class="nv"> </span><span class="s">https://file.io&#39;</span>
<span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">result</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Artifact</span><span class="nv"> </span><span class="s">URL</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">test</span><span class="nv"> </span><span class="s">results</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">Workflows&quot;</span>
<span class="w">      </span><span class="nt">set_stats</span><span class="p">:</span>
<span class="w">        </span><span class="nt">data</span><span class="p">:</span>
<span class="w">          </span><span class="nt">integration_results_url</span><span class="p">:</span><span class="w">  </span><span class="s">&quot;</span><span class="cp">{{</span> <span class="o">(</span><span class="nv">result.stdout</span><span class="o">|</span><span class="nf">from_json</span><span class="o">)</span><span class="nv">.link</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>use_set_stats.yml</strong>: second playbook in the workflow</p></li>
</ul>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">localhost</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Get</span><span class="nv"> </span><span class="s">test</span><span class="nv"> </span><span class="s">results</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">web&quot;</span>
<span class="w">      </span><span class="nt">uri</span><span class="p">:</span>
<span class="w">        </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">integration_results_url</span> <span class="cp">}}</span><span class="s">&quot;</span>
<span class="w">        </span><span class="nt">return_content</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">register</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">results</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Output</span><span class="nv"> </span><span class="s">test</span><span class="nv"> </span><span class="s">results&quot;</span>
<span class="w">      </span><span class="nt">debug</span><span class="p">:</span>
<span class="w">        </span><span class="nt">msg</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">results.content</span> <span class="cp">}}</span><span class="s">&quot;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">set_stats</span></code> module processes this workflow as follows:</p>
<ol class="arabic simple">
<li><p>The contents of an integration results (example: integration_results.txt below) is first uploaded to the web.</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">the tests are passing!</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Through the <strong>invoke_set_stats</strong> playbook, <code class="docutils literal notranslate"><span class="pre">set_stats</span></code> is then invoked to artifact the URL of the uploaded integration_results.txt into the Ansible variable “integration_results_url”.</p></li>
<li><p>The second playbook in the workflow consumes the Ansible extra variable “integration_results_url”. It calls out to the web using the <code class="docutils literal notranslate"><span class="pre">uri</span></code> module to get the contents of the file uploaded by the previous Job Template Job. Then, it simply prints out the contents of the gotten file.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For artifacts to work, keep the default setting, <code class="docutils literal notranslate"><span class="pre">per_host</span> <span class="pre">=</span> <span class="pre">False</span></code> in the <code class="docutils literal notranslate"><span class="pre">set_stats</span></code> module.</p>
</div>
</section>
<section id="workflow-states">
<h4><span class="section-number">22.3. </span>Workflow States<a class="headerlink" href="#workflow-states" title="Link to this heading"></a></h4>
<p>The workflow job can have the following states (no Failed state):</p>
<ul class="simple">
<li><p>Waiting</p></li>
<li><p>Running</p></li>
<li><p>Success (finished)</p></li>
<li><p>Cancel</p></li>
<li><p>Error</p></li>
<li><p>Failed</p></li>
</ul>
<p>In the workflow scheme, canceling a job cancels the branch, while canceling the workflow job cancels the entire workflow.</p>
</section>
<section id="role-based-access-controls">
<h4><span class="section-number">22.4. </span>Role-Based Access Controls<a class="headerlink" href="#role-based-access-controls" title="Link to this heading"></a></h4>
<p>To edit and delete a workflow job template, you must have the admin role. To create a workflow job template, you must be an organization admin or a system admin. However, you can run a workflow job template that contains job templates you don’t have permissions for. Similar to projects, organization admins can create a blank workflow and then grant an ‘admin_role’ to a low-level user, after which they can go about delegating more access and building the graph. You must have execute access to a job template to add it to a workflow job template.</p>
<p>Other tasks such as the ability to make a duplicate copy and re-launch a workflow can also be performed, depending on what kinds of permissions are granted to a particular user. Generally, you should have permissions to all the resources used in a workflow (like job templates) before relaunching or making a copy.</p>
<p>For more information on performing the tasks described in this section, refer to the <a class="reference internal" href="index.html#ag-start"><span class="std std-ref">Administration Guide</span></a>.</p>
</section>
</section>
<span id="document-userguide/workflow_templates"></span><section id="workflow-job-templates">
<span id="ug-wf-templates"></span><h3><span class="section-number">23. </span>Workflow Job Templates<a class="headerlink" href="#workflow-job-templates" title="Link to this heading"></a></h3>
<p id="index-0">A <a class="reference internal" href="index.html#term-Workflow-Job-Template"><span class="xref std std-term">workflow job template</span></a> links together a sequence of disparate resources that accomplishes the task of tracking the full set of jobs that were part of the release process as a single unit. These resources may include:</p>
<ul class="simple">
<li><p>job templates</p></li>
<li><p>workflow templates</p></li>
<li><p>project syncs</p></li>
<li><p>inventory source syncs</p></li>
</ul>
<p>The <strong>Templates</strong> menu opens a list of the workflow and job templates that are currently available. The default view is collapsed (Compact), showing the template name, template type, and the statuses of the jobs that ran using that template, but you can click <strong>Expanded</strong> to view more information. This list is sorted alphabetically by name, but you can sort by other criteria, or search by various fields and attributes of a template. From this screen, you can launch (<img alt="Workflow template launch button." src="_images/launch-button.png" />), edit (<img alt="Edit node details icon." src="_images/edit-button.png" />), and copy (<img alt="Copy button." src="_images/copy-button.png" />) a workflow job template.</p>
<p>Only workflow templates have the Workflow Visualizer icon (<img alt="Workflow vizualizer icon" src="_images/wf-viz-icon.png" />) as a shortcut for accessing the workflow editor.</p>
<p><img alt="Job templates list view with example of workflow template and arrow pointing to the Workflow vizualizer icon." src="_images/wf-templates-home-with-example-wf-template.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Workflow templates can be used as building blocks for another workflow template. Many parameters in a workflow template allow you to enable <strong>Prompt on Launch</strong> that can be modified at the workflow job template level, and do not affect the values assigned at the individual workflow template level. For instructions, see the <a class="reference internal" href="#ug-wf-editor"><span class="std std-ref">Workflow Visualizer</span></a> section.</p>
</div>
<section id="create-a-workflow-template">
<h4><span class="section-number">23.1. </span>Create a Workflow Template<a class="headerlink" href="#create-a-workflow-template" title="Link to this heading"></a></h4>
<p>To create a new workflow job template:</p>
<ol class="arabic simple">
<li><p>Click the <img alt="Create new template Add drop-down options." src="_images/add-options-template.png" /> button then select <strong>Workflow Template</strong> from the menu list.</p></li>
</ol>
<p><img alt="Create new workflow template form." src="_images/wf-templates-create-new-wf-template.png" /></p>
<ol class="arabic simple" start="2">
<li><p>Enter the appropriate details into the following fields:</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a field has the <strong>Prompt on launch</strong> checkbox selected, launching the workflow template, or when the workflow template is used within another workflow template, it will prompt for the value for that field upon launch. Most prompted values will override any values set in the workflow job template; exceptions are noted below.</p>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 47%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Options</p></th>
<th class="head"><p>Prompt on Launch</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Name</strong></p></td>
<td><p>Enter a name for the job.</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Description</strong></p></td>
<td><p>Enter an arbitrary description as appropriate (optional).</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td><p><strong>Organization</strong></p></td>
<td><p>Choose the organization to be used with this template from the organizations available to the currently logged in user.</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Inventory</strong></p></td>
<td><p>Optionally choose the inventory to be used with this template from the inventories available to the currently logged in user.</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><strong>Limit</strong></p></td>
<td><p>A host pattern to further constrain the list of hosts managed or affected by the playbook. Multiple patterns can be separated by colons (<code class="docutils literal notranslate"><span class="pre">:</span></code>). As with core Ansible, <code class="docutils literal notranslate"><span class="pre">a:b</span></code> means “in group a or b”, <code class="docutils literal notranslate"><span class="pre">a:b:&amp;c</span></code> means “in a or b but must be in c”, and <code class="docutils literal notranslate"><span class="pre">a:!b</span></code> means “in a, and definitely not in b”. For more information and examples refer to <a class="reference external" href="https://docs.ansible.com/ansible/latest/inventory_guide/intro_patterns.html">Patterns</a> in the Ansible documentation.</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Source control branch</strong></p></td>
<td><p>Select a branch for the workflow. This branch is applied to all workflow job template nodes that prompt for a branch.</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><strong>Labels</strong></p></td>
<td><ul class="simple">
<li><p>Optionally supply labels that describe this workflow job template, such as “dev” or “test”. Labels can be used to group and filter workflow job templates and completed jobs in the display.</p></li>
<li><p>Labels are created when they are added to the workflow template. Labels are associated to a single Organization using the Project that is provided in the workflow template. Members of the Organization can create labels on a workflow template if they have edit permissions (such as an admin role).</p></li>
<li><p>Once the workflow template is saved, the labels appear in the WFJT’s Details view.</p></li>
<li><p>Click the (<img alt="x button" src="_images/x-button.png" />) beside a label to remove it. When a label is removed, it is no longer associated with that particular workflow template, but it will remain associated with any other jobs or job templates that reference it.</p></li>
<li><p>Labels are only applied to the workflow templates not the job template nodes that are used in the workflow.</p></li>
</ul>
</td>
<td><ul class="simple">
<li><p>Yes. If selected, even if a default value is supplied, you will be prompted upon launch to supply additional labels if needed.</p></li>
<li><p>You will not be able to delete existing labels - clicking (<img alt="x delete button" src="_images/x-delete-button.png" />) only removes the newly added labels, not existing default labels.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Variables</strong></p></td>
<td><ul class="simple">
<li><p>Pass extra command line variables to the playbook. This is the “-e” or “–extra-vars” command line parameter for ansible-playbook that is documented in the Ansible documentation at <a class="reference external" href="https://docs.ansible.com/ansible/latest/reference_appendices/general_precedence.html">Passing Variables on the Command Line</a>.</p></li>
<li><p>Provide key/value pairs using either YAML or JSON. These variables have a maximum value of precedence and overrides other variables specified elsewhere. An example value might be:</p></li>
</ul>
<blockquote>
<div><div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">git_branch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">production</span>
<span class="nt">release_version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.5</span>
</pre></div>
</div>
</div></blockquote>
</td>
<td><ul class="simple">
<li><p>Yes. If you want to be able to specify <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code> on a schedule, you must select <strong>Prompt on Launch</strong> for <strong>Variables</strong> on the workflow job template, or a enable a survey on the workflow job template, then those answered survey questions become <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code>.</p></li>
<li><p>For more information about extra variables, refer to <a class="reference internal" href="#ug-wf-templates-extravars"><span class="std std-ref">Extra Variables</span></a>.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><strong>Job Tags</strong></p></td>
<td><p>Begin typing and selecting the <strong>Create x</strong> drop-down to specify which parts of the playbook should be executed.</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Skip Tags</strong></p></td>
<td><p>Begin typing and selecting the <strong>Create x</strong> drop-down to specify certain tasks or parts of the playbook to skip.</p></td>
<td><p>Yes</p></td>
</tr>
</tbody>
</table>
<p>For more information about <strong>Job Tags</strong> and <strong>Skip Tags</strong>, refer to <a class="reference external" href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_tags.html">Tags</a> in the Ansible documentation.</p>
<ol class="arabic simple" start="3">
<li><p><strong>Options</strong>: Specify options for launching this workflow job template, if necessary.</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>Check <strong>Enable Webhooks</strong> to turn on the ability to interface with a predefined SCM system web service that is used to launch a workflow job template. Currently supported SCM systems are GitHub and GitLab.</p></li>
</ul>
</div></blockquote>
<blockquote id="ug-wfjt-enable-webhooks">
<div><p>If you enable webhooks, other fields display, prompting for additional information:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Webhook Service</strong>: Select which service to listen for webhooks from</p></li>
<li><p><strong>Webhook Credential</strong>: Optionally, provide a GitHub or GitLab personal access token (PAT) as a credential to use to send status updates back to the webhook service. Before you can select it, the credential must exist. See <a class="reference internal" href="index.html#ug-credentials-cred-types"><span class="std std-ref">Credential Types</span></a> to create one.</p></li>
</ul>
<p>Upon <strong>Save</strong>, additional fields populate and the Workflow Visualizer automatically opens.</p>
<ul class="simple">
<li><p><strong>Webhook URL</strong>: Automatically populated with the URL for the webhook service to POST requests to.</p></li>
<li><p><strong>Webhook Key</strong>: Generated shared secret to be used by the webhook service to sign payloads sent to AWX. This must be configured in the settings on the webhook service in order for AWX to accept webhooks from this service.</p></li>
</ul>
<p>For additional information on setting up webhooks, see <a class="reference internal" href="index.html#ug-webhooks"><span class="std std-ref">Working with Webhooks</span></a>.</p>
</div></blockquote>
<ul class="simple">
<li><p>Check <strong>Enable Concurrent Jobs</strong> to allow simultaneous runs of this workflow. Refer to <a class="reference internal" href="index.html#ug-job-concurrency"><span class="std std-ref">AWX Capacity Determination and Job Impact</span></a> for additional information.</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>When you have completed configuring the workflow template, click <strong>Save</strong>.</p></li>
</ol>
<p>Saving the template exits the workflow template page and the Workflow Visualizer opens to allow you to build a workflow. See the <a class="reference internal" href="#ug-wf-editor"><span class="std std-ref">Workflow Visualizer</span></a> section for further instructions. Otherwise, you may close the Workflow Visualizer to return to the Details tab of the newly saved template in order to review, edit, add permissions, notifications, schedules, and surveys, or view completed jobs and build a workflow template at a later time. Alternatively, you can click <strong>Launch</strong> to launch the workflow, but you must first save the template prior to launching, otherwise, the <strong>Launch</strong> button remains grayed-out. Also, note the <strong>Notifications</strong> tab is present only after the template has been saved.</p>
<img alt="Details tab of the newly created workflow template." src="_images/wf-templates-wf-template-saved.png" />
</section>
<section id="work-with-permissions">
<h4><span class="section-number">23.2. </span>Work with Permissions<a class="headerlink" href="#work-with-permissions" title="Link to this heading"></a></h4>
<p>Clicking on <strong>Access</strong> allows you to review, grant, edit, and remove associated permissions for users as well as team members.</p>
<img alt="Access tab of the newly created workflow template showing two user roles and their permissions." src="_images/wf-template-completed-permissions-view.png" />
<p>Click the <strong>Add</strong> button to create new permissions for this workflow template by following the prompts to assign them accordingly.</p>
</section>
<section id="work-with-notifications">
<h4><span class="section-number">23.3. </span>Work with Notifications<a class="headerlink" href="#work-with-notifications" title="Link to this heading"></a></h4>
<p>Clicking on <strong>Notifications</strong> allows you to review any notification integrations you have setup. The <strong>Notifications</strong> tab is present only after the template has been saved.</p>
<img alt="Notifications tab of the newly created workflow template showing four notification configurations with one notification set for Approval." src="_images/wf-template-completed-notifications-view.png" />
<p>Use the toggles to enable or disable the notifications to use with your particular template. For more detail, see <a class="reference internal" href="index.html#ug-notifications-on-off"><span class="std std-ref">Enable and Disable Notifications</span></a>.</p>
<p>If no notifications have been set up, see <a class="reference internal" href="index.html#ug-notifications-create"><span class="std std-ref">Create a Notification Template</span></a> for detail.</p>
<img alt="Notifications tab of the newly created workflow template showing no notifications set up." src="_images/wf-template-no-notifications-blank.png" />
<p>Refer to <a class="reference internal" href="index.html#ug-notifications-types"><span class="std std-ref">Notification Types</span></a> for additional details on configuring various notification types.</p>
</section>
<section id="view-completed-jobs">
<h4><span class="section-number">23.4. </span>View Completed Jobs<a class="headerlink" href="#view-completed-jobs" title="Link to this heading"></a></h4>
<p>The <strong>Completed Jobs</strong> tab provides the list of workflow templates that have ran. Click <strong>Expanded</strong> to view the various details of each job.</p>
<img alt="Jobs tab of the example workflow template showing completed jobs." src="_images/wf-template-completed-jobs-list.png" />
<p>From this view, you can click the job ID - name of the workflow job and see its graphical representation. The example below shows the job details of a workflow job.</p>
<img alt="Details of the job output for the selected workflow template by job ID" src="_images/wf-template-jobID-detail-example.png" />
<p>The nodes are marked with labels that help you identify them at a glance. See the <a class="reference internal" href="#legend">legend</a> in the <a class="reference internal" href="#ug-wf-editor"><span class="std std-ref">Workflow Visualizer</span></a> section for more information.</p>
</section>
<section id="work-with-schedules">
<h4><span class="section-number">23.5. </span>Work with Schedules<a class="headerlink" href="#work-with-schedules" title="Link to this heading"></a></h4>
<p id="index-1">Clicking on <strong>Schedules</strong> allows you to review any schedules set up for this template.</p>
<section id="schedule-a-workflow-template">
<h5><span class="section-number">23.5.1. </span>Schedule a Workflow Template<a class="headerlink" href="#schedule-a-workflow-template" title="Link to this heading"></a></h5>
<p id="index-2">To schedule a wokflow job template run, click the <strong>Schedules</strong> tab.</p>
<ul class="simple">
<li><p>If schedules are already set up; review, edit, or enable/disable your schedule preferences.</p></li>
<li><p>If schedules have not been set up, refer to <a class="reference internal" href="index.html#ug-scheduling"><span class="std std-ref">Schedules</span></a> for more information.</p></li>
</ul>
<p>If a workflow template used in a nested workflow has a survey, or the <strong>Prompt on Launch</strong> selected for the inventory option, the <strong>PROMPT</strong> button displays next to the <strong>SAVE</strong> and <strong>CANCEL</strong> buttons on the schedule form. Clicking the <strong>PROMPT</strong> button shows an optional INVENTORY step where you can provide or remove an inventory or skip this step without any changes.</p>
</section>
</section>
<section id="surveys">
<span id="ug-wf-surveys"></span><h4><span class="section-number">23.6. </span>Surveys<a class="headerlink" href="#surveys" title="Link to this heading"></a></h4>
<p id="index-3">Workflows containing job types of Run or Check provide a way to set up surveys in the Workflow Job Template creation or editing screens. Surveys set extra variables for the playbook similar to ‘Prompt for Extra Variables’ does, but in a user-friendly question and answer way. Surveys also allow for validation of user input. Click the <strong>Survey</strong> tab to create a survey.</p>
<p>Use cases for surveys are numerous. An example might be if operations wanted to give developers a “push to stage” button they could run without advanced Ansible knowledge. When launched, this task could prompt for answers to questions such as, “What tag should we release?”</p>
<p>Many types of questions can be asked, including multiple-choice questions.</p>
<section id="create-a-survey">
<span id="ug-wf-surveys-create"></span><h5><span class="section-number">23.6.1. </span>Create a Survey<a class="headerlink" href="#create-a-survey" title="Link to this heading"></a></h5>
<p id="index-4">To create a survey:</p>
<ol class="arabic simple">
<li><p>Click the <strong>Survey</strong> tab to bring up the <strong>Add Survey</strong> window.</p></li>
</ol>
<img alt="Workflow Job Template showing the Create survey form." src="_images/wf-template-create-survey.png" />
<p>Use the <strong>ON/OFF</strong> toggle button at the top of the screen to quickly activate or deactivate this survey prompt.</p>
<ol class="arabic simple" start="2">
<li><p>A survey can consist of any number of questions. For each question, enter the following information:</p></li>
</ol>
<ul class="simple">
<li><p><strong>Name</strong>: The question to ask the user.</p></li>
<li><p><strong>Description</strong>: (optional) A description of what’s being asked of the user.</p></li>
<li><p><strong>Answer Variable Name</strong>: The Ansible variable name to store the user’s response in. This is the variable to be used by the playbook. Variable names cannot contain spaces.</p></li>
<li><p><strong>Answer Type</strong>: Choose from the following question types.</p>
<ul>
<li><p><em>Text</em>: A single line of text. You can set the minimum and maximum length (in characters) for this answer.</p></li>
<li><p><em>Textarea</em>: A multi-line text field. You can set the minimum and maximum length (in characters) for this answer.</p></li>
<li><p><em>Password</em>: Responses are treated as sensitive information, much like an actual password is treated. You can set the minimum and maximum length (in characters) for this answer.</p></li>
<li><p><em>Multiple Choice (single select)</em>: A list of options, of which only one can be selected at a time. Enter the options, one per line, in the <strong>Multiple Choice Options</strong> box.</p></li>
<li><p><em>Multiple Choice (multiple select)</em>: A list of options, any number
of which can be selected at a time. Enter the options, one per
line, in the <strong>Multiple Choice Options</strong> box.</p></li>
<li><p><em>Integer</em>: An integer number. You can set the minimum and maximum length (in characters) for this answer.</p></li>
<li><p><em>Float</em>: A decimal number. You can set the minimum and maximum length (in characters) for this answer.</p></li>
</ul>
</li>
<li><p><strong>Default Answer</strong>: Depending on which type chosen, you can supply the default answer to the question. This value is pre-filled in the interface and is used if the answer is not provided by the user.</p></li>
<li><p><strong>Required</strong>: Whether or not an answer to this question is required from the user.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Once you have entered the question information, click the <strong>Add</strong> button to add the question.</p></li>
</ol>
<p>A stylized version of the survey is presented in the Preview pane. For any question, you can click on the <strong>Edit</strong> button to edit the question, the <strong>Delete</strong> button to delete the question, and click and drag on the grid icon to rearrange the order of the questions.</p>
<ol class="arabic simple" start="4">
<li><p>Return to the left pane to add additional questions.</p></li>
<li><p>When done, click <strong>Save</strong> to save the survey.</p></li>
</ol>
<p><img alt="Workflow Job Template showing completed survey and arrows pointing to the re-ordering icons." src="_images/wf-template-completed-survey.png" /></p>
</section>
<section id="optional-survey-questions">
<h5><span class="section-number">23.6.2. </span>Optional Survey Questions<a class="headerlink" href="#optional-survey-questions" title="Link to this heading"></a></h5>
<p id="index-5">The <strong>Required</strong> setting on a survey question determines whether the answer is optional or not for the user interacting with it.</p>
<p>Behind the scenes, optional survey variables can be passed to the playbook in <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code>, even when they aren’t filled in.</p>
<ul class="simple">
<li><p>If a non-text variable (input type) is marked as optional, and is not filled in, no survey <code class="docutils literal notranslate"><span class="pre">extra_var</span></code> is passed to the playbook.</p></li>
<li><p>If a text input or text area input is marked as optional, is not filled in, and has a minimum <code class="docutils literal notranslate"><span class="pre">length</span> <span class="pre">&gt;</span> <span class="pre">0</span></code>, no survey <code class="docutils literal notranslate"><span class="pre">extra_var</span></code> is passed to the playbook.</p></li>
<li><p>If a text input or text area input is marked as optional, is not filled in, and has a minimum <code class="docutils literal notranslate"><span class="pre">length</span> <span class="pre">===</span> <span class="pre">0</span></code>, that survey <code class="docutils literal notranslate"><span class="pre">extra_var</span></code> is passed to the playbook, with the value set to an empty string ( “” ).</p></li>
</ul>
</section>
</section>
<section id="workflow-visualizer">
<span id="ug-wf-editor"></span><h4><span class="section-number">23.7. </span>Workflow Visualizer<a class="headerlink" href="#workflow-visualizer" title="Link to this heading"></a></h4>
<p id="index-6">The Workflow Visualizer provides a graphical way of linking together job templates, workflow templates, project syncs, and inventory syncs to build a workflow template. Before building a workflow template, refer to the <a class="reference internal" href="index.html#ug-workflows"><span class="std std-ref">Workflows</span></a> section for considerations associated with various scenarios on parent, child, and sibling nodes.</p>
<section id="build-a-workflow">
<h5><span class="section-number">23.7.1. </span>Build a Workflow<a class="headerlink" href="#build-a-workflow" title="Link to this heading"></a></h5>
<p>You can set up any combination of two or more of the following node types to build a workflow: Template (Job Template or Workflow Job Template), Project Sync, Inventory Sync, or Approval. Each node is represented by a rectangle while the relationships and their associated edge types are represented by a line (or link) that connects them.</p>
<ol class="arabic simple">
<li><p>In the details/edit view of a workflow template, click the <strong>Visualizer</strong> tab or from the Templates list view, click the (<img alt="Workflow vizualizer icon" src="_images/wf-viz-icon.png" />) icon to launch the Workflow Visualizer.</p></li>
</ol>
<img alt="Workflow Visualizer start page." src="_images/wf-editor-create-new.png" />
<ol class="arabic simple" start="2">
<li><p>Click the <img alt="Workflow Visualizer Start button." src="_images/wf-start-button.png" /> button to display a list of nodes to add to your workflow.</p></li>
</ol>
<img alt="Workflow Visualizer wizard, step 1 specifying the node type." src="_images/wf-editor-create-new-add-template-list.png" />
<ol class="arabic simple" start="3">
<li><p>On the right pane, select the type of node you want to add from the drop-down menu:</p></li>
</ol>
<img alt="Node type showing the drop-down menu of node type options." src="_images/wf-add-node-selections.png" />
<p>If selecting an <strong>Approval</strong> node, see <a class="reference internal" href="#ug-wf-approval-nodes"><span class="std std-ref">Approval nodes</span></a> for further detail.</p>
<p>Selecting a node provides the available valid options associated with it.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you select a job template that does not have a default inventory when populating a workflow graph, the inventory of the parent workflow will be used. Though a credential is not required in a job template, you will not be able to choose a job template for your workflow if it has a credential that requires a password, unless the credential is replaced by a prompted credential.</p>
</div>
<ol class="arabic simple" start="4">
<li><p>Once a node is selected, the workflow begins to build, and you must specify the type of action to be taken for the selected node. This action is also referred to as <em>edge type</em>.</p></li>
<li><p>If the node is a root node, the edge type defaults to <strong>Always</strong> and is non-editable.</p></li>
</ol>
<p>For subsequent nodes, you can select one of the following scenarios (edge type) to apply to each:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Always</strong>: Continue to execute regardless of success or failure.</p></li>
<li><p><strong>On Success</strong>: Upon successful completion, execute the next template.</p></li>
<li><p><strong>On Failure</strong>: Upon failure, execute a different template.</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" id="convergence-node" start="6">
<li><p>Select the behavior of the node if it is a convergent node from the <strong>Convergence</strong> field:</p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p><strong>Any</strong> is the default behavior, allowing <em>any</em> of the nodes to complete as specified, before triggering the next converging node. As long as the status of one parent meets one of those run conditions, an ANY child node will run. In other words, an ANY node requires <strong>all</strong> nodes to complete, but only one node must complete with the expected outcome.</p></li>
<li><p>Choose <strong>All</strong> to ensure that <em>all</em> nodes complete as specified, before converging and triggering the next node. The purpose of ALL nodes is to make sure that every parent met it’s expected outcome in order to run the child node. The workflow checks to make sure every parent behaved as expected in order to run the child node. Otherwise, it will not run the child node.</p></li>
</ul>
<p>If selected, the graphical view will indicate the node type with a representative color. Refer to the legend (<img alt="Workflow Visualizer legend button." src="_images/wf-editor-compass-button.png" />) to see the corresponding run scenario and their job types.</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a node is a root node, or a node that does not have any nodes converging into it, setting the <strong>Convergence</strong> rule does not apply, as its behavior is dictated by the action that triggers it.</p>
</div>
<ol class="arabic simple" start="7">
<li><p>If a job template used in the workflow has <strong>Prompt on Launch</strong> selected for any of its parameters, a <strong>Prompt</strong> button appears, allowing you to change those values at the node level. Use the wizard to change the value(s) in each of the tabs and click <strong>Confirm</strong> in the Preview tab.</p></li>
</ol>
<img alt="Workflow Visualizer wizard with Prompt on Launch options." src="_images/wf-editor-prompt-button-wizard.png" />
<p>Likewise, if a workflow template used in the workflow has <strong>Prompt on Launch</strong> selected for the inventory option, use the wizard to supply the inventory at the prompt. If the parent workflow has its own inventory, it will override any inventory that is supplied here.</p>
<img alt="Workflow Visualizer wizard with Prompt on Launch for Inventory." src="_images/wf-editor-prompt-button-inventory-wizard.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For workflow job templates with promptable fields that are required, but do not have a default, you must provide those values when creating a node before the <strong>Select</strong> button becomes enabled. The two cases that disable the <strong>Select</strong> button until a value is provided via the <strong>Prompt</strong> button: 1) when you select the <strong>Prompt on Launch</strong> checkbox in a workflow job template, but do not provide a default, or 2) when you create a survey question that is required but do not provide a default answer. However, this is <strong>NOT</strong> the case with credentials. Credentials that require a password on launch are <strong>not permitted</strong> when creating a workflow node, since everything needed to launch the node must be provided when the node is created. So, if a workflow job template prompts for credentials, AWX prevents you from being able to select a credential that requires a password.</p>
</div>
<p>Once the node is created, it is labeled with its job type. A template that is associated with each workflow node will run based on the selected run scenario as it proceeds. Click the compass (<img alt="Workflow Visualizer legend button." src="_images/wf-editor-compass-button.png" />) icon to display the legend for each run scenario and their job types.</p>
<span class="target" id="legend"></span><img alt="Workflow Visualizer legend expanded." src="_images/wf-editor-key-dropdown-list.png" />
<ol class="arabic simple" start="8">
<li><p>Hovering over a node allows you to add <img alt="Add node icon." src="_images/wf-editor-add-button.png" /> another node, view info <img alt="View node details icon." src="_images/wf-editor-info-button.png" /> about the node, edit <img alt="Edit node details icon." src="_images/edit-button.png" /> the node details, edit an existing link <img alt="Edit link icon." src="_images/wf-editor-edit-link.png" />, or delete <img alt="Delete node icon." src="_images/wf-editor-delete-button.png" /> the selected node.</p></li>
</ol>
<img alt="Building a new example workflow job template in the Workflow Visualizer" src="_images/wf-editor-create-new-add-template.png" />
<ol class="arabic simple" start="9">
<li><p>When done adding/editing a node, click <strong>Save</strong> to save any modifications and render it on the graphical view. For possible ways to build your workflow, see <a class="reference internal" href="#ug-wf-building-scenarios"><span class="std std-ref">Node building scenarios</span></a>.</p></li>
<li><p>When done with building your workflow template, click <strong>Save</strong> to save your entire workflow template and return to the new workflow template details page.</p></li>
</ol>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Closing the wizard without saving will not save your work, but instead, closes the entire Workflow Visualizer and you will have to start where you last saved.</p>
</div>
<section id="approval-nodes">
<span id="ug-wf-approval-nodes"></span><h6><span class="section-number">23.7.1.1. </span>Approval nodes<a class="headerlink" href="#approval-nodes" title="Link to this heading"></a></h6>
<p>Choosing an <strong>Approval</strong> node requires user intervention in order to advance the workflow. This functions as a means to pause the workflow in between playbooks so that a user can give approval to continue on to the next playbook in the workflow, giving the user a specified amount of time to intervene, but also allows the user to continue as quickly as possible without having to wait on some other trigger.</p>
<img alt="Workflow Visualizer Approval node form." src="_images/wf-node-approval-form.png" />
<p>The default for the timeout is none, but you can specify the length of time before the request expires and automatically gets denied. After selecting and supplying the information for the approval node, it displays on the graphical view with a pause (<img alt="Workflow node - approval icon." src="_images/wf-node-approval-icon.png" />) icon next to it.</p>
<img alt="Workflow Visualizer showing approval node with pause icon." src="_images/wf-node-approval-node.png" />
<p>The approver is anyone who can execute the workflow job template containing the approval nodes, has org admin or above privileges (for the org associated with that workflow job template), or any user who has the <em>Approve</em> permission explicitly assigned to them within that specific workflow job template.</p>
<img alt="Workflows requesting approval from notifications" src="_images/wf-node-approval-notifications.png" />
<p>If pending approval nodes are not approved within the specified time limit (if an expiration was assigned) or they are denied, then they are marked as “timed out” or “failed”, respectively, and move on to the next “on fail node” or “always node”. If approved, the “on success” path is taken. If you try to POST in the API to a node that has already been approved, denied or timed out, an error message notifies you that this action is redundant, and no further steps will be taken.</p>
<p>Below shows the various levels of permissions allowed on approval workflows:</p>
<img alt="Workflow nodes approval RBAC table." src="_images/wf-node-approval-rbac.png" />
</section>
<section id="node-building-scenarios">
<span id="ug-wf-building-scenarios"></span><h6><span class="section-number">23.7.1.2. </span>Node building scenarios<a class="headerlink" href="#node-building-scenarios" title="Link to this heading"></a></h6>
<p>You can add a sibling node by clicking the <img alt="Add node icon." src="_images/wf-editor-add-button.png" /> on the parent node:</p>
<img alt="Workflow Visualizer showing how to create a sibling node." src="_images/wf-editor-create-sibling-node.png" />
<p>You can insert another node in between nodes by hovering over the line that connects the two until the <img alt="Add node icon." src="_images/wf-editor-add-button.png" /> appears. Clicking on the <img alt="Add node icon." src="_images/wf-editor-add-button.png" /> automatically inserts the node between the two nodes.</p>
<img alt="Workflow Visualizer showing how to insert a node." src="_images/wf-editor-insert-node-template.png" />
<p>To add a root node to depict a split scenario, click the <img alt="Workflow Visualizer Start button." src="_images/wf-start-button.png" /> button again:</p>
<img alt="Workflow Visualizer showing how depict a split scnario." src="_images/wf-editor-create-new-add-template-split.png" />
<p>At any node where you want to create a split scenario, hover over the node from which the split scenario begins and click the <img alt="Add node icon." src="_images/wf-editor-add-button.png" />. This essentially adds multiple nodes from the same parent node, creating sibling nodes:</p>
<img alt="Workflow Visualizer showing how to create sibling nodes." src="_images/wf-editor-create-siblings.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When adding a new node, the <strong>PROMPT</strong> button applies to workflow templates as well. Workflow templates will prompt for inventory and surveys.</p>
</div>
<p>If you want to undo the last inserted node, click on another node without making a selection from the right pane. Or, click <strong>Cancel</strong> from the right pane.</p>
<p>Below is an example of a workflow that contains all three types of jobs that is initiated by a job template that if it fails to run, proceed to the project sync job, and regardless of whether that fails or succeeds, proceed to the inventory sync job.</p>
<img alt="Workflow Visualizer showing a workflow job that contains a job template, a project, and an inventory source." src="_images/wf-editor-create-new-add-template-example.png" />
<p>Remember to refer to the Legend at the top of the window to identify the meaning of the symbols and colors associated with the graphical depiction.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In a workflow with a set of sibling nodes having varying edge types, and you remove a node that has a follow-on node attached to it, the attached node automatically joins the set of sibling nodes and retains its edge type:</p>
<img alt="Workflow Visualizer showing a workflow job with a deleted node." src="_images/wf-node-delete-scenario.png" />
</div>
<p>The following ways you can modify your nodes:</p>
<ul class="simple">
<li><p>If you want to edit a node, click on the node you want to edit. The right pane displays the current selections. Make your changes and click <strong>Select</strong> to apply them to the graphical view.</p></li>
<li><p>To edit the edge type for an existing link (success/failure/always), click on the link. The right pane displays the current selection. Make your changes and click <strong>Save</strong> to apply them to the graphical view.</p></li>
</ul>
<blockquote>
<div><img alt="Workflow Visualizer showing the wizard to edit the link." src="_images/wf-editor-wizard-edit-link.png" />
</div></blockquote>
<ul class="simple">
<li><p>To add a new link from one node to another, click the link <img alt="Edit link icon." src="_images/wf-editor-edit-link.png" /> icon that appears on each node. Doing this highlights the nodes that are possible to link to. These feasible options are indicated by the dotted lines. Invalid options are indicated by grayed out boxes (nodes) that would otherwise produce an invalid link. The example below shows the <strong>Demo Project</strong> as a possible option for the <strong>e2e-ec20de52-project</strong> to link to, as indicated by the arrows:</p></li>
</ul>
<blockquote>
<div><img alt="Workflow showing linking scenerio between two nodes." src="_images/wf-node-link-scenario.png" />
<p>When linked, specify the type of run scenario you would like the link to have in the Add Link prompt.</p>
<img alt="Workflow Visualizer prompt specifying the run type when adding a new link." src="_images/wf-editor-wizard-add-link-prompt.png" />
</div></blockquote>
<ul class="simple">
<li><p>To remove a link, click the link and click the <strong>Unlink</strong> (<img alt="Delete node icon." src="_images/wf-editor-delete-button.png" />) icon and click <strong>Remove</strong> at the prompt to confirm.</p></li>
</ul>
<blockquote>
<div><img alt="Workflow Visualizer showing the wizard to remove the link." src="_images/wf-editor-wizard-unlink.png" />
</div></blockquote>
<p>This button only appears in the right hand panel if the target or child node has more than one parent. All nodes must be linked to at least one other node at all times so you must create a new link before removing an old one.</p>
<p>Click the Tools icon (<img alt="Workflow Visualizer tools icon." src="_images/tools.png" />) to zoom, pan, or reposition the view. Alternatively, you can drag the workflow diagram to reposition it on the screen or use the scroll on your mouse to zoom.</p>
</section>
</section>
</section>
<section id="launch-a-workflow-template">
<h4><span class="section-number">23.8. </span>Launch a Workflow Template<a class="headerlink" href="#launch-a-workflow-template" title="Link to this heading"></a></h4>
<p id="index-7">Launch a workflow template by any of the following ways:</p>
<ul class="simple">
<li><p>Access the workflow templates list from the <strong>Templates</strong> menu on the left navigation bar or while in the workflow template Details view, scroll to the bottom to access the <img alt="Workflow template launch button." src="_images/launch-button.png" /> button from the list of templates.</p></li>
</ul>
<img alt="Templates list view with arrow pointing to the launch button of the workflow job template." src="_images/wf-templates-wf-template-launch.png" />
<ul class="simple">
<li><p>While in the Workflow Job Template Details view of the job you want to launch, click <strong>Launch</strong>.</p></li>
</ul>
<p>Along with any extra variables set in the workflow job template and survey, AWX automatically adds the same variables as those added for a workflow job template upon launch. Additionally, AWX automatically redirects the web browser to the Jobs Details page for this job, displaying the progress and the results.</p>
<p>Events related to approvals on workflows display at the top in the Activity Stream (<img alt="Activity Stream icon." src="_images/activitystream.png" />) with detailed information about the approval requests, if any.</p>
</section>
<section id="copy-a-workflow-template">
<h4><span class="section-number">23.9. </span>Copy a Workflow Template<a class="headerlink" href="#copy-a-workflow-template" title="Link to this heading"></a></h4>
<p>AWX allows you the ability to copy a workflow template. If you choose to copy a workflow template, it <strong>does not</strong> copy any associated schedule, notifications, or permissions. Schedules and notifications must be recreated by the user or admin creating the copy of the workflow template. The user copying the workflow template will be granted the admin permission, but no permissions are assigned (copied) to the workflow template.</p>
<ol class="arabic simple">
<li><p>Access the workflow template that you want to copy from the <strong>Templates</strong> menu on the left navigation bar or while in the Workflow Job Template Details view, scroll to the bottom to access it from a list of templates.</p></li>
<li><p>Click the <img alt="Copy button." src="_images/copy-button.png" /> button.</p></li>
</ol>
<p>A new template opens with the name of the template from which you copied and a timestamp.</p>
<img alt="Templates list view with example copied workflow." src="_images/wf-list-view-copy-example.png" />
<p>Select the copied template and replace the contents of the <strong>Name</strong> field with a new name, and provide or modify the entries in the other fields to complete this template.</p>
<ol class="arabic simple" start="3">
<li><p>Click <strong>Save</strong> when done.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a resource has a related resource that you don’t have the right level of permission to, you cannot copy the resource, such as in the case where a project uses a credential that a current user only has <em>Read</em> access. However, for a workflow template, if any of its nodes uses an unauthorized job template, inventory, or credential, the workflow template can still be copied. But in the copied workflow template, the corresponding fields in the workflow template node will be absent.</p>
</div>
</section>
<section id="extra-variables">
<span id="ug-wf-templates-extravars"></span><h4><span class="section-number">23.10. </span>Extra Variables<a class="headerlink" href="#extra-variables" title="Link to this heading"></a></h4>
<span class="target" id="index-8"></span><div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">extra_vars</span></code> passed to the job launch API are only honored if one of the following is true:</p>
<ul class="simple">
<li><p>They correspond to variables in an enabled survey</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ask_variables_on_launch</span></code> is set to True</p></li>
</ul>
</div>
<p>When you pass survey variables, they are passed as extra variables (<code class="docutils literal notranslate"><span class="pre">extra_vars</span></code>). This can be tricky, as passing extra variables to a workflow template (as you would do with a survey) can override other variables being passed from the inventory and project.</p>
<p>For example, say that you have a defined variable for an inventory for <code class="docutils literal notranslate"><span class="pre">debug</span> <span class="pre">=</span> <span class="pre">true</span></code>. It is entirely possible that this variable, <code class="docutils literal notranslate"><span class="pre">debug</span> <span class="pre">=</span> <span class="pre">true</span></code>, can be overridden in a workflow template survey.</p>
<p>To ensure that the variables you need to pass are not overridden, ensure they are included by redefining them in the survey. Keep in mind that extra variables can be defined at the inventory, group, and host levels.</p>
<p id="index-9">The following table notes the behavior (hierarchy) of variable precedence in AWX as it compares to variable precedence in Ansible.</p>
<p><strong>Variable Precedence Hierarchy (last listed wins)</strong></p>
<img alt="AWX Variable Precedence Hierarchy for Workflows" src="_images/Architecture-AWX_Variable_Precedence_Hierarchy-Workflows.png" />
</section>
</section>
<span id="document-userguide/instance_groups"></span><section id="instance-groups">
<span id="ug-instance-groups"></span><h3><span class="section-number">24. </span>Instance Groups<a class="headerlink" href="#instance-groups" title="Link to this heading"></a></h3>
<p id="index-0">An <a class="reference internal" href="index.html#term-Instance-Group"><span class="xref std std-term">Instance Group</span></a> provides the ability to group instances in a clustered environment. Additionally, policies dictate how instance groups behave and how jobs are executed. The following view displays the capacity levels based on policy algorithms:</p>
<p><img alt="Instance groups list view showing example instance groups and one with capacity levels" src="_images/instance-groups_list_view.png" /></p>
<p>For more information about the policy or rules associated with instance groups, see the <a class="reference internal" href="index.html#ag-instance-groups"><span class="std std-ref">Instance Groups</span></a> section of the <em>AWX Administration Guide</em>.</p>
<p>If you want to connect your instance group to a container, refer to <a class="reference internal" href="index.html#ag-container-groups"><span class="std std-ref">Container Groups</span></a> for further detail.</p>
<p>For an in-depth discussion on these concepts, refer to the <em>Feature Spotlight: Instance Groups and Isolated Nodes</em> <a class="reference external" href="https://www.ansible.com/blog/ansible-tower-feature-spotlight-instance-groups-and-isolated-nodes">blog</a>.</p>
<section id="create-an-instance-group">
<span id="ug-instance-groups-create"></span><h4><span class="section-number">24.1. </span>Create an instance group<a class="headerlink" href="#create-an-instance-group" title="Link to this heading"></a></h4>
<p>To create a new instance group:</p>
<ol class="arabic simple">
<li><p>Click <strong>Instance Groups</strong> from the left navigation menu to open the Instance Groups configuration window.</p></li>
<li><p>Click <strong>Add</strong> and select <strong>Add instance group</strong>.</p></li>
</ol>
<p><img alt="Create instance group form" src="_images/instance-group-create-new-ig.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Enter the appropriate details into the following fields:</p></li>
</ol>
<ul class="simple">
<li><p><strong>Name</strong>. Names must be unique and must not be named <em>awx</em>.</p></li>
<li><p><strong>Policy instance minimum</strong>. Enter the minimum number of instances to automatically assign to this group when new instances come online.</p></li>
<li><p><strong>Policy instance percentage</strong>. Use the slider to select a minimum percentage of instances to automatically assign to this group when new instances come online.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Policy instance fields are not required to create a new instance group. If you do not specify values, then the Policy instance minimum and Policy instance percentage default to 0.</p>
</div>
<ul class="simple">
<li><p><strong>Max concurrent jobs</strong>. Specify the maximum number of forks that can be run for any given job.</p></li>
<li><p><strong>Max forks</strong>. Specify the maximum number of concurrent jobs that can be run for any given job.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The default value of 0 for <strong>Max concurrent jobs</strong> and <strong>Max forks</strong> denotes no limit. See <a class="reference internal" href="index.html#ag-instancegrp-cpacity"><span class="std std-ref">Instance group capacity limits</span></a> in the <em>AWX Administration Guide</em> for more detail.</p>
</div>
<ol class="arabic simple" start="4">
<li><p>Click <strong>Save</strong>.</p></li>
</ol>
<p>Once the instance group is successfully created, the <strong>Details</strong> tab of the newly created instance group remains, allowing you to review and edit your instance group information. This is the same screen that opens when the <strong>Edit</strong> (<img alt="Edit button" src="_images/edit-button.png" />) button is clicked from the <strong>Instance Groups</strong> list view. You can also edit <strong>Instances</strong> and review <strong>Jobs</strong> associated with this instance group.</p>
<p><img alt="Instance group details showing how to view instances and jobs associated with an instance group" src="_images/instance-group-example-ig-successfully-created.png" /></p>
<section id="associate-instances-to-an-instance-group">
<h5><span class="section-number">24.1.1. </span>Associate instances to an instance group<a class="headerlink" href="#associate-instances-to-an-instance-group" title="Link to this heading"></a></h5>
<p>To associate instances to an instance group:</p>
<ol class="arabic simple">
<li><p>Click the <strong>Instances</strong> tab of the Instance Group window and click the <strong>Associate</strong> button.</p></li>
<li><p>Click the checkbox next to one or more available instances from the list to select the instance(s) you want to associate with the instance group.</p></li>
</ol>
<p><img alt="Associating an instance with an instance group" src="_images/instance-group-assoc-instances.png" /></p>
<ol class="arabic simple" start="3">
<li><p>In the following example, the instances added to the instance group displays along with information about their capacity.</p></li>
</ol>
<p>This view also allows you to edit some key attributes associated with the instances in your instance group:</p>
<p><img alt="Edit attributes associated with instances in an instance group" src="_images/instance-group-instances-example-callouts.png" /></p>
</section>
<section id="view-jobs-associated-with-an-instance-group">
<h5><span class="section-number">24.1.2. </span>View jobs associated with an instance group<a class="headerlink" href="#view-jobs-associated-with-an-instance-group" title="Link to this heading"></a></h5>
<p>To view the jobs associated with the instance group, click the <strong>Jobs</strong> tab of the Instance Group window and then click <strong>Expanded</strong> to expand the view to show details about each job.</p>
<p><img alt="Viewing jobs associated with an instance group" src="_images/instance-group-jobs-list.png" /></p>
<p>Each job displays the job status, ID, and name; type of job, time started and completed, who started the job; and applicable resources associated with it, such as template, inventory, project, execution environment, etc.</p>
<p>The instances are run in accordance with instance group policies. Refer to <a class="reference internal" href="index.html#ag-instance-group-policies"><span class="std std-ref">Instance Group Policies</span></a> in the <em>AWX Administration Guide</em>.</p>
</section>
</section>
</section>
<span id="document-userguide/jobs"></span><section id="jobs">
<span id="ug-jobs"></span><h3><span class="section-number">25. </span>Jobs<a class="headerlink" href="#jobs" title="Link to this heading"></a></h3>
<p id="index-0">A <a class="reference internal" href="index.html#term-Job"><span class="xref std std-term">job</span></a> is an instance of AWX launching an Ansible playbook against an inventory of hosts.</p>
<p>The <strong>Jobs</strong> link displays a list of jobs and their statuses–shown as completed successfully or failed, or as an active (running) job.
The default view is collapsed (<strong>Compact</strong>) with the job name, status, job type, and start/finish times, but you can expand to see more information. You can sort this list by various criteria, and perform a search to filter the jobs of interest.</p>
<p><img alt="Jobs List with Example Jobs" src="_images/jobs-home-with-example-job.png" /></p>
<img alt="Expanded Jobs List" src="_images/jobs-list-all-expanded.png" />
<p>Actions you can take from this screen include viewing the details and standard output of a particular job, relaunching (<img alt="Launch Action Button" src="_images/launch-button.png" />) jobs, or removing selected jobs.The relaunch operation only applies to relaunches of playbook runs and does not apply to project/inventory updates, system jobs, workflow jobs, etc.</p>
<p id="index-1"><span id="ug-job-results"></span>When a job relaunches, you are directed the Jobs Output screen as the job runs. Clicking on any type of job also takes you to the Job Output View for that job, where you can filter jobs by various criteria:</p>
<img alt="Filter options in the Jobs Output window" src="_images/job-details-view-filters.png" />
<ul class="simple">
<li><p>The <strong>Stdout</strong> option is the default display that shows the job processes and output</p></li>
<li><p>The <strong>Event</strong> option allows you to filter by the event(s) of interest, such as errors, host failures, host retries, items skipped, etc. You can include as many events in the filter as necessary.</p></li>
</ul>
<img alt="Selected filter examples from the Jobs Output window" src="_images/job-details-view-filters-examples.png" />
<ul class="simple">
<li><p>The <strong>Advanced</strong> option is a refined search that allows you a combination of including or excluding criteria, searching by key, or by lookup type. For details about using Search, refer to the <a class="reference internal" href="index.html#ug-search"><span class="std std-ref">Search</span></a> chapter.</p></li>
</ul>
<section id="inventory-sync-jobs">
<h4><span class="section-number">25.1. </span>Inventory Sync Jobs<a class="headerlink" href="#inventory-sync-jobs" title="Link to this heading"></a></h4>
<span class="target" id="index-2"></span><p>When an inventory sync is executed, the full results automatically display in the Output tab. This shows the same information you would see if you ran it through the Ansible command line, and can be useful for debugging. The <code class="docutils literal notranslate"><span class="pre">ANSIBLE_DISPLAY_ARGS_TO_STDOUT</span></code> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code> by default for all playbook runs. This matches Ansible’s default behavior. This does not display task arguments in task headers in the Job Detail interface to avoid leaking certain sensitive module parameters to stdout.  If you wish to restore the prior behavior (despite the security implications), you can set <code class="docutils literal notranslate"><span class="pre">ANSIBLE_DISPLAY_ARGS_TO_STDOUT</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> via the <code class="docutils literal notranslate"><span class="pre">AWX_TASK_ENV</span></code> configuration setting. For more details, refer to the <a class="reference external" href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html#envvar-ANSIBLE_DISPLAY_ARGS_TO_STDOUT">ANSIBLE_DISPLAY_ARGS_TO_STDOUT</a>.</p>
<blockquote>
<div></div></blockquote>
<p>The icons at the top right corner of the Output tab allow you to relaunch (<img alt="Launch Action Button" src="_images/launch-button.png" />), download (<img alt="Download Action Button" src="_images/download.png" />) the job output, or delete (<img alt="Delete Action Button" src="_images/delete-button.png" />) the job.</p>
<p><img alt="Example output for a successful Inventory Sync job" src="_images/jobs-show-job-results-for-inv-sync.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An inventory update can be performed while a related job is running. In cases where you have a big project (around 10 GB), disk space on <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> may be an issue.</p>
</div>
<section id="inventory-sync-details">
<h5><span class="section-number">25.1.1. </span>Inventory sync details<a class="headerlink" href="#inventory-sync-details" title="Link to this heading"></a></h5>
<p>Access the <strong>Details</strong> tab to provide details about the job execution.</p>
<img alt="Example details for an Inventory Sync job" src="_images/jobs-show-job-details-for-inv-sync.png" />
<p>Notable details of the job executed are:</p>
<ul>
<li><p><strong>Status</strong>: Can be any of the following:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Pending</strong> - The inventory sync has been created, but not queued or started yet. Any job, not just inventory source syncs, will stay in pending until it’s actually ready to be run by the system.  Reasons for inventory source syncs not being ready include dependencies that are currently running (all dependencies must be completed before the next step can execute), or there is not enough capacity to run in the locations it is configured to.</p></li>
<li><p><strong>Waiting</strong> - The inventory sync is in the queue waiting to be executed.</p></li>
<li><p><strong>Running</strong> - The inventory sync is currently in progress.</p></li>
<li><p><strong>Successful</strong> - The inventory sync job succeeded.</p></li>
<li><p><strong>Failed</strong> - The inventory sync job failed.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>Inventory</strong>: The name of the associated inventory group.</p></li>
<li><p><strong>Source</strong>: The type of cloud inventory.</p></li>
<li><p><strong>Inventory Source Project</strong>: The project used as the source of this inventory sync job.</p></li>
<li><p><strong>Execution Environment</strong>: The execution environment used.</p></li>
<li><p><strong>Execution node</strong>: The node used to execute the job.</p></li>
<li><p><strong>Instance Group</strong>: The name of the instance group used with this job (AWX is the default instance group).</p></li>
</ul>
<p>By clicking on these items, where appropriate, you can view the corresponding job templates, projects, and other objects.</p>
</section>
</section>
<section id="scm-inventory-jobs">
<h4><span class="section-number">25.2. </span>SCM Inventory Jobs<a class="headerlink" href="#scm-inventory-jobs" title="Link to this heading"></a></h4>
<p id="index-3">When an inventory sourced from an SCM is executed, the full results automatically display in the Output tab. This shows the same information you would see if you ran it through the Ansible command line, and can be useful for debugging. The icons at the top right corner of the Output tab allow you to relaunch (<img alt="Launch Action Button" src="_images/launch-button.png" />), download (<img alt="Download Action Button" src="_images/download.png" />) the job output, or delete (<img alt="Delete Action Button" src="_images/delete-button.png" />) the job.</p>
<img alt="Example output for a successful SCM job" src="_images/jobs-show-job-results-for-scm-job.png" />
<section id="scm-inventory-details">
<h5><span class="section-number">25.2.1. </span>SCM inventory details<a class="headerlink" href="#scm-inventory-details" title="Link to this heading"></a></h5>
<p>Access the <strong>Details</strong> tab to provide details about the job execution and its associated project.</p>
<img alt="Example details for an SCM job" src="_images/jobs-show-job-details-for-scm-job.png" />
<p>Notable details of the job executed are:</p>
<ul>
<li><p><strong>Status</strong>: Can be any of the following:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Pending</strong> - The SCM job has been created, but not queued or started yet. Any job, not just SCM jobs, will stay in pending until it’s actually ready to be run by the system. Reasons for SCM jobs not being ready include dependencies that are currently running (all dependencies must be completed before the next step can execute), or there is not enough capacity to run in the locations it is configured to.</p></li>
<li><p><strong>Waiting</strong> - The SCM job is in the queue waiting to be executed.</p></li>
<li><p><strong>Running</strong> - The SCM job is currently in progress.</p></li>
<li><p><strong>Successful</strong> - The last SCM job succeeded.</p></li>
<li><p><strong>Failed</strong> - The last SCM job failed.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>Job Type</strong>: SCM jobs display Source Control Update.</p></li>
<li><p><strong>Project</strong>: The name of the project.</p></li>
<li><p><strong>Project Status</strong>: Indicates whether the associated project was successfully updated.</p></li>
<li><p><strong>Revision</strong>: Indicates the revision number of the sourced project that was used in this job.</p></li>
<li><p><strong>Execution Environment</strong>: Specifies the execution environment used to run this job.</p></li>
<li><p><strong>Execution Node</strong>: Indicates the node on which the job ran.</p></li>
<li><p><strong>Instance Group</strong>: Indicates the instance group on which the job ran, if specified.</p></li>
<li><p><strong>Job Tags</strong>: Tags show the various job operations executed.</p></li>
</ul>
<p>By clicking on these items, where appropriate, you can view the corresponding job templates, projects, and other objects.</p>
</section>
</section>
<section id="playbook-run-jobs">
<h4><span class="section-number">25.3. </span>Playbook Run Jobs<a class="headerlink" href="#playbook-run-jobs" title="Link to this heading"></a></h4>
<p id="index-4">When a playbook is executed, the full results automatically display in the Output tab. This shows the same information you would see if you ran it through the Ansible command line, and can be useful for debugging.</p>
<img alt="Example output for a successful playbook run" src="_images/jobs-show-job-results-for-example-job.png" />
<p>The events summary captures a tally of events that were run as part of this playbook:</p>
<ul class="simple">
<li><p>the number of times this playbook has ran in the <strong>Plays</strong> field</p></li>
<li><p>the number of tasks associated with this playbook in the <strong>Tasks</strong> field</p></li>
<li><p>the number of hosts associated with this playbook in the <strong>Hosts</strong> field</p></li>
<li><p>the amount of time it took to complete the playbook run in the <strong>Elapsed</strong> field</p></li>
</ul>
<img alt="Example summary details for a playbook" src="_images/jobs-events-summary.png" />
<p>The icons next to the events summary allow you to relaunch (<img alt="Launch Action Button" src="_images/launch-button.png" />), download (<img alt="Download Action Button" src="_images/download.png" />) the job output, or delete (<img alt="Delete Action Button" src="_images/delete-button.png" />) the job.</p>
<p>The host status bar runs across the top of the Output view. Hover over a section of the host status bar and the number of hosts associated with that particular status displays.</p>
<p><img alt="Show All Host Events" src="_images/job-all-host-events.png" /></p>
<p>The output for a Playbook job is also accessible after launching a job from the <strong>Jobs</strong> tab of its Job Templates page.</p>
<p>Clicking on the various line item tasks in the output, you can view its host details.</p>
<section id="search">
<h5><span class="section-number">25.3.1. </span>Search<a class="headerlink" href="#search" title="Link to this heading"></a></h5>
<p>Use Search to look up specific events, hostnames, and their statuses. To filter only certain hosts with a particular status, specify one of the following valid statuses:</p>
<ul class="simple">
<li><p><strong>OK</strong>: the playbook task returned “Ok”.</p></li>
<li><p><strong>Changed</strong>: the playbook task actually executed. Since Ansible tasks should be written to be idempotent, tasks may exit successfully without executing anything on the host. In these cases, the task would return Ok, but not Changed.</p></li>
<li><p><strong>Failed</strong>: the task failed. Further playbook execution was stopped for this host.</p></li>
<li><p><strong>Unreachable</strong>: the host was unreachable from the network or had another fatal error associated with it.</p></li>
<li><p><strong>Skipped</strong>: the playbook task was skipped because no change was necessary for the host to reach the target state.</p></li>
<li><p><strong>Rescued</strong>: introduced in Ansible 2.8, this shows the tasks that failed and then executes a rescue section.</p></li>
<li><p><strong>Ignored</strong>: introduced in Ansible 2.8, this shows the tasks that failed and have <code class="docutils literal notranslate"><span class="pre">ignore_errors:</span> <span class="pre">yes</span></code> configured.</p></li>
</ul>
<p>These statuses also display at bottom of each Stdout pane, in a group of “stats” called the Host Summary fields.</p>
<img alt="Example summary details in standard output" src="_images/job-std-out-host-summary-rescued-ignored.png" />
<p>The example below shows a search with only unreachable hosts.</p>
<img alt="Example of errored jobs filtered by unreachable hosts" src="_images/job-std-out-filter-failed.png" />
<p>For more details about using the Search, refer to the <a class="reference internal" href="index.html#ug-search"><span class="std std-ref">Search</span></a> chapter.</p>
<p>The standard output view displays all the events that occur on a particular job. By default, all rows are expanded so that all the details are displayed. Use the collapse-all button (<img alt="Collapse All Icon" src="_images/job-details-view-std-out-collapse-all-icon.png" />) to switch to a view that only contains the headers for plays and tasks. Click the (<img alt="Expand All Icon" src="_images/job-details-view-std-out-expand-all-icon.png" />) button to view all lines of the standard output.</p>
<p>Alternatively, you can display all the details of a specific play or task by clicking on the arrow icons next to them. Click an arrow from sideways to downward to expand the lines associated with that play or task. Click the arrow back to the sideways position to collapse and hide the lines.</p>
<img alt="Expand and Collapse Icons" src="_images/job-details-view-std-out-expand-collapse-icons.png" />
<p>Things to note when viewing details in the expand/collapse mode:</p>
<ul class="simple">
<li><p>Each displayed line that is not collapsed has a corresponding line number and start time.</p></li>
<li><p>An expand/collapse icon is at the start of any play or task after the play or task has completed.</p></li>
<li><p>If querying for a particular play or task, it will appear collapsed at the end of its completed process.</p></li>
<li><p>In some cases, an error message will appear, stating that the output may be too large to display. This occurs when there are more than 4000 events. Use the search and filter for specific events to bypass the error.</p></li>
</ul>
<p>Click on a line of an event from the <strong>Standard Out</strong> pane and a <strong>Host Events</strong> dialog displays in a separate window. This window shows the host that was affected by that particular event.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Upgrading to the latest versions of AWX involves progressively migrating all historical playbook output and events. This migration process is gradual, and happens automatically in the background after installation is complete. Installations with very large amounts of historical job output (tens, or hundreds of GB of output) may notice missing job output until migration is complete. Most recent data will show up at the top of the output, followed by older events. Migrating jobs with a large amount of events may take longer than jobs with a smaller amount.</p>
</div>
</section>
<section id="host-details">
<h5><span class="section-number">25.3.2. </span>Host Details<a class="headerlink" href="#host-details" title="Link to this heading"></a></h5>
<p id="index-5">The <strong>Host Details</strong> dialog shows information about the host affected by the selected event and its associated play and task:</p>
<ul class="simple">
<li><p>the <strong>Host</strong></p></li>
<li><p>the <strong>Status</strong></p></li>
<li><p>the type of run in the <strong>Play</strong> field</p></li>
<li><p>the type of <strong>Task</strong></p></li>
<li><p>if applicable, the Ansible <strong>Module</strong> for the task, and any <em>arguments</em> for that module</p></li>
</ul>
<img alt="Host Events Details" src="_images/job-details-host-hostevent.png" />
<p>To view the results in JSON format, click on the <strong>JSON</strong> tab. To view the output of the task, click the <strong>Standard Out</strong>. To view errors from the output, click <strong>Standard Error</strong>.</p>
</section>
<section id="playbook-run-details">
<h5><span class="section-number">25.3.3. </span>Playbook run details<a class="headerlink" href="#playbook-run-details" title="Link to this heading"></a></h5>
<p>Access the <strong>Details</strong> tab to provide details about the job execution.</p>
<img alt="Example Job details for a playbook run" src="_images/jobs-show-job-details-for-example-job.png" />
<p>Notable details of the job executed are:</p>
<ul>
<li><p><strong>Status</strong>: Can be any of the following:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Pending</strong> - The playbook run has been created, but not queued or started yet. Any job, not just playbook runs, will stay in pending until it is actually ready to be run by the system. Reasons for playbook runs not being ready include dependencies that are currently running (all dependencies must be completed before the next step can execute), or there is not enough capacity to run in the locations it is configured to.</p></li>
<li><p><strong>Waiting</strong> - The playbook run is in the queue waiting to be executed.</p></li>
<li><p><strong>Running</strong> - The playbook run is currently in progress.</p></li>
<li><p><strong>Successful</strong> - The last playbook run succeeded.</p></li>
<li><p><strong>Failed</strong> - The last playbook run failed.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>Job Template</strong>: The name of the job template from which this job was launched.</p></li>
<li><p><strong>Inventory</strong>: The inventory selected to run this job against.</p></li>
<li><p><strong>Project</strong>: The name of the project associated with the launched job.</p></li>
<li><p><strong>Project Status</strong>: The status of the project associated with the launched job.</p></li>
<li><p><strong>Playbook</strong>: The playbook used to launch this job.</p></li>
<li><p><strong>Execution Environment</strong>: The name of the execution environment used in this job.</p></li>
<li><p><strong>Container Group</strong>: The name of the container group used in this job.</p></li>
<li><p><strong>Credentials</strong>: The credential(s) used in this job.</p></li>
<li><p><strong>Extra Variables</strong>: Any extra variables passed when creating the job template are displayed here.</p></li>
</ul>
<p>By clicking on these items, where appropriate, you can view the corresponding job templates, projects, and other objects.</p>
</section>
</section>
<section id="awx-capacity-determination-and-job-impact">
<span id="ug-job-concurrency"></span><h4><span class="section-number">25.4. </span>AWX Capacity Determination and Job Impact<a class="headerlink" href="#awx-capacity-determination-and-job-impact" title="Link to this heading"></a></h4>
<p id="index-6">This section describes how to determine capacity for instance groups and its impact to your jobs. For container groups, see <a class="reference internal" href="index.html#ag-container-capacity"><span class="std std-ref">Container capacity limits</span></a> in the <em>AWX Administration Guide</em>.</p>
<p>AWX capacity system determines how many jobs can run on an instance given the amount of resources available to the instance and the size of the jobs that are running (referred to as <em>Impact</em>). The algorithm used to determine this is based entirely on two things:</p>
<ul class="simple">
<li><p>How much memory is available to the system (<code class="docutils literal notranslate"><span class="pre">mem_capacity</span></code>)</p></li>
<li><p>How much CPU is available to the system (<code class="docutils literal notranslate"><span class="pre">cpu_capacity</span></code>)</p></li>
</ul>
<p>Capacity also impacts Instance Groups. Since Groups are made up of instances, likewise, instances can be assigned to multiple groups. This means that impact to one instance can potentially affect the overall capacity of other Groups.</p>
<p>Instance Groups (not instances themselves) can be assigned to be used by jobs at various levels (see <a class="reference internal" href="index.html#ag-clustering"><span class="std std-ref">Clustering</span></a>). When the Task Manager is preparing its graph to determine which group a job will run on, it will commit the capacity of an Instance Group to a job that hasn’t or isn’t ready to start yet.</p>
<p>Finally, in smaller configurations, if only one instance is available for a job to run, the Task Manager will allow that job to run on the instance even if it pushes the instance over capacity. This guarantees that jobs themselves won’t get stuck as a result of an under-provisioned system.</p>
<p>Therefore, Capacity and Impact is not a zero-sum system relative to jobs and instances/Instance Groups.</p>
<p>For information on sliced jobs and their impact to capacity, see <a class="reference internal" href="index.html#ug-job-slice-execution"><span class="std std-ref">Job slice execution behavior</span></a>.</p>
<section id="resource-determination-for-capacity-algorithm">
<h5><span class="section-number">25.4.1. </span>Resource determination for capacity algorithm<a class="headerlink" href="#resource-determination-for-capacity-algorithm" title="Link to this heading"></a></h5>
<p>The capacity algorithms are defined in order to determine how many forks a system is capable of running simultaneously. This controls how many systems Ansible itself will communicate with simultaneously. Increasing the number of forks an AWX system is running will, in general, allow jobs to run faster by performing more work in parallel. The trade-off is that this will increase the load on the system, which could cause work to slow down overall.</p>
<p>AWX can operate in two modes when determining capacity. <code class="docutils literal notranslate"><span class="pre">mem_capacity</span></code> (the default) will allow you to over-commit CPU resources while protecting the system from running out of memory. If most of your work is not CPU-bound, then selecting this mode will maximize the number of forks.</p>
<section id="memory-relative-capacity">
<h6><span class="section-number">25.4.1.1. </span>Memory relative capacity<a class="headerlink" href="#memory-relative-capacity" title="Link to this heading"></a></h6>
<p><code class="docutils literal notranslate"><span class="pre">mem_capacity</span></code> is calculated relative to the amount of memory needed per fork. Taking into account the overhead for internal components, this comes out to be about 100MB per fork. When considering the amount of memory available to Ansible jobs, the capacity algorithm will reserve 2GB of memory to account for the presence of other services. The algorithm formula for this is:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">(mem - 2048) / mem_per_fork</span>
</pre></div>
</div>
<p>As an example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">(4096 - 2048) / 100 == ~20</span>
</pre></div>
</div>
<p>Therefore, a system with 4GB of memory would be capable of running 20 forks. The value <code class="docutils literal notranslate"><span class="pre">mem_per_fork</span></code> can be controlled by setting the settings value (or environment variable) <code class="docutils literal notranslate"><span class="pre">SYSTEM_TASK_FORKS_MEM</span></code>, which defaults to 100.</p>
</section>
<section id="cpu-relative-capacity">
<h6><span class="section-number">25.4.1.2. </span>CPU relative capacity<a class="headerlink" href="#cpu-relative-capacity" title="Link to this heading"></a></h6>
<p>Often, Ansible workloads can be fairly CPU-bound. In these cases, sometimes reducing the simultaneous workload allows more tasks to run faster and reduces the average time-to-completion of those jobs.</p>
<p>Just as the <code class="docutils literal notranslate"><span class="pre">mem_capacity</span></code> algorithm uses the amount of memory need per fork, the <code class="docutils literal notranslate"><span class="pre">cpu_capacity</span></code> algorithm looks at the amount of CPU resources is needed per fork. The baseline value for this is 4 forks per core. The algorithm formula for this is:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">cpus * fork_per_cpu</span>
</pre></div>
</div>
<p>For example, a 4-core system:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">4 * 4 == 16</span>
</pre></div>
</div>
<p>The value <code class="docutils literal notranslate"><span class="pre">fork_per_cpu</span></code> can be controlled by setting the settings value (or environment variable) <code class="docutils literal notranslate"><span class="pre">SYSTEM_TASK_FORKS_CPU</span></code> which defaults to 4.</p>
</section>
</section>
<section id="capacity-job-impacts">
<h5><span class="section-number">25.4.2. </span>Capacity job impacts<a class="headerlink" href="#capacity-job-impacts" title="Link to this heading"></a></h5>
<p>When selecting the capacity, it’s important to understand how each job type affects capacity.</p>
<p>It’s helpful to understand what forks mean to Ansible: <a class="reference external" href="https://www.ansible.com/blog/ansible-performance-tuning">https://www.ansible.com/blog/ansible-performance-tuning</a> (see the section on “Know Your Forks”).</p>
<p>The default forks value for Ansible is 5. However, if AWX knows that you’re running against fewer systems than that, then the actual concurrency value will be lower.</p>
<p>When a job is run, AWX will add 1 to the number of forks selected to compensate for the Ansible parent process. So if you are running a playbook against 5 systems with a forks value of 5, then the actual forks value from the perspective of Job Impact will be 6.</p>
<section id="impact-of-job-types-in-awx">
<h6><span class="section-number">25.4.2.1. </span>Impact of job types in AWX<a class="headerlink" href="#impact-of-job-types-in-awx" title="Link to this heading"></a></h6>
<p>Jobs and Ad-hoc jobs follow the above model, forks + 1. If you set a fork value on your job template, your job capacity value will be the minimum of the forks value supplied, and the number of hosts that you have, plus one. The plus one is to account for the parent Ansible process.</p>
<p>Instance capacity determines which jobs get assigned to any specific instance. Jobs and ad hoc commands use more capacity if they have a higher forks value.</p>
<p>Other job types have a fixed impact:</p>
<ul class="simple">
<li><p>Inventory Updates: 1</p></li>
<li><p>Project Updates: 1</p></li>
<li><p>System Jobs: 5</p></li>
</ul>
<p>If you don’t set a forks value on your job template, your job will use Ansible’s default forks value of five. Even though Ansible defaults to five forks, it will use fewer if your job has fewer than five hosts. In general, setting a forks value higher than what the system is capable of could cause trouble by running out of memory or over-committing CPU. So, the job template fork values that you use should fit on the system. If you have playbooks using 1000 forks but none of your systems individually has that much capacity, then your systems are undersized and at risk of performance or resource issues.</p>
</section>
<section id="selecting-the-right-capacity">
<h6><span class="section-number">25.4.2.2. </span>Selecting the right capacity<a class="headerlink" href="#selecting-the-right-capacity" title="Link to this heading"></a></h6>
<p>Selecting a capacity out of the CPU-bound or the memory-bound capacity limits is, in essence, selecting between the minimum or maximum number of forks. In the above examples, the CPU capacity would allow a maximum of 16 forks while the memory capacity would allow 20. For some systems, the disparity between these can be large and often times you may want to have a balance between these two.</p>
<p>The instance field <code class="docutils literal notranslate"><span class="pre">capacity_adjustment</span></code> allows you to select how much of one or the other you want to consider. It is represented as a value between 0.0 and 1.0. If set to a value of 1.0, then the largest value will be used. The above example involves memory capacity, so a value of 20 forks would be selected. If set to a value of 0.0 then the smallest value will be used. A value of 0.5 would be a 50/50 balance between the two algorithms which would be 18:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">16 + (20 - 16) * 0.5 == 18</span>
</pre></div>
</div>
<p>To view or edit the capacity in the user interface, select the <strong>Instances</strong> tab of the Instance Group.</p>
<img alt="Instances tab of Instance Group showing sliders for capacity adjustment." src="_images/instance-group-instances-capacity-callouts.png" />
</section>
</section>
</section>
<section id="job-branch-overriding">
<h4><span class="section-number">25.5. </span>Job branch overriding<a class="headerlink" href="#job-branch-overriding" title="Link to this heading"></a></h4>
<p id="ug-job-branching"><span id="index-7"></span>Projects specify the branch, tag, or reference to use from source control in the <code class="docutils literal notranslate"><span class="pre">scm_branch</span></code> field. These are represented by the values specified in the Project Details fields as shown.</p>
<img alt="Create New Project page with SCM branching options emphasized" src="_images/projects-create-scm-project-branching-emphasized.png" />
<p>Projects have the option to “Allow Branch Override”. When checked, project admins can delegate branch selection to the job templates that use that project (requiring only project <code class="docutils literal notranslate"><span class="pre">use_role</span></code>).</p>
<img alt="Allow Branch Override checkbox option in Project selected" src="_images/projects-create-scm-project-branch-override-checked.png" />
<section id="source-tree-copy-behavior">
<h5><span class="section-number">25.5.1. </span>Source tree copy behavior<a class="headerlink" href="#source-tree-copy-behavior" title="Link to this heading"></a></h5>
<p>Every job run has its own private data directory. This directory contains a copy of the project source tree for the given
<code class="docutils literal notranslate"><span class="pre">scm_branch</span></code> the job is running. Jobs are free to make changes to the project folder and make use of those changes while it is still running. This folder is temporary and is cleaned up at the end of the job run.</p>
<p>If <strong>Clean</strong> is checked, AWX discards modified files in its local copy of the repository through use of the <code class="docutils literal notranslate"><span class="pre">force</span></code> parameter in its respective Ansible modules pertaining to <a class="reference external" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/git_module.html#parameters">git</a> or <a class="reference external" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/subversion_module.html#parameters">Subversion</a>.</p>
<img alt="Clean checkbox option in Project selected" src="_images/projects-create-scm-project-clean-checked.png" />
</section>
<section id="project-revision-behavior">
<h5><span class="section-number">25.5.2. </span>Project revision behavior<a class="headerlink" href="#project-revision-behavior" title="Link to this heading"></a></h5>
<p>Typically, during a project update, the revision of the default branch (specified in the <strong>SCM Branch</strong> field of the project)
is stored when updated, and jobs using that project will employ this revision. Providing a non-default <strong>SCM Branch</strong> (not a commit hash or tag) in a job, the newest revision is pulled from the source control remote immediately before the job starts.
This revision is shown in the <strong>Source Control Revision</strong> field of the job and its respective project update.</p>
<img alt="Project's Source Control Revision value" src="_images/jobs-output-branch-override-example.png" />
<p>Consequently, offline job runs are impossible for non-default branches. To be sure that a job is running a static version from source control, use tags or commit hashes. Project updates do not save the revision of all branches, only the project default branch.</p>
<p>The <strong>SCM Branch</strong> field is not validated, so the project must update to assure it is valid. If this field is provided or prompted for, the <strong>Playbook</strong> field of job templates will not be validated, and you will have to launch the job template in order to verify presence of the expected playbook.</p>
</section>
<section id="git-refspec">
<h5><span class="section-number">25.5.3. </span>Git Refspec<a class="headerlink" href="#git-refspec" title="Link to this heading"></a></h5>
<p id="index-8">The <strong>SCM Refspec</strong> field specifies which extra references the update should download from the remote. Examples are:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">refs/*:refs/remotes/origin/*</span></code>: fetches all references, including remotes of the remote</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">refs/pull/*:refs/remotes/origin/pull/*</span></code> (GitHub-specific): fetches all refs for all pull requests</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">refs/pull/62/head:refs/remotes/origin/pull/62/head</span></code>: fetches the ref for that one GitHub pull request</p></li>
</ol>
</div></blockquote>
<p>For large projects, you should consider performance impact when using the 1st or 2nd examples here.</p>
<p>The <strong>SCM Refspec</strong> parameter affects the availability of the project branch, and can allow access to references not otherwise available. The examples above allow the user to supply a pull request from the <strong>SCM Branch</strong>, which would
not be possible without the <strong>SCM Refspec</strong> field.</p>
<p>The Ansible git module fetches <code class="docutils literal notranslate"><span class="pre">refs/heads/*</span></code> by default. This means that a project’s branches and tags (and commit hashes therein) can be used as the SCM Branch if <strong>SCM Refspec</strong> is blank. The value specified in the <strong>SCM Refspec</strong> field affects which <strong>SCM Branch</strong> fields can be used as overrides. Project updates (of any type) will perform an extra <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">fetch</span></code> command to pull that refspec from the remote.</p>
<p>For example: You could set up a project that allows branch override with the 1st or 2nd refspec example –&gt; Use this in a job template that prompts for the <strong>SCM Branch</strong> –&gt; A client could launch the job template when a new pull request is created, providing the branch <code class="docutils literal notranslate"><span class="pre">pull/N/head</span></code> –&gt; The job template would run against the provided GitGub pull request reference.</p>
<p>For more information on the Ansible git module, see <a class="reference external" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/git_module.html">https://docs.ansible.com/ansible/latest/collections/ansible/builtin/git_module.html</a>.</p>
</section>
</section>
</section>
<span id="document-userguide/webhooks"></span><section id="working-with-webhooks">
<span id="ug-webhooks"></span><h3><span class="section-number">26. </span>Working with Webhooks<a class="headerlink" href="#working-with-webhooks" title="Link to this heading"></a></h3>
<p id="index-0">A <a class="reference internal" href="index.html#term-Webhook"><span class="xref std std-term">Webhook</span></a> provides the ability to execute specified commands between apps over the web. AWX currently provides webhook integration with GitHub and GitLab. This section describes the procedure for setting up a webhook through their respective services.</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#github-webhook-setup" id="id1">GitHub webhook setup</a></p></li>
<li><p><a class="reference internal" href="#gitlab-webhook-setup" id="id2">GitLab webhook setup</a></p></li>
<li><p><a class="reference internal" href="#payload-output" id="id3">Payload output</a></p></li>
</ul>
</nav>
<p>The webhook post-status-back functionality for GitHub and GitLab is designed for work only under certain CI events. Receiving another kind of event will result in messages like the one below in the service log:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">awx.main.models.mixins Webhook event did not have a status API endpoint associated, skipping.</span>
</pre></div>
</div>
<section id="github-webhook-setup">
<h4><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">26.1. </span>GitHub webhook setup</a><a class="headerlink" href="#github-webhook-setup" title="Link to this heading"></a></h4>
<p>AWX has the ability to run jobs based on a triggered webhook event coming in. Job status information (pending, error, success) can be sent back only for pull request events. If you determine you do not want AWX to post job statuses back to the webhook service, skip steps 1-2, and go directly to <a class="reference internal" href="#ug-webhooks-setup-github"><span class="std std-ref">step 3</span></a>.</p>
<ol class="arabic">
<li><p>Optionally generate a personal access token (PAT) for use with AWX.</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>In the profile settings of your GitHub account, click <strong>Settings</strong>.</p></li>
<li><p>At the very bottom of the settings, click <strong>&lt;&gt; Developer Settings</strong>.</p></li>
<li><p>In the Developer settings, click <strong>Personal access tokens</strong>.</p></li>
<li><p>From the Personal access tokens screen, click <strong>Generate new token</strong>.</p></li>
<li><p>When prompted, enter your GitHub account password to continue.</p></li>
<li><p>In the <strong>Note</strong> field, enter a brief description about what this PAT will be used for.</p></li>
<li><p>In the Scope fields, the automation webhook only needs repo scope access, with the exception of invites. For information about other scopes, click the link right above the table to access the docs.</p></li>
</ol>
<img alt="Link to more information on scopes" src="_images/webhooks-create-webhook-github-scope.png" />
<ol class="loweralpha simple" start="8">
<li><p>Click the <strong>Generate Token</strong> button.</p></li>
<li><p>Once the token is generated, make sure you copy the PAT, as it will be used in a later step. You will not be able to access this token again in GitHub.</p></li>
</ol>
</div></blockquote>
</li>
<li><p>Use the PAT to optionally create a GitHub credential:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Go to your instance, and <a class="reference internal" href="index.html#ug-credentials-github"><span class="std std-ref">create a new credential for the GitHub PAT</span></a> using the above generated token.</p></li>
<li><p>Make note of the name of this credential, as it will be used in the job template that posts back to GitHub.</p></li>
</ol>
<img alt="Enter your generated PAT into the Token field" src="_images/webhooks-create-credential-github-PAT-token.png" />
<ol class="loweralpha simple" start="3">
<li><p>Go to the job template with which you want to enable webhooks, and select the webhook service and credential you created in the previous step.</p></li>
</ol>
<img alt="Select the webhook service and credential you created" src="_images/webhooks-job-template-gh-webhook-credential.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="loweralpha simple" start="4">
<li><p>Click <strong>Save</strong>. Now your job template is set up to be able to post back to GitHub. An example of one may look like this:</p></li>
</ol>
<img alt="An example GitHub status that shows all checks have passed" src="_images/webhooks-awx-to-github-status.png" />
</div></blockquote>
</li>
</ol>
<ol class="arabic simple" id="ug-webhooks-setup-github" start="3">
<li><p>Go to a specific GitHub repo you want to configure webhooks and click <strong>Settings</strong>.</p></li>
</ol>
<img alt="Settings link in your GitHub repo" src="_images/webhooks-github-repo-settings.png" />
<ol class="arabic simple" start="4">
<li><p>Under Options, click <strong>Webhooks</strong>.</p></li>
</ol>
<img alt="Webhooks link under Options" src="_images/webhooks-github-repo-settings-options.png" />
<ol class="arabic" start="5">
<li><p>On the Webhooks page, click <strong>Add webhook</strong>.</p></li>
<li><p>To complete the Add Webhook page, you need to <a class="reference internal" href="index.html#ug-jt-enable-webhooks"><span class="std std-ref">enable webhooks in a job template</span></a> (or in a <a class="reference internal" href="index.html#ug-wfjt-enable-webhooks"><span class="std std-ref">workflow job template</span></a>), which will provide you with the following information:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Copy the contents of the <strong>Webhook URL</strong> from the job template, and paste it in the <strong>Payload URL</strong> field. GitHub uses this address to send results to.</p></li>
<li><p>Set the <strong>Content type</strong> to <strong>application/json</strong>.</p></li>
<li><p>Copy the contents of the <strong>Webhook Key</strong> from the job template above and paste it in the <strong>Secret</strong> field.</p></li>
<li><p>Leave <strong>Enable SSL verification</strong> selected.</p></li>
</ol>
<img alt="Add Webhook page" src="_images/webhooks-github-repo-add-webhook.png" />
<ol class="loweralpha simple" start="5">
<li><p>Next, you must select the types of events you want to trigger a webhook. Any such event will trigger the Job or Workflow. In order to have job status (pending, error, success) sent back to GitHub, you must select <strong>Pull requests</strong> in the individual events section.</p></li>
</ol>
<img alt="List of trigger events for the webhook" src="_images/webhooks-github-repo-choose-events.png" />
<ol class="loweralpha simple" start="6">
<li><p>Leave <strong>Active</strong> checked and click <strong>Add Webhook</strong>.</p></li>
</ol>
<blockquote>
<div><img alt="Active option and Add Webhook button" src="_images/webhooks-github-repo-add-webhook-actve.png" />
</div></blockquote>
</div></blockquote>
</li>
<li><p>After your webhook is configured, it displays in the list of webhooks active for your repo, along with the ability to edit or delete it. Click on a webhook, and it brings you to the Manage webhook screen. Scroll to the very bottom of the screen to view all the delivery attempts made to your webhook and whether they succeeded or failed.</p></li>
</ol>
<img alt="An example listing of recent deliveries" src="_images/webhooks-github-repo-webhooks-deliveries.png" />
<p>For more information, refer to the <a class="reference external" href="https://developer.github.com/webhooks/">GitHub Webhooks developer documentation</a>.</p>
</section>
<section id="gitlab-webhook-setup">
<h4><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">26.2. </span>GitLab webhook setup</a><a class="headerlink" href="#gitlab-webhook-setup" title="Link to this heading"></a></h4>
<p>AWX has the ability to run jobs based on a triggered webhook event coming in. Job status information (pending, error, success) can be sent back only for merge request events. If you determine you do not want AWX to post job statuses back to the webhook service, skip steps 1-2, and go directly to <a class="reference internal" href="#ug-webhooks-setup-gitlab"><span class="std std-ref">step 3</span></a>.</p>
<ol class="arabic">
<li><p>Optionally, generate a personal access token (PAT). This token gives AWX the ability to post statuses back when we run jobs based on a webhook coming in.</p>
<blockquote>
<div><ol class="loweralpha">
<li><p>In the profile settings of your GitLab account, click <strong>Settings</strong>.</p></li>
<li><p>On the sidebar, under User Settings, click <strong>Access Tokens</strong>.</p>
<blockquote>
<div><img alt="Access Tokens link under User Settings" src="_images/webhooks-create-webhook-gitlab-settings.png" />
</div></blockquote>
</li>
<li><p>In the <strong>Name</strong> field, enter a brief description about what this PAT will be used for.</p></li>
<li><p>Skip the <strong>Expires at</strong> field unless you want to set an expiration date for your webhook.</p></li>
<li><p>In the Scopes fields, select the ones applicable to your integration. For AWX, API is the only selection necessary.</p></li>
</ol>
<img alt="Personal Access Token page" src="_images/webhooks-create-webhook-gitlab-scope.png" />
<ol class="loweralpha simple" start="6">
<li><p>Click the <strong>Create personal access token</strong> button.</p></li>
<li><p>Once the token is generated, make sure you copy the PAT, as it will be used in a later step. You will not be able to access this token again in GitLab.</p></li>
</ol>
</div></blockquote>
</li>
<li><p>Use the PAT to optionally create a GitLab credential:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Go to your instance, and <a class="reference internal" href="index.html#ug-credentials-gitlab"><span class="std std-ref">create a new credential for the GitLab PAT</span></a> using the above generated token.</p></li>
<li><p>Make note of the name of this credential, as it will be used in the job template that posts back to GitHub.</p></li>
</ol>
<img alt="Create New Credential page" src="_images/webhooks-create-credential-gitlab-PAT-token.png" />
<ol class="loweralpha simple" start="3">
<li><p>Go to the job template with which you want to enable webhooks, and select the webhook service and credential you created in the previous step.</p></li>
</ol>
<img alt="Select the webhook credential you created" src="_images/webhooks-job-template-gl-webhook-credential.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="loweralpha simple" start="4">
<li><p>Click <strong>Save</strong>. Now your job template is set up to be able to post back to GitLab. An example of one may look like this:</p></li>
</ol>
<img alt="An example GitLab status message" src="_images/webhooks-awx-to-gitlab-status.png" />
</div></blockquote>
</li>
</ol>
<ol class="arabic simple" id="ug-webhooks-setup-gitlab" start="3">
<li><p>Go to a specific GitLab repo you want to configure webhooks and click <strong>Settings &gt; Integrations</strong>.</p></li>
</ol>
<img alt="Integrations link under Settings" src="_images/webhooks-gitlab-repo-settings.png" />
<ol class="arabic" start="4">
<li><p>To complete the Integrations page, you need to <a class="reference internal" href="index.html#ug-jt-enable-webhooks"><span class="std std-ref">enable webhooks in a job template</span></a> (or in a <a class="reference internal" href="index.html#ug-wfjt-enable-webhooks"><span class="std std-ref">workflow job template</span></a>), which will provide you with the following information:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>Copy the contents of the <strong>Webhook URL</strong> from the job template above, and paste it in the <strong>URL</strong> field. GitLab uses this address to send results to.</p></li>
<li><p>Copy the contents of the <strong>Webhook Key</strong> from the job template above and paste it in the <strong>Secret Token</strong> field.</p></li>
<li><p>Next, you must select the types of events you want to trigger a webhook. Any such event will trigger the Job or Workflow. In order to have job status (pending, error, success) sent back to GitLab, you must select <strong>Merge request events</strong> in the Trigger section.</p></li>
<li><p>Leave <strong>Enable SSL verification</strong> selected.</p></li>
<li><p>Click <strong>Add webhook</strong>.</p></li>
</ol>
</div></blockquote>
</li>
</ol>
<img alt="Integrations page" src="_images/webhooks-gitlab-repo-add-webhook.png" />
<ol class="arabic simple" start="5">
<li><p>After your webhook is configured, it displays in the list of Project Webhooks for your repo, along with the ability to test events, edit or delete the webhook. Testing a webhook event displays the results at the top of the page whether it succeeded or failed.</p></li>
</ol>
<p>For more information, refer to the <a class="reference external" href="https://docs.gitlab.com/ee/user/project/integrations/webhooks.html">GitLab webhooks integrations documentation</a>.</p>
</section>
<section id="payload-output">
<h4><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">26.3. </span>Payload output</a><a class="headerlink" href="#payload-output" title="Link to this heading"></a></h4>
<p>The entire payload is exposed as an extra variable. To view the payload information, go to the Jobs Detail view of the job template that ran with the webhook enabled. In the <strong>Extra Variables</strong> field of the Details pane, view the payload output from the <code class="docutils literal notranslate"><span class="pre">awx_webhook_payload</span></code> variable, as shown in the example below.</p>
<img alt="Details page with payload output" src="_images/webhooks-jobs-extra-vars-payload.png" />
<img alt="Variables field expanded view" src="_images/webhooks-jobs-extra-vars-payload-expanded.png" />
</section>
</section>
<span id="document-userguide/notifications"></span><section id="notifications">
<span id="ug-notifications"></span><h3><span class="section-number">27. </span>Notifications<a class="headerlink" href="#notifications" title="Link to this heading"></a></h3>
<p id="index-0">A <a class="reference internal" href="index.html#term-Notification-Template"><span class="xref std std-term">Notification Template</span></a> is an instance of a <a class="reference internal" href="index.html#term-Notification"><span class="xref std std-term">Notification</span></a> type (Email, Slack, Webhook, etc.) with a name, description, and a defined configuration.</p>
<p>For example:</p>
<ul class="simple">
<li><p>A username, password, server, and recipients are needed for an Email notification template</p></li>
<li><p>The token and a list of channels are needed for a Slack notification template</p></li>
<li><p>The URL and Headers are needed for a Webhook notification template</p></li>
</ul>
<p>A Notification is a manifestation of the notification template; for example, when a job fails, a notification is sent using the configuration defined by the notification template.</p>
<p>At a high level, the typical flow for the notification system works as follows:</p>
<ul class="simple">
<li><p>A user creates a notification template to the REST API at the <code class="docutils literal notranslate"><span class="pre">/api/v2/notification_templates</span></code> endpoint (either through the API or through the UI).</p></li>
<li><p>A user assigns the notification template to any of the various objects that support it (all variants of job templates as well as organizations and projects) and at the appropriate trigger level for which they want the notification (started, success, or error). For example a user may wish to assign a particular notification template to trigger when Job Template 1 fails. In which case, they will associate the notification template with the job template at <code class="docutils literal notranslate"><span class="pre">/api/v2/job_templates/n/notification_templates_error</span></code> API endpoint.</p></li>
<li><p>You can set notifications on job start, not just job end. Users and teams are also able to define their own notifications that can be attached to arbitrary jobs.</p></li>
</ul>
<section id="notification-hierarchy">
<h4><span class="section-number">27.1. </span>Notification Hierarchy<a class="headerlink" href="#notification-hierarchy" title="Link to this heading"></a></h4>
<p id="index-1">Notification templates assigned at certain levels will inherit templates defined on parent objects as such:</p>
<ul class="simple">
<li><p>Job Templates will use notification templates defined on it as well as inheriting notification templates from the Project used by the Job Template and from the Organization that it is listed under (via the Project).</p></li>
<li><p>Project Updates will use notification templates defined on the project and will inherit notification templates from the Organization associated with it</p></li>
<li><p>Inventory Updates will use notification templates defined on the Organization that it is listed under</p></li>
<li><p>Ad-hoc commands will use notification templates defined on the Organization that the inventory is associated with</p></li>
</ul>
</section>
<section id="workflow">
<h4><span class="section-number">27.2. </span>Workflow<a class="headerlink" href="#workflow" title="Link to this heading"></a></h4>
<p id="index-2">When a job succeeds or fails, the error or success handler will pull a list of relevant notification templates using the procedure defined above. It will then create a Notification object for each one containing relevant details about the job and then sends it to the destination (email addresses, slack channel(s), sms numbers, etc). These Notification objects are available as related resources on job types (jobs, inventory updates, project updates), and also at <code class="docutils literal notranslate"><span class="pre">/api/v2/notifications</span></code>. You may also see what notifications have been sent from a notification templates by examining its related resources.</p>
<p>If a notification fails, it will not impact the job associated to it or cause it to fail. The status of the notification can be viewed at its detail endpoint (<code class="docutils literal notranslate"><span class="pre">/api/v2/notifications/&lt;n&gt;</span></code>).</p>
</section>
<section id="create-a-notification-template">
<span id="ug-notifications-create"></span><h4><span class="section-number">27.3. </span>Create a Notification Template<a class="headerlink" href="#create-a-notification-template" title="Link to this heading"></a></h4>
<p id="index-3">To create a Notification Template:</p>
<ol class="arabic simple">
<li><p>Click <strong>Notifications</strong> from the left navigation bar.</p></li>
<li><p>Click the <strong>Add</strong> button.</p></li>
</ol>
<img alt="Create new notification template" src="_images/notifications-template-add-new.png" />
<ol class="arabic simple" start="3">
<li><p>Enter the name of the notification and a description in their respective fields, and specify the organization (required) it belongs to.</p></li>
<li><p>Choose a type of notification from the <strong>Type</strong> drop-down menu. Refer to the subsequent sections for additional information.</p></li>
<li><p>Once all required information is complete, click <strong>Save</strong> to add the notification.</p></li>
</ol>
</section>
<section id="notification-types">
<span id="ug-notifications-types"></span><h4><span class="section-number">27.4. </span>Notification Types<a class="headerlink" href="#notification-types" title="Link to this heading"></a></h4>
<p id="index-4">Notification types supported with AWX:</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#aws-sns" id="id1">AWS SNS</a></p></li>
<li><p><a class="reference internal" href="#email" id="id2">Email</a></p></li>
<li><p><a class="reference internal" href="#grafana" id="id3">Grafana</a></p></li>
<li><p><a class="reference internal" href="#irc" id="id4">IRC</a></p></li>
<li><p><a class="reference internal" href="#mattermost" id="id5">Mattermost</a></p></li>
<li><p><a class="reference internal" href="#pagerduty" id="id6">PagerDuty</a></p></li>
<li><p><a class="reference internal" href="#rocket-chat" id="id7">Rocket.Chat</a></p></li>
<li><p><a class="reference internal" href="#slack" id="id8">Slack</a></p></li>
<li><p><a class="reference internal" href="#twilio" id="id9">Twilio</a></p></li>
<li><p><a class="reference internal" href="#webhook" id="id10">Webhook</a></p>
<ul>
<li><p><a class="reference internal" href="#webhook-payloads" id="id11">Webhook payloads</a></p></li>
</ul>
</li>
</ul>
</nav>
<p>Each of these have their own configuration and behavioral semantics and testing them may need to be approached in different ways. Additionally, you can customize each type of notification down to a specific detail, or a set of criteria to trigger a notification. See <a class="reference internal" href="#ug-custom-notifications"><span class="std std-ref">Create custom notifications</span></a> for more detail on configuring custom notifications. The following sections will give as much detail as possible on each type of notification.</p>
<section id="aws-sns">
<h5><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">27.4.1. </span>AWS SNS</a><a class="headerlink" href="#aws-sns" title="Link to this heading"></a></h5>
<p>The AWS SNS(<a class="reference external" href="https://aws.amazon.com/sns/">https://aws.amazon.com/sns/</a>) notification type supports sending messages into an SNS topic.</p>
<p>You must provide the following details to setup a SNS notification:</p>
<ul class="simple">
<li><p>AWS Region</p></li>
<li><p>AWS Access Key ID</p></li>
<li><p>AWS Secret Access Key</p></li>
<li><p>AWS SNS Topic ARN</p></li>
</ul>
</section>
<section id="email">
<h5><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">27.4.2. </span>Email</a><a class="headerlink" href="#email" title="Link to this heading"></a></h5>
<p>The email notification type supports a wide variety of SMTP servers and has support for TLS/SSL connections.</p>
<p>You must provide the following details to setup an email notification:</p>
<ul class="simple">
<li><p>Host</p></li>
<li><p>Recipient list</p></li>
<li><p>Sender email</p></li>
<li><p>Port</p></li>
<li><p>Timeout (in seconds): allows you to specify up to 120 seconds, the length of time AWX may attempt connecting to the email server before giving up.</p></li>
</ul>
<img alt="Email notification template" src="_images/notification-template-email.png" />
</section>
<section id="grafana">
<h5><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">27.4.3. </span>Grafana</a><a class="headerlink" href="#grafana" title="Link to this heading"></a></h5>
<p>Grafana is a fairly straightforward integration. First, create an API Key in the <a class="reference external" href="http://docs.grafana.org/tutorials/api_org_token_howto/">Grafana system</a> (this is the token that is given to AWX).</p>
<p>You must provide the following details to setup a Grafana notification:</p>
<ul class="simple">
<li><p>Grafana URL: The URL of the Grafana API service, generally <code class="docutils literal notranslate"><span class="pre">http://yourcompany.grafana.com</span></code>.</p></li>
<li><p>Grafana API Key: The user must first create an API Key in the Grafana system (this is the token that is given to AWX).</p></li>
</ul>
<p>The other options of note are:</p>
<ul class="simple">
<li><p>ID of the Dashboard: When you created an API Key for the Grafana account, you can set up a dashboard with its own unique ID.</p></li>
<li><p>ID of the Panel: If you added panels and graphs to your Grafana interface, you can specify its ID here.</p></li>
<li><p>Tags for the Annotation: Enter keywords that help identify the type(s) of events(s) of the notification you are configuring.</p></li>
<li><p>Disable SSL Verification: SSL verification is on by default, but you can choose to turn off verification the authenticity of the target’s certificate. Environments that use internal or private CA’s should select this option to disable verification.</p></li>
</ul>
<img alt="Grafana notification template" src="_images/notification-template-grafana.png" />
</section>
<section id="irc">
<h5><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">27.4.4. </span>IRC</a><a class="headerlink" href="#irc" title="Link to this heading"></a></h5>
<p>The IRC notification takes the form of an IRC bot that will connect, deliver its messages to channel(s) or individual user(s), and then disconnect. The notification bot also supports SSL authentication. The bot does not currently support Nickserv identification. If a channel or user does not exist or is not on-line then the Notification will not fail; the failure scenario is reserved specifically for connectivity.</p>
<p>Connectivity information is straightforward:</p>
<ul class="simple">
<li><p>IRC Server Password (optional): IRC servers can require a password to connect. If the server does not require one, leave blank</p></li>
<li><p>IRC Server Port: The IRC server Port</p></li>
<li><p>IRC Server Address: The host name or address of the IRC server</p></li>
<li><p>IRC Nick: The bot’s nickname once it connects to the server</p></li>
<li><p>Destination Channels or Users: A list of users and/or channels to which to send the notification.</p></li>
<li><p>SSL Connection (optional): Should the bot use SSL when connecting</p></li>
</ul>
<img alt="IRC notification template" src="_images/notification-template-irc.png" />
</section>
<section id="mattermost">
<h5><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">27.4.5. </span>Mattermost</a><a class="headerlink" href="#mattermost" title="Link to this heading"></a></h5>
<p>The Mattermost notification type provides a simple interface to Mattermost’s messaging and collaboration workspace. The parameters that can be specified are:</p>
<ul class="simple">
<li><p>Target URL (required): The full URL that will be POSTed to</p></li>
<li><p>Username</p></li>
<li><p>Channel</p></li>
<li><p>Icon URL: specifies the icon to display for this notification</p></li>
<li><p>Disable SSL Verification: Turns off verification of the authenticity of the target’s certificate. Environments that use internal or private CA’s should select this option to disable verification.</p></li>
</ul>
<img alt="Mattermost notification template" src="_images/notification-template-mattermost.png" />
</section>
<section id="pagerduty">
<h5><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">27.4.6. </span>PagerDuty</a><a class="headerlink" href="#pagerduty" title="Link to this heading"></a></h5>
<p>PagerDuty is a fairly straightforward integration. First, create an API Key in the <a class="reference external" href="https://support.pagerduty.com/docs/generating-api-keys">PagerDuty system</a> (this is the token that is given to AWX) and then create a “Service” which provides an “Integration Key” that will also be given to AWX. The other required options are:</p>
<ul class="simple">
<li><p>API Token: The user must first create an API Key in the PagerDuty system (this is the token that is given to AWX).</p></li>
<li><p>PagerDuty Subdomain: When you sign up for the PagerDuty account, you receive a unique subdomain to communicate with. For instance, if you signed up as “testuser”, the web dashboard will be at <code class="docutils literal notranslate"><span class="pre">testuser.pagerduty.com</span></code> and you will give the API <code class="docutils literal notranslate"><span class="pre">testuser</span></code> as the subdomain (not the full domain).</p></li>
<li><p>API Service/Integration Key</p></li>
<li><p>Client Identifier: This will be sent along with the alert content to the pagerduty service to help identify the service that is using the api key/service. This is helpful if multiple integrations are using the same API key and service.</p></li>
</ul>
<img alt="PagerDuty notification template" src="_images/notification-template-pagerduty.png" />
</section>
<section id="rocket-chat">
<h5><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">27.4.7. </span>Rocket.Chat</a><a class="headerlink" href="#rocket-chat" title="Link to this heading"></a></h5>
<p>The Rocket.Chat notification type provides an interface to Rocket.Chat’s collaboration and communication platform. The parameters that can be specified are:</p>
<ul class="simple">
<li><p>Target URL (required): The full URL that will be POSTed to</p></li>
<li><p>Username</p></li>
<li><p>Icon URL: specifies the icon to display for this notification</p></li>
<li><p>Disable SSL Verification: Turns off verification of the authenticity of the target’s certificate. Environments that use internal or private CA’s should select this option to disable verification.</p></li>
</ul>
<img alt="Rocket.Chat notification template" src="_images/notification-template-rocketchat.png" />
</section>
<section id="slack">
<h5><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">27.4.8. </span>Slack</a><a class="headerlink" href="#slack" title="Link to this heading"></a></h5>
<p>Slack, a collaborative team communication and messaging tool, is pretty easy to configure.</p>
<p>You must supply the following to setup Slack notifications:</p>
<ul class="simple">
<li><p>A Slack app (refer to the <a class="reference external" href="https://api.slack.com/authentication/basics">Basic App Setup</a> page of the Slack documentation for information on how to create one)</p></li>
<li><p>A token (refer to <a class="reference external" href="https://api.slack.com/bot-users">Enabling Interactions with Bots</a> and specific details on bot tokens on the <a class="reference external" href="https://api.slack.com/authentication/token-types#bot">Token Types</a> documentation page)</p></li>
</ul>
<p>Once you have a bot/app set up, you must navigate to “Your Apps”, click on the newly-created app and then go to <strong>Add features and functionality</strong>, which allows you to configure incoming webhooks, bots, and permissions; as well as <strong>Install your app to your workspace</strong>.</p>
<p>You must also invite the notification bot to join the channel(s) in question in Slack. Note that private messages are not supported.</p>
<img alt="Slack notification template" src="_images/notification-template-slack.png" />
</section>
<section id="twilio">
<h5><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">27.4.9. </span>Twilio</a><a class="headerlink" href="#twilio" title="Link to this heading"></a></h5>
<p>Twilio service is an Voice and SMS automation service. Once you are signed in, you must create a phone number from which the message will be sent. You can then define a “Messaging Service” under Programmable SMS and associate the number you created before with it.</p>
<p>Note that you may need to verify this number or some other information before you are allowed to use it to send to any numbers. The Messaging Service does not need a status callback URL nor does it need the ability to Process inbound messages.</p>
<p>Under your individual (or sub) account settings, you will have API credentials. Twilio uses two credentials to determine which account an API request is coming from. The “Account SID”, which acts as a username, and the “Auth Token” which acts as a password.</p>
<p>To setup Twilio, provide the following details:</p>
<ul class="simple">
<li><p>Account Token</p></li>
<li><p>Source Phone Number (this is the number associated with the messaging service above and must be given in the form of “+15556667777”)</p></li>
<li><p>Destination SMS number (this will be the list of numbers to receive the SMS and should be the 10-digit phone number)</p></li>
<li><p>Account SID</p></li>
</ul>
<img alt="Twilio notification template" src="_images/notification-template-twilio.png" />
</section>
<section id="webhook">
<h5><a class="toc-backref" href="#id10" role="doc-backlink"><span class="section-number">27.4.10. </span>Webhook</a><a class="headerlink" href="#webhook" title="Link to this heading"></a></h5>
<p>The webhook notification type provides a simple interface to sending POSTs to a predefined web service. AWX will POST to this address using application/json content type with the data payload containing all relevant details in json format. Some web service APIs expect HTTP requests to be in a certain format with certain fields. You can configure more of the webhook notification in the following ways:</p>
<ul class="simple">
<li><p>configure the HTTP method (using <strong>POST</strong> or <strong>PUT</strong>)</p></li>
<li><p>body of the outgoing request</p></li>
<li><p>configure authentication (using basic auth)</p></li>
</ul>
<p>The parameters for configuring webhooks are:</p>
<ul class="simple">
<li><p>Username</p></li>
<li><p>Basic Auth Password</p></li>
<li><p>Target URL (required): The full URL to which the webhook notification will be PUT or POSTed.</p></li>
<li><p>Disable SSL Verification: SSL verification is on by default, but you can choose to turn off verification of the authenticity of the target’s certificate. Environments that use internal or private CA’s should select this option to disable verification.</p></li>
<li><p>HTTP Headers (required): Headers in JSON form where the keys and values are strings.
For example, <code class="docutils literal notranslate"><span class="pre">{&quot;Authentication&quot;:</span> <span class="pre">&quot;988881adc9fc3655077dc2d4d757d480b5ea0e11&quot;,</span> <span class="pre">&quot;MessageType&quot;:</span> <span class="pre">&quot;Test&quot;}</span></code></p></li>
<li><p>HTTP Method (required). Select the method for your webhook:</p>
<ul>
<li><p>POST: Creates a new resource. Also acts as a catch-all for operations that do not fit into the other categories. It is likely you need to POST unless you know your webhook service expects a PUT.</p></li>
<li><p>PUT: Updates a specific resource (by an identifier) or a collection of resources. PUT can also be used to create a specific resource if the resource identifier is known beforehand.</p></li>
</ul>
</li>
</ul>
<img alt="Webhook notification template" src="_images/notification-template-webhook.png" />
<section id="webhook-payloads">
<h6><a class="toc-backref" href="#id11" role="doc-backlink"><span class="section-number">27.4.10.1. </span>Webhook payloads</a><a class="headerlink" href="#webhook-payloads" title="Link to this heading"></a></h6>
<p>AWX sends by default the following data at the webhook endpoint:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">job id</span>
<span class="l l-Scalar l-Scalar-Plain">name</span>
<span class="l l-Scalar l-Scalar-Plain">url</span>
<span class="l l-Scalar l-Scalar-Plain">created_by</span>
<span class="l l-Scalar l-Scalar-Plain">started</span>
<span class="l l-Scalar l-Scalar-Plain">finished</span>
<span class="l l-Scalar l-Scalar-Plain">status</span>
<span class="l l-Scalar l-Scalar-Plain">traceback</span>
<span class="l l-Scalar l-Scalar-Plain">inventory</span>
<span class="l l-Scalar l-Scalar-Plain">project</span>
<span class="l l-Scalar l-Scalar-Plain">playbook</span>
<span class="l l-Scalar l-Scalar-Plain">credential</span>
<span class="l l-Scalar l-Scalar-Plain">limit</span>
<span class="l l-Scalar l-Scalar-Plain">extra_vars</span>
<span class="l l-Scalar l-Scalar-Plain">hosts</span>
<span class="l l-Scalar l-Scalar-Plain">http method</span>
</pre></div>
</div>
<p>An example of a <code class="docutils literal notranslate"><span class="pre">started</span></code> notifications via webhook message as it is returned by AWX:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span><span class="s">&quot;id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">38</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Demo</span><span class="nv"> </span><span class="s">Job</span><span class="nv"> </span><span class="s">Template&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;url&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;https://host/#/jobs/playbook/38&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;created_by&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;bianca&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;started&quot;</span><span class="p p-Indicator">:</span>
<span class="s">&quot;2020-07-28T19:57:07.888193+00:00&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;finished&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">null</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;status&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;running&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;traceback&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;inventory&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Demo</span><span class="nv"> </span><span class="s">Inventory&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;project&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Demo</span><span class="nv"> </span><span class="s">Project&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;playbook&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;hello_world.yml&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;credential&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Demo</span><span class="nv"> </span><span class="s">Credential&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;limit&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;extra_vars&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;{}&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;hosts&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{}}</span><span class="l l-Scalar l-Scalar-Plain">POST / HTTP/1.1</span>
</pre></div>
</div>
<p>AWX returns by default the following data at the webhook endpoint for a <code class="docutils literal notranslate"><span class="pre">success</span></code>/<code class="docutils literal notranslate"><span class="pre">fail</span></code> status:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">job id</span>
<span class="l l-Scalar l-Scalar-Plain">name</span>
<span class="l l-Scalar l-Scalar-Plain">url</span>
<span class="l l-Scalar l-Scalar-Plain">created_by</span>
<span class="l l-Scalar l-Scalar-Plain">started</span>
<span class="l l-Scalar l-Scalar-Plain">finished</span>
<span class="l l-Scalar l-Scalar-Plain">status</span>
<span class="l l-Scalar l-Scalar-Plain">traceback</span>
<span class="l l-Scalar l-Scalar-Plain">inventory</span>
<span class="l l-Scalar l-Scalar-Plain">project</span>
<span class="l l-Scalar l-Scalar-Plain">playbook</span>
<span class="l l-Scalar l-Scalar-Plain">credential</span>
<span class="l l-Scalar l-Scalar-Plain">limit</span>
<span class="l l-Scalar l-Scalar-Plain">extra_vars</span>
<span class="l l-Scalar l-Scalar-Plain">hosts</span>
</pre></div>
</div>
<p>An example of a <code class="docutils literal notranslate"><span class="pre">success</span></code>/<code class="docutils literal notranslate"><span class="pre">fail</span></code> notifications via webhook message as it is returned by AWX:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span><span class="s">&quot;id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">46</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;AWX-Collection-tests-awx_job_wait-long_running-XVFBGRSAvUUIrYKn&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;url&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;https://host/#/jobs/playbook/46&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;created_by&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;bianca&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;started&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;2020-07-28T20:43:36.966686+00:00&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;finished&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;2020-07-28T20:43:44.936072+00:00&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;status&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;traceback&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;inventory&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Demo</span><span class="nv"> </span><span class="s">Inventory&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;project&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;AWX-Collection-tests-awx_job_wait-long_running-JJSlglnwtsRJyQmw&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;playbook&quot;</span><span class="p p-Indicator">:</span>
<span class="s">&quot;fail.yml&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;credential&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">null</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;limit&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;extra_vars&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;{\&quot;sleep_interval\&quot;:</span><span class="nv"> </span><span class="s">300}&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;hosts&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&quot;localhost&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="s">&quot;failed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;changed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">,</span>
<span class="s">&quot;dark&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;failures&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;ok&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;processed&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;skipped&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;rescued&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;ignored&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">}}}</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="create-custom-notifications">
<span id="ug-custom-notifications"></span><h4><span class="section-number">27.5. </span>Create custom notifications<a class="headerlink" href="#create-custom-notifications" title="Link to this heading"></a></h4>
<p>You can <a class="reference internal" href="index.html#ir-notifications-reference"><span class="std std-ref">customize the text content</span></a> of each of the <a class="reference internal" href="#ug-notifications-types"><span class="std std-ref">Notification Types</span></a> by enabling the <strong>Customize Messages</strong> portion at the bottom of the notifications form using the toggle button.</p>
<img alt="Custom notification template" src="_images/notification-template-customize.png" />
<p>You can provide a custom message for various job events:</p>
<ul class="simple">
<li><p>Start</p></li>
<li><p>Success</p></li>
<li><p>Error</p></li>
<li><p>Workflow approved</p></li>
<li><p>Workflow denied</p></li>
<li><p>Workflow running</p></li>
<li><p>Workflow timed out</p></li>
</ul>
<p>The message forms vary depending on the type of notification you are configuring. For example, messages for email and PagerDuty notifications have the appearance of a typical email form with a subject and body, in which case, AWX displays the fields as <strong>Message</strong> and <strong>Message Body</strong>. Other notification types only expect a <strong>Message</strong> for each type of event:</p>
<img alt="Custom notification template example" src="_images/notification-template-customize-simple.png" />
<p>The <strong>Message</strong> fields are pre-populated with a template containing a top-level variable, <code class="docutils literal notranslate"><span class="pre">job</span></code> coupled with an attribute, such as <code class="docutils literal notranslate"><span class="pre">id</span></code> or <code class="docutils literal notranslate"><span class="pre">name</span></code>, for example. Templates are enclosed in curly braces and may draw from a fixed set of fields provided by AWX, as shown in the pre-populated <strong>Messages</strong> fields.</p>
<img alt="Custom notification template example syntax" src="_images/notification-template-customize-simple-syntax.png" />
<p>This pre-populated field suggests commonly displayed messages to a recipient who is notified of an event. You can, however, customize these messages with different criteria by adding your own attribute(s) for the job as needed. Custom notification messages are rendered using Jinja - the same templating engine used by Ansible playbooks.</p>
<p>Messages and message bodies have different types of content:</p>
<ul>
<li><p>messages will always just be strings (one-liners only; new lines are not allowed)</p></li>
<li><p>message bodies will be either a dictionary or block of text:</p>
<blockquote>
<div><ul class="simple">
<li><p>the message body for <em>Webhooks</em> and <em>PagerDuty</em> uses dictionary definitions. The default message body for these is <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">job_metadata</span> <span class="pre">}}</span></code>, you can either leave that as is or provide your own dictionary</p></li>
<li><p>the message body for email uses a block of text or a multi-line string. The default message body is:</p></li>
</ul>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span>{{ job_friendly_name }} #{{ job.id }} had status {{ job.status }}, view details at {{ url }} {{ job_metadata }}
</pre></div>
</div>
<p>You can tweak this text (leaving <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">job_metadata</span> <span class="pre">}}</span></code> in, or drop <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">job_metadata</span> <span class="pre">}}</span></code> altogether). Since the body is a block of text, it can really be any string you want.</p>
<p><code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">job_metadata</span> <span class="pre">}}</span></code> gets rendered as a dictionary containing fields that describe the job being executed. In all cases, <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">job_metadata</span> <span class="pre">}}</span></code> will include the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">url</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">created_by</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">started</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">finished</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">status</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">traceback</span></code></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At the present time, you cannot query individual fields within <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">job_metadata</span> <span class="pre">}}</span></code>. When using <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">job_metadata</span> <span class="pre">}}</span></code> in a notification template, all data
will be returned.</p>
</div>
<p>The resulting dictionary will look something like this:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span><span class="s">&quot;id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">18</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Project</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Space</span><span class="nv"> </span><span class="s">Procedures&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;url&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;https://host/#/jobs/project/18&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;created_by&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;admin&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;started&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;2019-10-26T00:20:45.139356+00:00&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;finished&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;2019-10-26T00:20:55.769713+00:00&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;status&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;successful&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;traceback&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">job_metadata</span> <span class="pre">}}</span></code> is rendered in a job, it will include the following additional fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">inventory</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">project</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">playbook</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">credential</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">limit</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">extra_vars</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hosts</span></code></p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The resulting dictionary will look something like:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span><span class="s">&quot;id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;JobTemplate</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Launch</span><span class="nv"> </span><span class="s">Rockets&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;url&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;https://host/#/jobs/playbook/12&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;created_by&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;admin&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;started&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;2019-10-26T00:02:07.943774+00:00&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;finished&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">null</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;status&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;running&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;traceback&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;inventory&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Inventory</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Fleet&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;project&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Project</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Space</span><span class="nv"> </span><span class="s">Procedures&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;playbook&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;launch.yml&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;credential&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Credential</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Mission</span><span class="nv"> </span><span class="s">Control&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;limit&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;extra_vars&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;{}&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;hosts&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">job_metadata</span> <span class="pre">}}</span></code> is rendered in a workflow job, it will include the following additional field:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> (this will enumerate all the nodes in the workflow job and includes a description of the job associated with each node)</p></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The resulting dictionary will look something like this:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span><span class="s">&quot;id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">14</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Workflow</span><span class="nv"> </span><span class="s">Job</span><span class="nv"> </span><span class="s">Template</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">Launch</span><span class="nv"> </span><span class="s">Mars</span><span class="nv"> </span><span class="s">Mission&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;url&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;https://host/#/workflows/14&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;created_by&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;admin&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;started&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;2019-10-26T00:11:04.554468+00:00&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;finished&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;2019-10-26T00:11:24.249899+00:00&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;status&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;successful&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;traceback&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;body&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Workflow</span><span class="nv"> </span><span class="s">job</span><span class="nv"> </span><span class="s">summary:</span>

<span class="w">         </span><span class="s">node</span><span class="nv"> </span><span class="s">#1</span><span class="nv"> </span><span class="s">spawns</span><span class="nv"> </span><span class="s">job</span><span class="nv"> </span><span class="s">#15,</span><span class="nv"> </span><span class="s">\&quot;Assemble</span><span class="nv"> </span><span class="s">Fleet</span><span class="nv"> </span><span class="s">JT\&quot;,</span><span class="nv"> </span><span class="s">which</span><span class="nv"> </span><span class="s">finished</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">status</span><span class="nv"> </span><span class="s">successful.</span>
<span class="w">         </span><span class="s">node</span><span class="nv"> </span><span class="s">#2</span><span class="nv"> </span><span class="s">spawns</span><span class="nv"> </span><span class="s">job</span><span class="nv"> </span><span class="s">#16,</span><span class="nv"> </span><span class="s">\&quot;Mission</span><span class="nv"> </span><span class="s">Start</span><span class="nv"> </span><span class="s">approval</span><span class="nv"> </span><span class="s">node\&quot;,</span><span class="nv"> </span><span class="s">which</span><span class="nv"> </span><span class="s">finished</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">status</span><span class="nv"> </span><span class="s">successful.\n</span>
<span class="w">         </span><span class="s">node</span><span class="nv"> </span><span class="s">#3</span><span class="nv"> </span><span class="s">spawns</span><span class="nv"> </span><span class="s">job</span><span class="nv"> </span><span class="s">#17,</span><span class="nv"> </span><span class="s">\&quot;Deploy</span><span class="nv"> </span><span class="s">Fleet\&quot;,</span><span class="nv"> </span><span class="s">which</span><span class="nv"> </span><span class="s">finished</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">status</span><span class="nv"> </span><span class="s">successful.&quot;</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<p>For more detail, refer to <a class="reference external" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_variables.html#using-variables-with-jinja2">Using variables with Jinja2</a>.</p>
<p>AWX requires valid syntax in order to retrieve the correct data to display the messages. For a list of supported attributes and the proper syntax construction, refer to the <a class="reference internal" href="index.html#ir-notifications-reference"><span class="std std-ref">Supported Attributes for Custom Notifications</span></a> section of this guide.</p>
<p>If you create a notification template that uses invalid syntax or references unusable fields, an error message displays indicating the nature of the error. If you delete a notification’s custom message, the default message is shown in its place.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you save the notifications template without editing the custom message (or edit and revert back to the default values), the <strong>Details</strong> screen assumes the defaults and will not display the custom message tables. If you edit and save any of the values, the entire table displays in the <strong>Details</strong> screen.</p>
</div>
<img alt="Notification template with and without a custom message" src="_images/notifications-with-without-messages.png" />
</section>
<section id="enable-and-disable-notifications">
<span id="ug-notifications-on-off"></span><h4><span class="section-number">27.6. </span>Enable and Disable Notifications<a class="headerlink" href="#enable-and-disable-notifications" title="Link to this heading"></a></h4>
<p>You can select which notifications to notify you when a specific job starts, in addition to notifying you on success or failure at the end of the job run. Some behaviors to keep in mind:</p>
<ul class="simple">
<li><p>if a workflow template (WFJT) has notification on start enabled, and a job template (JT) within that workflow also has notification on start enabled, you will receive notifications for both</p></li>
<li><p>you can enable notifications to run on many JTs within a WFJT</p></li>
<li><p>you can enable notifications to run on a sliced job template (SJT) start and each slice will generate a notification</p></li>
<li><p>when you enable a notification to run on job start, and that notification gets deleted, the JT continues to run, but will result in an error message</p></li>
</ul>
<p>You can enable notifications on job start, job success, and job failure, or any combination thereof, from the <strong>Notifications</strong> tab of the following resources:</p>
<ul class="simple">
<li><p>Job Template</p></li>
<li><p>Workflow Template</p></li>
<li><p>Projects (shown in the example below)</p></li>
<li><p>Inventory Source</p></li>
<li><p>Organizations</p></li>
</ul>
<img alt="List of project notifications" src="_images/projects-notifications-example-list.png" />
<p>For workflow templates that have approval nodes, in addition to <em>Start</em>, <em>Success</em>, and <em>Failure</em>, you can enable or disable certain approval-related events:</p>
<img alt="List of project notifications with approval nodes option" src="_images/wf-template-completed-notifications-view.png" />
<p>Refer to <a class="reference internal" href="index.html#ug-wf-approval-nodes"><span class="std std-ref">Approval nodes</span></a> for additional detail on working with these types of nodes.</p>
</section>
<section id="configure-the-host-hostname-for-notifications">
<h4><span class="section-number">27.7. </span>Configure the <code class="docutils literal notranslate"><span class="pre">host</span></code> hostname for notifications<a class="headerlink" href="#configure-the-host-hostname-for-notifications" title="Link to this heading"></a></h4>
<p id="index-5">In the <a class="reference internal" href="index.html#configure-awx-system"><span class="std std-ref">System Settings</span></a>, you can replace the default value in the <strong>Base URL of the service</strong> field with your preferred hostname to change the notification hostname.</p>
<img alt="Configuring base URL with preferred hostname" src="_images/configure-awx-system-misc-baseurl.png" />
<p>Refreshing your license also changes the notification hostname. New installations of AWX should not have to set the hostname for notifications.</p>
<section id="reset-the-awx-url-base">
<h5><span class="section-number">27.7.1. </span>Reset the <code class="docutils literal notranslate"><span class="pre">AWX_URL_BASE</span></code><a class="headerlink" href="#reset-the-awx-url-base" title="Link to this heading"></a></h5>
<p id="index-6">The primary way that AWX determines how the base URL (<code class="docutils literal notranslate"><span class="pre">AWX_URL_BASE</span></code>) is defined is by looking at an incoming request and setting the server address based on that incoming request.</p>
<p>AWX takes settings values from the database first. If no settings values are found, it falls back to using the values from the settings files.  If a user posts a license by navigating to the AWX host’s IP address, the posted license is written to the settings entry in the database.</p>
<p>To change the <code class="docutils literal notranslate"><span class="pre">AWX_URL_BASE</span></code> if the wrong address has been picked up, navigate to <strong>Miscellaneous System settings</strong> from the Settings menu using the DNS entry you wish to appear in notifications, and re-add your license.</p>
</section>
</section>
<section id="notifications-api">
<h4><span class="section-number">27.8. </span>Notifications API<a class="headerlink" href="#notifications-api" title="Link to this heading"></a></h4>
<p id="index-7">Use the <code class="docutils literal notranslate"><span class="pre">started</span></code>, <code class="docutils literal notranslate"><span class="pre">success</span></code>, or <code class="docutils literal notranslate"><span class="pre">error</span></code> endpoints:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">/api/v2/organizations/N/notification_templates_started/</span>
<span class="l l-Scalar l-Scalar-Plain">/api/v2/organizations/N/notification_templates_success/</span>
<span class="l l-Scalar l-Scalar-Plain">/api/v2/organizations/N/notification_templates_error/</span>
</pre></div>
</div>
<p>Additionally, the <code class="docutils literal notranslate"><span class="pre">../../../N/notification_templates_started</span></code> endpoints have <strong>GET</strong> and <strong>POST</strong> actions for:</p>
<ul class="simple">
<li><p>Organizations</p></li>
<li><p>Projects</p></li>
<li><p>Inventory Sources</p></li>
<li><p>Job Templates</p></li>
<li><p>System Job Templates</p></li>
<li><p>Workflow Job Templates</p></li>
</ul>
</section>
</section>
<span id="document-userguide/notification_parameters_supported"></span><section id="supported-attributes-for-custom-notifications">
<span id="ir-notifications-reference"></span><h3><span class="section-number">28. </span>Supported Attributes for Custom Notifications<a class="headerlink" href="#supported-attributes-for-custom-notifications" title="Link to this heading"></a></h3>
<p id="index-0">This section describes the list of supported job attributes and the proper syntax for constructing the message text for notifications. The supported job attributes are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">allow_simultaneous</span></code> - (boolean) indicates if multiple jobs can run simultaneously from the JT associated with this job</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx_node</span></code> - (string) the instance that managed the isolated execution environment</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">created</span></code> - (datetime) timestamp when this job was created</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">custom_virtualenv</span></code> - (string) custom virtual environment used to execute job</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code> - (string) optional description of the job</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diff_mode</span></code> - (boolean) if enabled, textual changes made to any templated files on the host are shown in the standard output</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">elapsed</span></code> - (decimal) elapsed time in seconds that the job ran</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">execution_node</span></code> - (string) node the job executed on</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">failed</span></code> - (boolean) true if job failed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">finished</span></code> - (datetime) date and time the job finished execution</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">force_handlers</span></code> - (boolean) when handlers are forced, they will run when notified even if a task fails on that host (note that some conditions - e.g. unreachable hosts - can still prevent handlers from running)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forks</span></code> - (int) number of forks requested for job</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> - (int) database id for this job</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">job_explanation</span></code> - (string) status field to indicate the state of the job if it wasn’t able to run and capture stdout</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">job_slice_count</span></code> - (integer) if run as part of a sliced job, the total number of slices (if 1, job is not part of a sliced job)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">job_slice_number</span></code> - (integer) if run as part of a sliced job, the ID of the inventory slice operated on (if not part of a sliced job, attribute is not used)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">job_tags</span></code> - (string) only tasks with specified tags will execute</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">job_type</span></code> - (choice) run, check, or scan</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">launch_type</span></code> - (choice) manual, relaunch, callback, scheduled, dependency, workflow, sync, or scm</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">limit</span></code> - (string) playbook execution limited to this set of hosts, if specified</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modified</span></code> - (datetime) timestamp when this job was last modified</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - (string) name of this job</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">playbook</span></code> - (string) playbook executed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scm_revision</span></code> - (string) scm revision from the project used for this job, if available</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">skip_tags</span></code> - (string) playbook execution skips over this set of tag(s), if specified</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">start_at_task</span></code> - (string) playbook execution begins at the task matching this name, if specified</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">started</span></code> - (datetime) date and time the job was queued for starting</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">status</span></code> - (choice) new, pending, waiting, running, successful, failed, error, canceled</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timeout</span></code> - (int) amount of time (in seconds) to run before the task is canceled</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code> - (choice) data type for this job</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">url</span></code> - (string) URL for this job</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_fact_cache</span></code> - (boolean) if enabled for job, AWX acts as an Ansible Fact Cache Plugin, persisting facts at the end of a playbook run to the database and caching facts for use by Ansible</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbosity</span></code> - (choice) 0 through 5 (corresponding to Normal through WinRM Debug)</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">host_status_counts</span></code> (count of hosts uniquely assigned to each status)</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">skipped</span></code> (integer)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ok</span></code> (integer)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">changed</span></code> (integer)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">failures</span></code> (integer)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dark</span></code> (integer)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">processed</span></code> (integer)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rescued</span></code> (integer)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ignored</span></code> (integer)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">failed</span></code> (boolean)</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">summary_fields</span></code>:</dt><dd><ul>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">inventory</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> - (integer) database ID for inventory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - (string) name of the inventory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code> - (string) optional description of the inventory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">has_active_failures</span></code> - (boolean) (deprecated) flag indicating whether any hosts in this inventory have failed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_hosts</span></code> - (deprecated) (int) total number of hosts in this inventory.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hosts_with_active_failures</span></code> - (deprecated) (int) number of hosts in this inventory with active failures</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_groups</span></code> - (deprecated) (int) total number of groups in this inventory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">groups_with_active_failures</span></code> - (deprecated) (int) number of hosts in this inventory with active failures</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">has_inventory_sources</span></code> - (deprecated) (boolean) flag indicating whether this inventory has external inventory sources</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">total_inventory_sources</span></code> - (int) total number of external inventory sources configured within this inventory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inventory_sources_with_failures</span></code> - (int) number of external inventory sources in this inventory with failures</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">organization_id</span></code> - (id) organization containing this inventory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kind</span></code> - (choice) (empty string) (indicating hosts have direct link with inventory) or ‘smart’</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">project</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> - (int) database ID for project</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - (string) name of the project</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code> - (string) optional description of the project</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">status</span></code> - (choices) one of new, pending, waiting, running, successful, failed, error, canceled, never updated, ok, or missing</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scm_type</span> <span class="pre">(choice)</span></code> - one of (empty string), git, hg, svn, insights</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">job_template</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> - (int) database ID for job template</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - (string) name of job template</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code> - (string) optional description for the job template</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">unified_job_template</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> - (int) database ID for unified job template</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - (string) name of unified job template</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code> - (string) optional description for the unified job template</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unified_job_type</span></code> - (choice) unified job type (job, workflow_job, project_update, etc.)</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">instance_group</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> - (int) database ID for instance group</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - (string) name of instance group</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">created_by</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> - (int) database ID of user that launched the operation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">username</span></code> - (string) username that launched the operation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">first_name</span></code> - (string) first name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">last_name</span></code> - (string) last name</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">labels</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">count</span></code> - (int) number of labels</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">results</span></code> - list of dictionaries representing labels (e.g. {“id”: 5, “name”: “database jobs”})</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Information about a job can be referenced in a custom notification message using grouped curly braces <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">}}</span></code>. Specific job attributes are accessed using dotted notation, for example <code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">job.summary_fields.inventory.name</span> <span class="pre">}}</span></code>. Any characters used in front or around the braces, or plain text, can be added for clarification, such as ‘#’ for job ID and single-quotes to denote some descriptor. Custom messages can include a number of variables throughout the message:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">job_friendly_name</span> <span class="cp">}}</span><span class="w"> </span><span class="cp">{{</span> <span class="nv">job.id</span> <span class="cp">}}</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ran on </span><span class="cp">{{</span> <span class="nv">job.execution_node</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain"> in </span><span class="cp">{{</span> <span class="nv">job.elapsed</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain"> seconds.</span>
</pre></div>
</div>
<p>In addition to the job attributes, there are some other variables that can be added to the template:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">approval_node_name</span></code> - (string) the approval node name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">approval_status</span></code> - (choice) one of approved, denied, and timed_out</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">url</span></code> - (string) URL of the job for which the notification is emitted (this applies to start, success, fail, and approval notifications)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">workflow_url</span></code> - (string) URL to the relevant approval node. This allows the notification recipient to go to the relevant workflow job page to see what’s going on (i.e., <code class="docutils literal notranslate"><span class="pre">This</span> <span class="pre">node</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">viewed</span> <span class="pre">at:</span> <span class="pre">{{</span> <span class="pre">workflow_url</span> <span class="pre">}}</span></code>). In cases of approval-related notifications, both <code class="docutils literal notranslate"><span class="pre">url</span></code> and <code class="docutils literal notranslate"><span class="pre">workflow_url</span></code> are the same.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">job_friendly_name</span></code> - (string) the friendly name of the job</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">job_metadata</span></code> - (string) job metadata as a JSON string, for example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span><span class="s">&#39;url&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;https://awxhost/$/jobs/playbook/13&#39;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&#39;traceback&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&#39;status&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;running&#39;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&#39;started&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;2019-08-07T21:46:38.362630+00:00&#39;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&#39;project&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;Stub</span><span class="nv"> </span><span class="s">project&#39;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&#39;playbook&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;ping.yml&#39;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&#39;name&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;Stub</span><span class="nv"> </span><span class="s">Job</span><span class="nv"> </span><span class="s">Template&#39;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&#39;limit&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&#39;inventory&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;Stub</span><span class="nv"> </span><span class="s">Inventory&#39;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&#39;id&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">42</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&#39;hosts&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{},</span>
<span class="w"> </span><span class="s">&#39;friendly_name&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;Job&#39;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&#39;finished&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">False</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&#39;credential&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;Stub</span><span class="nv"> </span><span class="s">credential&#39;</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&#39;created_by&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;admin&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
</li>
</ul>
</section>
<span id="document-userguide/scheduling"></span><blockquote>
<div></div></blockquote>
<section id="schedules">
<span id="ug-scheduling"></span><h3><span class="section-number">29. </span>Schedules<a class="headerlink" href="#schedules" title="Link to this heading"></a></h3>
<p id="index-0">You can access all your configured schedules by clicking <strong>Schedules</strong> from the left navigation bar. The schedules list may be sorted by any of the attributes from each column using the directional arrows. You can also search by name, date, or the name of the month in which a schedule runs.</p>
<p>Each schedule has a corresponding <strong>Actions</strong> column that has options to enable/disable that schedule using the <strong>ON/OFF</strong> toggle next to the schedule name and to allow editing (<img alt="edit" src="_images/edit-button.png" />) of that schedule.</p>
<img alt="_images/schedules-sample-list.png" src="_images/schedules-sample-list.png" />
<p>If you are setting up a template, a project, or an inventory source, clicking on the <strong>Schedules</strong> tab allows you to configure schedules for these resources. Once schedules are created, they are listed by:</p>
<ul class="simple">
<li><p><strong>Name</strong>: Clicking the schedule name opens its details</p></li>
<li><p><strong>Type</strong>: Identifies whether the schedule is associated with a source control update or a system-managed job schedule</p></li>
<li><p><strong>Next Run</strong>: The next scheduled run of this task</p></li>
</ul>
<img alt="_images/generic-schedules-example-list.png" src="_images/generic-schedules-example-list.png" />
<section id="add-a-new-schedule">
<h4><span class="section-number">29.1. </span>Add a new schedule<a class="headerlink" href="#add-a-new-schedule" title="Link to this heading"></a></h4>
<p>Schedules can only be created from a template, project, or inventory source, and not directly on the main <strong>Schedules</strong> screen itself. To create a new schedule:</p>
<ol class="arabic simple">
<li><p>Click the <strong>Schedules</strong> tab of the resource you are configuring (template, project, or inventory source).</p></li>
<li><p>Click the <strong>Add</strong> button, which opens the <strong>Create Schedule</strong> window.</p></li>
</ol>
<img alt="_images/generic-create-schedule.png" src="_images/generic-create-schedule.png" />
<ol class="arabic simple" start="3">
<li><p>Enter the appropriate details into the following fields:</p></li>
</ol>
<ul class="simple">
<li><p><strong>Name</strong> (required)</p></li>
<li><p><strong>Start Date</strong> (required)</p></li>
<li><p><strong>Start Time</strong> (required)</p></li>
<li><p><strong>Local Time Zone</strong> - The entered Start Time should be in this timezone</p></li>
<li><p><strong>Repeat Frequency</strong> - Appropriate scheduling options display depending on the frequency you select</p></li>
</ul>
<p>The <strong>Schedule Details</strong> displays when you established a schedule, allowing you to review the schedule settings and a list of the scheduled occurrences in the selected Local Time Zone.</p>
<img alt="_images/generic-create-schedule-details.png" src="_images/generic-create-schedule-details.png" />
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Jobs are scheduled in UTC. Repeating jobs that run at a specific time of day may move relative to a local timezone when Daylight Savings Time shifts occur. The system resolves the local time zone based time to UTC when the schedule is saved.  To ensure your schedules are correctly set, you should set your schedules in UTC time.</p>
</div>
<ol class="arabic simple" start="4">
<li><p>Once done, click <strong>Save</strong>.</p></li>
</ol>
<p>You can use the <strong>ON/OFF</strong> toggle button to stop an active schedule or activate a stopped schedule.</p>
<img alt="_images/generic-schedules-list-configured.png" src="_images/generic-schedules-list-configured.png" />
</section>
</section>
<span id="document-userguide/insights"></span><section id="setting-up-insights-remediations">
<span id="insights"></span><h3><span class="section-number">30. </span>Setting up Insights Remediations<a class="headerlink" href="#setting-up-insights-remediations" title="Link to this heading"></a></h3>
<p id="index-0">Automation controller supports integration with Red Hat Insights. Once a host is registered with Insights, it will be continually scanned for vulnerabilities and known configuration conflicts. Each of the found problems may have an associated fix in the form of an Ansible playbook. Insights users create a maintenance plan to group the fixes and, ultimately, create a playbook to mitigate the problems. Automation controller tracks the maintenance plan playbooks via an Insights project. Authentication to Insights via Basic Auth is backed by a special Insights Credential, which must first be established in automation controller. To ultimately run an Insights Maintenance Plan, you need an Insights project, and an Insights inventory.</p>
<section id="create-insights-credential">
<h4><span class="section-number">30.1. </span>Create Insights Credential<a class="headerlink" href="#create-insights-credential" title="Link to this heading"></a></h4>
<p id="index-1">To create a new credential for use with Insights:</p>
<ol class="arabic simple">
<li><p>Click <strong>Credentials</strong> from the left navigation bar to access the Credentials page.</p></li>
<li><p>Click the <strong>Add</strong> button located in the upper right corner of the Credentials screen.</p></li>
<li><p>Enter the name of the credential to be used in the <strong>Name</strong> field.</p></li>
<li><p>Optionally enter a description for this credential in the <strong>Description</strong> field.</p></li>
<li><p>In the <strong>Organization</strong> field, optionally enter the name of the organization with which the credential is associated, or click the <img alt="Search button to select the organization from a pop-up window" src="_images/search-button.png" /> button and select it from the pop-up window.</p></li>
</ol>
<ol class="arabic simple" start="6">
<li><p>In the <strong>Credential Type</strong> field, enter <strong>Insights</strong> or select it from the drop-down list.</p></li>
</ol>
<img alt="Dropdown menu for selecting the &quot;Insights&quot; Credential Type" src="_images/credential-types-popup-window-insights.png" />
<ol class="arabic simple" start="7">
<li><p>Enter a valid Insights credential in the <strong>Username</strong> and <strong>Password</strong> fields.</p></li>
</ol>
<p><img alt="Create new credential form showing example Insights credential" src="_images/insights-create-with-demo-credentials.png" /></p>
<ol class="arabic simple" start="8">
<li><p>Click <strong>Save</strong> when done.</p></li>
</ol>
</section>
<section id="create-an-insights-project">
<h4><span class="section-number">30.2. </span>Create an Insights Project<a class="headerlink" href="#create-an-insights-project" title="Link to this heading"></a></h4>
<p id="index-2">To create a new Insights project:</p>
<ol class="arabic simple">
<li><p>Click <strong>Projects</strong> from the left navigation bar to access the Projects page.</p></li>
<li><p>Click the <strong>Add</strong> button located in the upper right corner of the Projects screen.</p></li>
<li><p>Enter the appropriate details into the required fields, at minimum. Note the following fields requiring specific Insights-related entries:</p></li>
</ol>
<ul class="simple">
<li><p><strong>Name</strong>: Enter the name for your Insights project.</p></li>
<li><p><strong>Organization</strong>: Enter the name of the organization associated with this project, or click the <img alt="Search button to select the organization from a pop-up window" src="_images/search-button.png" /> button and select it from the pop-up window.</p></li>
<li><p><strong>SCM Type</strong>: Select <strong>Red Hat Insights</strong>.</p></li>
<li><p>Upon selecting the SCM type, the <strong>Source Details</strong> field expands.</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p>The <strong>Credential</strong> field is pre-populated with the Insights credential you previously created. If not, enter the credential, or click the <img alt="Search button to select the organization from a pop-up window" src="_images/search-button.png" /> button and select it from the pop-up window.</p></li>
<li><p>Click to select the update option(s) for this project from the <strong>Options</strong> field, and provide any additional values, if applicable. For information about each option, click the tooltip <img alt="tooltip" src="_images/tooltips-icon.png" /> next to the options.</p></li>
</ol>
<p><img alt="Form for creating a new Insights project with specific Insights-related details" src="_images/insights-create-project-insights-form.png" /></p>
<ol class="arabic simple" start="6">
<li><p>Click <strong>Save</strong> when done.</p></li>
</ol>
<p>All SCM/Project syncs occur automatically the first time you save a new project. However, if you want them to be updated to what is current in Insights, manually update the SCM-based project by clicking the <img alt="Update button to manually refresh the SCM-based project" src="_images/update-button.png" /> button under the project’s available Actions.</p>
<p>This process syncs your Insights project with your Insights account solution. Notice that the status dot beside the name of the project updates once the sync has run.</p>
<p><img alt="Projects list showing successfully created sample Insights project" src="_images/insights-create-project-insights-succeed.png" /></p>
</section>
<section id="create-insights-inventory">
<h4><span class="section-number">30.3. </span>Create Insights Inventory<a class="headerlink" href="#create-insights-inventory" title="Link to this heading"></a></h4>
<p id="index-3">The Insights playbook contains a <cite>hosts:</cite> line where the value is the hostname that Insights itself knows about,  which may be different than the hostname that AWX knows about. To use an Insights playbook, you will need an Insights inventory.</p>
<p>To create a new inventory for use with Insights, see <a class="reference internal" href="index.html#ug-source-insights"><span class="std std-ref">Red Hat Insights</span></a>.</p>
</section>
<section id="remediate-insights-inventory">
<h4><span class="section-number">30.4. </span>Remediate Insights Inventory<a class="headerlink" href="#remediate-insights-inventory" title="Link to this heading"></a></h4>
<p id="index-4">Remediation of an Insights inventory allows AWX to run Insights playbooks with a single click. This is done by creating a Job Template to run the Insights remediation.</p>
<ol class="arabic simple">
<li><p>Click <strong>Job Templates</strong> from the left navigation bar to access the Job Templates page.</p></li>
<li><p>Create a new Job Template, with the appropriate details into the required fields, at minimum.  Note the following fields requiring specific Insights-related entries:</p></li>
</ol>
<ul class="simple">
<li><p><strong>Name</strong>: Enter the name of your Maintenance Plan.</p></li>
<li><p><strong>Job Type</strong>: If not already populated, select <strong>Run</strong> from the drop-down menu list.</p></li>
<li><p><strong>Inventory</strong>: Select the Insights Inventory you previously created.</p></li>
<li><p><strong>Project</strong>: Select the Insights project you previously created.</p></li>
<li><p><strong>Playbook</strong>: Select a playbook associated with the Maintenance Plan you want to run from the drop-down menu list.</p></li>
<li><p><strong>Credential</strong>: Enter the credential to use for this project or click the <img alt="Search button to select the organization from a pop-up window" src="_images/search-button.png" /> button and select it from the pop-up window. The credential does not have to be an Insights credential.</p></li>
<li><p><strong>Verbosity</strong>: Keep the default setting, or select the desired verbosity from the drop-down menu list.</p></li>
</ul>
<p><img alt="Form for creating a maintenance plan template for Insights remediation." src="_images/insights-create-new-job-template-maintenance-plan-filled.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Click <strong>Save</strong> when done.</p></li>
<li><p>Click the <img alt="Launch icon." src="_images/launch-button.png" /> icon to launch the job template.</p></li>
</ol>
<p>Once complete, the job results display in the Job Details page.</p>
</section>
</section>
<span id="document-userguide/best_practices"></span><section id="best-practices">
<h3><span class="section-number">31. </span>Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading"></a></h3>
<section id="use-source-control">
<span id="index-0"></span><h4><span class="section-number">31.1. </span>Use Source Control<a class="headerlink" href="#use-source-control" title="Link to this heading"></a></h4>
<p id="index-1">While AWX supports playbooks stored directly on the server, best practice is to store your playbooks, roles, and any associated details in source control. This way you have an audit trail describing when and why you changed the rules that are automating your infrastructure. Plus, it allows for easy sharing of playbooks with other parts of your infrastructure or team.</p>
</section>
<section id="ansible-file-and-directory-structure">
<h4><span class="section-number">31.2. </span>Ansible file and directory structure<a class="headerlink" href="#ansible-file-and-directory-structure" title="Link to this heading"></a></h4>
<p id="index-2">Please review the <a class="reference external" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_best_practices.html">Ansible Tips and Tricks</a> from the Ansible documentation. If creating a common set of roles to use across projects, these should be accessed via source control submodules, or a common location such as <code class="docutils literal notranslate"><span class="pre">/opt</span></code>. Projects should not expect to import roles or content from other projects.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Playbooks should not use the <code class="docutils literal notranslate"><span class="pre">vars_prompt</span></code> feature, as AWX does not interactively allow for <code class="docutils literal notranslate"><span class="pre">vars_prompt</span></code> questions. If you must use <code class="docutils literal notranslate"><span class="pre">vars_prompt</span></code>, refer to and make use of the <a class="reference internal" href="index.html#ug-surveys"><span class="std std-ref">Surveys</span></a> functionality.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Playbooks should not use the <code class="docutils literal notranslate"><span class="pre">pause</span></code> feature of Ansible without a timeout, as AWX does not allow for interactively cancelling a pause. If you must use <code class="docutils literal notranslate"><span class="pre">pause</span></code>, ensure that you set a timeout.</p>
</div>
<p>Jobs run use the playbook directory as the current working
directory, although jobs should be coded to use the <code class="docutils literal notranslate"><span class="pre">playbook_dir</span></code>
variable rather than relying on this.</p>
</section>
<section id="use-dynamic-inventory-sources">
<h4><span class="section-number">31.3. </span>Use Dynamic Inventory Sources<a class="headerlink" href="#use-dynamic-inventory-sources" title="Link to this heading"></a></h4>
<p id="index-3">If you have an external source of truth for your infrastructure, whether it is a cloud provider or a local CMDB, it is best to define an inventory sync process and use the support for dynamic inventory (including cloud inventory sources). This ensures your inventory is always up to date.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Edits and additions to Inventory host variables persist beyond an inventory sync as long as <code class="docutils literal notranslate"><span class="pre">--overwrite_vars</span></code> is <strong>not</strong> set.</p>
</div>
</section>
<section id="variable-management-for-inventory">
<h4><span class="section-number">31.4. </span>Variable Management for Inventory<a class="headerlink" href="#variable-management-for-inventory" title="Link to this heading"></a></h4>
<p id="index-4">Keeping variable data along with the hosts and groups definitions (see the inventory
editor) is encouraged, rather than using <code class="docutils literal notranslate"><span class="pre">group_vars/</span></code> and
<code class="docutils literal notranslate"><span class="pre">host_vars/</span></code>. If you use dynamic inventory sources, AWX can sync
such variables with the database as long as the <strong>Overwrite Variables</strong>
option is not set.</p>
</section>
<section id="autoscaling">
<h4><span class="section-number">31.5. </span>Autoscaling<a class="headerlink" href="#autoscaling" title="Link to this heading"></a></h4>
<p id="index-5">Using the “callback” feature to allow newly booting instances to request
configuration is very useful for auto-scaling scenarios or provisioning
integration.</p>
</section>
<section id="larger-host-counts">
<h4><span class="section-number">31.6. </span>Larger Host Counts<a class="headerlink" href="#larger-host-counts" title="Link to this heading"></a></h4>
<p id="index-6">Consider setting “forks” on a job template to larger values to increase
parallelism of execution runs. For more information on tuning Ansible,
see <a class="reference external" href="http://www.ansible.com/blog/ansible-performance-tuning">the Ansible
blog</a>.</p>
</section>
<section id="continuous-integration-continuous-deployment">
<h4><span class="section-number">31.7. </span>Continuous integration / Continuous Deployment<a class="headerlink" href="#continuous-integration-continuous-deployment" title="Link to this heading"></a></h4>
<p id="index-7">For a Continuous Integration system, such as Jenkins, to spawn a job, it should make a curl request to a job template. The credentials to the job template should not require prompting for any particular passwords. Refer to the <a class="reference external" href="https://docs.ansible.com/automation-controller/latest/html/controllercli/usage.html">CLI documentation</a> for configuration and usage instructions.</p>
<blockquote>
<div></div></blockquote>
</section>
</section>
<span id="document-userguide/security"></span><section id="security">
<span id="ug-security"></span><h3><span class="section-number">32. </span>Security<a class="headerlink" href="#security" title="Link to this heading"></a></h3>
<p id="index-0">The following sections will help you gain an understanding of how AWX handles and lets you control file system security.</p>
<p>All playbooks are executed via the <code class="docutils literal notranslate"><span class="pre">awx</span></code> file system user. For running jobs, AWX offers job isolation via the use of Linux containers. This projection ensures jobs can only access playbooks, roles, and data from the Project directory for that job template.</p>
<p>For credential security, users may choose to upload locked SSH keys and set the unlock password to “ask”. You can also choose to have the system prompt them for SSH credentials or sudo passwords rather than having the system store them in the database.</p>
<section id="playbook-access-and-information-sharing">
<h4><span class="section-number">32.1. </span>Playbook Access and Information Sharing<a class="headerlink" href="#playbook-access-and-information-sharing" title="Link to this heading"></a></h4>
<p id="index-1">AWX’s use of automation execution environments and Linux containers prevents playbooks from reading files outside of their project directory.</p>
<p>By default, the only data exposed to the ansible-playbook process inside the container is the current project being used.</p>
<p>You can customize this in the Job Settings and expose additional directories from the host into the container. Refer the next section, <a class="reference internal" href="#ug-isolation"><span class="std std-ref">Isolation functionality and variables</span></a> for more information.</p>
<section id="isolation-functionality-and-variables">
<span id="ug-isolation"></span><h5><span class="section-number">32.1.1. </span>Isolation functionality and variables<a class="headerlink" href="#isolation-functionality-and-variables" title="Link to this heading"></a></h5>
<p id="index-2">AWX uses container technology to isolate jobs from each other. By default, only the current project is exposed to the container running a job template.</p>
<p>You may find that you need to customize your playbook runs to expose additional directories. To fine tune your usage of job isolation, there are certain variables that can be set.</p>
<p>By default, AWX will use the system’s <code class="docutils literal notranslate"><span class="pre">tmp</span></code> directory (<code class="docutils literal notranslate"><span class="pre">/tmp</span></code> by default) as its staging area. This can be changed in the <strong>Job Execution Path</strong> field of the Jobs settings screen, or in the REST API at <code class="docutils literal notranslate"><span class="pre">/api/v2/settings/jobs</span></code>:</p>
<p><code class="docutils literal notranslate"><span class="pre">AWX_ISOLATION_BASE_PATH</span> <span class="pre">=</span> <span class="pre">&quot;/opt/tmp&quot;</span></code></p>
<p>If there are any additional directories that should specifically be exposed from the host to the container that playbooks run in, you can specify those in the <strong>Paths to Expose to Isolated Jobs</strong>
field of the Jobs setting screen, or in the REST API at <code class="docutils literal notranslate"><span class="pre">/api/v2/settings/jobs</span></code>:</p>
<p><code class="docutils literal notranslate"><span class="pre">AWX_ISOLATION_SHOW_PATHS</span> <span class="pre">=</span> <span class="pre">['/list/of/',</span> <span class="pre">'/paths']</span></code></p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The primary file you may want to add to <code class="docutils literal notranslate"><span class="pre">AWX_ISOLATION_SHOW_PATHS</span></code> is <code class="docutils literal notranslate"><span class="pre">/var/lib/awx/.ssh</span></code>, if your playbooks need to use keys or settings defined there.</p>
</div>
</div></blockquote>
<p>The above fields can be found in the Jobs Settings window:</p>
<img alt="_images/configure-awx-jobs-isolated-jobs-fields.png" src="_images/configure-awx-jobs-isolated-jobs-fields.png" />
</section>
</section>
</section>
<span id="document-userguide/glossary"></span><section id="glossary">
<h3><span class="section-number">33. </span>Glossary<a class="headerlink" href="#glossary" title="Link to this heading"></a></h3>
<dl class="simple glossary">
<dt id="term-Ad-Hoc">Ad Hoc<a class="headerlink" href="#term-Ad-Hoc" title="Link to this term"></a></dt><dd><p>Refers to running Ansible to perform some quick command, using /usr/bin/ansible, rather than the orchestration language, which is /usr/bin/ansible-playbook. An example of an ad hoc command might be rebooting 50 machines in your infrastructure. Anything you can do ad hoc can be accomplished by writing a Playbook, and Playbooks can also glue lots of other operations together.</p>
</dd>
<dt id="term-Callback-Plugin">Callback Plugin<a class="headerlink" href="#term-Callback-Plugin" title="Link to this term"></a></dt><dd><p>Refers to some user-written code that can intercept results from Ansible and do something with them. Some supplied examples in the GitHub project perform custom logging, send email, or even play sound effects.</p>
</dd>
<dt id="term-Control-Groups">Control Groups<a class="headerlink" href="#term-Control-Groups" title="Link to this term"></a></dt><dd><p>Also known as ‘<em>cgroups</em>’, a control group is a feature in the Linux kernel that allows resources to be grouped and allocated to run certain processes. In addition to assigning resources to processes, cgroups can also report actual resource usage by all processes running inside of the cgroup.</p>
</dd>
<dt id="term-Check-Mode">Check Mode<a class="headerlink" href="#term-Check-Mode" title="Link to this term"></a></dt><dd><p>Refers to running Ansible with the <code class="docutils literal notranslate"><span class="pre">--check</span></code> option, which does not make any changes on the remote systems, but only outputs the changes that might occur if the command ran without this flag. This is analogous to so-called “dry run” modes in other systems, though the user should be warned that this does not take into account unexpected command failures or cascade effects (which is true of similar modes in other systems). Use this to get an idea of what might happen, but it is not a substitute for a good staging environment.</p>
</dd>
<dt id="term-Container-Groups">Container Groups<a class="headerlink" href="#term-Container-Groups" title="Link to this term"></a></dt><dd><p>Container Groups are a type of Instance Group that specify a configuration for provisioning a pod in a Kubernetes or OpenShift cluster where a job is run. These pods are provisioned on-demand and exist only for the duration of the playbook run.</p>
</dd>
<dt id="term-Credentials">Credentials<a class="headerlink" href="#term-Credentials" title="Link to this term"></a></dt><dd><p>Authentication details that may be utilized by AWX to launch jobs against machines, to synchronize with inventory sources, and to import project content from a version control system.</p>
</dd>
<dt id="term-Credential-Plugin">Credential Plugin<a class="headerlink" href="#term-Credential-Plugin" title="Link to this term"></a></dt><dd><p>Python code that contains definitions for an external credential type, its metadata fields, and the code needed for interacting with a secret management system.</p>
</dd>
<dt id="term-Distributed-Job">Distributed Job<a class="headerlink" href="#term-Distributed-Job" title="Link to this term"></a></dt><dd><p>A job that consists of a job template, an inventory, and slice size. When executed, a distributed job slices each inventory into a number of “slice size” chunks, which are then used to run smaller job slices.</p>
</dd>
<dt id="term-External-Credential-Type">External Credential Type<a class="headerlink" href="#term-External-Credential-Type" title="Link to this term"></a></dt><dd><p>A managed credential type for AWX used for authenticating with a secret management system.</p>
</dd>
<dt id="term-Facts">Facts<a class="headerlink" href="#term-Facts" title="Link to this term"></a></dt><dd><p>Facts are simply things that are discovered about remote nodes. While they can be used in playbooks and templates just like variables, facts are things that are inferred, rather than set. Facts are automatically discovered when running plays by executing the internal setup module on the remote nodes. You never have to call the setup module explicitly, it just runs, but it can be disabled to save time if it is not needed. For the convenience of users who are switching from other configuration management systems, the fact module also pulls in facts from the ‘ohai’ and ‘facter’ tools if they are installed, which are fact libraries from Chef and Puppet, respectively.</p>
</dd>
<dt id="term-Forks">Forks<a class="headerlink" href="#term-Forks" title="Link to this term"></a></dt><dd><p>Ansible and AWX talk to remote nodes in parallel and the level of parallelism can be set several ways–during the creation or editing of a Job Template, by passing <code class="docutils literal notranslate"><span class="pre">--forks</span></code>, or by editing the default in a configuration file. The default is a very conservative 5 forks, though if you have a lot of RAM, you can easily set this to a value like 50 for increased parallelism.</p>
</dd>
<dt id="term-Group">Group<a class="headerlink" href="#term-Group" title="Link to this term"></a></dt><dd><p>A set of hosts in Ansible that can be addressed as a set, of which many may exist within a single Inventory.</p>
</dd>
<dt id="term-Group-Vars">Group Vars<a class="headerlink" href="#term-Group-Vars" title="Link to this term"></a></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">group_vars/</span></code> files are files that live in a directory alongside an inventory file, with an optional filename named after each group. This is a convenient place to put variables that will be provided to a given group, especially complex data structures, so that these variables do not have to be embedded in the inventory file or playbook.</p>
</dd>
<dt id="term-Handlers">Handlers<a class="headerlink" href="#term-Handlers" title="Link to this term"></a></dt><dd><p>Handlers are just like regular tasks in an Ansible playbook (see Tasks), but are only run if the Task contains a “notify” directive and also indicates that it changed something. For example, if a config file is changed then the task referencing the config file templating operation may notify a service restart handler. This means services can be bounced only if they need to be restarted. Handlers can be used for things other than service restarts, but service restarts are the most common usage.</p>
</dd>
<dt id="term-Host">Host<a class="headerlink" href="#term-Host" title="Link to this term"></a></dt><dd><p>A system managed by AWX, which may include a physical, virtual, cloud-based server, or other device. Typically an operating system instance. Hosts are contained in Inventory. Sometimes referred to as a “node”.</p>
</dd>
<dt id="term-Host-Specifier">Host Specifier<a class="headerlink" href="#term-Host-Specifier" title="Link to this term"></a></dt><dd><p>Each Play in Ansible maps a series of tasks (which define the role, purpose, or orders of a system) to a set of systems. This “hosts:” directive in each play is often called the hosts specifier. It may select one system, many systems, one or more groups, or even some hosts that are in one group and explicitly not in another.</p>
</dd>
<dt id="term-Instance-Group">Instance Group<a class="headerlink" href="#term-Instance-Group" title="Link to this term"></a></dt><dd><p>A group that contains instances for use in a clustered environment. An instance group provides the ability to group instances based on policy.</p>
</dd>
<dt id="term-Inventory">Inventory<a class="headerlink" href="#term-Inventory" title="Link to this term"></a></dt><dd><p>A collection of hosts against which Jobs may be launched.</p>
</dd>
<dt id="term-Inventory-Script">Inventory Script<a class="headerlink" href="#term-Inventory-Script" title="Link to this term"></a></dt><dd><p>A very simple program (or a complicated one) that looks up hosts, group membership for hosts, and variable information from an external resource–whether that be a SQL database, a CMDB solution, or something like LDAP. This concept was adapted from Puppet (where it is called an “External Nodes Classifier”) and works more or less exactly the same way.</p>
</dd>
<dt id="term-Inventory-Source">Inventory Source<a class="headerlink" href="#term-Inventory-Source" title="Link to this term"></a></dt><dd><p>Information about a cloud or other script that should be merged into the current inventory group, resulting in the automatic population of Groups, Hosts, and variables about those groups and hosts.</p>
</dd>
<dt id="term-Job">Job<a class="headerlink" href="#term-Job" title="Link to this term"></a></dt><dd><p>One of many background tasks launched by AWX, this is usually the instantiation of a Job Template; the launch of an Ansible playbook. Other types of jobs include inventory imports, project synchronizations from source control, or administrative cleanup actions.</p>
</dd>
<dt id="term-Job-Detail">Job Detail<a class="headerlink" href="#term-Job-Detail" title="Link to this term"></a></dt><dd><p>The history of running a particular job, including its output and success/failure status.</p>
</dd>
<dt id="term-Job-Slice">Job Slice<a class="headerlink" href="#term-Job-Slice" title="Link to this term"></a></dt><dd><p>See <a class="reference internal" href="#term-Distributed-Job"><span class="xref std std-term">Distributed Job</span></a>.</p>
</dd>
<dt id="term-Job-Template">Job Template<a class="headerlink" href="#term-Job-Template" title="Link to this term"></a></dt><dd><p>The combination of an Ansible playbook and the set of parameters required to launch it.</p>
</dd>
<dt id="term-JSON">JSON<a class="headerlink" href="#term-JSON" title="Link to this term"></a></dt><dd><p>Ansible and AWX use JSON for return data from remote modules. This allows modules to be written in any language, not just Python.</p>
</dd>
<dt id="term-Mesh">Mesh<a class="headerlink" href="#term-Mesh" title="Link to this term"></a></dt><dd><p>Describes a network comprising of nodes. Communication between nodes is established at the transport layer by protocols such as TCP, UDP or Unix sockets. See also, <a class="reference internal" href="#term-Node"><span class="xref std std-term">node</span></a>.</p>
</dd>
<dt id="term-Metadata">Metadata<a class="headerlink" href="#term-Metadata" title="Link to this term"></a></dt><dd><p>Information for locating a secret in the external system once authenticated. The uses provides this information when linking an external credential to a target credential field.</p>
</dd>
<dt id="term-Node">Node<a class="headerlink" href="#term-Node" title="Link to this term"></a></dt><dd><p>A node corresponds to entries in the instance database model, or the <code class="docutils literal notranslate"><span class="pre">/api/v2/instances/</span></code> endpoint, and is a machine participating in the cluster / mesh. The unified jobs API reports <code class="docutils literal notranslate"><span class="pre">awx_node</span></code> and <code class="docutils literal notranslate"><span class="pre">execution_node</span></code> fields. The execution node is where the job runs, and AWX node interfaces between the job and server functions.</p>
</dd>
<dt id="term-Notification-Template">Notification Template<a class="headerlink" href="#term-Notification-Template" title="Link to this term"></a></dt><dd><p>An instance of a notification type (Email, Slack, Webhook, etc.) with a name, description, and a defined configuration.</p>
</dd>
<dt id="term-Notification">Notification<a class="headerlink" href="#term-Notification" title="Link to this term"></a></dt><dd><p>A manifestation of the notification template; for example, when a job fails a notification is sent using the configuration defined by the notification template.</p>
</dd>
<dt id="term-Notify">Notify<a class="headerlink" href="#term-Notify" title="Link to this term"></a></dt><dd><p>The act of a task registering a change event and informing a handler task that another action needs to be run at the end of the play. If a handler is notified by multiple tasks, it will still be run only once. Handlers are run in the order they are listed, not in the order that they are notified.</p>
</dd>
<dt id="term-Organization">Organization<a class="headerlink" href="#term-Organization" title="Link to this term"></a></dt><dd><p>A logical collection of Users, Teams, Projects, and Inventories. The highest level in the AWX object hierarchy is the Organization.</p>
</dd>
<dt id="term-Organization-Administrator">Organization Administrator<a class="headerlink" href="#term-Organization-Administrator" title="Link to this term"></a></dt><dd><p>An AWX user with the rights to modify the Organization’s membership and settings, including making new users and projects within that organization. An organization admin can also grant permissions to other users within the organization.</p>
</dd>
<dt id="term-Permissions">Permissions<a class="headerlink" href="#term-Permissions" title="Link to this term"></a></dt><dd><p>The set of privileges assigned to Users and Teams that provide the ability to read, modify, and administer Projects, Inventories, and other AWX objects.</p>
</dd>
<dt id="term-Plays">Plays<a class="headerlink" href="#term-Plays" title="Link to this term"></a></dt><dd><p>A playbook is a list of plays. A play is minimally a mapping between a set of hosts selected by a host specifier (usually chosen by groups, but sometimes by hostname globs) and the tasks which run on those hosts to define the role that those systems will perform. There can be one or many plays in a playbook.</p>
</dd>
<dt id="term-Playbook">Playbook<a class="headerlink" href="#term-Playbook" title="Link to this term"></a></dt><dd><p>An Ansible playbook. Refer to <a class="reference external" href="http://docs.ansible.com/">http://docs.ansible.com/</a> for more information.</p>
</dd>
<dt id="term-Policy">Policy<a class="headerlink" href="#term-Policy" title="Link to this term"></a></dt><dd><p>Policies dictate how instance groups behave and how jobs are executed.</p>
</dd>
<dt id="term-Project">Project<a class="headerlink" href="#term-Project" title="Link to this term"></a></dt><dd><p>A logical collection of Ansible playbooks, represented in AWX.</p>
</dd>
<dt id="term-Roles">Roles<a class="headerlink" href="#term-Roles" title="Link to this term"></a></dt><dd><p>Roles are units of organization in Ansible and AWX. Assigning a role to a group of hosts (or a set of groups, or host patterns, etc.) implies that they should implement a specific behavior. A role may include applying certain variable values, certain tasks, and certain handlers–or just one or more of these things. Because of the file structure associated with a role, roles become redistributable units that allow you to share behavior among playbooks–or even with other users.</p>
</dd>
<dt id="term-Secret-Management-System">Secret Management System<a class="headerlink" href="#term-Secret-Management-System" title="Link to this term"></a></dt><dd><p>A server or service for securely storing and controlling access to tokens, passwords, certificates, encryption keys, and other sensitive data.</p>
</dd>
<dt id="term-Schedule">Schedule<a class="headerlink" href="#term-Schedule" title="Link to this term"></a></dt><dd><p>The calendar of dates and times for which a job should run automatically.</p>
</dd>
<dt id="term-Sliced-Job">Sliced Job<a class="headerlink" href="#term-Sliced-Job" title="Link to this term"></a></dt><dd><p>See <a class="reference internal" href="#term-Distributed-Job"><span class="xref std std-term">Distributed Job</span></a>.</p>
</dd>
<dt id="term-Source-Credential">Source Credential<a class="headerlink" href="#term-Source-Credential" title="Link to this term"></a></dt><dd><p>An external credential that is linked to the field of a target credential.</p>
</dd>
<dt id="term-Sudo">Sudo<a class="headerlink" href="#term-Sudo" title="Link to this term"></a></dt><dd><p>Ansible does not require root logins and, since it is daemonless, does not require root level daemons (which can be a security concern in sensitive environments). Ansible can log in and perform many operations wrapped in a <code class="docutils literal notranslate"><span class="pre">sudo</span></code> command, and can work with both password-less and password-based sudo. Some operations that do not normally work with <code class="docutils literal notranslate"><span class="pre">sudo</span></code> (like <code class="docutils literal notranslate"><span class="pre">scp</span></code> file transfer) can be achieved with Ansible’s <em>copy</em>, <em>template</em>, and <em>fetch</em> modules while running in <code class="docutils literal notranslate"><span class="pre">sudo</span></code> mode.</p>
</dd>
<dt id="term-Superuser">Superuser<a class="headerlink" href="#term-Superuser" title="Link to this term"></a></dt><dd><p>An admin of the AWX server who has permission to edit any object in the system, whether associated to any organization. Superusers can create organizations and other superusers.</p>
</dd>
<dt id="term-Survey">Survey<a class="headerlink" href="#term-Survey" title="Link to this term"></a></dt><dd><p>Questions asked by a job template at job launch time, configurable on the job template.</p>
</dd>
<dt id="term-Target-Credential">Target Credential<a class="headerlink" href="#term-Target-Credential" title="Link to this term"></a></dt><dd><p>A non-external credential with an input field that is linked to an external credential.</p>
</dd>
<dt id="term-Team">Team<a class="headerlink" href="#term-Team" title="Link to this term"></a></dt><dd><p>A sub-division of an Organization with associated Users, Projects, Credentials, and Permissions. Teams provide a means to implement role-based access control schemes and delegate responsibilities across Organizations.</p>
</dd>
<dt id="term-User">User<a class="headerlink" href="#term-User" title="Link to this term"></a></dt><dd><p>An AWX operator with associated permissions and credentials.</p>
</dd>
<dt id="term-Webhook">Webhook<a class="headerlink" href="#term-Webhook" title="Link to this term"></a></dt><dd><p>Webhooks allow communication and information sharing between apps. They are used to respond to commits pushed to SCMs and launch job templates or workflow templates.</p>
</dd>
<dt id="term-Workflow-Job-Template">Workflow Job Template<a class="headerlink" href="#term-Workflow-Job-Template" title="Link to this term"></a></dt><dd><p>A set consisting of any combination of job templates, project syncs, and inventory syncs, linked together in order to execute them as a single unit.</p>
</dd>
<dt id="term-YAML">YAML<a class="headerlink" href="#term-YAML" title="Link to this term"></a></dt><dd><p>Ansible and AWX use YAML to define playbook configuration languages and also variable files. YAML has a minimum of syntax, is very clean, and is easy for people to skim. It is a good data format for configuration files and humans, but is also machine readable. YAML is fairly popular in the dynamic language community and the format has libraries available for serialization in many languages (Python, Perl, Ruby, etc.).</p>
</dd>
</dl>
</section>
</div>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-rest_api/index"></span><section id="awx-api-reference">
<span id="api-start"></span><h2>AWX API Reference<a class="headerlink" href="#awx-api-reference" title="Link to this heading"></a></h2>
<p>Developer reference for the AWX API.</p>
<p>This guide applies to the latest version of AWX only.
The content in this guide is updated frequently and might contain functionality that is not available in previous versions.
Likewise content in this guide can be removed or replaced if it applies to functionality that is no longer available in the latest version.</p>
<p><strong>Join us online</strong></p>
<p>We talk about AWX documentation on Matrix at <a class="reference external" href="index.html#docs:ansible.im">#docs:ansible.im</a> and on libera IRC at <code class="docutils literal notranslate"><span class="pre">#ansible-docs</span></code> if you ever want to join us and chat about the docs!</p>
<p>You can also find lots of AWX discussion and get answers to questions at <a class="reference external" href="https://forum.ansible.com/">forum.ansible.com</a>.</p>
<div class="toctree-wrapper compound">
<span id="document-rest_api/tools"></span><section id="tools">
<h3><span class="section-number">1. </span>Tools<a class="headerlink" href="#tools" title="Link to this heading"></a></h3>
<p id="index-0">This document offers a basic understanding of the REST API used by AWX.</p>
<p>REST stands for Representational State Transfer and is sometimes spelled as “ReST”. It relies on a stateless, client-server, and cacheable communications protocol, usually the HTTP protocol.</p>
<p>You may find it helpful to see which API calls the user interface makes in sequence. To do this, you can use the UI from Firebug or Chrome with developer plugins.</p>
<p>Another alternative is Charles Proxy (<a class="reference external" href="http://www.charlesproxy.com/">http://www.charlesproxy.com/</a>), which offers a visualizer that you may find helpful. While it is commercial software, it can insert itself as an OS X proxy, for example, and intercept both requests from web browsers as well as curl and other API consumers.</p>
<p>Other alternatives include:</p>
<ul class="simple">
<li><p>Fiddler (<a class="reference external" href="http://www.telerik.com/fiddler">http://www.telerik.com/fiddler</a>)</p></li>
<li><p>mitmproxy (<a class="reference external" href="https://mitmproxy.org/">https://mitmproxy.org/</a>)</p></li>
<li><p>Live HTTP headers FireFox extension (<a class="reference external" href="https://addons.mozilla.org/en-US/firefox/addon/live-http-headers/">https://addons.mozilla.org/en-US/firefox/addon/live-http-headers/</a>)</p></li>
<li><p>Paros (<a class="reference external" href="http://sourceforge.net/projects/paros/">http://sourceforge.net/projects/paros/</a>)</p></li>
</ul>
</section>
<span id="document-rest_api/browseable"></span><section id="browsable-api">
<span id="api-browsable-api"></span><h3><span class="section-number">2. </span>Browsable API<a class="headerlink" href="#browsable-api" title="Link to this heading"></a></h3>
<p id="index-0">REST APIs provide access to resources (data entities) via URI paths.  You can visit the AWX REST API in a web browser at: <code class="docutils literal notranslate"><span class="pre">http://&lt;server</span> <span class="pre">name&gt;/api/</span></code></p>
<p><img alt="REST API" src="_images/rest-api.png" /></p>
<p>Automation controller supports version 2 of the API, which can be accessed by clicking the v2 link next to “current versions” or available versions”:</p>
<p><img alt="REST API V2" src="_images/rest-api-available-versions.png" /></p>
<p>If you perform a <strong>GET</strong> just the <code class="docutils literal notranslate"><span class="pre">/api/</span></code> endpoint, it gives the <code class="docutils literal notranslate"><span class="pre">current_version</span></code>, which would be the recommended version.</p>
<p>Clicking on various links in the API allows you to explore related resources.</p>
<img alt="REST API - discover resources" src="_images/rest-api-discover-resources.png" />
<p>Clicking on the <img alt="question" src="_images/api-questionmark.png" /> next to the page name (toward the top of the screen) for an API endpoint gives you documentation on the access methods for that particular API endpoint and what data is returned when using those methods.</p>
<p id="index-1">You can also use PUT and POST verbs on the specific API pages by formatting JSON in the various text fields.</p>
<p><img alt="REST API - POST to API via form" src="_images/rest-api-post-to-api-via-form.png" /></p>
<p>You can also view changed settings from factory defaults at <code class="docutils literal notranslate"><span class="pre">/api/v2/settings/changed/</span></code> endpoint. It reflects changes you made in the API browser, not changed settings that come from static settings files.</p>
<p><img alt="REST API - Changes to Settings" src="_images/rest-api-changed-settings.png" /></p>
</section>
<span id="document-rest_api/conventions"></span><section id="conventions">
<h3><span class="section-number">3. </span>Conventions<a class="headerlink" href="#conventions" title="Link to this heading"></a></h3>
<p id="index-0">AWX uses a standard REST API, rooted at <code class="docutils literal notranslate"><span class="pre">/api/</span></code> on the server. The API is versioned for compatibility reasons, and currently <code class="docutils literal notranslate"><span class="pre">api/v2/</span></code> is the latest available version. You can see information about what API versions are available by querying <code class="docutils literal notranslate"><span class="pre">/api/</span></code>.</p>
<p>You may have to specify the content/type on <strong>POST</strong> or <strong>PUT</strong> requests accordingly.</p>
<ul class="simple">
<li><p><strong>PUT</strong>: Update a specific resource (by an identifier) or a collection of resources. PUT can also be used to create a specific resource if the resource identifier is known before-hand.</p></li>
<li><p><strong>POST</strong>: Create a new resource. Also acts as a catch-all verb for operations that do not fit into the other categories.</p></li>
</ul>
<p>All URIs  not ending with <code class="docutils literal notranslate"><span class="pre">&quot;/&quot;</span></code> receive a 301 redirect.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Formatting of <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code> attached to Job Template records is preserved. YAML is returned as YAML with formatting and comments preserved, and JSON is returned as JSON.</p>
</div>
</section>
<span id="document-rest_api/sorting"></span><section id="sorting">
<h3><span class="section-number">4. </span>Sorting<a class="headerlink" href="#sorting" title="Link to this heading"></a></h3>
<p id="index-0">To provide examples that are easy to follow, the following URL is used throughout this guide:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">http://&lt;server name&gt;/api/v2/groups/</span>
</pre></div>
</div>
<p>To specify that {{ model_verbose_name_plural }} are returned in a particular order, use the <code class="docutils literal notranslate"><span class="pre">order_by</span></code> query string parameter on the <strong>GET</strong> request.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">http://&lt;server name&gt;/api/v2/model_verbose_name_plural?order_by=</span><span class="cp">{{</span> <span class="nv">order_field</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Prefix the field name with a dash (<code class="docutils literal notranslate"><span class="pre">-</span></code>) to sort in reverse:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">http://&lt;server name&gt;/api/v2/model_verbose_name_plural?order_by=-</span><span class="cp">{{</span> <span class="nv">order_field</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>Multiple sorting fields may be specified by separating the field names with a comma (<code class="docutils literal notranslate"><span class="pre">,</span></code>):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">http://&lt;server name&gt;/api/v2/model_verbose_name_plural?order_by=</span><span class="cp">{{</span> <span class="nv">order_field</span> <span class="cp">}}</span><span class="l l-Scalar l-Scalar-Plain">,some_other_field</span>
</pre></div>
</div>
</section>
<span id="document-rest_api/searching"></span><section id="searching">
<h3><span class="section-number">5. </span>Searching<a class="headerlink" href="#searching" title="Link to this heading"></a></h3>
<p id="index-0">Use the search query string parameter to perform a non-case-sensitive search within all designated text fields of a model:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">http://&lt;server name&gt;/api/v2/model_verbose_name?search=findme</span>
</pre></div>
</div>
<p>Search across related fields:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">http://&lt;server name&gt;/api/v2/model_verbose_name?related__search=findme</span>
</pre></div>
</div>
</section>
<span id="document-rest_api/filtering"></span><section id="filtering">
<h3><span class="section-number">6. </span>Filtering<a class="headerlink" href="#filtering" title="Link to this heading"></a></h3>
<p id="index-0">Any collection is what the system calls a “queryset” and can be filtered via various operators.</p>
<p>For example, to find the groups that contain the name “foo”:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">http://&lt;awx server name&gt;/api/v2/groups/?name__contains=foo</span>
</pre></div>
</div>
<p>To find an exact match:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">http://&lt;awx server name&gt;/api/v2/groups/?name=foo</span>
</pre></div>
</div>
<p>If a resource is of an integer type, you must add <code class="docutils literal notranslate"><span class="pre">\_\_int</span></code> to the end to cast your string input value to an integer, like so:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">http://&lt;awx server name&gt;/api/v2/arbitrary_resource/?x__int=5</span>
</pre></div>
</div>
<p>Related resources can also be queried, like so:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">http://&lt;awx server name&gt;/api/v2/users/?first_name__icontains=kim</span>
</pre></div>
</div>
<p>This will return all users with names that include the string “Kim” in them.</p>
<p>You can also filter against multiple fields at once:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">http://&lt;awx server name&gt;/api/v2/groups/?name__icontains=test&amp;has_active_failures=false</span>
</pre></div>
</div>
<p>This finds all groups containing the name “test” that has no active failures.</p>
<p>For more about what types of operators are available, refer to: <a class="reference external" href="https://docs.djangoproject.com/en/dev/ref/models/querysets/">https://docs.djangoproject.com/en/dev/ref/models/querysets/</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can also watch the API as the UI is being used to see how it is filtering on various criteria.</p>
</div>
<p>Any additional query string parameters may be used to filter the list of results returned to those matching a given value. Only fields and relations that exist in the database may be used for filtering. Any special characters in the specified value should be url-encoded. For example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">?field=value%20xyz</span>
</pre></div>
</div>
<p>Fields may also span relations, only for fields and relationships defined in the database:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">?other__field=value</span>
</pre></div>
</div>
<p>To exclude results matching certain criteria, prefix the field parameter with <code class="docutils literal notranslate"><span class="pre">not__</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">?not__field=value</span>
</pre></div>
</div>
<p>By default, all query string filters are AND’ed together, so only the results matching all filters will be returned. To combine results matching any one of multiple criteria, prefix each query string parameter with <code class="docutils literal notranslate"><span class="pre">or__</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">?or__field=value&amp;or__field=othervalue</span>
<span class="l l-Scalar l-Scalar-Plain">?or__not__field=value&amp;or__field=othervalue</span>
</pre></div>
</div>
<p>The default AND filtering applies all filters simultaneously to each related object being filtered across database relationships. The chain filter instead applies filters separately for each related object. To use, prefix the query string parameter with <code class="docutils literal notranslate"><span class="pre">chain__</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">?chain__related__field=value&amp;chain__related__field2=othervalue</span>
<span class="l l-Scalar l-Scalar-Plain">?chain__not__related__field=value&amp;chain__related__field2=othervalue</span>
</pre></div>
</div>
<p>If the first query above were written as <code class="docutils literal notranslate"><span class="pre">?related__field=value&amp;related__field2=othervalue</span></code>, it would return only the primary objects where the same related object satisfied both conditions. As written using the chain filter, it would return the intersection of primary objects matching each condition.</p>
<p>Field lookups may also be used for more advanced queries, by appending the lookup to the field name:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">?field__lookup=value</span>
</pre></div>
</div>
<p>The following field lookups are supported:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">exact</span></code>: Exact match (default lookup if not specified).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iexact</span></code>: Case-insensitive version of exact.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">contains</span></code>: Field contains value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">icontains</span></code>: Case-insensitive version of contains.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">startswith</span></code>: Field starts with value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">istartswith</span></code>: Case-insensitive version of startswith.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">endswith</span></code>: Field ends with value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iendswith</span></code>: Case-insensitive version of endswith.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">regex</span></code>: Field matches the given regular expression.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iregex</span></code>: Case-insensitive version of regex.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gt</span></code>: Greater than comparison.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gte</span></code>: Greater than or equal to comparison.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lt</span></code>: Less than comparison.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lte</span></code>: Less than or equal to comparison.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">isnull</span></code>: Check whether the given field or related object is null; expects a boolean value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in</span></code>: Check whether the given field’s value is present in the list provided; expects a list of items.</p></li>
<li><p>Boolean values may be specified as <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> for true, <code class="docutils literal notranslate"><span class="pre">False</span></code> or <code class="docutils literal notranslate"><span class="pre">0</span></code> for false (both case-insensitive).</p></li>
</ul>
<p>For example, <code class="docutils literal notranslate"><span class="pre">?created__gte=2023-01-01</span></code> will provide a list of items created after 1/1/2023.</p>
<p>Null values may be specified as <code class="docutils literal notranslate"><span class="pre">None</span></code> or <code class="docutils literal notranslate"><span class="pre">Null</span></code> (both case-insensitive), though it is preferred to use the <code class="docutils literal notranslate"><span class="pre">isnull</span></code> lookup to explicitly check for null values.</p>
<p>Lists (for the <code class="docutils literal notranslate"><span class="pre">in</span></code> lookup) may be specified as a comma-separated list of values.</p>
<p>Filtering based on the requesting user’s level of access by query string parameter:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">role_level</span></code>: Level of role to filter on, such as <code class="docutils literal notranslate"><span class="pre">admin_role</span></code></p></li>
</ul>
</section>
<span id="document-rest_api/pagination"></span><section id="pagination">
<h3><span class="section-number">7. </span>Pagination<a class="headerlink" href="#pagination" title="Link to this heading"></a></h3>
<p id="index-0">Responses for collections in the API are paginated. This means that while a collection may contain tens or hundreds of thousands of objects, in each web request, only a limited number of results are returned for API performance reasons.</p>
<p>When you get back the result for a collection you will see something similar to the following:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span><span class="s">&#39;count&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">25</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;next&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;http://testserver/api/v2/some_resource?page=2&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;previous&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">None</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;results&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">...</span><span class="w"> </span><span class="p p-Indicator">]</span><span class="w"> </span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>To get the next page, simply request the page given by the ‘next’ sequential URL.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">page_size=XX</span></code> query string parameter to change the number of results returned for each request.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">page_size</span></code> has a default maximum limit configured to 200, which is enforced when a user tries a value beyond it, for example, <code class="docutils literal notranslate"><span class="pre">?page_size=1000</span></code>. However, you can change this limit by setting the value in <code class="docutils literal notranslate"><span class="pre">/etc/awx/conf.d/&lt;some</span> <span class="pre">file&gt;.py</span></code> to something higher, e.g. <code class="docutils literal notranslate"><span class="pre">MAX_PAGE_SIZE=1000</span></code>.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">page</span></code> query string parameter to retrieve a particular page of results.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">http://&lt;server name&gt;/api/v2/model_verbose_name?page_size=100&amp;page=2</span>
</pre></div>
</div>
<p>The previous and next links returned with the results will set these query string parameters automatically.</p>
<p>The serializer is quite efficient, but you should probably not request page sizes beyond a couple of hundred.</p>
<p>The user interface uses smaller values to avoid the user having to do a lot of scrolling.</p>
</section>
<span id="document-rest_api/access_resources"></span><section id="access-resources">
<h3><span class="section-number">8. </span>Access Resources<a class="headerlink" href="#access-resources" title="Link to this heading"></a></h3>
<p id="index-0">Traditionally, AWX uses a primary key to access individual resource objects. The named URL feature allows you to access AWX resources via resource-specific human-readable identifiers. The named URL via URL path <code class="docutils literal notranslate"><span class="pre">/api/v2/hosts/host_name++inv_name++org_name/</span></code>, for example, allows you to access a resource object without an auxiliary query string.</p>
<section id="configuration-settings">
<h4><span class="section-number">8.1. </span>Configuration Settings<a class="headerlink" href="#configuration-settings" title="Link to this heading"></a></h4>
<p>There are two named-URL-related configuration settings available under <code class="docutils literal notranslate"><span class="pre">/api/v2/settings/named-url/</span></code>: <code class="docutils literal notranslate"><span class="pre">NAMED_URL_FORMATS</span></code> and <code class="docutils literal notranslate"><span class="pre">NAMED_URL_GRAPH_NODES</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">NAMED_URL_FORMATS</span></code> is a read only key-value pair list of all available named URL identifier formats. A typical <code class="docutils literal notranslate"><span class="pre">NAMED_URL_FORMATS</span></code> looks like this:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;NAMED_URL_FORMATS&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="s">&quot;organizations&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;name&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;teams&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;name&gt;++&lt;organization.name&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;credential_types&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;name&gt;+&lt;kind&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;credentials&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;name&gt;++&lt;credential_type.name&gt;+&lt;credential_type.kind&gt;++&lt;organization.name&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;notification_templates&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;name&gt;++&lt;organization.name&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;job_templates&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;name&gt;++&lt;organization.name&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;projects&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;name&gt;++&lt;organization.name&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;inventories&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;name&gt;++&lt;organization.name&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;hosts&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;name&gt;++&lt;inventory.name&gt;++&lt;organization.name&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;groups&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;name&gt;++&lt;inventory.name&gt;++&lt;organization.name&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;inventory_sources&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;name&gt;++&lt;inventory.name&gt;++&lt;organization.name&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;inventory_scripts&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;name&gt;++&lt;organization.name&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;instance_groups&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;name&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;labels&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;name&gt;++&lt;organization.name&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;workflow_job_templates&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;name&gt;++&lt;organization.name&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;workflow_job_template_nodes&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;identifier&gt;++&lt;workflow_job_template.name&gt;++&lt;organization.name&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;applications&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;name&gt;++&lt;organization.name&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;users&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;username&gt;&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;instances&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&lt;hostname&gt;&quot;</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>For each item in <code class="docutils literal notranslate"><span class="pre">NAMED_URL_FORMATS</span></code>, the key is the API name of the resource to have named URL, the value is a string indicating how to form a human-readable unique identifier for that resource. <code class="docutils literal notranslate"><span class="pre">NAMED_URL_FORMATS</span></code> exclusively lists every resource that can have named URL, any resource not listed there has no named URL. If a resource can have named URL, its objects should have a named_url field which represents the object-specific named URL. That field should only be visible under detail view, not list view. You can access specified resource objects using accurately generated named URL. This includes not only the object itself but also its related URLs. For example, if <code class="docutils literal notranslate"><span class="pre">/api/v2/res_name/obj_slug/</span></code> is valid, <code class="docutils literal notranslate"><span class="pre">/api/v2/res_name/obj_slug/related_res_name/</span></code> should also be valid.</p>
<p><code class="docutils literal notranslate"><span class="pre">NAMED_URL_FORMATS</span></code> are instructive enough to compose human-readable unique identifier and named URL themselves. For ease-of-use, every object of a resource that can have named URL will have a related field <code class="docutils literal notranslate"><span class="pre">named_url</span></code> that displays that object’s named URL. You can copy and paste that field for your own custom use. Also refer to the help text of API browser if a resource object has named URL for further guidance.</p>
<p>Suppose you want to manually determine the named URL for a label with ID 5. A typical procedure of composing a named URL for this specific resource object using <code class="docutils literal notranslate"><span class="pre">NAMED_URL_FORMATS</span></code> is to first look up the labels field of <code class="docutils literal notranslate"><span class="pre">NAMED_URL_FORMATS</span></code> to get the identifier format <code class="docutils literal notranslate"><span class="pre">&lt;name&gt;++&lt;organization.name&gt;</span></code>:</p>
<blockquote>
<div><ul class="simple">
<li><p>The first part of the URL format is <code class="docutils literal notranslate"><span class="pre">&lt;name&gt;</span></code>, which indicates that the label resource detail can be found in <code class="docutils literal notranslate"><span class="pre">/api/v2/labels/5/</span></code>, and look for <code class="docutils literal notranslate"><span class="pre">name</span></code> field in returned JSON. Suppose you have the <code class="docutils literal notranslate"><span class="pre">name</span></code> field with value ‘Foo’, then the first part of the unique identifier is <strong>Foo</strong>.</p></li>
<li><p>The second part of the format are double pluses ++. That is the delimiter that separates different parts of a unique identifier. Append them to the unique identifier to get <strong>Foo++</strong></p></li>
<li><p>The third part of the format is <code class="docutils literal notranslate"><span class="pre">&lt;organization.name&gt;</span></code>, which indicates that field is not in the current label object under investigation, but in an organization which the label object points to. Thus, as the format indicates, look up the organization in the related field of current returned JSON. That field may or may not exist. If it exists, follow the URL given in that field, for example, <code class="docutils literal notranslate"><span class="pre">/api/v2/organizations/3/</span></code>, to get the detail of the specific organization, extract its <code class="docutils literal notranslate"><span class="pre">name</span></code> field, for example, ‘Default’, and append it to our current unique identifier. Since <code class="docutils literal notranslate"><span class="pre">&lt;organizations.name&gt;</span></code> is the last part of format, thus, generating the resulting named URL: <code class="docutils literal notranslate"><span class="pre">/api/v2/labels/Foo++Default/</span></code>.  In the case where organization does not exist in related field of the label object detail, append an empty string instead, which essentially does not alter the current identifier. So <code class="docutils literal notranslate"><span class="pre">Foo++</span></code> becomes the final unique identifier and the resulting generated named URL becomes <code class="docutils literal notranslate"><span class="pre">/api/v2/labels/Foo++/</span></code>.</p></li>
</ul>
</div></blockquote>
<p>An important aspect of generating a unique identifier for named URL has to do with reserved characters. Because the identifier is part of a URL, the following reserved characters by URL standard is encoded by percentage symbols: <code class="docutils literal notranslate"><span class="pre">;/?:&#64;=&amp;[]</span></code>. For example, if an organization is named <code class="docutils literal notranslate"><span class="pre">;/?:&#64;=&amp;[]</span></code>, its unique identifier should be <code class="docutils literal notranslate"><span class="pre">%3B%2F%3F%3A%40%3D%26%5B%5D</span></code>. Another special reserved character is <code class="docutils literal notranslate"><span class="pre">+</span></code>, which is not reserved by URL standard but used by named URL to link different parts of an identifier. It is encoded by <code class="docutils literal notranslate"><span class="pre">[+]</span></code>. For example, if an organization is named <code class="docutils literal notranslate"><span class="pre">[+]</span></code>, its unique identifier is <code class="docutils literal notranslate"><span class="pre">%5B[+]%5D</span></code>, where original <code class="docutils literal notranslate"><span class="pre">[</span></code> and <code class="docutils literal notranslate"><span class="pre">]</span></code> are percent encoded and <code class="docutils literal notranslate"><span class="pre">+</span></code> is converted to <code class="docutils literal notranslate"><span class="pre">[+]</span></code>.</p>
<p>Although <code class="docutils literal notranslate"><span class="pre">NAMED_URL_FORMATS</span></code> cannot be manually modified, modifications do occur automatically and expanded over time, reflecting underlying resource modification and expansion. Consult the <code class="docutils literal notranslate"><span class="pre">NAMED_URL_FORMATS</span></code> on the same cluster where you want to use the named URL feature.</p>
<p><code class="docutils literal notranslate"><span class="pre">NAMED_URL_GRAPH_NODES</span></code> is another read-only list of key-value pairs that exposes the internal graph data structure used to manage named URLs. This is not intended to be human-readable but should be used for programmatically generating named URLs. An example script for generating named URL given the primary key of arbitrary resource objects that can have a named URL, using info provided by <code class="docutils literal notranslate"><span class="pre">NAMED_URL_GRAPH_NODES</span></code>, can be found in GitHub at <a class="reference external" href="https://github.com/ansible/awx/blob/devel/tools/scripts/pk_to_named_url.py">https://github.com/ansible/awx/blob/devel/tools/scripts/pk_to_named_url.py</a>.</p>
</section>
<section id="identifier-format-protocol">
<h4><span class="section-number">8.2. </span>Identifier Format Protocol<a class="headerlink" href="#identifier-format-protocol" title="Link to this heading"></a></h4>
<p>Resources are identifiable by their unique keys, which are basically tuples of resource fields. Every resource is guaranteed to have its primary key number alone as a unique key, but there might be multiple other unique keys. A resource can generate an identifier format thus, have a named URL if it contains at least one unique key that satisfies the rules below:</p>
<ol class="arabic simple">
<li><p>The key must contain only fields that are either the <code class="docutils literal notranslate"><span class="pre">name</span></code> field, or text fields with a finite number of possible choices (like credential type resource’s <code class="docutils literal notranslate"><span class="pre">kind</span></code> field).</p></li>
<li><p>The only allowed exceptional fields that breaks rule #1 is a many-to-one related field relating to a resource other than itself, which is also allowed to have a slug.</p></li>
</ol>
<p>Suppose there are resources <code class="docutils literal notranslate"><span class="pre">Foo</span></code> and <code class="docutils literal notranslate"><span class="pre">Bar</span></code>, both <code class="docutils literal notranslate"><span class="pre">Foo</span></code> and <code class="docutils literal notranslate"><span class="pre">Bar</span></code> contain a <code class="docutils literal notranslate"><span class="pre">name</span></code> field and a <code class="docutils literal notranslate"><span class="pre">choice</span></code> field that can only have value ‘yes’ or ‘no’. Additionally, resource <code class="docutils literal notranslate"><span class="pre">Foo</span></code> contains a many-to-one field (a foreign key) relating to <code class="docutils literal notranslate"><span class="pre">Bar</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">fk</span></code>. <code class="docutils literal notranslate"><span class="pre">Foo</span></code> has a unique key tuple (<code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">choice</span></code>, <code class="docutils literal notranslate"><span class="pre">fk</span></code>) and <code class="docutils literal notranslate"><span class="pre">Bar</span></code> has a unique key tuple (<code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">choice</span></code>). <code class="docutils literal notranslate"><span class="pre">Bar</span></code> can have named URL because it satisfies rule #1 above. <code class="docutils literal notranslate"><span class="pre">Foo</span></code> can also have named URL, even though it breaks rule #1, the extra field breaking rule #1 is the <code class="docutils literal notranslate"><span class="pre">fk</span></code> field, which is many-to-one-related to <code class="docutils literal notranslate"><span class="pre">Bar</span></code> and <code class="docutils literal notranslate"><span class="pre">Bar</span></code> can have named URL.</p>
<p>For resources satisfying rule #1 above, their human-readable unique identifiers are combinations of foreign key fields, delimited by <code class="docutils literal notranslate"><span class="pre">+</span></code>. In specific, resource <code class="docutils literal notranslate"><span class="pre">Bar</span></code> in the above example will have slug format <code class="docutils literal notranslate"><span class="pre">&lt;name&gt;+&lt;choice&gt;</span></code>. Note the field order matters in slug format: <code class="docutils literal notranslate"><span class="pre">name</span></code> field always comes first if present, following by all the rest fields arranged in lexicographic order of field name. For example, if Bar also has an <code class="docutils literal notranslate"><span class="pre">a_choice</span></code> field satisfying rule #1 and the unique key becomes (<code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">choice</span></code>, <code class="docutils literal notranslate"><span class="pre">a_choice</span></code>), its slug format becomes <code class="docutils literal notranslate"><span class="pre">&lt;name&gt;+&lt;a_choice&gt;+&lt;choice&gt;</span></code>.</p>
<p>For resources satisfying rule #2 above, if traced back via the extra foreign key fields, the result is a tree of resources that all together identify objects of that resource. In order to generate identifier format, each resource in the traceback tree generates its own part of standalone format in the way previously described, using all fields but the foreign keys. Finally all parts are combined by <code class="docutils literal notranslate"><span class="pre">++</span></code> in the following order:</p>
<ul class="simple">
<li><p>Put stand-alone format as the first identifier component.</p></li>
<li><p>Recursively generate unique identifiers for each resource. The underlying resource is pointing to using a foreign key (a child of a traceback tree node).</p></li>
<li><p>Treat generated unique identifiers as the rest of the identifier components. Sort them in lexicographic order of corresponding foreign keys.</p></li>
<li><p>Combine all components together using <code class="docutils literal notranslate"><span class="pre">++</span></code> to generate the final identifier format.</p></li>
</ul>
<p>In reference to the example above, when generating an identifier format for resource <code class="docutils literal notranslate"><span class="pre">Foo</span></code>, AWX generates the stand-alone formats, <code class="docutils literal notranslate"><span class="pre">&lt;name&gt;+&lt;choice&gt;</span></code> for <code class="docutils literal notranslate"><span class="pre">Foo</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;fk.name&gt;+&lt;fk.choice&gt;</span></code> for <code class="docutils literal notranslate"><span class="pre">Bar</span></code>, then combine them together to be <code class="docutils literal notranslate"><span class="pre">&lt;name&gt;+&lt;choice&gt;++&lt;fk.name&gt;+&lt;fk.choice&gt;</span></code>.</p>
<p>When generating identifiers according to the given identifier format, there are cases where a foreign key may point to nowhere. In this case, AWX substitutes the part of the format corresponding to the resource the foreign key should point to with an empty string ‘’. For example, if a <code class="docutils literal notranslate"><span class="pre">Foo</span></code> object has the name =’alice’, choice =’yes’, but <code class="docutils literal notranslate"><span class="pre">fk</span></code> field = None, its resulting identifier will be <code class="docutils literal notranslate"><span class="pre">alice+yes++</span></code>.</p>
</section>
</section>
<span id="document-rest_api/read_only_fields"></span><section id="read-only-fields">
<h3><span class="section-number">9. </span>Read-only Fields<a class="headerlink" href="#read-only-fields" title="Link to this heading"></a></h3>
<p id="index-0">Certain fields in the REST API are marked read-only. These usually
include the URL of a resource, the ID, and occasionally some internal
fields. For instance, the <code class="docutils literal notranslate"><span class="pre">'created\_by'</span></code> attribute of each object
indicates which user created the resource, and cannot be edited.</p>
<p>If you post some values and notice that they are not changing, these fields may be read-only.</p>
</section>
<span id="document-rest_api/authentication"></span><section id="authentication-methods-using-the-api">
<h3><span class="section-number">10. </span>Authentication Methods Using the API<a class="headerlink" href="#authentication-methods-using-the-api" title="Link to this heading"></a></h3>
<p id="index-0">This chapter describes the numerous enterprise authentication methods, the best use case for each, and examples:</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#session-authentication" id="id1">Session Authentication</a></p></li>
<li><p><a class="reference internal" href="#basic-authentication" id="id2">Basic Authentication</a></p></li>
<li><p><a class="reference internal" href="#oauth-2-token-authentication" id="id3">OAuth 2 Token Authentication</a></p></li>
<li><p><a class="reference internal" href="#sso-authentication" id="id4">SSO Authentication</a></p></li>
</ul>
</nav>
<p>AWX is designed for organizations to centralize and control their automation with a visual dashboard for out-of-the box control while providing a REST API to integrate with your other tooling on a deeper level. AWX supports a number of authentication methods to make it easy to embed AWX into existing tools and processes to help ensure the right people can access AWX resources.</p>
<section id="session-authentication">
<span id="api-session-auth"></span><h4><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">10.1. </span>Session Authentication</a><a class="headerlink" href="#session-authentication" title="Link to this heading"></a></h4>
<p>Session authentication is used when logging in directly to AWX’s API or UI to manually create resources (inventory, project, job template) and launch jobs in the browser. With this method, you can remain logged in for a prolonged period of time, not just for that HTTP request, but for instance, when browsing the UI or API in a browser like Chrome or Firefox. When a user logs in, a session cookie is created, which enables the user to remain logged in when navigating to different pages within AWX. Below represents the communication that occurs between the client and server in a session.</p>
<img alt="_images/session-auth-architecture.png" src="_images/session-auth-architecture.png" />
<p>Using the curl tool, you can see the activity that occurs when you log into AWX.</p>
<ol class="arabic simple">
<li><p>GET to the <code class="docutils literal notranslate"><span class="pre">/api/login/</span></code> endpoint to grab the <code class="docutils literal notranslate"><span class="pre">csrftoken</span></code> cookie.</p></li>
</ol>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>curl -k -c - https://&lt;awx-host&gt;/api/login/

localhost       FALSE   /       FALSE   0   csrftoken
AswSFn5p1qQvaX4KoRZN6A5yer0Pq0VG2cXMTzZnzuhaY0L4tiidYqwf5PXZckuj
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>POST to the <code class="docutils literal notranslate"><span class="pre">/api/login/</span></code> endpoint with username, password, and X-CSRFToken=&lt;token-value&gt;.</p></li>
</ol>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>curl -X POST -H &#39;Content-Type: application/x-www-form-urlencoded&#39; \
--referer https://&lt;awx-host&gt;/api/login/ \
-H &#39;X-CSRFToken: K580zVVm0rWX8pmNylz5ygTPamgUJxifrdJY0UDtMMoOis5Q1UOxRmV9918BUBIN&#39; \
--data &#39;username=root&amp;password=reverse&#39; \
--cookie &#39;csrftoken=K580zVVm0rWX8pmNylz5ygTPamgUJxifrdJY0UDtMMoOis5Q1UOxRmV9918BUBIN&#39; \
https://&lt;awx-host&gt;/api/login/ -k -D - -o /dev/null
</pre></div>
</div>
<p>All of this is done by the AWX when you log in to the UI or API in the browser, and should only be used when authenticating in the browser. For programmatic integration with AWX, see <a class="reference internal" href="#api-oauth2-auth"><span class="std std-ref">OAuth 2 Token Authentication</span></a>.</p>
<p>A typical response might look like:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Server: nginx
Date: &lt;current date&gt;
Content-Type: text/html; charset=utf-8
Content-Length: 0
Connection: keep-alive
Location: /accounts/profile/
X-API-Session-Cookie-Name: awx_sessionid
Expires: &lt;date&gt;
Cache-Control: max-age=0, no-cache, no-store, must-revalidate, private
Vary: Cookie, Accept-Language, Origin
Session-Timeout: 1800
Content-Language: en
X-API-Total-Time: 0.377s
X-API-Request-Id: 700826696425433fb0c8807cd40c00a0
Access-Control-Expose-Headers: X-API-Request-Id
Set-Cookie: userLoggedIn=true; Path=/
Set-Cookie: current_user=&lt;user cookie data&gt;; Path=/
Set-Cookie: csrftoken=&lt;csrftoken&gt;; Path=/; SameSite=Lax
Set-Cookie: awx_sessionid=&lt;your session id&gt;; expires=&lt;date&gt;; HttpOnly; Max-Age=1800; Path=/; SameSite=Lax
Strict-Transport-Security: max-age=15768000
</pre></div>
</div>
<p>When a user is successfully authenticated with this method, the server will respond with a header called <code class="docutils literal notranslate"><span class="pre">X-API-Session-Cookie-Name</span></code>, indicating the configured name of the session cookie. The default value is <code class="docutils literal notranslate"><span class="pre">awx_session_id</span></code> which you can see later in the <code class="docutils literal notranslate"><span class="pre">Set-Cookie</span></code> headers.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The session expiration time can be changed by specifying it in the <code class="docutils literal notranslate"><span class="pre">SESSION_COOKIE_AGE</span></code> parameter. Refer to <a class="reference internal" href="index.html#ag-session-limits"><span class="std std-ref">Working with Session Limits</span></a> for further detail.</p>
</div>
</section>
<section id="basic-authentication">
<h4><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">10.2. </span>Basic Authentication</a><a class="headerlink" href="#basic-authentication" title="Link to this heading"></a></h4>
<p>Basic Authentication (Basic Auth) is stateless, thus the base64-encoded <code class="docutils literal notranslate"><span class="pre">username</span></code> and <code class="docutils literal notranslate"><span class="pre">password</span></code> must be sent along with each request via the Authorization header. This can be used for API calls from curl requests, python scripts, or individual requests to the API. <a class="reference internal" href="#api-oauth2-auth"><span class="std std-ref">OAuth 2 Token Authentication</span></a> is recommended for accessing the API when at all possible.</p>
<p>Example with curl:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># the --user flag adds this Authorization header for us
curl -X GET --user &#39;user:password&#39; https://&lt;awx-host&gt;/api/v2/credentials -k -L
</pre></div>
</div>
<p>For more information about the Basic HTTP Authentication scheme, see <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc7617">RFC 7617</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can disable the Basic Auth for security purposes from the Miscellaneous Authentication settings of the AWX UI Settings menu:</p>
<img alt="_images/configure-awx-auth-basic-off.png" src="_images/configure-awx-auth-basic-off.png" />
</div>
</section>
<section id="oauth-2-token-authentication">
<span id="api-oauth2-auth"></span><h4><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">10.3. </span>OAuth 2 Token Authentication</a><a class="headerlink" href="#oauth-2-token-authentication" title="Link to this heading"></a></h4>
<p>OAuth (Open Authorization) is an open standard for token-based authentication and authorization. OAuth 2 authentication is commonly used when interacting with the AWX API programmatically. Like Basic Auth, an OAuth 2 token is supplied with each API request via the Authorization header. Unlike Basic Auth, OAuth 2 tokens have a configurable timeout and are scopable. Tokens have a configurable expiration time and can be easily revoked for one user or for the entire AWX system by an admin if needed. This can be done with the <a class="reference internal" href="index.html#ag-manage-utility-revoke-tokens"><span class="std std-ref">revoke_oauth2_tokens</span></a> management command, which is covered in more detail in <em>AWX Administration Guide</em> or by using the API as explained in <a class="reference internal" href="index.html#ag-oauth2-token-revoke"><span class="std std-ref">Revoke an access token</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, external users such as those created by SSO are not allowed to generate OAuth tokens for security purposes. This can be changed from the Miscellaneous Authentication settings of the AWX UI Settings menu:</p>
<img alt="_images/configure-awx-external-tokens-off.png" src="_images/configure-awx-external-tokens-off.png" />
</div>
<p>The different methods for obtaining OAuth 2 Access Tokens in AWX are:</p>
<ul class="simple">
<li><p>Personal access tokens (PAT)</p></li>
<li><p>Application Token: Password grant type</p></li>
<li><p>Application Token: Implicit grant type</p></li>
<li><p>Application Token: Authorization Code grant type</p></li>
</ul>
<p>For more information on the above methods, see <a class="reference internal" href="index.html#ag-oauth2-token-auth"><span class="std std-ref">Token-Based Authentication</span></a> in the <em>AWX Administration Guide</em>.</p>
<p>First, a user needs to create an OAuth 2 Access Token in the API or in their User’s <strong>Tokens</strong> tab in the UI. For further detail on creating them through the UI, see <a class="reference internal" href="index.html#ug-users-tokens"><span class="std std-ref">Users - Tokens</span></a>. For the purposes of this example, use the PAT method for creating a token in the API. Upon token creation, the user can set the scope.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The expiration time of the token can be configured system-wide. See <a class="reference internal" href="index.html#ag-use-oauth-pat"><span class="std std-ref">Using OAuth 2 Token System for Personal Access Tokens (PAT)</span></a> for more detail.</p>
</div>
<p>Token authentication is best used for any programmatic use of the AWX API, such as Python scripts or tools like curl, as in the example for creating a PAT (without an associated application) below.</p>
<p><strong>Curl Example</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>curl -u user:password -k -X POST https://&lt;awx-host&gt;/api/v2/tokens/
</pre></div>
</div>
<p>This call will return JSON data like:</p>
<img alt="_images/api_oauth2_json_returned_token_value.png" src="_images/api_oauth2_json_returned_token_value.png" />
<p>The value of the <code class="docutils literal notranslate"><span class="pre">token</span></code> property is what you can now use to perform a GET request for an AWX resource, e.g., Hosts.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>curl -k -X POST \
  -H “Content-Type: application/json”
  -H “Authorization: Bearer &lt;oauth2-token-value&gt;” \
  https://&lt;awx-host&gt;/api/v2/hosts/
</pre></div>
</div>
<p>Similarly, you can launch a job by making a POST to the job template that you want to launch.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>curl -k -X POST \
  -H &quot;Authorization: Bearer &lt;oauth2-token-value&gt;&quot; \
  -H &quot;Content-Type: application/json&quot; \
  --data &#39;{&quot;limit&quot; : &quot;ansible&quot;}&#39; \
  https://&lt;awx-host&gt;/api/v2/job_templates/14/launch/
</pre></div>
</div>
<p><strong>Python Example</strong></p>
<p><a class="reference external" href="https://pypi.org/project/awxkit/">awxkit</a> is an open source tool that makes it easy to use HTTP requests to access the AWX API.
You can have awxkit acquire a PAT on your behalf by using the <code class="docutils literal notranslate"><span class="pre">awxkit</span> <span class="pre">login</span></code> command. Refer to the <a class="reference internal" href="index.html#api-start"><span class="std std-ref">AWX API Reference</span></a> for more detail.</p>
<p>For more information on how to use OAuth 2 in AWX in the context of integrating external applications, see <a class="reference internal" href="index.html#ag-oauth2-token-auth"><span class="std std-ref">Token-Based Authentication</span></a> in the <em>AWX Administration Guide</em>.</p>
<p>If you need to write custom requests, you can write a Python script using <a class="reference external" href="https://pypi.org/project/requests/">Python library requests</a>, like in this example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>import requests
oauth2_token_value = &#39;y1Q8ye4hPvT61aQq63Da6N1C25jiA&#39;   # your token value from AWX
url = &#39;https://&lt;awx-host&gt;/api/v2/users/&#39;
payload = {}
headers = {&#39;Authorization&#39;: &#39;Bearer &#39; + oauth2_token_value,}

# makes request to awx user endpoint
response = requests.request(&#39;GET&#39;, url, headers=headers, data=payload,
allow_redirects=False, verify=False)

# prints json returned from awx with formatting
print(json.dumps(response.json(), indent=4, sort_keys=True))
</pre></div>
</div>
</section>
<section id="sso-authentication">
<span id="api-sso-auth"></span><h4><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">10.4. </span>SSO Authentication</a><a class="headerlink" href="#sso-authentication" title="Link to this heading"></a></h4>
<p>Single sign-on (SSO) authentication methods are fundamentally different from other methods because the authentication of the user happens external to AWX, like Google SSO, Azure SSO, SAML, or GitHub. For example, with GitHub SSO, GitHub is the single source of truth, which verifies your identity based on the username and password you gave AWX.</p>
<p>You can configure SSO authentication using AWX inside a large organization with a central Identity Provider. Once you have configured an SSO method in AWX, a button for that SSO will be present on the login screen. If you click that button, it will redirect you to the Identity Provider, in this case GitHub, where you will present your credentials. If the Identity Provider verifies you successfully, then AWX will make a user linked to your GitHub user (if this is your first time logging in via this SSO method), and log you in.</p>
<p>For the various types of supported SSO authentication methods, see <a class="reference internal" href="index.html#ag-social-auth"><span class="std std-ref">Setting up Social Authentication</span></a> and <a class="reference internal" href="index.html#ag-ent-auth"><span class="std std-ref">Setting up Enterprise Authentication</span></a> in the <em>AWX Administration Guide</em>.</p>
</section>
</section>
<span id="document-rest_api/api_ref"></span><section id="awx-api-reference-guide">
<span id="api-reference"></span><h3><span class="section-number">11. </span>AWX API Reference Guide<a class="headerlink" href="#awx-api-reference-guide" title="Link to this heading"></a></h3>
<p>The API Reference Manual provides in-depth documentation for the AWX REST API, including integration examples.</p>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="position:absolute;width:0;height:0">
  <defs>
    <symbol viewBox="0 0 20 20" id="unlocked">
          <path d="M15.8 8H14V5.6C14 2.703 12.665 1 10 1 7.334 1 6 2.703 6 5.6V6h2v-.801C8 3.754 8.797 3 10 3c1.203 0 2 .754 2 2.199V8H4c-.553 0-1 .646-1 1.199V17c0 .549.428 1.139.951 1.307l1.197.387C5.672 18.861 6.55 19 7.1 19h5.8c.549 0 1.428-.139 1.951-.307l1.196-.387c.524-.167.953-.757.953-1.306V9.199C17 8.646 16.352 8 15.8 8z"></path>
    </symbol>

    <symbol viewBox="0 0 20 20" id="locked">
      <path d="M15.8 8H14V5.6C14 2.703 12.665 1 10 1 7.334 1 6 2.703 6 5.6V8H4c-.553 0-1 .646-1 1.199V17c0 .549.428 1.139.951 1.307l1.197.387C5.672 18.861 6.55 19 7.1 19h5.8c.549 0 1.428-.139 1.951-.307l1.196-.387c.524-.167.953-.757.953-1.306V9.199C17 8.646 16.352 8 15.8 8zM12 8H8V5.199C8 3.754 8.797 3 10 3c1.203 0 2 .754 2 2.199V8z"/>
    </symbol>

    <symbol viewBox="0 0 20 20" id="close">
      <path d="M14.348 14.849c-.469.469-1.229.469-1.697 0L10 11.819l-2.651 3.029c-.469.469-1.229.469-1.697 0-.469-.469-.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-.469-.469-.469-1.228 0-1.697.469-.469 1.228-.469 1.697 0L10 8.183l2.651-3.031c.469-.469 1.228-.469 1.697 0 .469.469.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c.469.469.469 1.229 0 1.698z"/>
    </symbol>

    <symbol viewBox="0 0 20 20" id="large-arrow">
      <path d="M13.25 10L6.109 2.58c-.268-.27-.268-.707 0-.979.268-.27.701-.27.969 0l7.83 7.908c.268.271.268.709 0 .979l-7.83 7.908c-.268.271-.701.27-.969 0-.268-.269-.268-.707 0-.979L13.25 10z"/>
    </symbol>

    <symbol viewBox="0 0 20 20" id="large-arrow-down">
      <path d="M17.418 6.109c.272-.268.709-.268.979 0s.271.701 0 .969l-7.908 7.83c-.27.268-.707.268-.979 0l-7.908-7.83c-.27-.268-.27-.701 0-.969.271-.268.709-.268.979 0L10 13.25l7.418-7.141z"/>
    </symbol>


    <symbol viewBox="0 0 24 24" id="jump-to">
      <path d="M19 7v4H5.83l3.58-3.59L8 6l-6 6 6 6 1.41-1.41L5.83 13H21V7z"/>
    </symbol>

    <symbol viewBox="0 0 24 24" id="expand">
      <path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"/>
    </symbol>

  </defs>
</svg>
<div id="swagger-ui"></div>
<script src="../_static/swagger-ui-bundle.js"></script>
<script src="../_static/swagger-ui-standalone-preset.js"></script>
<script>
window.onload = function() {
  $('head').append('<link rel="stylesheet" href="../_static/swagger-ui.css" type="text/css"></link>');
  $('head').append('<link rel="stylesheet" href="../_static/awx-rest-api.css" type="text/css"></link>');
  $('#swagger-ui').on('click', function(e) {
    // By default, swagger-ui has a show/hide toggle for headers, and
    // there's no way to turn it off; this code intercepts the click event
    // higher in the DOM and disables it
    var header = $(e.target).closest('.opblock-tag');
        anchor = header.find('a[href]').attr('href');
        if (anchor) {
            window.location.hash = anchor.replace(' ', '_');
            e.stopPropagation();
            return false;
        }
    return true;
  });

  const ui = SwaggerUIBundle({
    spec: {{SPEC}},
    dom_id: '#swagger-ui',
    deepLinking: true,
    presets: [
      SwaggerUIBundle.presets.apis,
      SwaggerUIStandalonePreset
    ],
    operationsSorter: function(a, b){
        // sort alphabetically by path name first, then sort by method name
        var method_order = [
            'get', 'post', 'put', 'patch', 'delete'
        ];
        var compared = a.get("path").localeCompare(b.get("path"));
        if(compared == 0){
            return (
                method_order.indexOf(a.get('method')) -
                method_order.indexOf(b.get('method'))
            );
        }
        return compared;
    },
    layout: "StandaloneLayout"
  });
  window.ui = ui;
}
</script></section>
</div>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-administration/index"></span><section id="administering-awx-deployments">
<span id="ag-start"></span><h2>Administering AWX Deployments<a class="headerlink" href="#administering-awx-deployments" title="Link to this heading"></a></h2>
<p>Learn how to administer AWX deployments through custom scripts, management jobs, and DevOps workflows.
This guide assumes at least basic understanding of the systems that you manage and maintain with AWX.</p>
<p>This guide applies to the latest version of AWX only.
The content in this guide is updated frequently and might contain functionality that is not available in previous versions.
Likewise content in this guide can be removed or replaced if it applies to functionality that is no longer available in the latest version.</p>
<p><strong>Join us online</strong></p>
<p>We talk about AWX documentation on Matrix at <a class="reference external" href="index.html#docs:ansible.im">#docs:ansible.im</a> and on libera IRC at <code class="docutils literal notranslate"><span class="pre">#ansible-docs</span></code> if you ever want to join us and chat about the docs!</p>
<p>You can also find lots of AWX discussion and get answers to questions at <a class="reference external" href="https://forum.ansible.com/">forum.ansible.com</a>.</p>
<div class="toctree-wrapper compound">
<span id="document-administration/init_script"></span><section id="starting-stopping-and-restarting-awx">
<span id="ag-restart-awx"></span><h3><span class="section-number">1. </span>Starting, Stopping, and Restarting AWX<a class="headerlink" href="#starting-stopping-and-restarting-awx" title="Link to this heading"></a></h3>
<p>To install AWX: <a class="reference external" href="https://github.com/ansible/awx-operator/tree/devel/docs/installation">https://github.com/ansible/awx-operator/tree/devel/docs/installation</a></p>
<p>To migrate from an old AWX to a new AWX instance: <a class="reference external" href="https://github.com/ansible/awx-operator/blob/devel/docs/migration/migration.md">https://github.com/ansible/awx-operator/blob/devel/docs/migration/migration.md</a></p>
<p>To upgrade you AWX instance: <a class="reference external" href="https://github.com/ansible/awx-operator/blob/devel/docs/upgrade/upgrading.md">https://github.com/ansible/awx-operator/blob/devel/docs/upgrade/upgrading.md</a></p>
<p>To restart an AWX instance, you must first kill the container and restart it. Access the web-task container in the Operator to invoke the supervisord restart.</p>
<p>To uninstall you AWX instance: <a class="reference external" href="https://github.com/ansible/awx-operator/blob/devel/docs/uninstall/uninstall.md">https://github.com/ansible/awx-operator/blob/devel/docs/uninstall/uninstall.md</a></p>
</section>
<span id="document-administration/custom_inventory_script"></span><section id="custom-inventory-scripts">
<span id="ag-custom-inventory-script"></span><h3><span class="section-number">2. </span>Custom Inventory Scripts<a class="headerlink" href="#custom-inventory-scripts" title="Link to this heading"></a></h3>
<p id="index-0">Inventory scripts have been discontinued. For more information, see <a class="reference internal" href="index.html#ug-customscripts"><span class="std std-ref">Export old inventory scripts</span></a> in the <em>AWX User Guide</em>.</p>
<p>If you use custom inventory scripts, migrate to sourcing these scripts from a project. See <a class="reference internal" href="index.html#ag-inv-import"><span class="std std-ref">Inventory File Importing</span></a> in the subsequent chapter, and also refer to <a class="reference internal" href="index.html#ug-inventory-sources"><span class="std std-ref">Inventory Sources</span></a> in the <em>AWX User Guide</em> for more detail.</p>
<p>If you are migrating to execution environments, see:</p>
<ul class="simple">
<li><p><a class="reference internal" href="index.html#upgrade-venv"><span class="std std-ref">Upgrading to Execution Environments</span></a></p></li>
<li><p><a class="reference internal" href="index.html#mesh-topology-ee"><span class="std std-ref">View mesh topology</span></a> in the <em>AWX Upgrade and Migration Guide</em> to validate your topology</p></li>
</ul>
<p>If you already have a mesh topology set up and want to view node type, node health, and specific details about each node, see <a class="reference internal" href="index.html#ag-topology-viewer"><span class="std std-ref">Topology Viewer</span></a> later in this guide.</p>
</section>
<span id="document-administration/scm-inv-source"></span><section id="inventory-file-importing">
<span id="ag-inv-import"></span><h3><span class="section-number">3. </span>Inventory File Importing<a class="headerlink" href="#inventory-file-importing" title="Link to this heading"></a></h3>
<p id="index-0">AWX allows you to choose an inventory file from source control, rather than creating one from scratch. This function is the same as custom inventory scripts, except that the contents are obtained from source control instead of editing their contents browser. This means, the files are non-editable and as inventories are updated at the source, the inventories within the projects are also updated accordingly, including the <code class="docutils literal notranslate"><span class="pre">group_vars</span></code> and <code class="docutils literal notranslate"><span class="pre">host_vars</span></code> files or directory associated with them. SCM types can consume both inventory files and scripts, the overlap between inventory files and custom types in that both do scripts.</p>
<p>Any imported hosts will have a description of “imported” by default. This can be overridden by setting the <code class="docutils literal notranslate"><span class="pre">_awx_description</span></code> variable on a given host. For example, if importing from a sourced .ini file, you could add the following host variables:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="nv">main</span><span class="p p-Indicator">]</span>
<span class="l l-Scalar l-Scalar-Plain">127.0.0.1 _awx_description=&quot;my host 1&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">127.0.0.2 _awx_description=&quot;my host 2&quot;</span>
</pre></div>
</div>
<p>Similarly, group descriptions also default to “imported”, but can be overridden by the <code class="docutils literal notranslate"><span class="pre">_awx_description</span></code> as well.</p>
<p>In order to use old inventory scripts in source control, see <a class="reference internal" href="index.html#ug-customscripts"><span class="std std-ref">Export old inventory scripts</span></a> in the <em>AWX User Guide</em> for detail.</p>
<section id="custom-dynamic-inventory-scripts">
<h4><span class="section-number">3.1. </span>Custom Dynamic Inventory Scripts<a class="headerlink" href="#custom-dynamic-inventory-scripts" title="Link to this heading"></a></h4>
<p>A custom dynamic inventory script stored in version control can be imported and run. This makes it much easier to make changes to an inventory script — rather than having to copy and paste one into AWX, it is pulled directly from source control and then executed. The script must be written to handle any credentials needed for doing its work and you are responsible for installing any Python libraries needed by the script (which is the same requirement for custom dynamic inventory scripts). And this applies to both user-defined inventory source scripts and SCM sources as they are both exposed to Ansible <em>virtualenv</em> requirements related to playbooks.</p>
<p>You can specify environment variables when you edit the SCM inventory source itself. For some scripts, this will be sufficient, however, this is not a secure way to store secret information that gives access to cloud providers or inventory.</p>
<p>The better way is to create a new credential type for the inventory script you are going to use. The credential type will need to specify all the necessary types of inputs. Then, when you create a credential of this type, the secrets will be stored in an encrypted form. If you apply that credential to the inventory source, the script will have access to those inputs like environment variables or files.</p>
<p>For more detail, refer to <a class="reference internal" href="index.html#ug-credential-types"><span class="std std-ref">Credential types</span></a>.</p>
</section>
<section id="scm-inventory-source-fields">
<h4><span class="section-number">3.2. </span>SCM Inventory Source Fields<a class="headerlink" href="#scm-inventory-source-fields" title="Link to this heading"></a></h4>
<p>The source fields used are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">source_project</span></code>: project to use</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source_path</span></code>: relative path inside the project indicating a directory or a file. If left blank, “” is still a relative path indicating the root directory of the project</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source_vars</span></code>: if set on a “file” type inventory source then they will be passed to the environment vars when running</p></li>
</ul>
<p>An update of the project automatically triggers an inventory update where it is used. An update of the project is scheduled immediately after creation of the inventory source. Neither inventory nor project updates are blocked while a related job is running. In cases where you have a big project (around 10 GB), disk space on <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> may be an issue.</p>
<p>You can specify a location manually in the AWX User Interface from the Create Inventory Source page. Refer to the <a class="reference internal" href="index.html#ug-inventories"><span class="std std-ref">Inventories</span></a> section of the <em>AWX User Guide</em> for instructions on creating an inventory source.</p>
<p>This listing should be refreshed to latest SCM info on a project update. If no inventory sources use a project as an SCM inventory source, then the inventory listing may not be refreshed on update.</p>
<p>For inventories with SCM sources, the Job Details page for inventory updates show a status indicator for the project update as well as the name of the project. The status indicator links to the project update job. The project name links to the project.</p>
<img alt="_images/jobs-details-scm-sourced-inventories.png" src="_images/jobs-details-scm-sourced-inventories.png" />
<p>An inventory update can be performed while a related job is running.</p>
<section id="supported-file-syntax">
<h5><span class="section-number">3.2.1. </span>Supported File Syntax<a class="headerlink" href="#supported-file-syntax" title="Link to this heading"></a></h5>
<p>AWX uses the <code class="docutils literal notranslate"><span class="pre">ansible-inventory</span></code> module from Ansible to process inventory files, and supports all valid inventory syntax that AWX requires.</p>
</section>
</section>
</section>
<span id="document-administration/multi-creds-assignment"></span><section id="multi-credential-assignment">
<span id="ag-multicred-assgn"></span><h3><span class="section-number">4. </span>Multi-Credential Assignment<a class="headerlink" href="#multi-credential-assignment" title="Link to this heading"></a></h3>
<p id="index-0">AWX provides support for assigning zero or more credentials to a job template.</p>
<section id="important-changes">
<h4><span class="section-number">4.1. </span>Important Changes<a class="headerlink" href="#important-changes" title="Link to this heading"></a></h4>
<p>Job templates now have a single interface for credential assignment. From the API endpoint:</p>
<p><code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/api/v2/job_templates/N/credentials/</span></code></p>
<p>You can associate and disassociate credentials using <code class="docutils literal notranslate"><span class="pre">POST</span></code> requests, similar to the behavior in the deprecated <code class="docutils literal notranslate"><span class="pre">extra_credentials</span></code> endpoint:</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>POST /api/v2/job_templates/N/credentials/ {&#39;associate&#39;: true, &#39;id&#39;: &#39;X&#39;}
POST /api/v2/job_templates/N/credentials/ {&#39;disassociate&#39;: true, &#39;id&#39;: &#39;Y&#39;}
</pre></div>
</div>
</div></blockquote>
<p>Under this model, a job template is considered valid even when there are <em>no</em> credentials assigned to it. This model also provides users the ability to assign multiple Vault credentials to a job template.</p>
</section>
<section id="launch-time-considerations">
<h4><span class="section-number">4.2. </span>Launch Time Considerations<a class="headerlink" href="#launch-time-considerations" title="Link to this heading"></a></h4>
<p>Job templates have a configurable attribute, <code class="docutils literal notranslate"><span class="pre">ask_credential_on_launch</span></code> , when set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, it signifies that if desired, you may specify a list of credentials at launch time to override those defined on the job template. For example:</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>POST /api/v2/job_templates/N/launch/ {&#39;credentials&#39;: [A, B, C]}`
</pre></div>
</div>
</div></blockquote>
<p>If <code class="docutils literal notranslate"><span class="pre">ask_credential_on_launch</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, it signifies that custom credentials provided in the <code class="docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/api/v2/job_templates/N/launch/</span></code> will be ignored.</p>
<p>Under this model, the only purpose for <code class="docutils literal notranslate"><span class="pre">ask_credential_on_launch</span></code> is to signal API clients to prompt the user for (optional) changes at launch time.</p>
</section>
<section id="multi-vault-credentials">
<span id="ag-multi-vault"></span><h4><span class="section-number">4.3. </span>Multi-Vault Credentials<a class="headerlink" href="#multi-vault-credentials" title="Link to this heading"></a></h4>
<p>As it possible to assign multiple credentials to a job, you can specify multiple Vault credentials to decrypt when your job template runs. This functionality mirrors the support for <a class="reference external" href="http://docs.ansible.com/ansible/latest/vault.html#vault-ids-and-multiple-vault-passwords">multiple vault passwords for a playbook run</a> in Ansible 2.4 and later.</p>
<p>Vault credentials now have an optional field, <code class="docutils literal notranslate"><span class="pre">vault_id</span></code>, which is analogous to the <code class="docutils literal notranslate"><span class="pre">--vault-id</span></code> argument to <code class="docutils literal notranslate"><span class="pre">ansible-playbook</span></code>. To run a playbook which makes use of multiple vault passwords:</p>
<ol class="arabic">
<li><p>Create a Vault credential in AWX for each vault password; specify the Vault ID as a field on the credential and input the password (which will be encrypted and stored).</p></li>
<li><p>Assign multiple vault credentials to the job template via the new credentials endpoint:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>POST /api/v2/job_templates/N/credentials/

{
    &#39;associate&#39;: true,
    &#39;id&#39;: X
}
</pre></div>
</div>
</li>
</ol>
<p>Alternatively, you can perform the same assignment in AWX User Interface in the <em>Create Credential</em> page:</p>
<img alt="_images/credentials-create-multivault-credential.png" src="_images/credentials-create-multivault-credential.png" />
<p>In the above example, the credential created specifies the secret to be used by its Vault Identifier (“first”) and password pair. When this credential is used in a Job Template, as in the example below, it will only decrypt the secret associated with the “first” Vault ID:</p>
<img alt="_images/job-template-include-multi-vault-credential.png" src="_images/job-template-include-multi-vault-credential.png" />
<p>If you have a playbook that is setup the traditional way with all the secrets in one big file without distinction, then leave the <strong>Vault Identifier</strong> field blank when setting up the Vault credential.</p>
<section id="prompted-vault-credentials">
<h5><span class="section-number">4.3.1. </span>Prompted Vault Credentials<a class="headerlink" href="#prompted-vault-credentials" title="Link to this heading"></a></h5>
<p>Passwords for Vault credentials that are marked with “Prompt on launch”, the launch endpoint of any related Job Templates will communicate necessary Vault passwords via the <code class="docutils literal notranslate"><span class="pre">passwords_needed_to_start</span></code> key:</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>GET /api/v2/job_templates/N/launch/
{
    &#39;passwords_needed_to_start&#39;: [
        &#39;vault_password.X&#39;,
        &#39;vault_password.Y&#39;,
    ]
}
</pre></div>
</div>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">Y</span></code> in the above example are primary keys of the associated Vault credentials.</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>POST /api/v2/job_templates/N/launch/
{
    &#39;credential_passwords&#39;: {
        &#39;vault_password.X&#39;: &#39;first-vault-password&#39;
        &#39;vault_password.Y&#39;: &#39;second-vault-password&#39;
    }
}
</pre></div>
</div>
</div></blockquote>
</section>
<section id="linked-credentials">
<h5><span class="section-number">4.3.2. </span>Linked credentials<a class="headerlink" href="#linked-credentials" title="Link to this heading"></a></h5>
<p>Instead of uploading sensitive credential information into AWX, you can link credential fields to external systems and using them to run your playbooks. Refer to the <a class="reference internal" href="index.html#ug-credential-plugins"><span class="std std-ref">Secret Management System</span></a> section of the <em>AWX User Guide</em>.</p>
</section>
</section>
</section>
<span id="document-administration/management_jobs"></span><section id="management-jobs">
<span id="ag-management-jobs"></span><h3><span class="section-number">5. </span>Management Jobs<a class="headerlink" href="#management-jobs" title="Link to this heading"></a></h3>
<p id="index-0"><strong>Management Jobs</strong> assist in the cleaning of old data from AWX, including system tracking information, tokens, job histories, and activity streams. You can use this if you have specific retention policies or need to decrease the storage used by your AWX database. Click <strong>Management Jobs</strong> from the left navigation bar.</p>
<p><img alt="management jobs" src="_images/ug-management-jobs.png" /></p>
<p>Several job types are available for you to schedule and launch:</p>
<ul class="simple">
<li><p><strong>Cleanup Activity Stream</strong>: Remove activity stream history older than a specified number of days</p></li>
<li><p><strong>Cleanup Expired OAuth 2 Tokens</strong>:  Remove expired OAuth 2 access tokens and refresh tokens</p></li>
<li><p><strong>Cleanup Expired Sessions</strong>:   Remove expired browser sessions from the database</p></li>
<li><p><strong>Cleanup Job Details</strong>: Remove job history older than a specified number of days</p></li>
</ul>
<section id="removing-old-activity-stream-data">
<h4><span class="section-number">5.1. </span>Removing Old Activity Stream Data<a class="headerlink" href="#removing-old-activity-stream-data" title="Link to this heading"></a></h4>
<p id="index-1">To remove older activity stream data, click on the launch (<img alt="launch" src="_images/launch-button.png" />) button beside <strong>Cleanup Activity Stream</strong>.</p>
<p><img alt="activity stream launch - remove activity stream launch" src="_images/ug-management-jobs-remove-activity-stream-launch.png" /></p>
<p>Enter the number of days of data you would like to save and click <strong>Launch</strong>.</p>
<section id="scheduling">
<span id="ag-mgmt-job-schedule"></span><h5><span class="section-number">5.1.1. </span>Scheduling<a class="headerlink" href="#scheduling" title="Link to this heading"></a></h5>
<p>To review or set a schedule for purging data marked for deletion:</p>
<ol class="arabic simple">
<li><p>For a particular cleanup job, click the <strong>Schedules</strong> tab.</p></li>
</ol>
<img alt="_images/ug-management-jobs-remove-activity-stream-schedule.png" src="_images/ug-management-jobs-remove-activity-stream-schedule.png" />
<p>Note that you can turn this scheduled management job on and off easily using the <strong>ON/OFF</strong> toggle button.</p>
<ol class="arabic simple" start="2">
<li><p>Click on the name of the job, in this example “Cleanup Activity Schedule”, to review the schedule settings and click <strong>Edit</strong> to modify them. You can also use the <strong>Add</strong> button to create a new schedule for this management job.</p></li>
</ol>
<img alt="_images/ug-management-jobs-remove-activity-stream-schedule-details.png" src="_images/ug-management-jobs-remove-activity-stream-schedule-details.png" />
<ol class="arabic simple" start="3">
<li><p>Enter the appropriate details into the following fields and click <strong>Save</strong>:</p></li>
</ol>
<ul class="simple">
<li><p>Name (required)</p></li>
<li><p>Start Date (required)</p></li>
<li><p>Start Time (required)</p></li>
<li><p>Local Time Zone (the entered Start Time should be in this timezone)</p></li>
<li><p>Repeat Frequency (the appropriate options display as the update frequency is modified including data you do not want to include by specifying exceptions)</p></li>
<li><p>Days of Data to Keep (required) - specify how much data you want to retain</p></li>
</ul>
<p>The <strong>Details</strong> tab displays a description of the schedule and a list of the scheduled occurrences in the selected Local Time Zone.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Jobs are scheduled in UTC. Repeating jobs that runs at a specific time of day may move relative to a local timezone when Daylight Saving Time shifts occur.</p>
</div>
</section>
<section id="notifications">
<span id="ag-mgmt-job-notify"></span><h5><span class="section-number">5.1.2. </span>Notifications<a class="headerlink" href="#notifications" title="Link to this heading"></a></h5>
<p>To review or set notifications associated with a management job:</p>
<ol class="arabic simple">
<li><p>For a particular cleanup job, click the <strong>Notifications</strong> tab.</p></li>
</ol>
<img alt="_images/management-job-notifications.png" src="_images/management-job-notifications.png" />
<p>If none exist, see <a class="reference internal" href="index.html#ug-notifications"><span class="std std-ref">Notifications</span></a> for more information.</p>
<img alt="_images/management-job-notifications-empty.png" src="_images/management-job-notifications-empty.png" />
<p>An example of a notifications with details specified:</p>
<img alt="_images/management-job-add-notification-details.png" src="_images/management-job-add-notification-details.png" />
</section>
</section>
<section id="cleanup-expired-oauth2-tokens">
<h4><span class="section-number">5.2. </span>Cleanup Expired OAuth2 Tokens<a class="headerlink" href="#cleanup-expired-oauth2-tokens" title="Link to this heading"></a></h4>
<p id="index-2">To remove expired OAuth2 tokens, click on the launch (<img alt="launch" src="_images/launch-button.png" />) button beside <strong>Cleanup Expired OAuth2 Tokens</strong>.</p>
<p>You can review or set a schedule for cleaning up expired OAuth2 tokens by performing the same procedure described for activity stream management jobs. See <a class="reference internal" href="#ag-mgmt-job-schedule"><span class="std std-ref">Scheduling</span></a> for detail.</p>
<p>You can also set or review notifications associated with this management job the same way as described in <a class="reference internal" href="#ag-mgmt-job-notify"><span class="std std-ref">Notifications</span></a> for activity stream management jobs, and refer to <a class="reference internal" href="index.html#ug-notifications"><span class="std std-ref">Notifications</span></a> for more detail.</p>
</section>
<section id="cleanup-expired-sessions">
<h4><span class="section-number">5.3. </span>Cleanup Expired Sessions<a class="headerlink" href="#cleanup-expired-sessions" title="Link to this heading"></a></h4>
<p id="index-3">To remove expired sessions, click on the launch (<img alt="launch" src="_images/launch-button.png" />) button beside <strong>Cleanup Expired Sessions</strong>.</p>
<p>You can review or set a schedule for cleaning up expired sessions by performing the same procedure described for activity stream management jobs. See <a class="reference internal" href="#ag-mgmt-job-schedule"><span class="std std-ref">Scheduling</span></a> for detail.</p>
<p>You can also set or review notifications associated with this management job the same way as described in <a class="reference internal" href="#ag-mgmt-job-notify"><span class="std std-ref">Notifications</span></a> for activity stream management jobs, and refer to <a class="reference internal" href="index.html#ug-notifications"><span class="std std-ref">Notifications</span></a> for more detail.</p>
</section>
<section id="removing-old-job-history">
<h4><span class="section-number">5.4. </span>Removing Old Job History<a class="headerlink" href="#removing-old-job-history" title="Link to this heading"></a></h4>
<p id="index-4">To remove job history older than a specified number of days, click on the launch (<img alt="launch" src="_images/launch-button.png" />) button beside <strong>Cleanup Job Details</strong>.</p>
<p><img alt="management jobs - cleanup job launch" src="_images/ug-management-jobs-cleanup-job-launch.png" /></p>
<p>Enter the number of days of data you would like to save and click <strong>Launch</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The initial job run for an AWX resource (e.g. Projects, Job Templates) is excluded from <strong>Cleanup Job Details</strong>, regardless of retention value.</p>
</div>
<p>You can review or set a schedule for cleaning up old job history by performing the same procedure described for activity stream management jobs. See <a class="reference internal" href="#ag-mgmt-job-schedule"><span class="std std-ref">Scheduling</span></a> for detail.</p>
<p>You can also set or review notifications associated with this management job the same way as described in <a class="reference internal" href="#ag-mgmt-job-notify"><span class="std std-ref">Notifications</span></a> for activity stream management jobs, and refer to <a class="reference internal" href="index.html#ug-notifications"><span class="std std-ref">Notifications</span></a> for more detail.</p>
</section>
</section>
<span id="document-administration/clustering"></span><section id="clustering">
<span id="ag-clustering"></span><h3><span class="section-number">6. </span>Clustering<a class="headerlink" href="#clustering" title="Link to this heading"></a></h3>
<p id="index-0">Clustering is sharing load between hosts. Each instance should be able to act as an entry point for UI and API access. This should enable AWX administrators to use load balancers in front of as many instances as they wish and maintain good data visibility.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Load balancing is optional and is entirely possible to have ingress on one or all instances as needed. The <code class="docutils literal notranslate"><span class="pre">CSRF_TRUSTED_ORIGIN</span></code> setting may be required if you are using AWX behind a load balancer. See <a class="reference internal" href="index.html#ki-csrf-trusted-origin-setting"><span class="std std-ref">The CSRF_TRUSTED_ORIGIN setting</span></a> for more detail.</p>
</div>
<p>Each instance should be able to join AWX cluster and expand its ability to execute jobs. This is a simple system where jobs can and will run anywhere rather than be directed on where to run. Also, clustered instances can be grouped into different pools/queues, called <a class="reference internal" href="index.html#ag-instance-groups"><span class="std std-ref">Instance Groups</span></a>.</p>
<section id="setup-considerations">
<h4><span class="section-number">6.1. </span>Setup Considerations<a class="headerlink" href="#setup-considerations" title="Link to this heading"></a></h4>
<p id="index-1">This section covers initial setup of clusters only. For upgrading an existing cluster, refer to the <em>AWX Upgrade and Migration Guide</em>.</p>
<p>Important considerations to note in the new clustering environment:</p>
<ul class="simple">
<li><p>PostgreSQL is still a standalone instance and is not clustered. AWX does not manage replica configuration or database failover (if the user configures standby replicas).</p></li>
<li><p>When spinning up a cluster, the database node should be a standalone server, and PostgreSQL should not be installed on one of AWX nodes.</p></li>
<li><p>PgBouncer is not recommended for connection pooling with AWX. Currently, AWX relies heavily on <code class="docutils literal notranslate"><span class="pre">pg_notify</span></code> for sending messages across various components, and therefore, PgBouncer cannot readily be used in transaction pooling mode.</p></li>
<li><p>The maximum supported instances in a cluster is 20.</p></li>
<li><p>All instances should be reachable from all other instances and they should be able to reach the database. It is also important for the hosts to have a stable address and/or hostname (depending on how the AWX host is configured).</p></li>
<li><p>All instances must be geographically collocated, with reliable low-latency connections between instances.</p></li>
<li><p>For purposes of upgrading to a clustered environment, your primary instance must be part of the <code class="docutils literal notranslate"><span class="pre">default</span></code> group in the inventory <em>AND</em> it needs to be the first host listed in the <code class="docutils literal notranslate"><span class="pre">default</span></code> group.</p></li>
<li><p>Manual projects must be manually synced to all instances by the customer, and updated on all instances at once.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">inventory</span></code> file for platform deployments should be saved/persisted. If new instances are to be provisioned, the passwords and configuration options, as well as host names, must be made available to the installer.</p></li>
</ul>
</section>
<section id="scaling-the-web-and-task-pods-independently">
<h4><span class="section-number">6.2. </span>Scaling the Web and Task pods independently<a class="headerlink" href="#scaling-the-web-and-task-pods-independently" title="Link to this heading"></a></h4>
<p>You can scale replicas up or down for each deployment by using the <code class="docutils literal notranslate"><span class="pre">web_replicas</span></code> or <code class="docutils literal notranslate"><span class="pre">task_replicas</span></code> respectively. You can scale all pods across both deployments by using <code class="docutils literal notranslate"><span class="pre">replicas</span></code> as well. The logic behind these CRD keys acts as such:</p>
<ul class="simple">
<li><p>If you specify the <code class="docutils literal notranslate"><span class="pre">replicas</span></code> field, the key passed will scale both the <code class="docutils literal notranslate"><span class="pre">web</span></code> and <code class="docutils literal notranslate"><span class="pre">task</span></code> replicas to the same number.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">web_replicas</span></code> or <code class="docutils literal notranslate"><span class="pre">task_replicas</span></code> is ever passed, it will override the existing <code class="docutils literal notranslate"><span class="pre">replicas</span></code> field on the specific deployment with the new key value.</p></li>
</ul>
<p>These new replicas can be constrained in a similar manner to previous single deployments by appending the particular deployment name in front of the constraint used. More about those new constraints can be found below in the <a class="reference internal" href="#ag-assign-pods-to-nodes"><span class="std std-ref">Assigning AWX pods to specific nodes</span></a> section.</p>
</section>
<section id="assigning-awx-pods-to-specific-nodes">
<span id="ag-assign-pods-to-nodes"></span><h4><span class="section-number">6.3. </span>Assigning AWX pods to specific nodes<a class="headerlink" href="#assigning-awx-pods-to-specific-nodes" title="Link to this heading"></a></h4>
<p>You can constrain the AWX pods created by the operator to run on a certain subset of nodes. <code class="docutils literal notranslate"><span class="pre">node_selector</span></code> and <code class="docutils literal notranslate"><span class="pre">postgres_selector</span></code> constrains the AWX pods to run only on the nodes that match all the specified key/value pairs. <code class="docutils literal notranslate"><span class="pre">tolerations</span></code> and <code class="docutils literal notranslate"><span class="pre">postgres_tolerations</span></code> allow the AWX pods to be scheduled onto nodes with matching taints. The ability to specify <code class="docutils literal notranslate"><span class="pre">topologySpreadConstraints</span></code> is also allowed through <code class="docutils literal notranslate"><span class="pre">topology_spread_constraints</span></code> If you want to use affinity rules for your AWX pod, you can use the <code class="docutils literal notranslate"><span class="pre">affinity</span></code> option.</p>
<p>If you want to constrain the web and task pods individually, you can do so by specifying the deployment type before the specific setting. For example, specifying <code class="docutils literal notranslate"><span class="pre">task_tolerations</span></code> will allow the AWX task pod to be scheduled onto nodes with matching taints.</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Description</p></td>
<td><p>Default</p></td>
</tr>
<tr class="row-even"><td><p>postgres_image</p></td>
<td><p>Path of the image to pull</p></td>
<td><p>postgres</p></td>
</tr>
<tr class="row-odd"><td><p>postgres_image_version</p></td>
<td><p>Image version to pull</p></td>
<td><p>13</p></td>
</tr>
<tr class="row-even"><td><p>node_selector</p></td>
<td><p>AWX pods’ nodeSelector</p></td>
<td><p>‘’</p></td>
</tr>
<tr class="row-odd"><td><p>web_node_selector</p></td>
<td><p>AWX web pods’ nodeSelector</p></td>
<td><p>‘’</p></td>
</tr>
<tr class="row-even"><td><p>task_node_selector</p></td>
<td><p>AWX task pods’ nodeSelector</p></td>
<td><p>‘’</p></td>
</tr>
<tr class="row-odd"><td><p>topology_spread_constraints</p></td>
<td><p>AWX pods’ topologySpreadConstraints</p></td>
<td><p>‘’</p></td>
</tr>
<tr class="row-even"><td><p>web_topology_spread_constraints</p></td>
<td><p>AWX web pods’ topologySpreadConstraints</p></td>
<td><p>‘’</p></td>
</tr>
<tr class="row-odd"><td><p>task_topology_spread_constraints</p></td>
<td><p>AWX task pods’ topologySpreadConstraints</p></td>
<td><p>‘’</p></td>
</tr>
<tr class="row-even"><td><p>affinity</p></td>
<td><p>AWX pods’ affinity rules</p></td>
<td><p>‘’</p></td>
</tr>
<tr class="row-odd"><td><p>web_affinity</p></td>
<td><p>AWX web pods’ affinity rules</p></td>
<td><p>‘’</p></td>
</tr>
<tr class="row-even"><td><p>task_affinity</p></td>
<td><p>AWX task pods’ affinity rules</p></td>
<td><p>‘’</p></td>
</tr>
<tr class="row-odd"><td><p>tolerations</p></td>
<td><p>AWX pods’ tolerations</p></td>
<td><p>‘’</p></td>
</tr>
<tr class="row-even"><td><p>web_tolerations</p></td>
<td><p>AWX web pods’ tolerations</p></td>
<td><p>‘’</p></td>
</tr>
<tr class="row-odd"><td><p>task_tolerations</p></td>
<td><p>AWX task pods’ tolerations</p></td>
<td><p>‘’</p></td>
</tr>
<tr class="row-even"><td><p>annotations</p></td>
<td><p>AWX pods’ annotations</p></td>
<td><p>‘’</p></td>
</tr>
<tr class="row-odd"><td><p>postgres_selector</p></td>
<td><p>Postgres pods’ nodeSelector</p></td>
<td><p>‘’</p></td>
</tr>
<tr class="row-even"><td><p>postgres_tolerations</p></td>
<td><p>Postgres pods’ tolerations</p></td>
<td><p>‘’</p></td>
</tr>
</tbody>
</table>
<p>Example of customization could be:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">node_selector</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">disktype: ssd</span>
<span class="w">      </span><span class="no">kubernetes.io/arch: amd64</span>
<span class="w">      </span><span class="no">kubernetes.io/os: linux</span>
<span class="w">    </span><span class="nt">topology_spread_constraints</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">- maxSkew: 100</span>
<span class="w">      </span><span class="no">topologyKey: &quot;topology.kubernetes.io/zone&quot;</span>
<span class="w">      </span><span class="no">whenUnsatisfiable: &quot;ScheduleAnyway&quot;</span>
<span class="w">      </span><span class="no">labelSelector:</span>
<span class="w">        </span><span class="no">matchLabels:</span>
<span class="w">            </span><span class="no">app.kubernetes.io/name: &quot;&lt;resourcename&gt;&quot;</span>
<span class="w">    </span><span class="nt">tolerations</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">- key: &quot;dedicated&quot;</span>
<span class="w">      </span><span class="no">operator: &quot;Equal&quot;</span>
<span class="w">      </span><span class="no">value: &quot;AWX&quot;</span>
<span class="w">      </span><span class="no">effect: &quot;NoSchedule&quot;</span>
<span class="w">    </span><span class="nt">task_tolerations</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">- key: &quot;dedicated&quot;</span>
<span class="w">      </span><span class="no">operator: &quot;Equal&quot;</span>
<span class="w">      </span><span class="no">value: &quot;AWX_task&quot;</span>
<span class="w">      </span><span class="no">effect: &quot;NoSchedule&quot;</span>
<span class="w">    </span><span class="nt">postgres_selector</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">disktype: ssd</span>
<span class="w">      </span><span class="no">kubernetes.io/arch: amd64</span>
<span class="w">      </span><span class="no">kubernetes.io/os: linux</span>
<span class="w">    </span><span class="nt">postgres_tolerations</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">- key: &quot;dedicated&quot;</span>
<span class="w">      </span><span class="no">operator: &quot;Equal&quot;</span>
<span class="w">      </span><span class="no">value: &quot;AWX&quot;</span>
<span class="w">      </span><span class="no">effect: &quot;NoSchedule&quot;</span>
<span class="w">    </span><span class="nt">affinity</span><span class="p">:</span>
<span class="w">      </span><span class="nt">nodeAffinity</span><span class="p">:</span>
<span class="w">      </span><span class="nt">preferredDuringSchedulingIgnoredDuringExecution</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">weight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">        </span><span class="nt">preference</span><span class="p">:</span>
<span class="w">            </span><span class="nt">matchExpressions</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">another-node-label-key</span>
<span class="w">              </span><span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">In</span>
<span class="w">              </span><span class="nt">values</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">another-node-label-value</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">another-node-label-value</span>
<span class="w">      </span><span class="nt">podAntiAffinity</span><span class="p">:</span>
<span class="w">      </span><span class="nt">preferredDuringSchedulingIgnoredDuringExecution</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">weight</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">        </span><span class="nt">podAffinityTerm</span><span class="p">:</span>
<span class="w">            </span><span class="nt">labelSelector</span><span class="p">:</span>
<span class="w">              </span><span class="nt">matchExpressions</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security</span>
<span class="w">                </span><span class="nt">operator</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">In</span>
<span class="w">                </span><span class="nt">values</span><span class="p">:</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">S2</span>
<span class="w">            </span><span class="nt">topologyKey</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">topology.kubernetes.io/zone</span>
</pre></div>
</div>
</section>
<section id="status-and-monitoring-via-browser-api">
<h4><span class="section-number">6.4. </span>Status and Monitoring via Browser API<a class="headerlink" href="#status-and-monitoring-via-browser-api" title="Link to this heading"></a></h4>
<p>AWX itself reports as much status as it can via the Browsable API at <code class="docutils literal notranslate"><span class="pre">/api/v2/ping</span></code> in order to provide validation of the health of the cluster, including:</p>
<ul class="simple">
<li><p>The instance servicing the HTTP request</p></li>
<li><p>The timestamps of the last heartbeat of all other instances in the cluster</p></li>
<li><p>Instance Groups and Instance membership in those groups</p></li>
</ul>
<p>View more details about Instances and Instance Groups, including running jobs and membership information at <code class="docutils literal notranslate"><span class="pre">/api/v2/instances/</span></code> and <code class="docutils literal notranslate"><span class="pre">/api/v2/instance_groups/</span></code>.</p>
</section>
<section id="instance-services-and-failure-behavior">
<h4><span class="section-number">6.5. </span>Instance Services and Failure Behavior<a class="headerlink" href="#instance-services-and-failure-behavior" title="Link to this heading"></a></h4>
<p>Each AWX instance is made up of several different services working collaboratively:</p>
<ul class="simple">
<li><p>HTTP Services - This includes the AWX application itself as well as external web services.</p></li>
<li><p>Callback Receiver - Receives job events from running Ansible jobs.</p></li>
<li><p>Dispatcher - The worker queue that processes and runs all jobs.</p></li>
<li><p>Redis - This key value store is used as a queue for event data propagated from ansible-playbook to the application.</p></li>
<li><p>Rsyslog - log processing service used to deliver logs to various external logging services.</p></li>
</ul>
<p>AWX is configured in such a way that if any of these services or their components fail, then all services are restarted. If these fail sufficiently often in a short span of time, then the entire instance will be placed offline in an automated fashion in order to allow remediation without causing unexpected behavior.</p>
</section>
<section id="job-runtime-behavior">
<h4><span class="section-number">6.6. </span>Job Runtime Behavior<a class="headerlink" href="#job-runtime-behavior" title="Link to this heading"></a></h4>
<p>The way jobs are run and reported to a ‘normal’ user of AWX does not change. On the system side, some differences are worth noting:</p>
<ul class="simple">
<li><p>When a job is submitted from the API interface it gets pushed into the dispatcher queue.  Each AWX instance will connect to and receive jobs from that queue using a particular scheduling algorithm. Any instance in the cluster is just as likely to receive the work and execute the task. If a instance fails while executing jobs, then the work is marked as permanently failed.</p></li>
</ul>
<img alt="An illustration depicting job distribution in an AWX cluster." src="_images/clustering-visual.png" />
<ul class="simple">
<li><p>Project updates run successfully on any instance that could potentially run a job. Projects will sync themselves to the correct version on the instance immediately prior to running the job. If the needed revision is already locally checked out and Galaxy or Collections updates are not needed, then a sync may not be performed.</p></li>
<li><p>When the sync happens, it is recorded in the database as a project update with a <code class="docutils literal notranslate"><span class="pre">launch_type</span> <span class="pre">=</span> <span class="pre">sync</span></code> and <code class="docutils literal notranslate"><span class="pre">job_type</span> <span class="pre">=</span>&#160; <span class="pre">run</span></code>. Project syncs will not change the status or version of the project; instead, they will update the source tree <em>only</em> on the instance where they run.</p></li>
<li><p>If updates are needed from Galaxy or Collections, a sync is performed that downloads the required roles, consuming that much more space in your /tmp file. In cases where you have a big project (around 10 GB), disk space on <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> may be an issue.</p></li>
</ul>
<section id="job-runs">
<h5><span class="section-number">6.6.1. </span>Job Runs<a class="headerlink" href="#job-runs" title="Link to this heading"></a></h5>
<p>By default, when a job is submitted to the AWX queue, it can be picked up by any of the workers. However, you can control where a particular job runs, such as restricting the instances from which a job runs on.</p>
<p>In order to support temporarily taking an instance offline, there is a property enabled defined on each instance. When this property is disabled, no jobs will be assigned to that instance. Existing jobs will finish, but no new work will be assigned.</p>
</section>
</section>
</section>
<span id="document-administration/containers_instance_groups"></span><section id="container-and-instance-groups">
<span id="ag-ext-exe-env"></span><h3><span class="section-number">7. </span>Container and Instance Groups<a class="headerlink" href="#container-and-instance-groups" title="Link to this heading"></a></h3>
<p id="index-0">AWX allows you to execute jobs via ansible playbook runs directly on a member of the cluster or in a namespace of an Openshift cluster with the necessary service account provisioned called a Container Group. You can execute jobs in a container group only as-needed per playbook. For more information, see <a class="reference internal" href="#ag-container-groups"><span class="std std-ref">Container Groups</span></a> towards the end of this section.</p>
<p>For execution environments, see <a class="reference internal" href="index.html#ug-execution-environments"><span class="std std-ref">Execution Environments</span></a> in the <em>AWX User Guide</em>.</p>
<section id="instance-groups">
<span id="ag-instance-groups"></span><h4><span class="section-number">7.1. </span>Instance Groups<a class="headerlink" href="#instance-groups" title="Link to this heading"></a></h4>
<p>Instances can be grouped into one or more Instance Groups. Instance groups can be assigned to one or more of the resources listed below.</p>
<ul class="simple">
<li><p>Organizations</p></li>
<li><p>Inventories</p></li>
<li><p>Job Templates</p></li>
</ul>
<p>When a job associated with one of the resources executes, it will be assigned to the instance group associated with the resource. During the execution process, instance groups associated with Job Templates are checked before those associated with Inventories. Similarly, instance groups associated with Inventories are checked before those associated with Organizations. Thus, Instance Group assignments for the three resources form a hierarchy: Job Template <strong>&gt;</strong> Inventory <strong>&gt;</strong> Organization.</p>
<p>Here are some of the things to consider when working with instance groups:</p>
<ul class="simple">
<li><p>You may optionally define other groups and group instances in those groups. These groups should be prefixed with <code class="docutils literal notranslate"><span class="pre">instance_group_</span></code>. Instances are required to be in the <code class="docutils literal notranslate"><span class="pre">awx</span></code> or <code class="docutils literal notranslate"><span class="pre">execution_nodes</span></code> group alongside other <code class="docutils literal notranslate"><span class="pre">instance_group_</span></code> groups. In a clustered setup, at least one instance <strong>must</strong> be present in the <code class="docutils literal notranslate"><span class="pre">awx</span></code> group, which will appear as <code class="docutils literal notranslate"><span class="pre">controlplane</span></code> in the API instance groups. See <a class="reference internal" href="#ag-awx-group-policies"><span class="std std-ref">awx group policies</span></a> for example scenarios.</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">default</span></code> API instance group is automatically created with all nodes capable of running jobs. Technically, it is like any other instance group but if a specific instance group is not associated with a specific resource, then job execution will always fall back to the <code class="docutils literal notranslate"><span class="pre">default</span></code> instance group. The <code class="docutils literal notranslate"><span class="pre">default</span></code> instance group always exists (it cannot be deleted nor renamed).</p></li>
<li><p>Do not create a group named <code class="docutils literal notranslate"><span class="pre">instance_group_default</span></code>.</p></li>
<li><p>Do not name any instance the same as a group name.</p></li>
</ul>
<section id="awx-group-policies">
<span id="ag-awx-group-policies"></span><h5><span class="section-number">7.1.1. </span><code class="docutils literal notranslate"><span class="pre">awx</span></code> group policies<a class="headerlink" href="#awx-group-policies" title="Link to this heading"></a></h5>
<p id="index-1">Use the following criteria when defining nodes:</p>
<ul class="simple">
<li><p>nodes in the <code class="docutils literal notranslate"><span class="pre">awx</span></code> group can define <code class="docutils literal notranslate"><span class="pre">node_type</span></code> hostvar to be <code class="docutils literal notranslate"><span class="pre">hybrid</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">control</span></code></p></li>
<li><p>nodes in the <code class="docutils literal notranslate"><span class="pre">execution_nodes</span></code> group can define <code class="docutils literal notranslate"><span class="pre">node_type</span></code> hostvar to be <code class="docutils literal notranslate"><span class="pre">execution</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">hop</span></code></p></li>
</ul>
<p>You can define custom groups in the inventory file by naming groups with <code class="docutils literal notranslate"><span class="pre">instance_group_*</span></code> where <code class="docutils literal notranslate"><span class="pre">*</span></code> becomes the name of the group in the API. Or, you can create custom instance groups in the API after the install has finished.</p>
<p>The current behavior expects a member of an <code class="docutils literal notranslate"><span class="pre">instance_group_*</span></code> be part of <code class="docutils literal notranslate"><span class="pre">awx</span></code> or <code class="docutils literal notranslate"><span class="pre">execution_nodes</span></code> group. Consider this example scenario:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="nv">awx</span><span class="p p-Indicator">]</span>
<span class="l l-Scalar l-Scalar-Plain">126-addr.tatu.home ansible_host=192.168.111.126  node_type=control</span>

<span class="l l-Scalar l-Scalar-Plain">[awx:vars]</span>
<span class="l l-Scalar l-Scalar-Plain">peers=execution_nodes</span>

<span class="l l-Scalar l-Scalar-Plain">[execution_nodes]</span>

<span class="l l-Scalar l-Scalar-Plain">[instance_group_test]</span>
<span class="l l-Scalar l-Scalar-Plain">110-addr.tatu.home ansible_host=192.168.111.110 receptor_listener_port=8928</span>
</pre></div>
</div>
<p>As a result of running the installer, you will get the error below:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>TASK<span class="w"> </span><span class="o">[</span>ansible.automation_platform_installer.check_config_static<span class="w"> </span>:<span class="w"> </span>Validate<span class="w"> </span>mesh<span class="w"> </span>topology<span class="o">]</span><span class="w"> </span>***
fatal:<span class="w"> </span><span class="o">[</span><span class="m">126</span>-addr.tatu.home<span class="w"> </span>-&gt;<span class="w"> </span>localhost<span class="o">]</span>:<span class="w"> </span>FAILED!<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="s2">&quot;The host &#39;110-addr.tatu.home&#39; is not present in either [awx] or [execution_nodes]&quot;</span><span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<p>To fix this, you could move the box <code class="docutils literal notranslate"><span class="pre">110-addr.tatu.home</span></code> to an <code class="docutils literal notranslate"><span class="pre">execution_node</span></code> group.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="nv">awx</span><span class="p p-Indicator">]</span>
<span class="l l-Scalar l-Scalar-Plain">126-addr.tatu.home ansible_host=192.168.111.126  node_type=control</span>

<span class="l l-Scalar l-Scalar-Plain">[awx:vars]</span>
<span class="l l-Scalar l-Scalar-Plain">peers=execution_nodes</span>

<span class="l l-Scalar l-Scalar-Plain">[execution_nodes]</span>
<span class="l l-Scalar l-Scalar-Plain">110-addr.tatu.home ansible_host=192.168.111.110 receptor_listener_port=8928</span>

<span class="l l-Scalar l-Scalar-Plain">[instance_group_test]</span>
<span class="l l-Scalar l-Scalar-Plain">110-addr.tatu.home</span>
</pre></div>
</div>
<p>This results in:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>TASK<span class="w"> </span><span class="o">[</span>ansible.automation_platform_installer.check_config_static<span class="w"> </span>:<span class="w"> </span>Validate<span class="w"> </span>mesh<span class="w"> </span>topology<span class="o">]</span><span class="w"> </span>***
ok:<span class="w"> </span><span class="o">[</span><span class="m">126</span>-addr.tatu.home<span class="w"> </span>-&gt;<span class="w"> </span>localhost<span class="o">]</span><span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>false,<span class="w"> </span><span class="s2">&quot;mesh&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;110-addr.tatu.home&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;node_type&quot;</span>:<span class="w"> </span><span class="s2">&quot;execution&quot;</span>,<span class="w"> </span><span class="s2">&quot;peers&quot;</span>:<span class="w"> </span><span class="o">[]</span>,<span class="w"> </span><span class="s2">&quot;receptor_control_filename&quot;</span>:<span class="w"> </span><span class="s2">&quot;receptor.sock&quot;</span>,<span class="w"> </span><span class="s2">&quot;receptor_control_service_name&quot;</span>:<span class="w"> </span><span class="s2">&quot;control&quot;</span>,<span class="w"> </span><span class="s2">&quot;receptor_listener&quot;</span>:<span class="w"> </span>true,<span class="w"> </span><span class="s2">&quot;receptor_listener_port&quot;</span>:<span class="w"> </span><span class="m">8928</span>,<span class="w"> </span><span class="s2">&quot;receptor_listener_protocol&quot;</span>:<span class="w"> </span><span class="s2">&quot;tcp&quot;</span>,<span class="w"> </span><span class="s2">&quot;receptor_log_level&quot;</span>:<span class="w"> </span><span class="s2">&quot;info&quot;</span><span class="o">}</span>,<span class="w"> </span><span class="s2">&quot;126-addr.tatu.home&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;node_type&quot;</span>:<span class="w"> </span><span class="s2">&quot;control&quot;</span>,<span class="w"> </span><span class="s2">&quot;peers&quot;</span>:<span class="w"> </span><span class="o">[</span><span class="s2">&quot;110-addr.tatu.home&quot;</span><span class="o">]</span>,<span class="w"> </span><span class="s2">&quot;receptor_control_filename&quot;</span>:<span class="w"> </span><span class="s2">&quot;receptor.sock&quot;</span>,<span class="w"> </span><span class="s2">&quot;receptor_control_service_name&quot;</span>:<span class="w"> </span><span class="s2">&quot;control&quot;</span>,<span class="w"> </span><span class="s2">&quot;receptor_listener&quot;</span>:<span class="w"> </span>false,<span class="w"> </span><span class="s2">&quot;receptor_listener_port&quot;</span>:<span class="w"> </span><span class="m">27199</span>,<span class="w"> </span><span class="s2">&quot;receptor_listener_protocol&quot;</span>:<span class="w"> </span><span class="s2">&quot;tcp&quot;</span>,<span class="w"> </span><span class="s2">&quot;receptor_log_level&quot;</span>:<span class="w"> </span><span class="s2">&quot;info&quot;</span><span class="o">}}}</span>
</pre></div>
</div>
</div></blockquote>
<p>Upon upgrading from older versions of awx, the legacy <code class="docutils literal notranslate"><span class="pre">instance_group_</span></code> member will most likely have the awx code installed, which would cause that node to be placed in the <code class="docutils literal notranslate"><span class="pre">awx</span></code> group.</p>
</section>
<section id="configuring-instance-groups-from-the-api">
<h5><span class="section-number">7.1.2. </span>Configuring Instance Groups from the API<a class="headerlink" href="#configuring-instance-groups-from-the-api" title="Link to this heading"></a></h5>
<p id="index-2">Instance groups can be created by POSTing to <code class="docutils literal notranslate"><span class="pre">/api/v2/instance_groups</span></code> as a system administrator.</p>
<p>Once created, instances can be associated with an instance group with:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>HTTP<span class="w"> </span>POST<span class="w"> </span>/api/v2/instance_groups/x/instances/<span class="w"> </span><span class="o">{</span><span class="s1">&#39;id&#39;</span>:<span class="w"> </span>y<span class="o">}</span><span class="sb">`</span>
</pre></div>
</div>
</div></blockquote>
<p>An instance that is added to an instance group will automatically reconfigure itself to listen on the group’s work queue. See the following section, <a class="reference internal" href="#ag-instance-group-policies"><span class="std std-ref">Instance group policies</span></a>, for more details.</p>
</section>
<section id="instance-group-policies">
<span id="ag-instance-group-policies"></span><h5><span class="section-number">7.1.3. </span>Instance group policies<a class="headerlink" href="#instance-group-policies" title="Link to this heading"></a></h5>
<p id="index-3">You can configure AWX instances to automatically join Instance Groups when they come online by defining a <a class="reference internal" href="index.html#term-Policy"><span class="xref std std-term">policy</span></a>. These policies are evaluated for every new instance that comes online.</p>
<p>Instance Group Policies are controlled by three optional fields on an <code class="docutils literal notranslate"><span class="pre">Instance</span> <span class="pre">Group</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">policy_instance_percentage</span></code>: This is a number between 0 - 100. It guarantees that this percentage of active AWX instances will be added to this Instance Group. As new instances come online, if the number of Instances in this group relative to the total number of instances is less than the given percentage, then new ones will be added until the percentage condition is satisfied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">policy_instance_minimum</span></code>: This policy attempts to keep at least this many instances in the Instance Group. If the number of available instances is lower than this minimum, then all instances will be placed in this Instance Group.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">policy_instance_list</span></code>: This is a fixed list of instance names to always include in this Instance Group.</p></li>
</ul>
<p>The Instance Groups list view from the automation controller User Interface provides a summary of the capacity levels for each instance group according to instance group policies:</p>
<p><img alt="Instance Group list view with example instance group and container groups." src="_images/instance-groups_list_view.png" /></p>
<p>See <a class="reference internal" href="index.html#ug-instance-groups-create"><span class="std std-ref">Create an instance group</span></a> for further detail.</p>
</section>
<section id="notable-policy-considerations">
<h5><span class="section-number">7.1.4. </span>Notable policy considerations<a class="headerlink" href="#notable-policy-considerations" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">policy_instance_percentage</span></code> and <code class="docutils literal notranslate"><span class="pre">policy_instance_minimum</span></code> both set minimum allocations. The rule that results in more instances assigned to the group will take effect. For example, if you have a <code class="docutils literal notranslate"><span class="pre">policy_instance_percentage</span></code> of 50% and a <code class="docutils literal notranslate"><span class="pre">policy_instance_minimum</span></code> of 2 and you start 6 instances, 3 of them would be assigned to the Instance Group. If you reduce the number of total instances in the cluster to 2, then both of them would be assigned to the Instance Group to satisfy <code class="docutils literal notranslate"><span class="pre">policy_instance_minimum</span></code>. This way, you can set a lower bound on the amount of available resources.</p></li>
<li><p>Policies do not actively prevent instances from being associated with multiple Instance Groups, but this can effectively be achieved by making the percentages add up to 100. If you have 4 instance groups, assign each a percentage value of 25 and the instances will be distributed among them with no overlap.</p></li>
</ul>
</section>
<section id="manually-pinning-instances-to-specific-groups">
<h5><span class="section-number">7.1.5. </span>Manually pinning instances to specific groups<a class="headerlink" href="#manually-pinning-instances-to-specific-groups" title="Link to this heading"></a></h5>
<p id="index-4">If you have a special instance which needs to be exclusively assigned to a specific Instance Group but don’t want it to automatically join other groups via “percentage” or “minimum” policies:</p>
<ol class="arabic simple">
<li><p>Add the instance to one or more Instance Groups’ <code class="docutils literal notranslate"><span class="pre">policy_instance_list</span></code></p></li>
<li><p>Update the instance’s <code class="docutils literal notranslate"><span class="pre">managed_by_policy</span></code> property to be <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ol>
<p>This will prevent the Instance from being automatically added to other groups based on percentage and minimum policy; it will only belong to the groups you’ve manually assigned it to:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>HTTP<span class="w"> </span>PATCH<span class="w"> </span>/api/v2/instance_groups/N/
<span class="o">{</span>
<span class="s2">&quot;policy_instance_list&quot;</span>:<span class="w"> </span><span class="o">[</span><span class="s2">&quot;special-instance&quot;</span><span class="o">]</span>
<span class="o">}</span>

HTTP<span class="w"> </span>PATCH<span class="w"> </span>/api/v2/instances/X/
<span class="o">{</span>
<span class="s2">&quot;managed_by_policy&quot;</span>:<span class="w"> </span>False
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="job-runtime-behavior">
<span id="ag-instance-groups-job-runtime-behavior"></span><h5><span class="section-number">7.1.6. </span>Job Runtime Behavior<a class="headerlink" href="#job-runtime-behavior" title="Link to this heading"></a></h5>
<p>When you run a job associated with a instance group, some behaviors worth noting are:</p>
<ul class="simple">
<li><p>If a cluster is divided into separate instance groups, then the behavior is similar to the cluster as a whole. If two instances are assigned to a group then either one is just as likely to receive a job as any other in the same group.</p></li>
<li><p>As AWX instances are brought online, it effectively expands the work capacity of the system. If those instances are also placed into instance groups, then they also expand that group’s capacity. If an instance is performing work and it is a member of multiple groups, then capacity will be reduced from all groups for which it is a member. De-provisioning an instance will remove capacity from the cluster wherever that instance was assigned.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Not all instances are required to be provisioned with an equal capacity.</p>
</div>
</section>
<section id="control-where-a-job-runs">
<span id="ag-instance-groups-control-where-job-runs"></span><h5><span class="section-number">7.1.7. </span>Control Where a Job Runs<a class="headerlink" href="#control-where-a-job-runs" title="Link to this heading"></a></h5>
<p>If any of the job template, inventory, or organization has instance groups associated with them, a job ran from that job template will not be eligible for the default behavior. That means that if all of the instances inside of the instance groups associated with these 3 resources are out of capacity, the job will remain in the pending state until capacity becomes available.</p>
<p>The order of preference in determining which instance group to submit the job to is as follows:</p>
<ol class="arabic simple">
<li><p>job template</p></li>
<li><p>inventory</p></li>
<li><p>organization (by way of project)</p></li>
</ol>
<p>If instance groups are associated with the job template, and all of these are at capacity, then the job will be submitted to instance groups specified on inventory, and then organization. Jobs should execute in those groups in preferential order as resources are available.</p>
<p>The global <code class="docutils literal notranslate"><span class="pre">default</span></code> group can still be associated with a resource, just like any of the custom instance groups defined in the playbook. This can be used to specify a preferred instance group on the job template or inventory, but still allow the job to be submitted to any instance if those are out of capacity.</p>
<p>As an example, by associating <code class="docutils literal notranslate"><span class="pre">group_a</span></code> with a Job Template and also associating the <code class="docutils literal notranslate"><span class="pre">default</span></code> group with its inventory, you allow the <code class="docutils literal notranslate"><span class="pre">default</span></code> group to be used as a fallback in case <code class="docutils literal notranslate"><span class="pre">group_a</span></code> gets out of capacity.</p>
<p>In addition, it is possible to not associate an instance group with one resource but designate another resource as the fallback. For example, not associating an instance group with a job template and have it fall back to the inventory and/or the organization’s instance group.</p>
<p>This presents two other great use cases:</p>
<ol class="arabic simple">
<li><p>Associating instance groups with an inventory (omitting assigning the job template to an instance group) will allow the user to ensure that any playbook run against a specific inventory will run only on the group associated with it. This can be super useful in the situation where only those instances have a direct link to the managed nodes.</p></li>
<li><p>An administrator can assign instance groups to organizations. This effectively allows the administrator to segment out the entire infrastructure and guarantee that each organization has capacity to run jobs without interfering with any other organization’s ability to run jobs.</p></li>
</ol>
<p>Likewise, an administrator could assign multiple groups to each organization as desired, as in the following scenario:</p>
<blockquote>
<div><ul class="simple">
<li><p>There are three instance groups: A, B, and C. There are two organizations: Org1 and Org2.</p></li>
<li><p>The administrator assigns group A to Org1, group B to Org2 and then assign group C to both Org1 and Org2 as an overflow for any extra capacity that may be needed.</p></li>
<li><p>The organization administrators are then free to assign inventory or job templates to whichever group they want (or just let them inherit the default order from the organization).</p></li>
</ul>
<p><img alt="Illustration showing grouping scenarios." src="_images/instance-groups-scenarios.png" /></p>
</div></blockquote>
<p>Arranging resources in this way offers a lot of flexibility. Also, you can create instance groups with only one instance, thus allowing you to direct work towards a very specific Host in the AWX cluster.</p>
</section>
<section id="instance-group-capacity-limits">
<span id="ag-instancegrp-cpacity"></span><h5><span class="section-number">7.1.8. </span>Instance group capacity limits<a class="headerlink" href="#instance-group-capacity-limits" title="Link to this heading"></a></h5>
<p id="index-5">Sometimes there is external business logic which may drive the desire to limit the concurrency of jobs sent to an instance group, or the maximum number of forks to be consumed.</p>
<p>For traditional instances and instance groups, there could be a desire to allow two organizations to run jobs on the same underlying instances, but limit each organization’s total number of concurrent jobs. This can be achieved by creating an instance group for each organization and assigning the value for <code class="docutils literal notranslate"><span class="pre">max_concurrent_jobs</span></code>.</p>
<p>For container groups, AWX is generally not aware of the resource limits of the OpenShift cluster. There may be limits set on the number of pods on a namespace, or only resources available to schedule a certain number of pods at a time if no auto-scaling is in place. Again, in this case, we can adjust the value for <code class="docutils literal notranslate"><span class="pre">max_concurrent_jobs</span></code>.</p>
<p>Another parameter available is <code class="docutils literal notranslate"><span class="pre">max_forks</span></code>. This provides additional flexibility for capping the capacity consumed on an instance group or container group. This may be used if jobs with a wide variety of inventory sizes and “forks” values are being run. This way, you can limit an organization to run up to 10 jobs concurrently, but consume no more than 50 forks at a time.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">max_concurrent_jobs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="nt">max_forks</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
</pre></div>
</div>
<p>If 10 jobs that use 5 forks each are run, an 11th job will wait until one of these finishes to run on that group (or be scheduled on a different group with capacity).</p>
<p>If 2 jobs are running with 20 forks each, then a 3rd job with a <code class="docutils literal notranslate"><span class="pre">task_impact</span></code> of 11 or more will wait until one of these finishes to run on that group (or be scheduled on a different group with capacity).</p>
<p>For container groups, using the <code class="docutils literal notranslate"><span class="pre">max_forks</span></code> value is useful given that all jobs are submitted using the same <code class="docutils literal notranslate"><span class="pre">pod_spec</span></code> with the same resource requests, irrespective of the “forks” value of the job. The default <code class="docutils literal notranslate"><span class="pre">pod_spec</span></code> sets requests and not limits, so the pods can “burst” above their requested value without being throttled or reaped. By setting the <code class="docutils literal notranslate"><span class="pre">max_forks</span></code> value, you can help prevent a scenario where too many jobs with large forks values get scheduled concurrently and cause the OpenShift nodes to be oversubscribed with multiple pods using more resources than their requested value.</p>
<p>To set the maximum values for the concurrent jobs and forks in an instance group, see <a class="reference internal" href="index.html#ug-instance-groups-create"><span class="std std-ref">Create an instance group</span></a> in the <em>AWX User Guide</em>.</p>
</section>
<section id="deprovision-instance-groups">
<span id="ag-instancegrp-deprovision"></span><h5><span class="section-number">7.1.9. </span>Deprovision Instance Groups<a class="headerlink" href="#deprovision-instance-groups" title="Link to this heading"></a></h5>
<p id="index-6">Re-running the setup playbook does not automatically deprovision instances since clusters do not currently distinguish between an instance that was taken offline intentionally or due to failure. Instead, shut down all services on the AWX instance and then run the deprovisioning tool from any other instance:</p>
<ol class="arabic">
<li><p>Shut down the instance or stop the service with the command, <code class="docutils literal notranslate"><span class="pre">automation-awx-service</span> <span class="pre">stop</span></code>.</p></li>
<li><p>Run the deprovision command <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">awx-manage</span> <span class="pre">deprovision_instance</span> <span class="pre">--hostname=&lt;name</span> <span class="pre">used</span> <span class="pre">in</span> <span class="pre">inventory</span> <span class="pre">file&gt;</span></code> from another instance to remove it from the AWX cluster registry.</p>
<blockquote>
<div><p>Example: <code class="docutils literal notranslate"><span class="pre">awx-manage</span> <span class="pre">deprovision_instance</span> <span class="pre">--hostname=hostB</span></code></p>
</div></blockquote>
</li>
</ol>
<p>Similarly, deprovisioning instance groups in AWX does not automatically deprovision or remove instance groups, even though re-provisioning will often cause these to be unused. They may still show up in API endpoints and stats monitoring. These groups can be removed with the following command:</p>
<blockquote>
<div><p>Example: <code class="docutils literal notranslate"><span class="pre">awx-manage</span> <span class="pre">unregister_queue</span> <span class="pre">--queuename=&lt;name&gt;</span></code></p>
</div></blockquote>
<p>Removing an instance’s membership from an instance group in the inventory file and re-running the setup playbook does not ensure the instance won’t be added back to a group. To be sure that an instance will not be added back to a group, remove via the API and also remove it in your inventory file, or you can stop defining instance groups in the inventory file altogether. You can also manage instance group topology through the automation controller User Interface. For more information on managing instance groups in the UI, refer to <a class="reference internal" href="index.html#ug-instance-groups"><span class="std std-ref">Instance Groups</span></a> in the <em>AWX User Guide</em>.</p>
</section>
</section>
<section id="container-groups">
<span id="ag-container-groups"></span><h4><span class="section-number">7.2. </span>Container Groups<a class="headerlink" href="#container-groups" title="Link to this heading"></a></h4>
<p id="index-7">AWX supports <a class="reference internal" href="index.html#term-Container-Groups"><span class="xref std std-term">Container Groups</span></a>, which allow you to execute jobs in pods on Kubernetes (k8s) or OpenShift clusters. Container groups act as a pool of resources within a virtual environment. These pods are created on-demand and only exist for the duration of the playbook run. This is known as the ephemeral execution model and ensures a clean environment for every job run.</p>
<p>In some cases, it is desirable to have container groups be “always-on”, which is configured through the creation of an instance.</p>
<p>Container groups are different from execution environments in that execution environments are container images and do not use a virtual environment. See <a class="reference internal" href="index.html#ug-execution-environments"><span class="std std-ref">Execution Environments</span></a> in the <em>AWX User Guide</em> for further detail.</p>
<section id="create-a-container-group">
<h5><span class="section-number">7.2.1. </span>Create a container group<a class="headerlink" href="#create-a-container-group" title="Link to this heading"></a></h5>
<p>A <code class="docutils literal notranslate"><span class="pre">ContainerGroup</span></code> is a type of <code class="docutils literal notranslate"><span class="pre">InstanceGroup</span></code> that has an associated Credential that allows for connecting to an OpenShift cluster. To set up a container group, you must first have the following:</p>
<ul class="simple">
<li><p>A namespace you can launch into (every cluster has a “default” namespace, but you may want to use a specific namespace)</p></li>
<li><p>A service account that has the roles that allow it to launch and manage Pods in this namespace</p></li>
<li><p>If you will be using execution environments in a private registry, and have a Container Registry credential associated to them in AWX, the service account also needs the roles to get, create, and delete secrets in the namespace. If you do not want to give these roles to the service account, you can pre-create the <code class="docutils literal notranslate"><span class="pre">ImagePullSecrets</span></code> and specify them on the pod spec for the ContainerGroup. In this case, the execution environment should NOT have a Container Registry credential associated, or AWX will attempt to create the secret for you in the namespace.</p></li>
<li><p>A token associated with that service account (OpenShift or Kubernetes Bearer Token)</p></li>
<li><p>A CA certificate associated with the cluster</p></li>
</ul>
<p>This section describes creating a Service Account in an Openshift cluster (or K8s) in order to be used to run jobs in a container group via AWX. After the Service Account is created, its credentials are provided to AWX in the form of an Openshift or Kubernetes API bearer token credential. Below describes how to create a service account and collect the needed information for configuring AWX.</p>
<p>To configure AWX:</p>
<ol class="arabic">
<li><p>To create a service account, you may download and use this sample service account, <a class="reference download internal" download="" href="_downloads/c0241c5d30477cf767908e8b663d5fec/containergroup-sa.yml"><code class="xref download docutils literal notranslate"><span class="pre">containergroup</span> <span class="pre">sa</span></code></a> and modify it as needed to obtain the above credentials.</p></li>
<li><p>Apply the configuration from <code class="docutils literal notranslate"><span class="pre">containergroup-sa.yml</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">oc apply -f containergroup-sa.yml</span>
</pre></div>
</div>
</li>
<li><p>Get the secret name associated with the service account:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">export SA_SECRET=$(oc get sa containergroup-service-account -o json | jq &#39;.secrets[0].name&#39; | tr -d &#39;&quot;&#39;)</span>
</pre></div>
</div>
</li>
<li><p>Get the token from the secret:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">oc get secret $(echo ${SA_SECRET}) -o json | jq &#39;.data.token&#39; | xargs | base64 --decode &gt; containergroup-sa.token</span>
</pre></div>
</div>
</li>
<li><p>Get the CA cert:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">oc get secret $SA_SECRET -o json | jq &#39;.data[&quot;ca.crt&quot;]&#39; | xargs | base64 --decode &gt; containergroup-ca.crt</span>
</pre></div>
</div>
</li>
<li><p>Use the contents of <code class="docutils literal notranslate"><span class="pre">containergroup-sa.token</span></code> and <code class="docutils literal notranslate"><span class="pre">containergroup-ca.crt</span></code> to provide the information for the <a class="reference internal" href="index.html#ug-credentials-ocp-k8s"><span class="std std-ref">OpenShift or Kubernetes API Bearer Token</span></a> required for the container group.</p></li>
</ol>
<p>To create a container group:</p>
<ol class="arabic simple">
<li><p>Use the AWX user interface to create an <a class="reference internal" href="index.html#ug-credentials-ocp-k8s"><span class="std std-ref">OpenShift or Kubernetes API Bearer Token</span></a> credential that will be used with your container group, see <a class="reference internal" href="index.html#ug-credentials-add"><span class="std std-ref">Add a New Credential</span></a> in the <em>AWX User Guide</em> for detail.</p></li>
<li><p>Create a new container group by navigating to the Instance Groups configuration window by clicking <strong>Instance Groups</strong> from the left navigation bar.</p></li>
<li><p>Click the <strong>Add</strong> button and select <strong>Create Container Group</strong>.</p></li>
</ol>
<p><img alt="Create new container group form." src="_images/instance-group-create-new-cg.png" /></p>
<ol class="arabic simple" start="4">
<li><p>Enter a name for your new container group and select the credential previously created to associate it to the container group.</p></li>
</ol>
</section>
<section id="customize-the-pod-spec">
<span id="ag-customize-pod-spec"></span><h5><span class="section-number">7.2.2. </span>Customize the pod spec<a class="headerlink" href="#customize-the-pod-spec" title="Link to this heading"></a></h5>
<p>AWX provides a simple default pod specification, however, you can provide a custom YAML (or JSON) document that overrides the default pod spec. This field uses any custom fields (for example, <code class="docutils literal notranslate"><span class="pre">ImagePullSecrets</span></code>) that can be “serialized” as valid pod JSON or YAML. A full list of options can be found in the <a class="reference external" href="https://docs.openshift.com/online/pro/architecture/core_concepts/pods_and_services.html">OpenShift documentation</a>.</p>
<p>To customize the pod spec, check the <strong>Customize pod specification</strong> option to enable and expand the <strong>Custom pod spec</strong> field where you specify the namespace and provide additional customizations as needed.</p>
<p><img alt="Create new container group form with the option to custom the pod spec." src="_images/instance-group-customize-cg-pod.png" /></p>
<p>Click <strong>Expand</strong> to view the entire customization window.</p>
<img alt="The expanded view for customizing the pod spec." src="_images/instance-group-customize-cg-pod-expanded.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The image used at job launch time is determined by which execution environment is associated with the job. If a Container Registry credential is associated with the execution environment, then AWX will attempt to make a <code class="docutils literal notranslate"><span class="pre">ImagePullSecret</span></code> to pull the image. If you prefer not to give the service account permission to manage secrets, you must pre-create the <code class="docutils literal notranslate"><span class="pre">ImagePullSecret</span></code> and specify it on the pod spec, and omit any credential from the execution environment used.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In order to override DNS/host entries, use the <code class="docutils literal notranslate"><span class="pre">hostAliases</span></code> attribute on the pod spec. When the pod is created, these entries will be added to <code class="docutils literal notranslate"><span class="pre">/etc/hosts</span></code> in the container running the job.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hostAliases</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.1&quot;</span>
<span class="w">    </span><span class="nt">hostnames</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;foo.local&quot;</span>
</pre></div>
</div>
<p>For more information, refer to Kubernetes’ documentation on <a class="reference external" href="https://kubernetes.io/docs/tasks/network/customize-hosts-file-for-pods/#adding-additional-entries-with-hostaliases">Adding additional entries with hostAliases</a>.</p>
</div>
<p>Once the container group is successfully created, the <strong>Details</strong> tab of the newly created container group remains, which allows you to review and edit your container group information. This is the same menu that is opened if the Edit (<img alt="Edit button." src="_images/edit-button.png" />) button is clicked from the <strong>Instance Group</strong> link. You can also edit <strong>Instances</strong> and review <strong>Jobs</strong> associated with this instance group.</p>
<p><img alt="Example of the successfully created instance group as shown in the Jobs tab of the Instance groups window." src="_images/instance-group-example-cg-successfully-created.png" /></p>
<p>Container groups and instance groups are labeled accordingly.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using a custom pod spec may cause issues on upgrades if the default <code class="docutils literal notranslate"><span class="pre">pod_spec</span></code> changes. Since any manifest can be applied to any namespace, with the namespace specified separately, most likely you will only need to override the namespace. Similarly, pinning a default image for different releases of the platform to different versions of the default job runner container is tricky. If the default image is specified in the pod spec, then upgrades do not pick up the new default changes that are made to the default pod spec.</p>
</div>
</section>
<section id="verify-container-group-functions">
<h5><span class="section-number">7.2.3. </span>Verify container group functions<a class="headerlink" href="#verify-container-group-functions" title="Link to this heading"></a></h5>
<p>To verify the deployment and termination of your container:</p>
<ol class="arabic simple">
<li><p>Create a mock inventory and associate the container group to it by populating the name of the container group in the <strong>Instance Group</strong> field. See <a class="reference internal" href="index.html#ug-inventories-add"><span class="std std-ref">Add a new inventory</span></a> in the <em>AWX User Guide</em> for detail.</p></li>
</ol>
<p><img alt="Example of creating a new container group test inventory." src="_images/inventories-create-new-cg-test-inventory.png" /></p>
<ol class="arabic simple" start="2">
<li><p>Create “localhost” host in inventory with variables:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span><span class="s">&#39;ansible_host&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;127.0.0.1&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;ansible_connection&#39;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;local&#39;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p><img alt="The new container group test inventory showing the populated variables." src="_images/inventories-create-new-cg-test-localhost.png" /></p>
<ol class="arabic simple" start="3">
<li><p>Launch an ad hoc job against the localhost using the <em>ping</em> or <em>setup</em> module. Even though the <strong>Machine Credential</strong> field is required, it does not matter which one is selected for this simple test.</p></li>
</ol>
<p><img alt="Launch inventory with localhost" src="_images/inventories-launch-adhoc-cg-test-localhost.png" /></p>
<img alt="Launching a Ping adhoc command on the newly created inventory with localhost." src="_images/inventories-launch-adhoc-cg-test-localhost2.png" />
<p>You can see in the jobs detail view the container was reached successfully using one of ad hoc jobs.</p>
<p><img alt="Jobs output view showing a successfully ran adhoc job." src="_images/inventories-launch-adhoc-cg-test-localhost-success.png" /></p>
<p>If you have an OpenShift UI, you can see pods appear and disappear as they deploy and terminate. Alternatively, you can use the CLI to perform a <code class="docutils literal notranslate"><span class="pre">get</span> <span class="pre">pod</span></code> operation on your namespace to watch these same events occurring in real-time.</p>
</section>
<section id="view-container-group-jobs">
<h5><span class="section-number">7.2.4. </span>View container group jobs<a class="headerlink" href="#view-container-group-jobs" title="Link to this heading"></a></h5>
<p>When you run a job associated with a container group, you can see the details of that job in the <strong>Details</strong> view and its associated container group and the execution environment that spun up.</p>
<p><img alt="Example Job details window showing the associated execution environment and container group." src="_images/instance-group-job-details-with-cgs.png" /></p>
</section>
<section id="kubernetes-api-failure-conditions">
<h5><span class="section-number">7.2.5. </span>Kubernetes API failure conditions<a class="headerlink" href="#kubernetes-api-failure-conditions" title="Link to this heading"></a></h5>
<p>When running a container group and the Kubernetes API responds that the resource quota has been exceeded, AWX keeps the job in pending state. Other failures result in the traceback of the <strong>Error Details</strong> field showing the failure reason, similar to the example here:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">Error creating pod: pods is forbidden</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">User &quot;system</span><span class="nt">: serviceaccount</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aap:example&quot; cannot create resource &quot;pods&quot; in API group &quot;&quot; in the namespace &quot;aap&quot;</span>
</pre></div>
</div>
</section>
<section id="container-capacity-limits">
<span id="ag-container-capacity"></span><h5><span class="section-number">7.2.6. </span>Container capacity limits<a class="headerlink" href="#container-capacity-limits" title="Link to this heading"></a></h5>
<p id="index-8">Capacity limits and quotas for containers are defined via objects in the Kubernetes API:</p>
<ul class="simple">
<li><p>To set limits on all pods within a given namespace, use the <code class="docutils literal notranslate"><span class="pre">LimitRange</span></code> object. Refer to the OpenShift documentation for <a class="reference external" href="https://docs.openshift.com/online/pro/dev_guide/compute_resources.html#overview">Quotas and Limit Ranges</a>.</p></li>
<li><p>To set limits directly on the pod definition launched by AWX, see <a class="reference internal" href="#ag-customize-pod-spec"><span class="std std-ref">Customize the pod spec</span></a> and refer to the OpenShift documentation to set the options to <a class="reference external" href="https://docs.openshift.com/online/pro/dev_guide/compute_resources.html#dev-compute-resources">compute resources</a>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Container groups do not use the capacity algorithm that normal nodes use. You would need to explicitly set the number of forks at the job template level, for instance. If forks are configured in AWX, that setting will be passed along to the container.</p>
</div>
</section>
</section>
</section>
<span id="document-administration/instances"></span><section id="managing-capacity-with-instances">
<span id="ag-instances"></span><h3><span class="section-number">8. </span>Managing Capacity With Instances<a class="headerlink" href="#managing-capacity-with-instances" title="Link to this heading"></a></h3>
<p id="index-0">Scaling your mesh is only available on Openshift and Kubernetes (K8S) deployments of AWX and is possible through adding or removing nodes from your cluster dynamically, through the <strong>Instances</strong> resource of the AWX User Interface, without running the installation script.</p>
<p>Instances serve as nodes in your mesh topology. Automation mesh allows you to extend the footprint of your automation. Where you launch a job and where the <code class="docutils literal notranslate"><span class="pre">ansible-playbook</span></code> runs can be in different locations.</p>
<img alt="Site A pointing to Site B and dotted arrows to two hosts from Site B" src="_images/instances_mesh_concept.drawio.png" />
<p>Automation mesh is useful for:</p>
<ul class="simple">
<li><p>traversing difficult network topologies</p></li>
<li><p>bringing execution capabilities (the machine running <code class="docutils literal notranslate"><span class="pre">ansible-playbook</span></code>) closer to your target hosts</p></li>
</ul>
<p>The nodes (control, hop, and execution instances) are interconnected via receptor, forming a virtual mesh.</p>
<img alt="Control node pointing to hop node, which is pointing to two execution nodes." src="_images/instances_mesh_concept_with_nodes.drawio.png" />
<section id="prerequisites">
<h4><span class="section-number">8.1. </span>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading"></a></h4>
<ul>
<li><p>Red Hat Enterprise Linux (RHEL) or Debian operating system. Bring a machine online with a compatible Red Hat family OS (e.g. RHEL 8 and 9) or Debian 11. This machine requires a static IP, or a resolvable DNS hostname that the AWX cluster can access. If the <code class="docutils literal notranslate"><span class="pre">listener_port</span></code> is defined, the machine will also need an available open port on which to establish inbound TCP connections (e.g. 27199).</p>
<p>In general, the more CPU cores and memory the machine has, the more jobs that can be scheduled to run on that machine at once. See <a class="reference internal" href="index.html#ug-job-concurrency"><span class="std std-ref">AWX Capacity Determination and Job Impact</span></a> for more information on capacity.</p>
</li>
<li><p>The system that is going to run the install bundle to setup the remote node requires the collection <code class="docutils literal notranslate"><span class="pre">ansible.receptor</span></code> to be installed:</p>
<blockquote>
<div><ul class="simple">
<li><p>If machine has access to the internet:</p></li>
</ul>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ansible-galaxy install -r requirements.yml</span>
</pre></div>
</div>
<p>Installing the receptor collection dependency from the <code class="docutils literal notranslate"><span class="pre">requirements.yml</span></code> file will consistently retrieve the receptor version specified there, as well as any other collection dependencies that may be needed in the future.</p>
<ul class="simple">
<li><p>If machine does not have access to the internet, refer to <a class="reference external" href="https://docs.ansible.com/ansible/latest/collections_guide/collections_installing.html#downloading-a-collection-for-offline-use">Downloading a collection for offline use</a>.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>To manage instances from the AWX user interface, you must have System Administrator or System Auditor permissions.</p></li>
</ul>
</section>
<section id="common-topologies">
<h4><span class="section-number">8.2. </span>Common topologies<a class="headerlink" href="#common-topologies" title="Link to this heading"></a></h4>
<p>Instances make up the network of devices that communicate with one another. They are the building blocks of an automation mesh. These building blocks serve as nodes in a mesh topology. There are several kinds of instances:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Node Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Control</p></td>
<td><p>Nodes that run persistent Ansible Automation Platform services, and delegate jobs to hybrid and execution nodes</p></td>
</tr>
<tr class="row-odd"><td><p>Hybrid</p></td>
<td><p>Nodes that run persistent Ansible Automation Platform services and execute jobs
(not applicable to operator-based installations)</p></td>
</tr>
<tr class="row-even"><td><p>Hop</p></td>
<td><p>Used for relaying across the mesh only</p></td>
</tr>
<tr class="row-odd"><td><p>Execution</p></td>
<td><p>Nodes that run jobs delivered from control nodes (jobs submitted from the user’s Ansible automation)</p></td>
</tr>
</tbody>
</table>
<section id="simple-topology">
<h5><span class="section-number">8.2.1. </span>Simple topology<a class="headerlink" href="#simple-topology" title="Link to this heading"></a></h5>
<p>One of the ways to expand job capacity is to create a standalone execution node that can be added to run alongside the Kubernetes deployment of AWX. These machines will not be a part of the AWX Kubernetes cluster. The control nodes running in the cluster will connect and submit work to these machines via Receptor. The machines are registered in AWX as type “execution” instances, meaning they will only be used to run AWX jobs, not dispatch work or handle web requests as control nodes do.</p>
<p>Hop nodes can be added to sit between the control plane of AWX and standalone execution nodes. These machines will not be a part of the AWX Kubernetes cluster and they will be registered in AWX as node type “hop”, meaning they will only handle inbound and outbound traffic for otherwise unreachable nodes in a different or more strict network.</p>
<p>Below is an example of an AWX task pod with two execution nodes. Traffic to execution node 2 flows through a hop node that is setup between it and the control plane.</p>
<img alt="AWX task pod with a hop node between the control plane of AWX and standalone execution nodes." src="_images/instances_awx_task_pods_hopnode.drawio.png" />
<p>Below are sample values used to configure each node in a simple topology:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 32%" />
<col style="width: 11%" />
<col style="width: 21%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Instance type</p></th>
<th class="head"><p>Hostname</p></th>
<th class="head"><p>Listener port</p></th>
<th class="head"><p>Peers from control nodes</p></th>
<th class="head"><p>Peers</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Control plane</p></td>
<td><p>awx-task-65d6d96987-mgn9j</p></td>
<td><p>n/a</p></td>
<td><p>n/a</p></td>
<td><p>[hop node]</p></td>
</tr>
<tr class="row-odd"><td><p>Hop node</p></td>
<td><p>awx-hop-node</p></td>
<td><p>27199</p></td>
<td><p>True</p></td>
<td><p>[]</p></td>
</tr>
<tr class="row-even"><td><p>Execution node</p></td>
<td><p>awx-example.com</p></td>
<td><p>n/a</p></td>
<td><p>False</p></td>
<td><p>[hop node]</p></td>
</tr>
</tbody>
</table>
</section>
<section id="mesh-topology">
<h5><span class="section-number">8.2.2. </span>Mesh topology<a class="headerlink" href="#mesh-topology" title="Link to this heading"></a></h5>
<p>Mesh ingress is a feature that allows remote nodes to connect inbound to the control plane. This is especially useful when creating remote nodes in restricted networking environments that disallow inbound traffic.</p>
<img alt="Mesh ingress architecture showing the peering relationship between nodes." src="_images/instances_mesh_ingress_topology.drawio.png" />
<p>Below are sample values used to configure each node in a mesh ingress topology:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 32%" />
<col style="width: 11%" />
<col style="width: 21%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Instance type</p></th>
<th class="head"><p>Hostname</p></th>
<th class="head"><p>Listener port</p></th>
<th class="head"><p>Peers from control nodes</p></th>
<th class="head"><p>Peers</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Control plane</p></td>
<td><p>awx-task-65d6d96987-mgn9j</p></td>
<td><p>n/a</p></td>
<td><p>n/a</p></td>
<td><p>[hop node]</p></td>
</tr>
<tr class="row-odd"><td><p>Hop node</p></td>
<td><p>awx-mesh-ingress-1</p></td>
<td><p>27199</p></td>
<td><p>True</p></td>
<td><p>[]</p></td>
</tr>
<tr class="row-even"><td><p>Execution node</p></td>
<td><p>awx-example.com</p></td>
<td><p>n/a</p></td>
<td><p>False</p></td>
<td><p>[hop node]</p></td>
</tr>
</tbody>
</table>
<p>In order to create a mesh ingress for AWX, see the <a class="reference external" href="https://ansible.readthedocs.io/projects/awx-operator/en/latest/user-guide/advanced-configuration/mesh-ingress.html">Mesh Ingress</a> chapter of the AWX Operator Documentation for information on setting up this type of topology. The last step is to create a remote execution node and add the execution node to an instance group in order for it to be used in your job execution. Whatever execution environment image used to run a playbook needs to be accessible for your remote execution node. Everything you are using in your playbook also needs to be accessible from this remote execution node.</p>
<a class="reference internal image-reference" href="_images/instances-job-template-using-remote-execution-ig.png"><img alt="Job template using the instance group with the execution node to run jobs." src="_images/instances-job-template-using-remote-execution-ig.png" style="width: 1400px;" /></a>
</section>
</section>
<section id="add-an-instance">
<span id="ag-instances-add"></span><h4><span class="section-number">8.3. </span>Add an instance<a class="headerlink" href="#add-an-instance" title="Link to this heading"></a></h4>
<p>To create an instance in AWX:</p>
<ol class="arabic simple">
<li><p>Click <strong>Instances</strong> from the left side navigation menu of the AWX UI.</p></li>
<li><p>In the Instances list view, click the <strong>Add</strong> button and the Create new Instance window opens.</p></li>
</ol>
<a class="reference internal image-reference" href="_images/instances_create_new.png"><img alt="Create a new instance form." src="_images/instances_create_new.png" style="width: 1400px;" /></a>
<p>An instance has several attributes that may be configured:</p>
<ul class="simple">
<li><p>Enter a fully qualified domain name (ping-able DNS) or IP address for your instance in the <strong>Host Name</strong> field (required). This field is equivalent to <code class="docutils literal notranslate"><span class="pre">hostname</span></code> in the API.</p></li>
<li><p>Optionally enter a <strong>Description</strong> for the instance</p></li>
<li><p>The <strong>Instance State</strong> field is auto-populated, indicating that it is being installed, and cannot be modified</p></li>
<li><p>Optionally specify the <strong>Listener Port</strong> for the receptor to listen on for incoming connections. This is an open port on the remote machine used to establish inbound TCP connections. This field is equivalent to <code class="docutils literal notranslate"><span class="pre">listener_port</span></code> in the API.</p></li>
<li><p>Select from the options in <strong>Instance Type</strong> field to specify the type you want to create. Only execution and hop nodes can be created as operator-based installations do not support hybrid nodes. This field is equivalent to <code class="docutils literal notranslate"><span class="pre">node_type</span></code> in the API.</p></li>
<li><p>In the <strong>Peers</strong> field, select the instance hostnames you want your new instance to connect outbound to.</p></li>
<li><dl class="simple">
<dt>In the <strong>Options</strong> fields:</dt><dd><ul>
<li><p>Check the <strong>Enable Instance</strong> box to make it available for jobs to run on an execution node.</p></li>
<li><p>Check the <strong>Managed by Policy</strong> box to allow policy to dictate how the instance is assigned.</p></li>
<li><p>Check the <strong>Peers from control nodes</strong> box to allow control nodes to peer to this instance automatically. Listener port needs to be set if this is enabled or the instance is a peer.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Once the attributes are configured, click <strong>Save</strong> to proceed.</p></li>
</ol>
<p>Upon successful creation, the Details of the one of the created instances opens.</p>
<a class="reference internal image-reference" href="_images/instances_create_details.png"><img alt="Details of the newly created instance." src="_images/instances_create_details.png" style="width: 1400px;" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The proceeding steps 4-8 are intended to be ran from any computer that has SSH access to the newly created instance.</p>
</div>
<ol class="arabic simple" start="4">
<li><p>Click the download button next to the <strong>Install Bundle</strong> field to download the tarball that contain files to allow AWX to make proper TCP connections to the remote machine.</p></li>
</ol>
<a class="reference internal image-reference" href="_images/instances_install_bundle.png"><img alt="Instance details showing the Download button in the Install Bundle field of the Details tab." src="_images/instances_install_bundle.png" style="width: 1400px;" /></a>
<ol class="arabic simple" start="5">
<li><p>Extract the downloaded <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> file from the location you downloaded it. The install bundle contains TLS certificates and keys, a certificate authority, and a proper Receptor configuration file. To facilitate that these files will be in the right location on the remote machine, the install bundle includes an <code class="docutils literal notranslate"><span class="pre">install_receptor.yml</span></code> playbook. The playbook requires the Receptor collection which can be obtained via:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ansible-galaxy collection install -r requirements.yml</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Before running the <code class="docutils literal notranslate"><span class="pre">ansible-playbook</span></code> command, edit the following fields in the <code class="docutils literal notranslate"><span class="pre">inventory.yml</span></code> file:</p></li>
</ol>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ansible_user</span></code> with the username running the installation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ansible_ssh_private_key_file</span></code> to contain the filename of the private key used to connect to the instance</p></li>
</ul>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">all</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hosts</span><span class="p">:</span>
<span class="w">    </span><span class="nt">remote-execution</span><span class="p">:</span>
<span class="w">      </span><span class="nt">ansible_host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;hostname&gt;</span>
<span class="w">      </span><span class="nt">ansible_user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;username&gt;</span><span class="w"> </span><span class="c1"># user provided</span>
<span class="w">      </span><span class="nt">ansible_ssh_private_key_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">~/.ssh/id_rsa</span>
</pre></div>
</div>
<p>The content of the <code class="docutils literal notranslate"><span class="pre">inventory.yml</span></code> file serves as a template and contains variables for roles that are applied during the installation and configuration of a receptor node in a mesh topology. You may modify some of the other fields, or replace the file in its entirety for advanced scenarios. Refer to <a class="reference external" href="https://github.com/ansible/receptor-collection/blob/main/README.md">Role Variables</a> for more information on each variable.</p>
<ol class="arabic simple" start="7">
<li><p>Save the file to continue.</p></li>
<li><p>Run the following command on the machine you want to update your mesh:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ansible-playbook -i inventory.yml install_receptor.yml</span>
</pre></div>
</div>
<p>Wait a few minutes for the periodic AWX task to do a health check against the new instance. You may run a health check by selecting the node and clicking the <strong>Run health check</strong> button from its Details page at any time. Once the instances endpoint or page reports a “Ready” status for the instance, jobs are now ready to run on this machine!</p>
<ol class="arabic simple" start="9">
<li><p>To view other instances within the same topology or associate peers, click the <strong>Peers</strong> tab.</p></li>
</ol>
<a class="reference internal image-reference" href="_images/instances_peers_tab.png"><img alt="&quot;Peers&quot; tab showing two peers." src="_images/instances_peers_tab.png" style="width: 1400px;" /></a>
<p>To associate peers with your node, click the <strong>Associate</strong> button to open a dialog box of instances eligible for peering.</p>
<a class="reference internal image-reference" href="_images/instances_associate_peer.png"><img alt="Instances available to peer with the example hop node." src="_images/instances_associate_peer.png" style="width: 1400px;" /></a>
<p>Execution nodes can peer with either hop nodes or other execution nodes. Hop nodes can only peer with execution nodes unless you check the <strong>Peers from control nodes</strong> check box from the <strong>Options</strong> field.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<blockquote>
<div><p>If you associate or disassociate a peer, a notification will inform you to re-run the install bundle from the Peer Detail view (the <a class="reference internal" href="index.html#ag-topology-viewer"><span class="std std-ref">Topology Viewer</span></a> has the download link).</p>
</div></blockquote>
<img alt="Notification to re-run the installation bundle due to change in the peering." src="_images/instances_associate_peer_reinstallmsg.png" />
</div>
<p>You can remove an instance by clicking <strong>Remove</strong> in the Instances page, or by setting the instance <code class="docutils literal notranslate"><span class="pre">node_state</span> <span class="pre">=</span> <span class="pre">deprovisioning</span></code> via the API. Upon deleting, a pop-up message will appear to notify that you may need to re-run the install bundle to make sure things that were removed are no longer connected.</p>
<ol class="arabic simple" start="10">
<li><p>To view a graphical representation of your updated topology, refer to the <a class="reference internal" href="index.html#ag-topology-viewer"><span class="std std-ref">Topology Viewer</span></a> section of this guide.</p></li>
</ol>
</section>
<section id="manage-instances">
<h4><span class="section-number">8.4. </span>Manage instances<a class="headerlink" href="#manage-instances" title="Link to this heading"></a></h4>
<p>Click <strong>Instances</strong> from the left side navigation menu to access the Instances list.</p>
<a class="reference internal image-reference" href="_images/instances_list_view.png"><img alt="List view of instances in AWX" src="_images/instances_list_view.png" style="width: 1400px;" /></a>
<p>The Instances list displays all the current nodes in your topology, along with relevant details:</p>
<ul class="simple">
<li><p><strong>Host Name</strong></p></li>
</ul>
<ul id="node-statuses">
<li><p><strong>Status</strong> indicates the state of the node:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Installed</strong>: a node that has successfully installed and configured, but has not yet passed the periodic health check</p></li>
<li><p><strong>Ready</strong>: a node that is available to run jobs or route traffic between nodes on the mesh. This replaces the previously “Healthy” node state used in the mesh topology</p></li>
<li><p><strong>Provisioning</strong>: a node that is in the process of being added to a current mesh, but is awaiting the job to install all of the packages (currently not yet supported and is subject to change in a future release)</p></li>
<li><p><strong>Deprovisioning</strong>: a node that is in the process of being removed from a current mesh and is finishing up jobs currently running on it</p></li>
<li><p><strong>Unavailable</strong>: a node that did not pass the most recent health check, indicating connectivity or receptor problems</p></li>
<li><p><strong>Provisioning Failure</strong>: a node that failed during provisioning (currently not yet supported and is subject to change in a future release)</p></li>
<li><p><strong>De-provisioning Failure</strong>: a node that failed during deprovisioning (currently not yet supported and is subject to change in a future release)</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>Node Type</strong> specifies whether the node is a control, hop, execution node, or hybrid (not applicable to operator-based installations). See <a class="reference internal" href="index.html#term-Node"><span class="xref std std-term">node</span></a> for further detail.</p></li>
<li><p><strong>Capacity Adjustment</strong> allows you to adjust the number of forks in your nodes</p></li>
<li><p><strong>Used Capacity</strong> indicates how much capacity has been used</p></li>
<li><p><strong>Actions</strong> allow you to enable or disable the instance to control whether jobs can be assigned to it</p></li>
</ul>
<p>From this page, you can add, remove or run health checks on your nodes. Use the check boxes next to an instance to select it to remove or run a health check against. When a button is grayed-out, you do not have permission for that particular action. Contact your Administrator to grant you the required level of access. If you are able to remove an instance, you will receive a prompt for confirmation, like the one below:</p>
<a class="reference internal image-reference" href="_images/instances_delete_prompt.png"><img alt="Prompt for deleting instances in AWX" src="_images/instances_delete_prompt.png" style="width: 1400px;" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can still remove an instance even if it is active and jobs are running on it. AWX will attempt to wait for any jobs running on this node to complete before actually removing it.</p>
</div>
<p>Click <strong>Remove</strong> to confirm.</p>
<p id="health-check">If running a health check on an instance, at the top of the Details page, a message displays that the health check is in progress.</p>
<a class="reference internal image-reference" href="_images/instances_health_check.png"><img alt="Health check for instances in AWX" src="_images/instances_health_check.png" style="width: 1400px;" /></a>
<p>Click <strong>Reload</strong> to refresh the instance status.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<blockquote>
<div><p>Health checks are ran asynchronously, and may take up to a minute for the instance status to update, even with a refresh. The status may or may not change after the health check. At the bottom of the Details page, a timer/clock icon displays next to the last known health check date and time stamp if the health check task is currently running.</p>
</div></blockquote>
<img alt="Health check for instance still in pending state." src="_images/instances_health_check_pending.png" />
</div>
<p>The example health check shows the status updates with an error on node ‘one’:</p>
<a class="reference internal image-reference" href="_images/topology-viewer-instance-with-errors.png"><img alt="Health check showing an error in one of the instances." src="_images/topology-viewer-instance-with-errors.png" style="width: 1400px;" /></a>
</section>
<section id="using-a-custom-receptor-ca">
<h4><span class="section-number">8.5. </span>Using a custom Receptor CA<a class="headerlink" href="#using-a-custom-receptor-ca" title="Link to this heading"></a></h4>
<p>Refer to the AWX Operator Documentation, <a class="reference external" href="https://ansible.readthedocs.io/projects/awx-operator/en/latest/user-guide/advanced-configuration/custom-receptor-certs.html">Custom Receptor CA</a> for detail.</p>
</section>
<section id="using-a-private-image-for-the-default-ee">
<h4><span class="section-number">8.6. </span>Using a private image for the default EE<a class="headerlink" href="#using-a-private-image-for-the-default-ee" title="Link to this heading"></a></h4>
<p>Refer to the AWX Operator Documentation on <a class="reference external" href="https://ansible.readthedocs.io/projects/awx-operator/en/latest/user-guide/advanced-configuration/default-execution-environments-from-private-registries.html">Default execution environments from private registries</a> for detail.</p>
</section>
<section id="troubleshooting">
<h4><span class="section-number">8.7. </span>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Link to this heading"></a></h4>
<p>If you encounter issues while setting up instances, refer to these troubleshooting tips.</p>
<section id="fact-cache-not-working">
<h5><span class="section-number">8.7.1. </span>Fact cache not working<a class="headerlink" href="#fact-cache-not-working" title="Link to this heading"></a></h5>
<p>Make sure the system timezone on the execution node matches <code class="docutils literal notranslate"><span class="pre">settings.TIME_ZONE</span></code> (default is ‘UTC’) on AWX. Fact caching relies on comparing modified times of artifact files, and these modified times are not timezone-aware. Therefore, it is critical that the timezones of the execution nodes match AWX’s timezone setting.</p>
<p>To set the system timezone to UTC:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ln -s /usr/share/zoneinfo/Etc/UTC /etc/localtime</span>
</pre></div>
</div>
</section>
<section id="permission-denied-errors">
<h5><span class="section-number">8.7.2. </span>Permission denied errors<a class="headerlink" href="#permission-denied-errors" title="Link to this heading"></a></h5>
<p>Jobs may fail with the following error, or similar:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="s">&quot;msg&quot;</span><span class="l l-Scalar l-Scalar-Plain">:&quot;exec container process `/usr/local/bin/entrypoint`</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Permission denied&quot;</span>
</pre></div>
</div>
<p>For RHEL-based machines, this could be due to SELinux that is enabled on the system. You can pass these <code class="docutils literal notranslate"><span class="pre">extra_settings</span></code> container options to override SELinux protections:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">DEFAULT_CONTAINER_RUN_OPTIONS = [&#39;--network&#39;, &#39;slirp4netns:enable_ipv6=true&#39;, &#39;--security-opt&#39;, &#39;label=disable&#39;]</span>
</pre></div>
</div>
</section>
</section>
</section>
<span id="document-administration/topology_viewer"></span><section id="topology-viewer">
<span id="ag-topology-viewer"></span><h3><span class="section-number">9. </span>Topology Viewer<a class="headerlink" href="#topology-viewer" title="Link to this heading"></a></h3>
<p id="index-0">The topology viewer allows you to view node type, node health, and specific details about each node if you already have a mesh topology deployed. In order to access the topology viewer from the AWX user interface, you must have System Administrator or System Auditor permissions.</p>
<p>To access the topology viewer from the AWX user interface:</p>
<ol class="arabic simple">
<li><p>In the Administration menu from left navigation bar, click <strong>Topology View</strong>.</p></li>
</ol>
<p>The Topology View opens and displays a graphic representation of how each receptor node links together.</p>
<img alt="_images/topology-viewer-initial-view.png" src="_images/topology-viewer-initial-view.png" />
<ol class="arabic simple" start="2">
<li><p>To adjust the zoom levels, refresh the current view, or manipulate the graphic views, use the control buttons on the upper right-hand corner of the window.</p></li>
</ol>
<img alt="_images/topology-viewer-view-controls.png" src="_images/topology-viewer-view-controls.png" />
<p>You can also click and drag to pan around; and use the scroll wheel on your mouse or trackpad to zoom. The fit-to-screen feature automatically scales the graphic to fit on the screen and repositions it in the center. It is particularly useful when you want to see a large mesh in its entirety.</p>
<img alt="_images/topology-viewer-zoomed-view.png" src="_images/topology-viewer-zoomed-view.png" />
<p>To reset the view to its default view, click <strong>Reset zoom</strong>.</p>
<ol class="arabic simple" start="3">
<li><p>Refer to the Legend to the left of the graphic to identify the type of nodes that are represented.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the Legend is not present, use the toggle on the upper right corner of the window to enable it.</p>
</div>
<p>The Legend shows the <a class="reference internal" href="index.html#node-statuses"><span class="std std-ref">node status</span></a> by color, which is indicative of the health of the node. The status of <strong>Error</strong> in the legend encompasses the <strong>Unavailable</strong> state (as displayed in the Instances list view) plus any future error conditions encountered in later versions of AWX. Also depicted in the legend are the link statuses:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Established</strong>: this is a link state that indicates a peer connection between nodes that are either ready, unavailable, or disabled</p></li>
<li><p><strong>Adding</strong>: this is a link state indicating a peer connection between nodes that was selected to be added to the mesh topology</p></li>
<li><p><strong>Removing</strong>: this is a link state indicating a peer connection between nodes that was selected to be removed from the topology</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Hover over a node and the connectors highlight to show its immediate connected nodes (peers) or click on a node to retrieve details about it, such as its hostname, node type, and status.</p></li>
</ol>
<img alt="_images/topology-viewer-node-hover-click.png" src="_images/topology-viewer-node-hover-click.png" />
<ol class="arabic simple" start="5">
<li><p>Click on the link for instance hostname from the details displayed, and you will be redirected to its Details page that provides more information about that node, most notably for information about an <code class="docutils literal notranslate"><span class="pre">Error</span></code> status, as in the example below.</p></li>
</ol>
<img alt="_images/topology-viewer-node-view.png" src="_images/topology-viewer-node-view.png" />
<img alt="_images/topology-viewer-instance-details.png" src="_images/topology-viewer-instance-details.png" />
<p>At the bottom of the Details view, you can remove the instance, run a health check on the instance on an as-needed basis, or unassign jobs from the instance. By default, jobs can be assigned to each node. However, you can disable it to exclude the node from having any jobs running on it.</p>
<p>For more information on creating new nodes and scaling the mesh, refer to <a class="reference internal" href="index.html#ag-instances"><span class="std std-ref">Managing Capacity With Instances</span></a> in this guide for more detail.</p>
</section>
<span id="document-administration/logfiles"></span><section id="awx-logfiles">
<h3><span class="section-number">10. </span>AWX Logfiles<a class="headerlink" href="#awx-logfiles" title="Link to this heading"></a></h3>
<p id="index-0">The AWX logfiles are streamed real-time on the console.</p>
</section>
<span id="document-administration/logging"></span><section id="logging-and-aggregation">
<span id="ag-logging"></span><h3><span class="section-number">11. </span>Logging and Aggregation<a class="headerlink" href="#logging-and-aggregation" title="Link to this heading"></a></h3>
<p id="index-0">Logging is a feature that provides the capability to send detailed logs to several kinds of 3rd party external log aggregation services. Services connected to this data feed serve as a useful means in gaining insight into AWX usage or technical trends. The data can be used to analyze events in the infrastructure, monitor for anomalies, and correlate events from one service with events in another. The types of data that are most useful to AWX are job fact data, job events/job runs, activity stream data, and log messages. The data is sent in JSON format over a HTTP connection using minimal service-specific tweaks engineered in a custom handler or via an imported library.</p>
<p>Installing AWX will install a newer version of rsyslog, which will replace the version that comes with the RHEL base. The version of rsyslog that is installed by AWX does not include the following rsyslog modules:</p>
<ul class="simple">
<li><p>rsyslog-udpspoof.x86_64</p></li>
<li><p>rsyslog-libdbi.x86_64</p></li>
</ul>
<p>After installing AWX, use only AWX provided rsyslog package for any logging outside of AWX that may have previously been done with the RHEL provided rsyslog package. If you already use rsyslog for logging system logs on AWX instances, you can continue to use rsyslog to handle logs from outside of AWX by running a separate rsyslog process (using the same version of rsyslog that AWX is), and pointing it to a separate /etc/rsyslog.conf.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For systems that use rsyslog outside of AWX, consider any conflict that may arise with also using new version of rsyslog that comes with AWX.</p>
</div>
<p>You can configure from the <code class="docutils literal notranslate"><span class="pre">/api/v2/settings/logging/</span></code> endpoint how AWX rsyslog process handles messages that have not yet been sent in the event that your external logger goes offline:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">LOG_AGGREGATOR_MAX_DISK_USAGE_GB</span></code>: specifies the amount of data to store (in gigabytes) during an outage of the external log aggregator (defaults to 1). Equivalent to the <code class="docutils literal notranslate"><span class="pre">rsyslogd</span> <span class="pre">queue.maxdiskspace</span></code> setting.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LOG_AGGREGATOR_MAX_DISK_USAGE_PATH</span></code>: specifies the location to persist logs that should be retried after an outage of the external log aggregator (defaults to <code class="docutils literal notranslate"><span class="pre">/var/lib/awx</span></code>). Equivalent to the <code class="docutils literal notranslate"><span class="pre">rsyslogd</span> <span class="pre">queue.spoolDirectory</span></code> setting.</p></li>
</ul>
<p>For example, if Splunk goes offline, rsyslogd stores a queue on the disk until Splunk comes back online. By default, it will store up to 1GB of events (while Splunk is offline) but you can make that more than 1GB if necessary, or change the path where you save the queue.</p>
<section id="loggers">
<h4><span class="section-number">11.1. </span>Loggers<a class="headerlink" href="#loggers" title="Link to this heading"></a></h4>
<p>Below are special loggers (except for <code class="docutils literal notranslate"><span class="pre">awx</span></code>, which constitutes generic server logs) that provide large amount of information in a predictable structured or semi-structured format, following the same structure as one would expect if obtaining the data from the API:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">job_events</span></code>: Provides data returned from the Ansible callback module</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">activity_stream</span></code>: Displays the record of changes to the objects within the AWX application</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">system_tracking</span></code>: Provides fact data gathered by Ansible <code class="docutils literal notranslate"><span class="pre">setup</span></code> module (i.e. <code class="docutils literal notranslate"><span class="pre">gather_facts:</span> <span class="pre">True</span></code>) when job templates are ran with <strong>Enable Fact Cache</strong> selected</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">awx</span></code>: Provides generic server logs, which include logs that would normally be written to a file. It contains the standard metadata that all logs have, except it only has the message from the log statement.</p></li>
</ul>
<p>These loggers only use log-level of INFO, except for the <code class="docutils literal notranslate"><span class="pre">awx</span></code> logger, which may be any given level.</p>
<p>Additionally, the standard AWX logs are be deliverable through this same mechanism. It is apparent how to enable or disable each of these five sources of data without manipulating a complex dictionary in your local settings file, as well as adjust the log-level consumed from the standard AWX logs.</p>
<p>To configure various logging components in AWX, click <strong>Settings</strong> from the left navigation bar then select <strong>Logging settings</strong> from the list of System options.</p>
<section id="log-message-schema">
<h5><span class="section-number">11.1.1. </span>Log message schema<a class="headerlink" href="#log-message-schema" title="Link to this heading"></a></h5>
<p>Common schema for all loggers:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cluster_host_id</span></code>: Unique identifier of the host within the AWX cluster</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">level</span></code>: Standard python log level, roughly reflecting the significance of the event All of the data loggers as a part of this feature use INFO level, but the other AWX logs will use different levels as appropriate</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">logger_name</span></code>: Name of the logger we use in the settings, for example, “activity_stream”</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&#64;timestamp</span></code>: Time of log</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code>: File path in code where the log was generated</p></li>
</ul>
</section>
<section id="activity-stream-schema">
<h5><span class="section-number">11.1.2. </span>Activity stream schema<a class="headerlink" href="#activity-stream-schema" title="Link to this heading"></a></h5>
<ul class="simple">
<li><p>(common): This uses all the fields common to all loggers listed above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">actor</span></code>: Username of the user who took the action documented in the log</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">changes</span></code>: JSON summary of what fields changed, and their old/new values.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">operation</span></code>: The basic category of the changed logged in the activity stream, for instance, “associate”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">object1</span></code>: Information about the primary object being operated on, consistent with what we show in the activity stream</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">object2</span></code>: If applicable, the second object involved in the action</p></li>
</ul>
</section>
<section id="job-event-schema">
<h5><span class="section-number">11.1.3. </span>Job event schema<a class="headerlink" href="#job-event-schema" title="Link to this heading"></a></h5>
<p>This logger reflects the data being saved into job events, except when they would otherwise conflict with expected standard fields from the logger, in which case the fields are nested. Notably, the field host on the <code class="docutils literal notranslate"><span class="pre">job_event</span></code> model is given as <code class="docutils literal notranslate"><span class="pre">event_host</span></code>. There is also a sub-dictionary field, <code class="docutils literal notranslate"><span class="pre">event_data</span></code> within the payload, which contains different fields depending on the specifics of the Ansible event.</p>
<p>This logger also includes the common fields.</p>
</section>
<section id="scan-fact-system-tracking-data-schema">
<h5><span class="section-number">11.1.4. </span>Scan / fact / system tracking data schema<a class="headerlink" href="#scan-fact-system-tracking-data-schema" title="Link to this heading"></a></h5>
<p>These contain a detailed dictionary-type fields that are either services, packages, or files.</p>
<ul class="simple">
<li><p>(common): This uses all the fields common to all loggers listed above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">services</span></code>: For services scans, this field is included and has keys based on the name of the service. <strong>NOTE</strong>: Periods are disallowed by elastic search in names, and are replaced with “_” by our log formatter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">package</span></code>: Included for log messages from package scans</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">files</span></code>: Included for log messages from file scans</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">host</span></code>: Name of host scan applies to</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inventory_id</span></code>: Inventory id host is inside of</p></li>
</ul>
</section>
<section id="job-status-changes">
<h5><span class="section-number">11.1.5. </span>Job status changes<a class="headerlink" href="#job-status-changes" title="Link to this heading"></a></h5>
<p>This is a intended to be a lower-volume source of information about changes in job states compared to job events, and also intended to capture changes to types of unified jobs other than job template based jobs.</p>
<p>In addition to common fields, these logs include fields present on the job model.</p>
</section>
<section id="awx-logs">
<h5><span class="section-number">11.1.6. </span>AWX logs<a class="headerlink" href="#awx-logs" title="Link to this heading"></a></h5>
<p>In addition to the common fields, this contains a <code class="docutils literal notranslate"><span class="pre">msg</span></code> field with the log message. Errors contain a separate <code class="docutils literal notranslate"><span class="pre">traceback</span></code> field. These logs can be enabled or disabled with the <code class="docutils literal notranslate"><span class="pre">ENABLE</span> <span class="pre">EXTERNAL</span> <span class="pre">LOGGING</span></code> option from the Logging settings page.</p>
</section>
<section id="logging-aggregator-services">
<h5><span class="section-number">11.1.7. </span>Logging Aggregator Services<a class="headerlink" href="#logging-aggregator-services" title="Link to this heading"></a></h5>
<p>The logging aggregator service works with the following monitoring and data analysis systems:</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#logstash" id="id1">Logstash</a></p></li>
<li><p><a class="reference internal" href="#splunk" id="id2">Splunk</a></p></li>
<li><p><a class="reference internal" href="#loggly" id="id3">Loggly</a></p></li>
<li><p><a class="reference internal" href="#sumologic" id="id4">Sumologic</a></p></li>
<li><p><a class="reference internal" href="#elastic-stack-formerly-elk-stack" id="id5">Elastic stack (formerly ELK stack)</a></p></li>
</ul>
</nav>
<section id="logstash">
<h6><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">11.1.7.1. </span>Logstash</a><a class="headerlink" href="#logstash" title="Link to this heading"></a></h6>
<p>These instructions describe how to use the logstash container.</p>
<ol class="arabic simple">
<li><p>Uncomment the following lines in the <code class="docutils literal notranslate"><span class="pre">docker-compose.yml</span></code> file:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="c1">#- logstash</span>
<span class="nn">...</span>

<span class="c1">#logstash:</span>
<span class="c1">#  build:</span>
<span class="c1">#    context: ./docker-compose</span>
<span class="c1">#    dockerfile: Dockerfile-logstash</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>POST the following content to 1`/api/v2/settings/logging/1` (this uses authentication set up inside of the logstash configuration file).</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w">    </span><span class="s">&quot;LOG_AGGREGATOR_HOST&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;http://logstash&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;LOG_AGGREGATOR_PORT&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">8085</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;LOG_AGGREGATOR_TYPE&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;logstash&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;LOG_AGGREGATOR_USERNAME&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;awx_logger&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;LOG_AGGREGATOR_PASSWORD&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;workflows&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;LOG_AGGREGATOR_LOGGERS&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">        </span><span class="s">&quot;awx&quot;</span><span class="p p-Indicator">,</span>
<span class="w">        </span><span class="s">&quot;activity_stream&quot;</span><span class="p p-Indicator">,</span>
<span class="w">        </span><span class="s">&quot;job_events&quot;</span><span class="p p-Indicator">,</span>
<span class="w">        </span><span class="s">&quot;system_tracking&quot;</span>
<span class="w">    </span><span class="p p-Indicator">],</span>
<span class="w">    </span><span class="s">&quot;LOG_AGGREGATOR_INDIVIDUAL_FACTS&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;LOG_AGGREGATOR_TOWER_UUID&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;991ac7e9-6d68-48c8-bbde-7ca1096653c6&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;LOG_AGGREGATOR_ENABLED&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>HTTP must be specified in the <code class="docutils literal notranslate"><span class="pre">LOG_AGGREGATOR_HOST</span></code> if you are using the docker development environment.</p>
</div>
<ol class="arabic simple" start="3">
<li><p>To view the most recent logs from the container:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">docker exec -i -t $(docker ps -aqf &quot;name=tools_logstash_1&quot;) tail -n 50 /logstash.log</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>To add logstash plugins, you can add any plugins you need in <code class="docutils literal notranslate"><span class="pre">tools/elastic/logstash/Dockerfile</span></code> before running the container.</p></li>
</ol>
</section>
<section id="splunk">
<h6><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">11.1.7.2. </span>Splunk</a><a class="headerlink" href="#splunk" title="Link to this heading"></a></h6>
<p>AWX’s Splunk logging integration uses the Splunk HTTP Collector. When configuring a SPLUNK logging aggregator, add the full URL to the HTTP Event Collector host, like in the following example:</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>https://example.com/api/v2/settings/logging

{
    &quot;LOG_AGGREGATOR_HOST&quot;: &quot;https://splunk_host:8088/services/collector/event&quot;,
    &quot;LOG_AGGREGATOR_PORT&quot;: null,
    &quot;LOG_AGGREGATOR_TYPE&quot;: &quot;splunk&quot;,
    &quot;LOG_AGGREGATOR_USERNAME&quot;: &quot;&quot;,
    &quot;LOG_AGGREGATOR_PASSWORD&quot;: &quot;$encrypted$&quot;,
    &quot;LOG_AGGREGATOR_LOGGERS&quot;: [
        &quot;awx&quot;,
        &quot;activity_stream&quot;,
        &quot;job_events&quot;,
        &quot;system_tracking&quot;
    ],
    &quot;LOG_AGGREGATOR_INDIVIDUAL_FACTS&quot;: false,
    &quot;LOG_AGGREGATOR_ENABLED&quot;: true,
    &quot;LOG_AGGREGATOR_TOWER_UUID&quot;: &quot;&quot;
}
</pre></div>
</div>
</div></blockquote>
<p>Splunk HTTP Event Collector listens on 8088 by default so it is necessary to provide the full HEC event URL (with port) in order for incoming requests to be processed successfully. These values are entered in the example below:</p>
<img alt="_images/logging-splunk-awx-example.png" src="_images/logging-splunk-awx-example.png" />
<p>For further instructions on configuring the HTTP Event Collector, refer to the <a class="reference external" href="http://docs.splunk.com/Documentation/Splunk/latest/Data/UsetheHTTPEventCollector">Splunk documentation</a>.</p>
<blockquote>
<div></div></blockquote>
</section>
<section id="loggly">
<h6><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">11.1.7.3. </span>Loggly</a><a class="headerlink" href="#loggly" title="Link to this heading"></a></h6>
<p>To set up the sending of logs through Loggly’s HTTP endpoint, refer to <a class="reference external" href="https://www.loggly.com/docs/http-endpoint/">https://www.loggly.com/docs/http-endpoint/</a>. Loggly uses the URL convention described at <a class="reference external" href="http://logs-01.loggly.com/inputs/TOKEN/tag/http/">http://logs-01.loggly.com/inputs/TOKEN/tag/http/</a>, which is shown inputted in the <strong>Logging Aggregator</strong> field in the example below:</p>
<img alt="_images/logging-loggly-awx-example.png" src="_images/logging-loggly-awx-example.png" />
</section>
<section id="sumologic">
<h6><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">11.1.7.4. </span>Sumologic</a><a class="headerlink" href="#sumologic" title="Link to this heading"></a></h6>
<p>In Sumologic, create a search criteria containing the json files that provide the parameters used to collect the data you need.</p>
<img alt="_images/logging_sumologic_main.png" src="_images/logging_sumologic_main.png" />
</section>
<section id="elastic-stack-formerly-elk-stack">
<h6><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">11.1.7.5. </span>Elastic stack (formerly ELK stack)</a><a class="headerlink" href="#elastic-stack-formerly-elk-stack" title="Link to this heading"></a></h6>
<p>If starting from scratch, standing up your own version the elastic stack, the only change you required is to add the following lines to the logstash <code class="docutils literal notranslate"><span class="pre">logstash.conf</span></code> file:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">filter {</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">json {</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">source =&gt; &quot;message&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">}</span>
<span class="l l-Scalar l-Scalar-Plain">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Backward-incompatible changes were introduced with Elastic 5.0.0, and different configurations may be required depending on what versions you are using.</p>
</div>
</section>
</section>
</section>
<section id="set-up-logging">
<span id="ag-ctit-logging"></span><h4><span class="section-number">11.2. </span>Set Up Logging<a class="headerlink" href="#set-up-logging" title="Link to this heading"></a></h4>
<section id="log-aggregation">
<h5><span class="section-number">11.2.1. </span>Log Aggregation<a class="headerlink" href="#log-aggregation" title="Link to this heading"></a></h5>
<p>To set up logging to any of the aggregator types:</p>
<ol class="arabic simple">
<li><p>Click <strong>Settings</strong> from the left navigation bar.</p></li>
<li><p>Under the list of System options, click to select <strong>Logging settings</strong>.</p></li>
<li><p>At the bottom of the Logging settings screen, click <strong>Edit</strong>.</p></li>
<li><p>Set the configurable options from the fields provided:</p></li>
</ol>
<ul class="simple">
<li><p><strong>Enable External Logging</strong>: Click the toggle button to <strong>ON</strong> if you want to send logs to an external log aggregator.</p></li>
<li><p><strong>Logging Aggregator</strong>: Enter the hostname or IP address you want to send logs.</p></li>
<li><p><strong>Logging Aggregator Port</strong>: Specify the port for the aggregator if it requires one.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the connection type is HTTPS, you can enter the hostname as a URL with a port number and therefore, you are not required to enter the port again. But TCP and UDP connections are determined by the hostname and port number combination, rather than URL. So in the case of TCP/UDP connection, supply the port in the specified field. If instead a URL is entered in host field (<strong>Logging Aggregator</strong> field), its hostname portion will be extracted as the actual hostname.</p>
</div>
<ul class="simple">
<li><p><strong>Logging Aggregator Type</strong>: Click to select the aggregator service from the drop-down menu:</p></li>
</ul>
<img alt="_images/configure-awx-system-logging-types.png" src="_images/configure-awx-system-logging-types.png" />
<ul class="simple">
<li><p><strong>Logging Aggregator Username</strong>: Enter the username of the logging aggregator if it requires it.</p></li>
<li><p><strong>Logging Aggregator Password/Token</strong>: Enter the password of the logging aggregator if it requires it.</p></li>
<li><p><strong>Log System Tracking Facts Individually</strong>: Click the tooltip <img alt="help" src="_images/tooltips-icon.png" /> icon for additional information whether or not you want to turn it on, or leave it off by default.</p></li>
<li><p><strong>Logging Aggregator Protocol</strong>: Click to select a connection type (protocol) to communicate with the log aggregator. Subsequent options vary depending on the selected protocol.</p></li>
<li><p><strong>Logging Aggregator Level Threshold</strong>: Select the level of severity you want the log handler to report.</p></li>
<li><p><strong>TCP Connection Timeout</strong>: Specify the connection timeout in seconds. This option is only applicable to HTTPS and TCP log aggregator protocols.</p></li>
<li><p><strong>Enable/disable HTTPS certificate verification</strong>: Certificate verification is enabled by default for HTTPS log protocol. Click the toggle button to <strong>OFF</strong> if you do not want the log handler to verify the HTTPS certificate sent by the external log aggregator before establishing a connection.</p></li>
<li><p><strong>Loggers to Send Data to the Log Aggregator Form</strong>: All four types of data are pre-populated by default. Click the tooltip <img alt="help" src="_images/tooltips-icon.png" /> icon next to the field for additional information on each data type. Delete the data types you do not want.</p></li>
<li><p><strong>Log Format For API 4XX Errors</strong>: Configure a specific error message. See <a class="reference internal" href="#logging-api-400-error-config"><span class="std std-ref">API 4XX Error Configuration</span></a> for further detail.</p></li>
</ul>
<ol class="arabic simple" start="5">
<li><p>Review your entries for your chosen logging aggregation. Below is an example of one set up for Splunk:</p></li>
</ol>
<img alt="_images/configure-awx-system-logging-splunk-example.png" src="_images/configure-awx-system-logging-splunk-example.png" />
<ol class="arabic simple" start="7">
<li><p>When done, click <strong>Save</strong> to apply the settings or <strong>Cancel</strong> to abandon the changes.</p></li>
<li><p>To verify if your configuration is set up correctly, click <strong>Save</strong> first then click <strong>Test</strong>. This sends a test log message to the log aggregator using the current logging configuration in AWX. You should check to make sure this test message was received by your external log aggregator.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the <strong>Test</strong> button is disabled, it is an indication that the fields are different than their initial values so save your changes first, and make sure the <strong>Enable External Logging</strong> toggle is set to ON.</p>
</div>
</section>
<section id="api-4xx-error-configuration">
<span id="logging-api-400-error-config"></span><h5><span class="section-number">11.2.2. </span>API 4XX Error Configuration<a class="headerlink" href="#api-4xx-error-configuration" title="Link to this heading"></a></h5>
<p>When the API encounters an issue with a request, it will typically return an HTTP error code in the 400 range along with an error. When this happens, an error message will be generated in the log which follows the pattern:</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">status</span> <span class="pre">{status_code}</span> <span class="pre">received</span> <span class="pre">by</span> <span class="pre">user</span> <span class="pre">{user_name}</span> <span class="pre">attempting</span> <span class="pre">to</span> <span class="pre">access</span> <span class="pre">{url_path}</span> <span class="pre">from</span> <span class="pre">{remote_addr}</span>
<span class="pre">`</span></code></p>
<p>These messages can be configured as required. To modify the default API 4XX errors log message format, do the following:</p>
<ol class="arabic simple">
<li><p>Click <strong>Settings</strong> from the left navigation bar.</p></li>
<li><p>Under the list of System options, click to select <strong>Logging settings</strong>.</p></li>
<li><p>At the bottom of the Logging settings screen, click <strong>Edit</strong>.</p></li>
<li><p>Modify the field <strong>Log Format For API 4XX Errors</strong>.</p></li>
</ol>
<p>Items surrounded by <code class="docutils literal notranslate"><span class="pre">{}</span></code> will be substituted when the log error is generated. The following variables can be used:</p>
<ul class="simple">
<li><p><strong>status_code</strong>: The HTTP status code the API is returning</p></li>
<li><p><strong>user_name</strong>: The name of the user that was authenticated when making the API request</p></li>
<li><p><strong>url_path</strong>: The path portion of the URL being called (aka the API endpoint)</p></li>
<li><p><strong>remote_addr</strong>: The remote address received by AWX</p></li>
<li><p><strong>error</strong>: The error message returned by the API or, if no error is specified, the HTTP status as text</p></li>
</ul>
</section>
</section>
<section id="troubleshoot-logging">
<h4><span class="section-number">11.3. </span>Troubleshoot Logging<a class="headerlink" href="#troubleshoot-logging" title="Link to this heading"></a></h4>
<section id="api-4xx-errors">
<h5><span class="section-number">11.3.1. </span>API 4XX Errors<a class="headerlink" href="#api-4xx-errors" title="Link to this heading"></a></h5>
<p>You can include the API error message for 4XX errors by modifying the log format for those messages. Refer to the <a class="reference internal" href="#logging-api-400-error-config"><span class="std std-ref">API 4XX Error Configuration</span></a> section for more detail.</p>
</section>
<section id="ldap">
<h5><span class="section-number">11.3.2. </span>LDAP<a class="headerlink" href="#ldap" title="Link to this heading"></a></h5>
<p>You can enable logging messages for the LDAP adapter. Refer to the <a class="reference internal" href="index.html#ldap-logging"><span class="std std-ref">Enabling Logging for LDAP</span></a> section for more detail.</p>
</section>
<section id="saml">
<h5><span class="section-number">11.3.3. </span>SAML<a class="headerlink" href="#saml" title="Link to this heading"></a></h5>
<p>You can enable logging messages for the SAML adapter the same way you can enable logging for LDAP. Refer to the <a class="reference internal" href="index.html#ldap-logging"><span class="std std-ref">Enabling Logging for LDAP</span></a> section for more detail.</p>
</section>
</section>
</section>
<span id="document-administration/metrics"></span><section id="metrics">
<span id="ag-metrics"></span><h3><span class="section-number">12. </span>Metrics<a class="headerlink" href="#metrics" title="Link to this heading"></a></h3>
<p id="index-0">A metrics endpoint is available in the API: <code class="docutils literal notranslate"><span class="pre">/api/v2/metrics/</span></code> that surfaces instantaneous metrics about AWX, which can be consumed by system monitoring software like the open source project Prometheus.</p>
<p>The type of data shown at the <code class="docutils literal notranslate"><span class="pre">metrics/</span></code> endpoint is <code class="docutils literal notranslate"><span class="pre">Content-type:</span> <span class="pre">text/plain</span></code> and <code class="docutils literal notranslate"><span class="pre">application/json</span></code> as well. This endpoint contains useful information, such as counts of how many active user sessions there are, or how many jobs are actively running on each AWX node. Prometheus can be configured to scrape these metrics from AWX by hitting AWX metrics endpoint and storing this data in a time-series database. Clients can later use Prometheus in conjunction with other software like Grafana or Metricsbeat to visualize that data and set up alerts.</p>
<section id="set-up-prometheus">
<h4><span class="section-number">12.1. </span>Set up Prometheus<a class="headerlink" href="#set-up-prometheus" title="Link to this heading"></a></h4>
<p>To set up and use Prometheus, you will need to install Prometheus on a virtual machine or container. Refer to the <a class="reference external" href="https://prometheus.io/docs/introduction/first_steps/">Prometheus documentation</a> for further detail.</p>
<ol class="arabic">
<li><p>In the Prometheus config file (typically <code class="docutils literal notranslate"><span class="pre">prometheus.yml</span></code>), specify a <code class="docutils literal notranslate"><span class="pre">&lt;token_value&gt;</span></code>, a valid user/password for an AWX user you have created, and a <code class="docutils literal notranslate"><span class="pre">&lt;awx_host&gt;</span></code>.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Alternatively, you can provide an OAuth2 token (which can be generated at <code class="docutils literal notranslate"><span class="pre">/api/v2/users/N/personal_tokens/</span></code>). By default, the config assumes a user with username=admin and password=password.</p>
</div>
</div></blockquote>
</li>
</ol>
<blockquote>
<div><p>Using an OAuth2 Token, created at the <code class="docutils literal notranslate"><span class="pre">/api/v2/tokens</span></code> endpoint to authenticate prometheus with AWX, the following example provides a valid scrape config if the URL for your AWX’s metrics endpoint was <code class="docutils literal notranslate"><span class="pre">https://awx_host:443/metrics</span></code>.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">scrape_configs</span>

<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">- job_name</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;awx&#39;</span>
<span class="w">    </span><span class="nt">tls_config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">insecure_skip_verify</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">    </span><span class="nt">metrics_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/api/v2/metrics</span>
<span class="w">    </span><span class="nt">scrape_interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5s</span>
<span class="w">    </span><span class="nt">scheme</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https</span>
<span class="w">    </span><span class="nt">bearer_token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;token_value&gt;</span>
<span class="w">    </span><span class="c1"># basic_auth:</span>
<span class="w">    </span><span class="c1">#   username: admin</span>
<span class="w">    </span><span class="c1">#   password: password</span>
<span class="w">    </span><span class="nt">static_configs</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">targets</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;awx_host&gt;</span>
</pre></div>
</div>
<p>For help configuring other aspects of Prometheus, such as alerts and service discovery configurations, refer to the <a class="reference external" href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/">Prometheus configuration docs</a>.</p>
<blockquote>
<div></div></blockquote>
<p>If Prometheus is already running, you must restart it in order to apply the configuration changes by making a <strong>POST</strong> to the reload endpoint, or by killing the Prometheus process or service.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Use a browser to navigate to your graph in the Prometheus UI at <code class="docutils literal notranslate"><span class="pre">http://your_prometheus:9090/graph</span></code> and test out some queries. For example, you can query the current number of active AWX user sessions by executing: <code class="docutils literal notranslate"><span class="pre">awx_sessions_total{type=&quot;user&quot;}</span></code>.</p></li>
</ol>
<img alt="_images/metrics-prometheus-ui-query-example.png" src="_images/metrics-prometheus-ui-query-example.png" />
<p>Refer to the metrics endpoint in AWX API for your instance (<code class="docutils literal notranslate"><span class="pre">api/v2/metrics</span></code>) for more ways to query.</p>
</section>
</section>
<span id="document-administration/performance"></span><section id="improving-awx-performance">
<span id="ag-performance"></span><h3><span class="section-number">13. </span>Improving AWX Performance<a class="headerlink" href="#improving-awx-performance" title="Link to this heading"></a></h3>
<p id="index-0">This section aims to provide the guidelines for tuning AWX for performance and scalability.</p>
<section id="performance-improvements">
<span id="ag-performance-improvements"></span><h4><span class="section-number">13.1. </span>Performance improvements<a class="headerlink" href="#performance-improvements" title="Link to this heading"></a></h4>
<p id="index-1">AWX brings multiple improvements that support large scale deployments of AWX. Major gains have been made to support workloads with many more concurrent jobs. In the past, there were issues with excessive database connections, job scheduling issues when there were thousands of pending and running jobs, and issues with successfully starting jobs when operating near 100% capacity of control nodes.</p>
<p>Additionally, changes have been made by default to take advantage of CPU capacity available on larger control nodes. This means customers who provision larger control nodes and want to run thousands of concurrent jobs have multiple improvements to look forward to in this release:</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#vertical-scaling-improvements" id="id1">Vertical scaling improvements</a></p></li>
<li><p><a class="reference internal" href="#job-scheduling-improvements" id="id2">Job scheduling improvements</a></p></li>
<li><p><a class="reference internal" href="#database-resource-usage-improvements" id="id3">Database resource usage improvements</a></p></li>
<li><p><a class="reference internal" href="#stability-improvements" id="id4">Stability improvements</a></p></li>
<li><p><a class="reference internal" href="#metrics-enhancements" id="id5">Metrics enhancements</a></p></li>
<li><p><a class="reference internal" href="#ldap-login-and-basic-authentication" id="id6">LDAP login and basic authentication</a></p></li>
</ul>
</nav>
<section id="vertical-scaling-improvements">
<h5><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">13.1.1. </span>Vertical scaling improvements</a><a class="headerlink" href="#vertical-scaling-improvements" title="Link to this heading"></a></h5>
<p id="index-2">Control nodes are responsible for processing the output of jobs and writing them to the database. The process that does this is called the callback receiver. The callback receiver has a configurable number of workers, controlled by the setting <code class="docutils literal notranslate"><span class="pre">JOB_EVENT_WORKERS</span></code>. In the past, the default for this setting was always 4, regardless of the CPU or memory capacity of the node. Now, in traditional virtual machines, the <code class="docutils literal notranslate"><span class="pre">JOB_EVENT_WORKERS</span></code> will be set to the same as the number of CPU if that is greater than 4. This means administrators that provision larger control nodes will see greater ability for those nodes to keep up with the job output created by jobs without having to manually adjust <code class="docutils literal notranslate"><span class="pre">JOB_EVENT_WORKERS</span></code>.</p>
</section>
<section id="job-scheduling-improvements">
<h5><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">13.1.2. </span>Job scheduling improvements</a><a class="headerlink" href="#job-scheduling-improvements" title="Link to this heading"></a></h5>
<p id="index-3">When jobs are created either via a schedule, a workflow, the UI or the API, they are first created in Pending state. To determine when and where to run this job, a background task called the Task Manager collects all pending and running jobs and determines where capacity is available to run the job. In previous versions of AWX, scheduling slowed as the number of pending and running jobs increased, and the Task Manager was vulnerable to timing out without having made any progress. The scenario exhibits symptoms of having thousands of pending jobs, available capacity, but no jobs starting.</p>
<p>Optimizations in the job scheduler have made scheduling faster, as well as safeguards to better ensure the scheduler commits its progress even if it is nearing time out. Additionally, work that previously occurred in the Task Manager that blocked its progress has been decoupled into separate, non-blocking work units executed by the Dispatcher.</p>
</section>
<section id="database-resource-usage-improvements">
<h5><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">13.1.3. </span>Database resource usage improvements</a><a class="headerlink" href="#database-resource-usage-improvements" title="Link to this heading"></a></h5>
<p id="index-4">The use of database connections by running jobs has dramatically decreased, which removes a previous limit to concurrent running jobs, as well reduces pressure on memory consumption of PostgreSQL.</p>
<p>Each job in AWX has a worker process, called the dispatch worker, on the control node that started the process, which submits the work to the execution node via the Receptor, as well as consumes the output of the job and puts it in the Redis queue for the callback receiver to serialize the output and write it to the database as job events.</p>
<p>The dispatch worker is also responsible for noticing if the job has been canceled by the user in order to then cancel the receptor work unit. In the past, the worker maintained multiple open database connections per job. This caused two main problems:</p>
<ul class="simple">
<li><p>The application would begin to experience errors attempting to open new database connections (for API calls or other essential processes) when there were more than 350 jobs running concurrently, unless users increased the maximum number of connections.</p></li>
<li><p>Even idle connections consume memory. For example, in experiments done by AWS, idle connections to PostgreSQL were shown to consume at least 1.5 MB of memory. So if an AWX administrator wanted to support running 2,000 concurrent jobs, this could result in 9GB of memory consumed on PostgreSQL from just idle connections alone.</p></li>
</ul>
<p>The dispatch process closes database connections once the job has started. This means now the number of concurrent running jobs is no longer limited by the maximum number of database connections, and the risk of over-consuming memory on PostgreSQL is greatly reduced.</p>
</section>
<section id="stability-improvements">
<h5><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">13.1.4. </span>Stability improvements</a><a class="headerlink" href="#stability-improvements" title="Link to this heading"></a></h5>
<p id="index-5">Notable stability improvements in this release:</p>
<ul class="simple">
<li><p><strong>Improvements to job reaping</strong> - Fixed root cause of jobs in waiting getting reaped before the job ever started, which often occurred when running near 100% capacity on control and hybrid nodes.</p></li>
<li><p><strong>Improvements in stability for Operator-based deployments</strong> - Resolved issues with multiple control pod deployments erroneously marking each other as offline. Now scaling operator-based deployments horizontally is more stable.</p></li>
</ul>
</section>
<section id="metrics-enhancements">
<h5><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">13.1.5. </span>Metrics enhancements</a><a class="headerlink" href="#metrics-enhancements" title="Link to this heading"></a></h5>
<p id="index-6">Metrics added in this release to track:</p>
<ul class="simple">
<li><p><strong>awx_database_connections_total</strong> - Tracks current number of open database connections. When included in monitoring, can help identify when errors have occurred due lack of available database connections.</p></li>
<li><p><strong>callback_receiver_event_processing_avg_seconds</strong> - Proxy for “how far behind the callback receiver workers are in processing output”. If this number stays large, consider horizontally scaling the control plane and reducing the <code class="docutils literal notranslate"><span class="pre">capacity_adjustment</span></code> value on the node.</p></li>
</ul>
</section>
<section id="ldap-login-and-basic-authentication">
<h5><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">13.1.6. </span>LDAP login and basic authentication</a><a class="headerlink" href="#ldap-login-and-basic-authentication" title="Link to this heading"></a></h5>
<p id="index-7">Enhancements were made to the authentication backend that syncs LDAP configuration with the organizations and teams in the AWX. Logging in with large mappings between LDAP groups and organizations and teams is now up to 10 times faster than in previous versions.</p>
</section>
</section>
<section id="capacity-planning">
<h4><span class="section-number">13.2. </span>Capacity Planning<a class="headerlink" href="#capacity-planning" title="Link to this heading"></a></h4>
<section id="example-capacity-planning-exercise">
<span id="index-8"></span><h5><span class="section-number">13.2.1. </span>Example capacity planning exercise<a class="headerlink" href="#example-capacity-planning-exercise" title="Link to this heading"></a></h5>
<p id="index-9">Determining the number and size of instances to support the desired workload must take into account the following:</p>
<ul class="simple">
<li><p>Managed hosts</p></li>
<li><p>Tasks/hour per host</p></li>
<li><p>Maximum number of concurrent jobs you want to support</p></li>
<li><p>Maximum number of forks set on jobs</p></li>
<li><p>Node size you prefer to deploy (CPU/Memory/Disk)</p></li>
</ul>
<p>With this data, you can calculate the number of tasks per hour, which the cluster needs control capacity to process; as well as the number of “forks” or capacity you need to be able to run your peak load, which the cluster needs execution capacity to run.</p>
<p>For example, to plan for a cluster with:</p>
<ul class="simple">
<li><p>300 managed hosts</p></li>
<li><p>1,000 tasks/hour per host, or 16 tasks per minute per host</p></li>
<li><p>10 concurrent jobs</p></li>
<li><p>Forks set to 5 on playbooks</p></li>
<li><p>Average event size 1 Mb</p></li>
<li><p>Preferred node size of 4 cpu and 16 GB Ram with disks rated at 3000 IOPs</p></li>
</ul>
<p>Known factors:</p>
<ul class="simple">
<li><p>To run the 10 concurrent jobs, you need at least (10 jobs * 5 forks) + (10 jobs * 1 base task impact of a job) = 60 execution capacity</p></li>
<li><p>To control 10 concurrent jobs, you need at least 10 control capacity.</p></li>
<li><p>Running 1000 tasks * 300 managed hosts/hour will produce at least 300,000 events/hour. You would need to run the job to see exactly how many events it produces because this is dependent on the specific task and verbosity. For example, a debug task printing “Hello World” produces 6  job events with the verbosity of 1 on one host. With a verbosity of 3, it produces 34 job events on one host. Therefore, estimate the task produces at least 6 events. That means, closer to 3,000,000 events/hour or approximately 833 events/second.</p></li>
</ul>
<p>To determine how many execution and control nodes you will need, reference experiment results in the following table that show the observed event processing rate of a single control node with 5 execution nodes of equal size (API Capacity column). The default “forks” setting of job templates is 5, so using this default the maximum number of jobs a control node can dispatch to execution nodes will make 5 execution nodes of equal CPU/RAM use 100% of their capacity, arriving to the previously mentioned 1:5 ratio of control to execution capacity.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 15%" />
<col style="width: 8%" />
<col style="width: 8%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Node</p></th>
<th class="head"><p>API Capacity</p></th>
<th class="head"><p>Default Execution Capacity</p></th>
<th class="head"><p>Default Control Capacity</p></th>
<th class="head"><p>Mean Event Processing Rate at 100% capacity usage</p></th>
<th class="head"><p>Mean Events Processing Rate at 50% capacity usage</p></th>
<th class="head"><p>Mean Events Processing Rate at 40% capacity usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>4 CPU &#64; 2.5Ghz, 16 GB RAM Control Node, max 3000 IOPs disk</p></td>
<td><p>100 - 300 requests/second</p></td>
<td><p>n/a</p></td>
<td><p>137 jobs</p></td>
<td><p>1100/second</p></td>
<td><p>1400/second</p></td>
<td><p>1630/second</p></td>
</tr>
<tr class="row-odd"><td><p>4 CPU &#64; 2.5Ghz, 16 GB RAM Execution Node, max 3000 IOPs disk</p></td>
<td><p>n/a</p></td>
<td><p>137</p></td>
<td><p>0</p></td>
<td><p>n/a</p></td>
<td><p>n/a</p></td>
<td><p>n/a</p></td>
</tr>
<tr class="row-even"><td><p>4 CPU &#64; 2.5Ghz, 16 GB RAM DB Node, max 3000 IOPs disk</p></td>
<td><p>n/a</p></td>
<td><p>n/a</p></td>
<td><p>n/a</p></td>
<td><p>n/a</p></td>
<td><p>n/a</p></td>
<td><p>n/a</p></td>
</tr>
</tbody>
</table>
<p>This table shows that controlling jobs competes with job event processing on the control node. Therefore, over-provisioning control capacity can have a positive impact on reducing processing times. When processing times are high, users can experience a delay between when the job runs and when they can view the output in the API or UI.</p>
<p>For the example workload on 300 managed hosts, executing 1000 tasks/hour per host, 10 concurrent jobs with forks set to 5 on playbooks, and an average event size 1 Mb, do the following:</p>
<ul class="simple">
<li><p>Deploy 1 execution node, 1 control node, 1 DB node of 4 CPU &#64; 2.5Ghz, 16 GB RAM with disk having ~3000 IOPs</p></li>
<li><p>Keep default fork setting of 5 on job templates</p></li>
<li><p>Use the capacity adjustment feature on the control node to reduce the capacity down to 16 (lowest value) to reserve more of the Control node’s capacity for processing events</p></li>
</ul>
<img alt="_images/perf-capacity-adj-instances.png" src="_images/perf-capacity-adj-instances.png" />
</section>
<section id="factors-influencing-node-size-choice">
<h5><span class="section-number">13.2.2. </span>Factors influencing node size choice<a class="headerlink" href="#factors-influencing-node-size-choice" title="Link to this heading"></a></h5>
<p id="index-10">The previous exercise was done given that the cluster administrator already had a preferred node size, which happened to be the minimum recommended node size for AWX. Increasing the RAM and CPU on nodes increases the calculated capacity of the instances. For each instance type, there are different considerations as to why you may want to vertically scale the node.</p>
<section id="control-nodes">
<h6><span class="section-number">13.2.2.1. </span>Control nodes<a class="headerlink" href="#control-nodes" title="Link to this heading"></a></h6>
<p>Vertically scaling a control node increases the number of jobs it can perform control tasks for, which requires both more CPU and memory. In general, scaling CPU alongside memory in the same proportion is recommended (e.g. 1 CPU: 4GB RAM). Even in the case where memory consumption is observed to be high, increasing the CPU of an instance can often relieve pressure, as most memory consumption of control nodes is usually from unprocessed events.</p>
<p>As mentioned in the <a class="reference internal" href="#ag-performance-improvements"><span class="std std-ref">Performance improvements</span></a> section, increasing the number of CPU can also increase the job event processing rate of a control node. At this time, vertically scaling a control node does not increase the number of workers that handle web requests, so horizontally scaling is more effective, if the desire is to increase the API availability.</p>
</section>
<section id="execution-nodes">
<h6><span class="section-number">13.2.2.2. </span>Execution Nodes<a class="headerlink" href="#execution-nodes" title="Link to this heading"></a></h6>
<p>Vertical scaling an execution node will provide more forks for job execution. As mentioned in the example, a host with 16 GB of memory will by default, be assigned the capacity to run 137 “forks”, which at the default setting of 5 forks/job, will be able to run around 22 jobs concurrently. In general, scaling CPU alongside memory in the same proportion is recommended. Like control and hybrid nodes, there is a “capacity adjustment” on each execution instance that can be used to align actual utilization with the estimation of capacity consumption AWX makes. By default, all nodes are set to the top range of the capacity AWX estimates the node to have. If actual monitoring data reveals the node to be over-utilized, decreasing the capacity adjustment can help bring this in line with actual usage.</p>
<p>Vertically scaling execution will do exactly what the user expects and increase the number of concurrent jobs an instance can run. One downside is that concurrently running jobs on the same execution node, while isolated from each other in the sense that they cannot access the other’s data, can impact the other’s performance, if a particular job is very resource-consumptive and overwhelms the node to the extent that it degrades performance of the entire node. Horizontal scaling the execution plane (e.g deploying more execution nodes) can provide some additional isolation of workloads, as well as allowing administrators to assign different instances to different instance groups, which can then be assigned to Organizations, Inventories, or Job Templates. This can enable something like an instance group that can only be used for running jobs against a “production” Inventory, this way jobs for development do not end up eating up capacity and causing higher priority jobs to queue waiting for capacity.</p>
</section>
<section id="hop-nodes">
<h6><span class="section-number">13.2.2.3. </span>Hop Nodes<a class="headerlink" href="#hop-nodes" title="Link to this heading"></a></h6>
<p>Hop nodes have very low memory and CPU utilization and there is no significant motivation for vertically scaling hop nodes. A hop node that serves as the sole connection of many execution nodes to the control plane should be monitored for network bandwidth utilization, if this is seen to be saturated, changes to the network may be worth considering.</p>
</section>
<section id="hybrid-nodes">
<h6><span class="section-number">13.2.2.4. </span>Hybrid nodes<a class="headerlink" href="#hybrid-nodes" title="Link to this heading"></a></h6>
<p>Hybrid nodes perform both execution and control tasks, so vertically scaling these nodes both increases the number of jobs they can run, and now in 4.3.0, how many events they can process.</p>
</section>
</section>
<section id="capacity-planning-for-operator-based-deployments">
<h5><span class="section-number">13.2.3. </span>Capacity planning for Operator based Deployments<a class="headerlink" href="#capacity-planning-for-operator-based-deployments" title="Link to this heading"></a></h5>
<p id="index-11">For Operator based deployments, refer to <a class="reference external" href="https://ansible.readthedocs.io/projects/awx-operator">Ansible AWX Operator documentation</a>.</p>
</section>
</section>
<section id="monitoring-awx">
<h4><span class="section-number">13.3. </span>Monitoring AWX<a class="headerlink" href="#monitoring-awx" title="Link to this heading"></a></h4>
<p id="index-12">It is a best practice to monitor your AWX hosts both from a system level as well as at the application level. System level monitoring would include information about disk I/O, RAM utilization, CPU utilization, and network traffic.</p>
<p>For application level monitoring, AWX provides Prometheus-style metrics on an API endpoint <code class="docutils literal notranslate"><span class="pre">/api/v2/metrics</span></code>. This can be used to monitor aggregate data about job status as well as subsystem performance such as for job output processing or job scheduling.</p>
<p>Monitoring the actual CPU and memory utilization of your hosts is important because capacity management for instances does not dynamically introspect into the actual resource usage of hosts. The resource impact of automation will vary based on what exactly the playbooks are doing. For example, many cloud or networking modules do most of the actual processing on the node running the Ansible playbook (the execution node), which can have a significantly different impact on AWX than running <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">update</span></code> across many hosts, where the execution node spends much of the time during this task waiting on results.</p>
<p>If CPU or memory usage is very high, consider lowering the capacity adjustment on affected instances in AWX. This will limit how many jobs are run on or controlled by this instance.</p>
<p>Using this in combination with application level metrics can help identify what was happening in the application when and if any service degradation occurred. Having information about AWX’s performance over time can be very useful in diagnosing problems or doing capacity planning for future growth.</p>
</section>
<section id="database-settings">
<h4><span class="section-number">13.4. </span>Database Settings<a class="headerlink" href="#database-settings" title="Link to this heading"></a></h4>
<p id="index-13">The following are configurable settings in the database that may help improve performance:</p>
<ul>
<li><p><strong>Autovacuuming</strong>. Setting this PostgreSQL setting to true is a good practice. However, autovacuuming will not occur if there is never any idle time on the database. If it is observed that autovacuuming is not sufficiently cleaning up space on the database disk, then scheduling specific vacuum tasks during specific maintenance windows can be a solution.</p></li>
<li><p><strong>GUC</strong> parameters. Following are certain GUC (Grand Unified Configuration) parameters recommended for memory management in PostgreSQL, which is helpful for improving the performance of the database server. Recommended settings for each parameter are also provided.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">shared_buffers</span></code> (integer)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">work_mem</span></code> (integer)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maintenance_work_mem</span></code> (integer)</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>All of these parameters reside under the <code class="docutils literal notranslate"><span class="pre">postgresql.conf</span></code> file (inside <code class="docutils literal notranslate"><span class="pre">$PDATA</span></code> directory), which manages the configurations of the database server.</p>
<p>The <strong>shared_buffers</strong> parameter determines how much memory is dedicated to the server for caching data. Set in <code class="docutils literal notranslate"><span class="pre">postgresql.conf</span></code>, the default value for this parameter is:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="c1">#sharedPostgres_buffers = 128MB</span>
</pre></div>
</div>
<p>The value should be set at 15%-25% of the machine’s total RAM. For example: if your machine’s RAM size is 32 GB, then the recommended value for <code class="docutils literal notranslate"><span class="pre">shared_buffers</span></code> is 8 GB. Please note that the database server needs to be restarted after this change.</p>
<p>The <strong>work_mem</strong> parameter basically provides the amount of memory to be used by internal sort operations and hash tables before writing to temporary disk files. Sort operations are used for order by, distinct, and merge join operations. Hash tables are used in hash joins and hash based aggregation. Set in <code class="docutils literal notranslate"><span class="pre">postgresql.conf</span></code>, the default value for this parameter is:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="c1">#work_mem = 4MB</span>
</pre></div>
</div>
<p>Setting the correct value of <code class="docutils literal notranslate"><span class="pre">work_mem</span></code> parameter can result in less disk-swapping, and therefore far quicker queries.</p>
<p>We can use the formula below to calculate the optimal <code class="docutils literal notranslate"><span class="pre">work_mem</span></code> value for the database server:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">Total RAM * 0.25 / max_connections</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">max_connections</span></code> parameter is one of the GUC parameters to specify the maximum number of concurrent connections to the database server. Please note setting a large <code class="docutils literal notranslate"><span class="pre">work_mem</span></code> can cause issues like PostgreSQL server going out of memory (OOM), if there are too many open connections to the database.</p>
<p>The <strong>maintenance_work_mem</strong> parameter basically provides the maximum amount of memory to be used by maintenance operations like vacuum, create index, and alter table add foreign key operations. Set in <code class="docutils literal notranslate"><span class="pre">postgresql.conf</span></code>, the default value for this parameter is:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="c1">#maintenance_work_mem = 64MB</span>
</pre></div>
</div>
<p>It is recommended to set this value higher than <code class="docutils literal notranslate"><span class="pre">work_mem</span></code>; this can improve performance for vacuuming. In general, it should calculated as:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">Total RAM * 0.05</span>
</pre></div>
</div>
<section id="max-connections">
<h5><span class="section-number">13.4.1. </span>Max Connections<a class="headerlink" href="#max-connections" title="Link to this heading"></a></h5>
<p>For a realistic method of determining a value of <code class="docutils literal notranslate"><span class="pre">max_connections</span></code>, a ballpark formula for AWX is outlined here.
Database connections will scale with the number of control and hybrid nodes.
Per-node connection needs are listed here.</p>
<ul class="simple">
<li><p>Callback Receiver workers: 4 connections per node or the number of CPUs per node, whichever is larger</p></li>
<li><p>Dispatcher Workers: instance (forks) capacity plus 7</p></li>
<li><p>uWSGI workers: 16 connections per node</p></li>
<li><p>Listeners and auxiliary services: 4 connections per node</p></li>
<li><p>Reserve for installer and other actions: 5 connections in total</p></li>
</ul>
<p>Each of these points represent maximum expected connection use in high-load circumstances.
To apply this, consider a cluster with 3 hybrid nodes, each with 8 CPUs and 16 GB of RAM.
The capacity formula will determine a capacity of 132 forks per node based on the memory and capacity formula.</p>
<blockquote>
<div><p>(3 nodes) x (
(8 CPUs / node) x (1 connection / CPU) +
(132 forks / node) x (1 connection / fork) + (7 connections / node) +
(16 connections / node) +
(4 connections / node)
) + (5 connections)</p>
</div></blockquote>
<p>Adding up all the components comes out to 506 for this example cluster.
Practically, this means that the max_connections should be set to something higher than this.
Additional connections should be added to account for other platform components.</p>
<p>This calculation is most sensitive to the number of forks per node. Database connections are briefly opened at the start of and end of jobs. Environments where bursts of many jobs start at once will be most likely to reach the theoretical max number of open database connections.
The max number of jobs that would be started concurrently can be adjusted by modifying the effective capacity of the instances. This can be done with the SYSTEM_TASK_ABS_MEM setting, the capacity adjustment on instances, or with instance groups max jobs or max forks.</p>
</section>
<section id="awx-settings">
<h5><span class="section-number">13.4.2. </span>AWX Settings<a class="headerlink" href="#awx-settings" title="Link to this heading"></a></h5>
<p id="index-14">Many AWX settings are available to set via AWX UI or API. There are additional settings that are only available as file-based settings. Refer to product documentation about where each of these settings can be set. This section will focus on why administrators may want to adjust these values.</p>
<section id="live-events-in-the-awx-ui">
<h6><span class="section-number">13.4.2.1. </span>Live events in the AWX UI<a class="headerlink" href="#live-events-in-the-awx-ui" title="Link to this heading"></a></h6>
<p id="index-15">Events are broadcast to all nodes so that the events can be served over websocket to any client that connects to a control node’s web service. This task is expensive, and becomes more expensive as the number of events that the cluster is producing increases as well as the number of control nodes increase, because all events are broadcast to all nodes regardless of how many clients are subscribed to particular jobs.</p>
<p>There are a few settings that allow you to influence behavior of how job events are displayed in the UI and served over websockets.</p>
<p>For large clusters with large job event loads, an easy way to avoid the additional overhead is to disable live streaming events (the events are only loaded on hard refresh to a job’s output detail page). This is possible by setting <code class="docutils literal notranslate"><span class="pre">UI_LIVE_UPDATES_ENABLED</span></code> to False or set the <strong>Enable Activity Stream</strong> toggle to <strong>Off</strong> from the AWX UI Miscellaneous System Settings window.</p>
<img alt="_images/perf-enable-activity-stream.png" src="_images/perf-enable-activity-stream.png" />
<p>If disabling live streaming of events is not possible, for very verbose jobs with many events, administrators can consider reducing the number of events shown per second or before truncating or hiding events in the UI. The following settings all address issues of rate or size of events.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="c1"># Returned in the header on event api lists as a recommendation to the UI</span>
<span class="c1"># on how many events to display before truncating/hiding</span>
<span class="l l-Scalar l-Scalar-Plain">MAX_UI_JOB_EVENTS = 4000</span>

<span class="l l-Scalar l-Scalar-Plain"># The maximum size of the ansible callback event&#39;s &quot;res&quot; data structure,</span>
<span class="l l-Scalar l-Scalar-Plain"># (the &quot;res&quot; is the full &quot;result&quot; of the module)</span>
<span class="l l-Scalar l-Scalar-Plain"># beyond this limit and the value will be removed (e.g. truncated)</span>
<span class="l l-Scalar l-Scalar-Plain">MAX_EVENT_RES_DATA = 700000</span>

<span class="l l-Scalar l-Scalar-Plain"># Note</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">These settings may be overridden by database settings.</span>
<span class="l l-Scalar l-Scalar-Plain">EVENT_STDOUT_MAX_BYTES_DISPLAY = 1024</span>
<span class="l l-Scalar l-Scalar-Plain">MAX_WEBSOCKET_EVENT_RATE = 30</span>

<span class="c1"># The amount of time before a stdout file is expired and removed locally</span>
<span class="c1"># Note that this can be recreated if the stdout is downloaded</span>
<span class="l l-Scalar l-Scalar-Plain">LOCAL_STDOUT_EXPIRE_TIME = 2592000</span>
</pre></div>
</div>
</section>
<section id="job-event-processing-callback-receiver-settings">
<h6><span class="section-number">13.4.2.2. </span>Job Event Processing (Callback Receiver) Settings<a class="headerlink" href="#job-event-processing-callback-receiver-settings" title="Link to this heading"></a></h6>
<p id="index-16">The callback receiver is a process with multiple workers. The number of workers spawned is determined by the setting <code class="docutils literal notranslate"><span class="pre">JOB_EVENT_WORKERS</span></code>. These workers pull events off of a queue in Redis where unprocessed events are placed by jobs’ respective dispatch workers as results are available. As mentioned in the <a class="reference internal" href="#ag-performance-improvements"><span class="std std-ref">Performance improvements</span></a> section, this number of workers increased based on the number of CPU detected on the control instance. Previously, this setting was hardcoded to 4 workers, and administrators had to set this file based setting via a custom settings file on each control node.</p>
<p>This setting is still available for administrators to modify, with the knowledge that that values above 1 worker per CPU or less than 4 workers is not recommended. Greater values will have more workers available to clear the Redis queue as events stream to AWX, but may compete with other processes for CPU seconds. Lower values of workers may compete less for CPU on a node that also has had its number of UWSGI workers increased significantly, to prioritize serving web requests.</p>
</section>
<section id="task-manager-job-scheduling-settings">
<h6><span class="section-number">13.4.2.3. </span>Task Manager (Job Scheduling) Settings<a class="headerlink" href="#task-manager-job-scheduling-settings" title="Link to this heading"></a></h6>
<p id="index-17">The task manager is a periodic task that collects tasks that need to be scheduled and determines what instances have capacity and are eligible for running them. Its job is to find and assign the control and execution instances, update the job’s status to waiting, and send the message to the control node via <code class="docutils literal notranslate"><span class="pre">pg_notify</span></code> for the dispatcher to pick up the task and start running it.</p>
<p>As mentioned in the <a class="reference internal" href="#ag-performance-improvements"><span class="std std-ref">Performance improvements</span></a> section, a number of optimizations and refactors of this process were implemented in version 4.3. One such refactor was to fix a defect that when the task manager did reach its timeout, it was terminated in such a way that it did not make any progress. Multiple changes were implemented to fix this, so that as the task manager approaches its timeout, it makes an effort to exit and commit any progress made on that run. These issues generally arise when there are thousands of pending jobs, so may not be applicable to your use case.</p>
<p>The first “short-circuit” available to limit how much work the task manager attempts to do in one run is <code class="docutils literal notranslate"><span class="pre">START_TASK_LIMIT</span></code>. The default is 100 jobs, which is a safe default. If there are remaining jobs to schedule, a new run of the task manager will be scheduled to run immediately after the current run. Users who are willing to risk potentially longer individual runs of the task manager in order to start more jobs in individual run may consider increasing the <code class="docutils literal notranslate"><span class="pre">START_TASK_LIMIT</span></code>. One metric, the Prometheus metrics, available in <code class="docutils literal notranslate"><span class="pre">/api/v2/metrics</span></code> observes how long individual runs of the task manager take is “task_manager__schedule_seconds”.</p>
<p>As a safeguard against excessively long runs of the task manager, there is a timeout which is determined by the setting “TASK_MANAGER_TIMEOUT”. This is when the task manager will begin to exit any loops and attempt to commit any progress it made. The task is not actually killed until <code class="docutils literal notranslate"><span class="pre">TASK_MANAGER_TIMEOUT</span></code> + <code class="docutils literal notranslate"><span class="pre">TASK_MANAGER_TIMEOUT_GRACE_PERIOD</span></code> seconds has passed.</p>
</section>
</section>
</section>
<section id="additional-resources">
<h4><span class="section-number">13.5. </span>Additional Resources<a class="headerlink" href="#additional-resources" title="Link to this heading"></a></h4>
<p>For workloads with high levels of API interaction, best practices include:</p>
<ul class="simple">
<li><p>Use a load balancer</p></li>
<li><p>Limit the rate</p></li>
<li><p>Set max connections per node to 100</p></li>
<li><p>Use dynamic inventory sources instead of individually creating inventory hosts via the API</p></li>
<li><p>Use webhook notifications instead of polling for job status</p></li>
</ul>
<p>Since the published blog, additional observations have been made in the field regarding authentication methods. For automation clients that will make many requests in rapid succession, using tokens is a best practice, because depending on the type of user, there may be additional overhead when using basic authentication. For example, LDAP users using basic authentication trigger a process to reconcile if the LDAP user is correctly mapped to particular organizations, teams and roles. Refer to <a class="reference internal" href="index.html#ag-oauth2-token-auth"><span class="std std-ref">Token-Based Authentication</span></a> for detail on how to generate and use tokens.</p>
</section>
</section>
<span id="document-administration/secret_handling"></span><section id="secret-handling-and-connection-security">
<span id="ag-secret-handling"></span><h3><span class="section-number">14. </span>Secret handling and connection security<a class="headerlink" href="#secret-handling-and-connection-security" title="Link to this heading"></a></h3>
<p>This document describes how AWX handles secrets and connections in a secure fashion.</p>
<section id="secret-handling">
<h4><span class="section-number">14.1. </span>Secret Handling<a class="headerlink" href="#secret-handling" title="Link to this heading"></a></h4>
<p>AWX manages three sets of secrets:</p>
<ul class="simple">
<li><p>user passwords for local AWX users</p></li>
<li><p>secrets for AWX operational use (database password, message
bus password, etc.)</p></li>
<li><p>secrets for automation use (SSH keys, cloud credentials, external
password vault credentials, etc.)</p></li>
</ul>
<section id="user-passwords-for-local-users">
<h5><span class="section-number">14.1.1. </span>User passwords for local users<a class="headerlink" href="#user-passwords-for-local-users" title="Link to this heading"></a></h5>
<p>AWX hashes local AWX user passwords with the PBKDF2 algorithm using a SHA256 hash. Users who authenticate via external
account mechanisms (LDAP, SAML, OAuth, and others) do not have any password or secret stored.</p>
</section>
<section id="secret-handling-for-operational-use">
<h5><span class="section-number">14.1.2. </span>Secret handling for operational use<a class="headerlink" href="#secret-handling-for-operational-use" title="Link to this heading"></a></h5>
<p id="index-0">AWX contains the following secrets used operationally:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/awx/SECRET_KEY</span></code></p>
<ul>
<li><p>A secret key used for encrypting automation secrets in the
database (see below). If the <code class="docutils literal notranslate"><span class="pre">SECRET_KEY</span></code> changes or is unknown,
no encrypted fields in the database will be accessible.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">/etc/awx/awx.{cert,key}</span></code></p>
<ul>
<li><p>SSL certificate and key for the AWX web service. A
self-signed cert/key is installed by default; the customer can
provide a locally appropriate certificate and key.</p></li>
</ul>
</li>
<li><p>Database password in <code class="docutils literal notranslate"><span class="pre">/etc/awx/conf.d/postgres.py</span></code> and message bus
password in <code class="docutils literal notranslate"><span class="pre">/etc/awx/conf.d/channels.py</span></code></p>
<ul>
<li><p>Passwords for connecting to AWX component services</p></li>
</ul>
</li>
</ul>
<p>These secrets are all stored unencrypted on the AWX server, as they are all needed to be read by the AWX service at startup
in an automated fashion. All secrets are protected by Unix permissions, and restricted to root and the AWX service user awx.</p>
<p>If hiding of these secrets is required, the files that these secrets are read from are interpreted Python. These files can be adjusted to retrieve these secrets via some other mechanism anytime a service restarts.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the secrets system is down, AWX will be unable to get the information and may fail in a way that would be recoverable once the service is restored. Using some redundancy on that system is highly recommended.</p>
</div>
<p>If, for any reason you believe the <code class="docutils literal notranslate"><span class="pre">SECRET_KEY</span></code> AWX generated for you has been compromised and needs to be regenerated, you can run a tool from the installer that behaves much like AWX backup and restore tool.</p>
<p>To generate a new secret key, run <code class="docutils literal notranslate"><span class="pre">setup.sh</span> <span class="pre">-k</span></code> using the inventory from your install.</p>
<p>A backup copy of the prior key is saved in <code class="docutils literal notranslate"><span class="pre">/etc/awx/</span></code>.</p>
</section>
<section id="secret-handling-for-automation-use">
<h5><span class="section-number">14.1.3. </span>Secret handling for automation use<a class="headerlink" href="#secret-handling-for-automation-use" title="Link to this heading"></a></h5>
<p>AWX stores a variety of secrets in the database that are
either used for automation or are a result of automation. These secrets
include:</p>
<ul class="simple">
<li><p>all secret fields of all credential types (passwords, secret keys,
authentication tokens, secret cloud credentials)</p></li>
<li><p>secret tokens and passwords for external services defined in AWX settings</p></li>
<li><p>“password” type survey fields entries</p></li>
</ul>
<p>To encrypt secret fields, AWX uses AES in CBC mode with a 256-bit key
for encryption, PKCS7 padding, and HMAC using SHA256 for authentication.
The encryption/decryption process derives the AES-256 bit encryption key
from the <code class="docutils literal notranslate"><span class="pre">SECRET_KEY</span></code> (described above), the field name of the model field
and the database assigned auto-incremented record ID. Thus, if any
attribute used in the key generation process changes, AWX fails to
correctly decrypt the secret. AWX is designed such that the
<code class="docutils literal notranslate"><span class="pre">SECRET_KEY</span></code> is never readable in playbooks AWX launches, that
these secrets are never readable by AWX users, and no secret field values
are ever made available via the AWX REST API. If a secret value is
used in a playbook, we recommend using <code class="docutils literal notranslate"><span class="pre">no_log</span></code> on the task so that
it is not accidentally logged.</p>
</section>
</section>
<section id="connection-security">
<h4><span class="section-number">14.2. </span>Connection Security<a class="headerlink" href="#connection-security" title="Link to this heading"></a></h4>
<section id="internal-services">
<h5><span class="section-number">14.2.1. </span>Internal Services<a class="headerlink" href="#internal-services" title="Link to this heading"></a></h5>
<p>AWX connects to the following services as part of internal
operation:</p>
<ul class="simple">
<li><p>PostgreSQL database</p></li>
<li><p>A Redis key/value store</p></li>
</ul>
<p>The connection to redis is over a local unix socket, restricted to the awx service user.</p>
<p>The connection to the PostgreSQL database is done via password authentication over TCP, either via localhost or remotely (external
database). This connection can use PostgreSQL’s built in support for SSL/TLS, as natively configured by the installer support.
SSL/TLS protocols are configured by the default OpenSSL configuration.</p>
</section>
<section id="external-access">
<h5><span class="section-number">14.2.2. </span>External Access<a class="headerlink" href="#external-access" title="Link to this heading"></a></h5>
<p>AWX is accessed via standard HTTP/HTTPS on standard ports, provided by nginx. A self-signed cert/key is installed by default; the
customer can provide a locally appropriate certificate and key. SSL/TLS algorithm support is configured in the <code class="docutils literal notranslate"><span class="pre">/etc/nginx/nginx.conf</span></code> file. An “intermediate” profile is used by default, and can be configured. Changes must be reapplied on each update.</p>
</section>
<section id="managed-nodes">
<h5><span class="section-number">14.2.3. </span>Managed Nodes<a class="headerlink" href="#managed-nodes" title="Link to this heading"></a></h5>
<p>AWX also connects to managed machines and services as part of automation. All connections to managed machines are done via standard
secure mechanism as specified such as SSH, WinRM, SSL/TLS, and so on - each of these inherits configuration from the system configuration for the feature in question (such as the system OpenSSL configuration).</p>
</section>
</section>
</section>
<span id="document-administration/security_best_practices"></span><section id="security-best-practices">
<span id="ag-security-best-practices"></span><h3><span class="section-number">15. </span>Security Best Practices<a class="headerlink" href="#security-best-practices" title="Link to this heading"></a></h3>
<p>AWX is deployed in a secure fashion for use to automate typical environments. However, managing certain operating system environments, automation, and automation platforms, may require some additional best practices to ensure security. This document describes best practices for automation in a secure manner.</p>
<section id="understand-the-architecture-of-ansible-and-awx">
<h4><span class="section-number">15.1. </span>Understand the architecture of Ansible and AWX<a class="headerlink" href="#understand-the-architecture-of-ansible-and-awx" title="Link to this heading"></a></h4>
<p>Ansible and AWX comprise a general purpose, declarative, automation platform. That means that once an Ansible playbook is launched (via AWX, or directly on the command line), the playbook, inventory, and credentials provided to Ansible are considered to be the source of truth.  If policies are desired around external verification of specific playbook content, job definition, or inventory contents, these processes must be undertaken before the automation is launched (whether via the AWX web UI, or the AWX API).</p>
<p>These can take many forms. The use of source control, branching, and mandatory code review is best practice for Ansible automation. There are many tools that can help create process flow around using source control in this manner.</p>
<p>At a higher level, many tools exist that allow for creation of approvals and policy-based actions around arbitrary workflows, including automation; these tools can then use Ansible via AWX’s API to perform automation.</p>
<p>We recommend all customers of AWX select a secure default administrator password at time of installation.  See <a class="reference internal" href="index.html#tips-change-password"><span class="std std-ref">Changing the AWX Admin Password</span></a> for more information.</p>
<p>AWX exposes services on certain well-known ports, such as port 80 for HTTP traffic and port 443 for HTTPS traffic.  We recommend that you do not expose AWX on the open internet, significantly reducing the threat surface of your installation.</p>
</section>
<section id="granting-access">
<h4><span class="section-number">15.2. </span>Granting access<a class="headerlink" href="#granting-access" title="Link to this heading"></a></h4>
<p>Granting access to certain parts of the system exposes security risks. Apply the following practices to help secure access:</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#minimize-administrative-accounts" id="id2">Minimize administrative accounts</a></p></li>
<li><p><a class="reference internal" href="#minimize-local-system-access" id="id3">Minimize local system access</a></p></li>
<li><p><a class="reference internal" href="#remove-access-to-credentials-from-users" id="id4">Remove access to credentials from users</a></p></li>
<li><p><a class="reference internal" href="#enforce-separation-of-duties" id="id5">Enforce separation of duties</a></p></li>
</ul>
</nav>
<section id="minimize-administrative-accounts">
<h5><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">15.2.1. </span>Minimize administrative accounts</a><a class="headerlink" href="#minimize-administrative-accounts" title="Link to this heading"></a></h5>
<p>Minimizing the access to system administrative accounts is crucial for maintaining a secure system. A system administrator/root user can access, edit, and disrupt any system application. Keep the number of people/accounts with root access to as small of a group as possible. Do not give out <cite>sudo</cite> to <cite>root</cite> or <cite>awx</cite> (awx user) to untrusted users. Know that when restricting administrative access via mechanisms like <cite>sudo</cite>, that restricting to a certain set of commands may still give a wide range of access. Any command that allows for execution of a shell or arbitrary shell commands, or any command that can change files on the system, is fundamentally equivalent to full root access.</p>
<p>In an AWX context, any AWX ‘system administrator’ or ‘superuser’ account can edit, change, and update any inventory or automation definition in AWX. Restrict this to the minimum set of users possible for low-level AWX configuration and disaster recovery only.</p>
</section>
<section id="minimize-local-system-access">
<h5><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">15.2.2. </span>Minimize local system access</a><a class="headerlink" href="#minimize-local-system-access" title="Link to this heading"></a></h5>
<p>AWX, when used with best practices, should not require local user access except for administrative purposes. Non-administrator users should not have access to the AWX system.</p>
</section>
<section id="remove-access-to-credentials-from-users">
<h5><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">15.2.3. </span>Remove access to credentials from users</a><a class="headerlink" href="#remove-access-to-credentials-from-users" title="Link to this heading"></a></h5>
<p>If an automation credential is only stored in AWX, it can be further secured. Services such as OpenSSH can be configured to only allow credentials on connections from specific addresses. Credentials used by automation can be different than credentials used by system administrators for disaster-recovery or other ad-hoc management, allowing for easier auditing.</p>
</section>
<section id="enforce-separation-of-duties">
<h5><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">15.2.4. </span>Enforce separation of duties</a><a class="headerlink" href="#enforce-separation-of-duties" title="Link to this heading"></a></h5>
<p>Different pieces of automation may need to access a system at different levels. For example, you may have low-level system automation that applies patches and performs security baseline checking, while a higher-level piece of automation deploys applications. By using different keys or credentials for each piece of automation, the effect of any one key vulnerability is minimized, while also allowing for easy baseline auditing.</p>
</section>
</section>
<section id="available-resources">
<h4><span class="section-number">15.3. </span>Available resources<a class="headerlink" href="#available-resources" title="Link to this heading"></a></h4>
<p>Several resources exist in AWX and elsewhere to ensure a secure platform. Consider utilizing the following functionality:</p>
<nav class="contents local" id="id1">
<ul class="simple">
<li><p><a class="reference internal" href="#audit-and-logging-functionality" id="id6">Audit and logging functionality</a></p></li>
<li><p><a class="reference internal" href="#existing-security-functionality" id="id7">Existing security functionality</a></p></li>
<li><p><a class="reference internal" href="#external-account-stores" id="id8">External account stores</a></p></li>
<li><p><a class="reference internal" href="#django-password-policies" id="id9">Django password policies</a></p></li>
</ul>
</nav>
<section id="audit-and-logging-functionality">
<h5><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">15.3.1. </span>Audit and logging functionality</a><a class="headerlink" href="#audit-and-logging-functionality" title="Link to this heading"></a></h5>
<p>For any administrative access, it is key to audit and watch for actions.</p>
<p>For AWX, this is done via the built-in Activity Stream support that logs all changes within AWX, as well as via the automation logs.</p>
<p>Best practices dictate collecting logging and auditing centrally, rather than reviewing it on the local system. It is recommended that AWX be configured to use whatever IDS and/or logging/auditing (Splunk) is standard in your environment. AWX includes built-in logging integrations for Elastic Stack, Splunk, Sumologic, Loggly, and more. See <a class="reference internal" href="index.html#ag-logging"><span class="std std-ref">Logging and Aggregation</span></a> for more information.</p>
</section>
<section id="existing-security-functionality">
<h5><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">15.3.2. </span>Existing security functionality</a><a class="headerlink" href="#existing-security-functionality" title="Link to this heading"></a></h5>
<p>Do not disable SELinux, and do not disable AWX’s existing multi-tenant containment. Use AWX’s role-based access control (RBAC) to delegate the minimum level of privileges required to run automation. Use Teams in AWX to assign permissions to groups of users rather than to users individually. See <a class="reference internal" href="index.html#rbac-ug"><span class="std std-ref">Role-Based Access Controls</span></a> in the <em>AWX User Guide</em>.</p>
</section>
<section id="external-account-stores">
<h5><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">15.3.3. </span>External account stores</a><a class="headerlink" href="#external-account-stores" title="Link to this heading"></a></h5>
<p>Maintaining a full set of users just in AWX can be a time-consuming task in a large organization, prone to error. AWX supports connecting to external account sources via <a class="reference internal" href="index.html#ag-auth-ldap"><span class="std std-ref">LDAP</span></a>, <a class="reference internal" href="index.html#ag-auth-saml"><span class="std std-ref">SAML 2.0</span></a>, and certain <a class="reference internal" href="index.html#ag-social-auth"><span class="std std-ref">OAuth providers</span></a>. Using this eliminates a source of error when working with permissions.</p>
</section>
<section id="django-password-policies">
<span id="ag-security-django-password"></span><h5><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">15.3.4. </span>Django password policies</a><a class="headerlink" href="#django-password-policies" title="Link to this heading"></a></h5>
<p>AWX admins can leverage Django to set password policies at creation time via <code class="docutils literal notranslate"><span class="pre">AUTH_PASSWORD_VALIDATORS</span></code> to validate AWX user passwords. In the <code class="docutils literal notranslate"><span class="pre">custom.py</span></code> file located at <code class="docutils literal notranslate"><span class="pre">/etc/awx/conf.d</span></code> of your AWX instance, add the following code block example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>AUTH_PASSWORD_VALIDATORS = [
    {
        &#39;NAME&#39;: &#39;django.contrib.auth.password_validation.UserAttributeSimilarityValidator&#39;,
    },
    {
        &#39;NAME&#39;: &#39;django.contrib.auth.password_validation.MinimumLengthValidator&#39;,
        &#39;OPTIONS&#39;: {
            &#39;min_length&#39;: 9,
        }
    },
    {
        &#39;NAME&#39;: &#39;django.contrib.auth.password_validation.CommonPasswordValidator&#39;,
    },
    {
        &#39;NAME&#39;: &#39;django.contrib.auth.password_validation.NumericPasswordValidator&#39;,
    },
]
</pre></div>
</div>
<p>For more information, see <a class="reference external" href="https://docs.djangoproject.com/en/3.2/topics/auth/passwords/#module-django.contrib.auth.password_validation">Password management in Django</a> in addition to the example posted above.</p>
<p>Be sure to restart your AWX instance for the change to take effect. See <a class="reference internal" href="index.html#ag-restart-awx"><span class="std std-ref">Starting, Stopping, and Restarting AWX</span></a> for detail.</p>
</section>
</section>
</section>
<span id="document-administration/awx-manage"></span><section id="the-awx-manage-utility">
<span id="ag-manage-utility"></span><h3><span class="section-number">16. </span>The <em>awx-manage</em> Utility<a class="headerlink" href="#the-awx-manage-utility" title="Link to this heading"></a></h3>
<p id="index-0">The <code class="docutils literal notranslate"><span class="pre">awx-manage</span></code> utility is used to access detailed internal information of AWX. Commands for <code class="docutils literal notranslate"><span class="pre">awx-manage</span></code> should run as the <code class="docutils literal notranslate"><span class="pre">awx</span></code> user only.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Running awx-manage commands via playbook is not recommended or supported.</p>
</div>
<section id="inventory-import">
<h4><span class="section-number">16.1. </span>Inventory Import<a class="headerlink" href="#inventory-import" title="Link to this heading"></a></h4>
<p id="index-1"><code class="docutils literal notranslate"><span class="pre">awx-manage</span></code> is a mechanism by which an AWX administrator can import inventory directly into AWX, for those who cannot use Custom Inventory Scripts.</p>
<p>To use <code class="docutils literal notranslate"><span class="pre">awx-manage</span></code> properly, you must first create an inventory in AWX to use as the destination for the import.</p>
<p>For help with <code class="docutils literal notranslate"><span class="pre">awx-manage</span></code>, run the following command: <code class="docutils literal notranslate"><span class="pre">awx-manage</span> <span class="pre">inventory_import</span> <span class="pre">[--help]</span></code></p>
<p>The <code class="docutils literal notranslate"><span class="pre">inventory_import</span></code> command synchronizes an AWX inventory object with a text-based inventory file, dynamic inventory script, or a directory of one or more of the above as supported by core Ansible.</p>
<p>When running this command, specify either an <code class="docutils literal notranslate"><span class="pre">--inventory-id</span></code> or <code class="docutils literal notranslate"><span class="pre">--inventory-name</span></code>, and the path to the Ansible inventory source (<code class="docutils literal notranslate"><span class="pre">--source</span></code>).</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">awx-manage inventory_import --source=/ansible/inventory/ --inventory-id=1</span>
</pre></div>
</div>
<p>By default, inventory data already stored in AWX blends with data from the external source. To use only the external data, specify <code class="docutils literal notranslate"><span class="pre">--overwrite</span></code>. To specify that any existing hosts get variable data exclusively from the <code class="docutils literal notranslate"><span class="pre">--source</span></code>, specify <code class="docutils literal notranslate"><span class="pre">--overwrite_vars</span></code>. The default behavior adds any new variables from the external source, overwriting keys that already exist, but preserves any variables that were not sourced from the external data source.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">awx-manage inventory_import --source=/ansible/inventory/ --inventory-id=1 --overwrite</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Edits and additions to Inventory host variables persist beyond an inventory sync as long as <code class="docutils literal notranslate"><span class="pre">--overwrite_vars</span></code> is <strong>not</strong> set.</p>
</div>
</section>
<section id="cleanup-of-old-data">
<h4><span class="section-number">16.2. </span>Cleanup of old data<a class="headerlink" href="#cleanup-of-old-data" title="Link to this heading"></a></h4>
<p id="index-2"><code class="docutils literal notranslate"><span class="pre">awx-manage</span></code> has a variety of commands used to clean old data from AWX. The AWX administrators can use the Management Jobs interface for access or use the command line.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">awx-manage</span> <span class="pre">cleanup_jobs</span> <span class="pre">[--help]</span></code></p></li>
</ul>
<p>This permanently deletes the job details and job output for jobs older than a specified number of days.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">awx-manage</span> <span class="pre">cleanup_activitystream</span> <span class="pre">[--help]</span></code></p></li>
</ul>
<p>This permanently deletes any <a class="reference internal" href="index.html#ug-activitystreams"><span class="std std-ref">Activity Stream</span></a> data older than a specific number of days.</p>
</section>
<section id="cluster-management">
<h4><span class="section-number">16.3. </span>Cluster management<a class="headerlink" href="#cluster-management" title="Link to this heading"></a></h4>
<p id="index-3">Refer to the <a class="reference internal" href="index.html#ag-clustering"><span class="std std-ref">Clustering</span></a> section for details on the
<code class="docutils literal notranslate"><span class="pre">awx-manage</span> <span class="pre">provision_instance</span></code> and <code class="docutils literal notranslate"><span class="pre">awx-manage</span> <span class="pre">deprovision_instance</span></code>
commands.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Do not run other <code class="docutils literal notranslate"><span class="pre">awx-manage</span></code> commands unless instructed by Ansible Support.</p>
</div>
</section>
<section id="token-and-session-management">
<span id="ag-token-utility"></span><h4><span class="section-number">16.4. </span>Token and session management<a class="headerlink" href="#token-and-session-management" title="Link to this heading"></a></h4>
<p id="index-4">AWX supports the following commands for OAuth2 token management:</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#create-oauth2-token" id="id1"><code class="docutils literal notranslate"><span class="pre">create_oauth2_token</span></code></a></p></li>
<li><p><a class="reference internal" href="#revoke-oauth2-tokens" id="id2"><code class="docutils literal notranslate"><span class="pre">revoke_oauth2_tokens</span></code></a></p></li>
<li><p><a class="reference internal" href="#cleartokens" id="id3"><code class="docutils literal notranslate"><span class="pre">cleartokens</span></code></a></p></li>
<li><p><a class="reference internal" href="#expire-sessions" id="id4"><code class="docutils literal notranslate"><span class="pre">expire_sessions</span></code></a></p></li>
<li><p><a class="reference internal" href="#clearsessions" id="id5"><code class="docutils literal notranslate"><span class="pre">clearsessions</span></code></a></p></li>
</ul>
</nav>
<section id="create-oauth2-token">
<h5><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">16.4.1. </span><code class="docutils literal notranslate"><span class="pre">create_oauth2_token</span></code></a><a class="headerlink" href="#create-oauth2-token" title="Link to this heading"></a></h5>
<p>Use this command to create OAuth2 tokens (specify actual username for <code class="docutils literal notranslate"><span class="pre">example_user</span></code> below):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ awx-manage create_oauth2_token --user example_user</span>

<span class="l l-Scalar l-Scalar-Plain">New OAuth2 token for example_user</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">j89ia8OO79te6IAZ97L7E8bMgXCON2</span>
</pre></div>
</div>
<p>Make sure you provide a valid user when creating tokens. Otherwise, you will get an error message that you tried to issue the command without specifying a user, or supplying a username that does not exist.</p>
</section>
<section id="revoke-oauth2-tokens">
<span id="ag-manage-utility-revoke-tokens"></span><h5><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">16.4.2. </span><code class="docutils literal notranslate"><span class="pre">revoke_oauth2_tokens</span></code></a><a class="headerlink" href="#revoke-oauth2-tokens" title="Link to this heading"></a></h5>
<p>Use this command to revoke OAuth2 tokens (both application tokens and personal access tokens (PAT)). By default, it revokes all application tokens (but not their associated refresh tokens), and revokes all personal access tokens. However, you can also specify a user for whom to revoke all tokens.</p>
<p>To revoke all existing OAuth2 tokens:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ awx-manage revoke_oauth2_tokens</span>
</pre></div>
</div>
<p>To revoke all OAuth2 tokens &amp; their refresh tokens:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ awx-manage revoke_oauth2_tokens --revoke_refresh</span>
</pre></div>
</div>
<p>To revoke all OAuth2 tokens for the user with <code class="docutils literal notranslate"><span class="pre">id=example_user</span></code> (specify actual username for <code class="docutils literal notranslate"><span class="pre">example_user</span></code> below):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ awx-manage revoke_oauth2_tokens --user example_user</span>
</pre></div>
</div>
<p>To revoke all OAuth2 tokens and refresh token for the user with <code class="docutils literal notranslate"><span class="pre">id=example_user</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ awx-manage revoke_oauth2_tokens --user example_user --revoke_refresh</span>
</pre></div>
</div>
</section>
<section id="cleartokens">
<h5><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">16.4.3. </span><code class="docutils literal notranslate"><span class="pre">cleartokens</span></code></a><a class="headerlink" href="#cleartokens" title="Link to this heading"></a></h5>
<p>Use this command to clear tokens which have already been revoked. Refer to <a class="reference external" href="https://django-oauth-toolkit.readthedocs.io/en/latest/management_commands.html">Django’s Oauth Toolkit documentation on cleartokens</a> for more detail.</p>
<blockquote>
<div></div></blockquote>
</section>
<section id="expire-sessions">
<h5><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">16.4.4. </span><code class="docutils literal notranslate"><span class="pre">expire_sessions</span></code></a><a class="headerlink" href="#expire-sessions" title="Link to this heading"></a></h5>
<p>Use this command to terminate all sessions or all sessions for a specific user. Consider using this command when a user changes role in an organization, is removed from assorted groups in LDAP/AD, or the administrator wants to ensure the user can no longer execute jobs due to membership in these groups.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ awx-manage expire_sessions</span>
</pre></div>
</div>
<p>This command terminates all sessions by default. The users associated with those sessions will be consequently logged out. To only expire the sessions of a specific user, you can pass their username using the <code class="docutils literal notranslate"><span class="pre">--user</span></code> flag (specify actual username for <code class="docutils literal notranslate"><span class="pre">example_user</span></code> below):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ awx-manage expire_sessions --user example_user</span>
</pre></div>
</div>
</section>
<section id="clearsessions">
<h5><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">16.4.5. </span><code class="docutils literal notranslate"><span class="pre">clearsessions</span></code></a><a class="headerlink" href="#clearsessions" title="Link to this heading"></a></h5>
<p>Use this command to delete all sessions that have expired. Refer to <a class="reference external" href="https://docs.djangoproject.com/en/2.1/topics/http/sessions/#clearing-the-session-store">Django’s documentation on clearsessions</a> for more detail.</p>
<blockquote>
<div></div></blockquote>
<p>For more information on OAuth2 token management in the AWX user interface, see the <a class="reference internal" href="index.html#ug-applications-auth"><span class="std std-ref">Applications</span></a> section of the <em>AWX User Guide</em>.</p>
</section>
</section>
<section id="analytics-gathering">
<h4><span class="section-number">16.5. </span>Analytics gathering<a class="headerlink" href="#analytics-gathering" title="Link to this heading"></a></h4>
<p id="index-5">Use this command to gather analytics on-demand outside of the predefined window (default is 4 hours):</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">$ awx-manage gather_analytics --ship</span>
</pre></div>
</div>
<p>For customers with disconnected environments who want to collect usage information about unique hosts automated across a time period, use this command:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">awx-manage host_metric --since YYYY-MM-DD --until YYYY-MM-DD --json</span>
</pre></div>
</div>
<p>The parameters <code class="docutils literal notranslate"><span class="pre">--since</span></code> and <code class="docutils literal notranslate"><span class="pre">--until</span></code> specify date ranges and are optional, but one of them has to be present. The <code class="docutils literal notranslate"><span class="pre">--json</span></code> flag specifies the output format and is optional.</p>
</section>
</section>
<span id="document-administration/configure_awx"></span><section id="awx-configuration">
<span id="ag-configure-awx"></span><h3><span class="section-number">17. </span>AWX Configuration<a class="headerlink" href="#awx-configuration" title="Link to this heading"></a></h3>
<p id="configure-awx-overview"><span id="index-0"></span>You can configure various AWX settings within the Settings screen in the following tabs:</p>
<img alt="Screenshot of the AWX settings menu screen." src="_images/ug-settings-menu-screen.png" />
<p>Each tab contains fields with a <strong>Reset</strong> button, allowing you to revert any value entered back to the default value. <strong>Reset All</strong> allows you to revert all the values to their factory default values.</p>
<p><strong>Save</strong> applies changes you make, but it does not exit the edit dialog. To return to the Settings screen, click <strong>Settings</strong> from the left navigation bar or use the breadcrumbs at the top of the current view.</p>
<section id="authentication">
<h4><span class="section-number">17.1. </span>Authentication<a class="headerlink" href="#authentication" title="Link to this heading"></a></h4>
<p id="index-1">Through the AWX user interface, you can set up a simplified login through various authentication types: GitHub, Google, LDAP, RADIUS, and SAML. After you create and register your developer application with the appropriate service, you can set up authorizations for them.</p>
<ol class="arabic simple">
<li><p>From the left navigation bar, click <strong>Settings</strong>.</p></li>
<li><p>The left side of the Settings window is a set of configurable Authentication settings. Select from the following options:</p></li>
</ol>
<ul class="simple">
<li><p><a class="reference internal" href="index.html#ag-auth-azure"><span class="std std-ref">Azure AD settings</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ag-auth-github"><span class="std std-ref">GitHub settings</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ag-auth-google-oauth2"><span class="std std-ref">Google OAuth2 settings</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ag-auth-ldap"><span class="std std-ref">LDAP settings</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ag-auth-radius"><span class="std std-ref">RADIUS settings</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ag-auth-saml"><span class="std std-ref">SAML settings</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ag-auth-tacacs"><span class="std std-ref">TACACS+ settings</span></a></p></li>
<li><p><a class="reference internal" href="index.html#ag-auth-oidc"><span class="std std-ref">Generic OIDC settings</span></a></p></li>
</ul>
<p>Different authentication types require you to enter different information. Be sure to include all the information as required.</p>
<ol class="arabic simple" start="3">
<li><p>Click <strong>Save</strong> to apply the settings or <strong>Cancel</strong> to abandon the changes.</p></li>
</ol>
</section>
<section id="jobs">
<span id="configure-awx-jobs"></span><h4><span class="section-number">17.2. </span>Jobs<a class="headerlink" href="#jobs" title="Link to this heading"></a></h4>
<p id="index-2">The Jobs tab allows you to configure the types of modules that are allowed to be used by AWX’s Ad Hoc Commands feature, set limits on the number of jobs that can be scheduled, define their output size, and other details pertaining to working with Jobs in AWX.</p>
<ol class="arabic simple">
<li><p>From the left navigation bar, click <strong>Settings</strong> from the left navigation bar and select <strong>Jobs settings</strong> from the Settings screen.</p></li>
<li><p>Set the configurable options from the fields provided. Click the tooltip <img alt="help" src="_images/tooltips-icon.png" /> icon next to the field that you need additional information or details about. Refer to the <a class="reference internal" href="index.html#ug-galaxy"><span class="std std-ref">Ansible Galaxy Support</span></a> section for details about configuring Galaxy settings.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The values for all the timeouts are in seconds.</p>
</div>
<img alt="Screenshot of the AWX job configuration settings." src="_images/configure-awx-jobs.png" />
<ol class="arabic simple" start="3">
<li><p>Click <strong>Save</strong> to apply the settings or <strong>Cancel</strong> to abandon the changes.</p></li>
</ol>
</section>
<section id="system">
<span id="configure-awx-system"></span><h4><span class="section-number">17.3. </span>System<a class="headerlink" href="#system" title="Link to this heading"></a></h4>
<p id="index-3">The System tab allows you to define the base URL for the AWX host, configure alerts, enable activity capturing, control visibility of users, enable certain AWX features and functionality through a license file, and configure logging aggregation options.</p>
<ol class="arabic simple">
<li><p>From the left navigation bar, click <strong>Settings</strong>.</p></li>
<li><p>The right side of the Settings window is a set of configurable System settings. Select from the following options:</p></li>
</ol>
<blockquote>
<div><ul>
<li><p><strong>Miscellaneous System settings</strong>: enable activity streams, specify the default execution environment, define the base URL for the AWX host, enable AWX administration alerts, set user visibility, define analytics, specify usernames and passwords, and configure proxies.</p></li>
<li><p><strong>Miscellaneous Authentication settings</strong>: configure options associated with authentication methods (built-in or SSO), sessions (timeout, number of sessions logged in, tokens), and social authentication mapping.</p></li>
<li><p><strong>Logging settings</strong>: configure logging options based on the type you choose:</p>
<img alt="Logging settings shown with the list of options for Logging Aggregator Types." src="_images/configure-awx-system-logging-types.png" />
<p>For more information about each of the logging aggregation types, refer to the <a class="reference internal" href="index.html#ag-logging"><span class="std std-ref">Logging and Aggregation</span></a> section of the <em>AWX Administration Guide</em>.</p>
</li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Set the configurable options from the fields provided. Click the tooltip <img alt="help" src="_images/tooltips-icon.png" /> icon next to the field that you need additional information or details about. Below is an example of the System settings window.</p></li>
</ol>
<img alt="Miscellaneous System settings window showing all possible configurable options." src="_images/configure-awx-system.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <strong>Allow External Users to Create Oauth2 Tokens</strong> setting is disabled by default. This ensures external users cannot <em>create</em> their own tokens. If you enable then disable it, any tokens created by external users in the meantime will still exist, and are not automatically revoked.</p>
</div>
<ol class="arabic simple" start="4">
<li><p>Click <strong>Save</strong> to apply the settings or <strong>Cancel</strong> to abandon the changes.</p></li>
</ol>
</section>
<section id="user-interface">
<span id="configure-awx-ui"></span><h4><span class="section-number">17.4. </span>User Interface<a class="headerlink" href="#user-interface" title="Link to this heading"></a></h4>
<p id="index-4">AWX supports the use of a custom logo and login message. You can add a custom logo by uploading an image; and supply a custom login message from the <strong>User Interface settings</strong> of the Settings menu.</p>
<img alt="Edit User Interface Settings form." src="_images/configure-awx-ui.png" />
<p>For the custom logo to look its best, use a <code class="docutils literal notranslate"><span class="pre">.png</span></code> file with a transparent background. GIF, PNG, and JPEG formats are supported.</p>
<p>If needed, you can add specific information (such as a legal notice or a disclaimer) to a text box in the login modal by
adding it to the <strong>Custom Login Info</strong> text field.</p>
<p>For example, if you uploaded a specific logo, and added the following text:</p>
<img alt="Edit User Interface Settings form populated with custom text and logo." src="_images/configure-awx-ui-logo-filled.png" />
<p>The Tower login dialog would look like this:</p>
<img alt="AWX login screen with custom text and logo." src="_images/configure-awx-ui-angry-spud-login.png" />
<p>Selecting <code class="docutils literal notranslate"><span class="pre">Revert</span></code> will result in the appearance of the standard automation controller logo.</p>
<img alt="AWX login screen with default AWX logo." src="_images/login-form.png" />
</section>
</section>
<span id="document-administration/isolation_variables"></span><section id="isolation-functionality-and-variables">
<span id="ag-isolation-variables"></span><h3><span class="section-number">18. </span>Isolation functionality and variables<a class="headerlink" href="#isolation-functionality-and-variables" title="Link to this heading"></a></h3>
<p id="index-0">AWX uses container technology to isolate jobs from each other. By default, only the current project is exposed to the container running a job template.</p>
<p>You may find that you need to customize your playbook runs to expose additional directories. To fine tune your usage of job isolation, there are certain variables that can be set.</p>
<p>By default, AWX will use the system’s <code class="docutils literal notranslate"><span class="pre">tmp</span></code> directory (<code class="docutils literal notranslate"><span class="pre">/tmp</span></code> by default) as its staging area. This can be changed in the <strong>Job Execution Path</strong> field of the Jobs settings screen, or in the REST API at <code class="docutils literal notranslate"><span class="pre">/api/v2/settings/jobs</span></code>:</p>
<p><code class="docutils literal notranslate"><span class="pre">AWX_ISOLATION_BASE_PATH</span> <span class="pre">=</span> <span class="pre">&quot;/opt/tmp&quot;</span></code></p>
<p>If there are any additional directories that should specifically be exposed from the host to the container that playbooks run in, you can specify those in the <strong>Paths to Expose to Isolated Jobs</strong>
field of the Jobs setting screen, or in the REST API at <code class="docutils literal notranslate"><span class="pre">/api/v2/settings/jobs</span></code>:</p>
<p><code class="docutils literal notranslate"><span class="pre">AWX_ISOLATION_SHOW_PATHS</span> <span class="pre">=</span> <span class="pre">['/list/of/',</span> <span class="pre">'/paths']</span></code></p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The primary file you may want to add to <code class="docutils literal notranslate"><span class="pre">AWX_ISOLATION_SHOW_PATHS</span></code> is <code class="docutils literal notranslate"><span class="pre">/var/lib/awx/.ssh</span></code>, if your playbooks need to use keys or settings defined there.</p>
</div>
</div></blockquote>
<p>The above fields can be found in the Jobs Settings window:</p>
<img alt="_images/configure-awx-jobs-isolated-jobs-fields.png" src="_images/configure-awx-jobs-isolated-jobs-fields.png" />
</section>
<span id="document-administration/oauth2_token_auth"></span><section id="token-based-authentication">
<span id="ag-oauth2-token-auth"></span><h3><span class="section-number">19. </span>Token-Based Authentication<a class="headerlink" href="#token-based-authentication" title="Link to this heading"></a></h3>
<p id="index-0">OAuth 2 is used for token-based authentication. You can manage OAuth tokens as well as applications, a server-side representation of API clients used to generate tokens. By including an OAuth token as part of the HTTP authentication header, you can authenticate yourself and adjust the degree of restrictive permissions in addition to the base RBAC permissions. Refer to <a class="reference external" href="https://tools.ietf.org/html/rfc6749">RFC 6749</a> for more details of OAuth 2 specification.</p>
<blockquote>
<div></div></blockquote>
<p>For details on using the <code class="docutils literal notranslate"><span class="pre">manage</span></code> utility to create tokens, refer to the <a class="reference internal" href="index.html#ag-token-utility"><span class="std std-ref">Token and session management</span></a> section.</p>
<section id="managing-oauth-2-applications-and-tokens">
<h4><span class="section-number">19.1. </span>Managing OAuth 2 Applications and Tokens<a class="headerlink" href="#managing-oauth-2-applications-and-tokens" title="Link to this heading"></a></h4>
<p>Applications and tokens can be managed as a top-level resource at <code class="docutils literal notranslate"><span class="pre">/api/&lt;version&gt;/applications</span></code> and <code class="docutils literal notranslate"><span class="pre">/api/&lt;version&gt;/tokens</span></code>. These resources can also be accessed respective to the user at <code class="docutils literal notranslate"><span class="pre">/api/&lt;version&gt;/users/N/&lt;resource&gt;</span></code>. Applications can be created by making a <strong>POST</strong> to either <code class="docutils literal notranslate"><span class="pre">api/&lt;version&gt;/applications</span></code> or <code class="docutils literal notranslate"><span class="pre">/api/&lt;version&gt;/users/N/applications</span></code>.</p>
<p>Each OAuth 2 application represents a specific API client on the server side. For an API client to use the API via an application token, it must first have an application and issue an access token. Individual applications are accessible via their primary keys: <code class="docutils literal notranslate"><span class="pre">/api/&lt;version&gt;/applications/&lt;pk&gt;/</span></code>. Here is a typical application:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="p p-Indicator">{</span>
<span class="w">    </span><span class="s">&quot;id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;o_auth2_application&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;url&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;/api/v2/applications/2/&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;related&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">        </span><span class="s">&quot;tokens&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;/api/v2/applications/2/tokens/&quot;</span>
<span class="w">    </span><span class="p p-Indicator">},</span>
<span class="w">    </span><span class="s">&quot;summary_fields&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">        </span><span class="s">&quot;organization&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">            </span><span class="s">&quot;id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span>
<span class="w">            </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Default&quot;</span><span class="p p-Indicator">,</span>
<span class="w">            </span><span class="s">&quot;description&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">        </span><span class="p p-Indicator">},</span>
<span class="w">        </span><span class="s">&quot;user_capabilities&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">            </span><span class="s">&quot;edit&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
<span class="w">            </span><span class="s">&quot;delete&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span>
<span class="w">        </span><span class="p p-Indicator">},</span>
<span class="w">        </span><span class="s">&quot;tokens&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">            </span><span class="s">&quot;count&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">0</span><span class="p p-Indicator">,</span>
<span class="w">            </span><span class="s">&quot;results&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>
<span class="w">        </span><span class="p p-Indicator">}</span>
<span class="w">    </span><span class="p p-Indicator">},</span>
<span class="w">    </span><span class="s">&quot;created&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;2018-07-02T21:16:45.824400Z&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;modified&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;2018-07-02T21:16:45.824514Z&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;My</span><span class="nv"> </span><span class="s">Application&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;description&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;client_id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Ecmc6RjjhKUOWJzDYEP8TZ35P3dvsKt0AKdIjgHV&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;client_secret&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;7Ft7ym8MpE54yWGUNvxxg6KqGwPFsyhYn9QQfYHlgBxai74Qp1GE4zsvJduOfSFkTfWFnPzYpxqcRsy1KacD0HH0vOAQUDJDCidByMiUIH4YQKtGFM1zE1dACYbpN44E&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;client_type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;confidential&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;redirect_uris&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;authorization_grant_type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;password&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;skip_authorization&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;organization&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">1</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>As shown in the example above, <code class="docutils literal notranslate"><span class="pre">name</span></code> is the human-readable identifier of the application. The rest of the fields, like <code class="docutils literal notranslate"><span class="pre">client_id</span></code> and <code class="docutils literal notranslate"><span class="pre">redirect_uris</span></code>, are mainly used for OAuth2 authorization, which is covered later in <a class="reference internal" href="#ag-use-oauth-pat"><span class="std std-ref">Using OAuth 2 Token System for Personal Access Tokens (PAT)</span></a>.</p>
<p>The values for the <code class="docutils literal notranslate"><span class="pre">client_id</span></code> and <code class="docutils literal notranslate"><span class="pre">client_secret</span></code> fields are generated during creation and are non-editable identifiers of applications, while <code class="docutils literal notranslate"><span class="pre">organization</span></code> and <code class="docutils literal notranslate"><span class="pre">authorization_grant_type</span></code> are required upon creation and become non-editable.</p>
<section id="access-rules-for-applications">
<h5><span class="section-number">19.1.1. </span>Access Rules for Applications<a class="headerlink" href="#access-rules-for-applications" title="Link to this heading"></a></h5>
<p>Access rules for applications are as follows:</p>
<ul class="simple">
<li><p>System administrators can view and manipulate all applications in the system</p></li>
<li><p>Organization administrators can view and manipulate all applications belonging to Organization members</p></li>
<li><p>Other users can only view, update, and delete their own applications, but cannot create any new applications</p></li>
</ul>
<p>Tokens, on the other hand, are resources used to actually authenticate incoming requests and mask the permissions of the underlying user. There are two ways to create a token:</p>
<ul class="simple">
<li><p>POST to the <code class="docutils literal notranslate"><span class="pre">/api/v2/tokens/</span></code> endpoint with <code class="docutils literal notranslate"><span class="pre">application</span></code> and <code class="docutils literal notranslate"><span class="pre">scope</span></code> fields to point to the related application and specify token scope</p></li>
<li><p>POST to the <code class="docutils literal notranslate"><span class="pre">/api/v2/applications/&lt;pk&gt;/tokens/</span></code> endpoint with the <code class="docutils literal notranslate"><span class="pre">scope</span></code> field (the parent application will be automatically linked)</p></li>
</ul>
<p>Individual tokens are accessible via their primary keys: <code class="docutils literal notranslate"><span class="pre">/api/&lt;version&gt;/tokens/&lt;pk&gt;/</span></code>. Here is an example of a typical token:</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{
    &quot;id&quot;: 4,
    &quot;type&quot;: &quot;o_auth2_access_token&quot;,
    &quot;url&quot;: &quot;/api/v2/tokens/4/&quot;,
    &quot;related&quot;: {
        &quot;user&quot;: &quot;/api/v2/users/1/&quot;,
        &quot;application&quot;: &quot;/api/v2/applications/1/&quot;,
        &quot;activity_stream&quot;: &quot;/api/v2/tokens/4/activity_stream/&quot;
},
    &quot;summary_fields&quot;: {
        &quot;application&quot;: {
            &quot;id&quot;: 1,
            &quot;name&quot;: &quot;Default application for root&quot;,
            &quot;client_id&quot;: &quot;mcU5J5uGQcEQMgAZyr5JUnM3BqBJpgbgL9fLOVch&quot;
        },
        &quot;user&quot;: {
            &quot;id&quot;: 1,
            &quot;username&quot;: &quot;root&quot;,
            &quot;first_name&quot;: &quot;&quot;,
            &quot;last_name&quot;: &quot;&quot;
        }
    },
    &quot;created&quot;: &quot;2018-02-23T14:39:32.618932Z&quot;,
    &quot;modified&quot;: &quot;2018-02-23T14:39:32.643626Z&quot;,
    &quot;description&quot;: &quot;App Token Test&quot;,
    &quot;user&quot;: 1,
    &quot;token&quot;: &quot;*************&quot;,
    &quot;refresh_token&quot;: &quot;*************&quot;,
    &quot;application&quot;: 1,
    &quot;expires&quot;: &quot;2018-02-24T00:39:32.618279Z&quot;,
    &quot;scope&quot;: &quot;read&quot;
},
</pre></div>
</div>
</div></blockquote>
<p>For an OAuth 2 token, the only fully editable fields are <code class="docutils literal notranslate"><span class="pre">scope</span></code> and <code class="docutils literal notranslate"><span class="pre">description</span></code>. The <code class="docutils literal notranslate"><span class="pre">application</span></code> field is non-editable on update, and all other fields are entirely non-editable, and are auto-populated during creation, as follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code> field corresponds to the user the token is created for, and in this case, is also the user creating the token</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">expires</span></code> is generated according to AWX configuration setting <code class="docutils literal notranslate"><span class="pre">OAUTH2_PROVIDER</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">token</span></code> and <code class="docutils literal notranslate"><span class="pre">refresh_token</span></code> are auto-generated to be non-clashing random strings</p></li>
</ul>
<p>Both application tokens and personal access tokens are shown at the <code class="docutils literal notranslate"><span class="pre">/api/v2/tokens/</span></code> endpoint. The <code class="docutils literal notranslate"><span class="pre">application</span></code> field in the personal access tokens is always <strong>null</strong>. This is a good way to differentiate the two types of tokens.</p>
</section>
<section id="access-rules-for-tokens">
<h5><span class="section-number">19.1.2. </span>Access rules for tokens<a class="headerlink" href="#access-rules-for-tokens" title="Link to this heading"></a></h5>
<p>Access rules for tokens are as follows:</p>
<ul class="simple">
<li><p>Users can create a token if they are able to view the related application; and are also able to create a personal token for themselves</p></li>
<li><p>System administrators are able to view and manipulate every token in the system</p></li>
<li><p>Organization administrators are able to view and manipulate all tokens belonging to Organization members</p></li>
<li><p>System Auditors can view all tokens and applications</p></li>
<li><p>Other normal users are only able to view and manipulate their own tokens</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Users can only view the token or refresh the token value at the time of creation only.</p>
</div>
</section>
</section>
<section id="using-oauth-2-token-system-for-personal-access-tokens-pat">
<span id="ag-use-oauth-pat"></span><h4><span class="section-number">19.2. </span>Using OAuth 2 Token System for Personal Access Tokens (PAT)<a class="headerlink" href="#using-oauth-2-token-system-for-personal-access-tokens-pat" title="Link to this heading"></a></h4>
<p>The easiest and most common way to obtain an OAuth 2 token is to create a personal access token at the <code class="docutils literal notranslate"><span class="pre">/api/v2/users/&lt;userid&gt;/personal_tokens/</span></code> endpoint, as shown in this example below:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">curl -H &quot;Content-type</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/json&quot; -d &#39;{&quot;description&quot;:&quot;Personal AWX CLI token&quot;, &quot;application&quot;:null, &quot;scope&quot;:&quot;write&quot;}&#39; https://&lt;USERNAME&gt;:&lt;PASSWORD&gt;@&lt;AWX_SERVER&gt;/api/v2/users/&lt;USER_ID&gt;/personal_tokens/ | python -m json.tool</span>
</pre></div>
</div>
<p>You could also pipe the JSON output through <code class="docutils literal notranslate"><span class="pre">jq</span></code>, if installed.</p>
<p>Following is an example of using the personal token to access an API endpoint using curl:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">curl -H &quot;Authorization</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bearer &lt;token&gt;&quot; -H &quot;Content-Type</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/json&quot; -d &#39;{}&#39; https://awx/api/v2/job_templates/5/launch/</span>
</pre></div>
</div>
<p>In AWX, the OAuth 2 system is built on top of the <a class="reference external" href="https://django-oauth-toolkit.readthedocs.io/en/latest/">Django Oauth Toolkit</a>, which provides dedicated endpoints for authorizing, revoking, and refreshing tokens. These endpoints can be found under the <code class="docutils literal notranslate"><span class="pre">/api/v2/users/&lt;USER_ID&gt;/personal_tokens/</span></code> endpoint, which also provides detailed examples on some typical usage of those endpoints. These special OAuth 2 endpoints only support using the <code class="docutils literal notranslate"><span class="pre">x-www-form-urlencoded</span></code> <strong>Content-type</strong>, so none of the <code class="docutils literal notranslate"><span class="pre">api/o/*</span></code> endpoints accept <code class="docutils literal notranslate"><span class="pre">application/json</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can also request tokens using the <code class="docutils literal notranslate"><span class="pre">/api/o/token</span></code> endpoint by specifying <code class="docutils literal notranslate"><span class="pre">null</span></code> for the application type.</p>
</div>
<p>Alternatively, you can <a class="reference internal" href="index.html#ug-tokens-auth-create"><span class="std std-ref">add tokens</span></a> for users through the AWX user interface, as well as configure the expiration of an access token and its associated refresh token (if applicable).</p>
<img alt="_images/configure-awx-system-misc-sys-token-expire.png" src="_images/configure-awx-system-misc-sys-token-expire.png" />
<section id="token-scope-mask-over-rbac-system">
<h5><span class="section-number">19.2.1. </span>Token scope mask over RBAC system<a class="headerlink" href="#token-scope-mask-over-rbac-system" title="Link to this heading"></a></h5>
<p>The scope of an OAuth 2 token is a space-separated string composed of valid scope keywords, ‘read’ and ‘write’. These keywords are configurable and used to specify permission level of the authenticated API client. Read and write scopes provide a mask layer over the Role-Based Access Control (RBAC) permission system of AWX. Specifically, a ‘write’ scope gives the authenticated user the full permissions the RBAC system provides, while a ‘read’ scope gives the authenticated user only read permissions the RBAC system provides. Note that ‘write’ implies ‘read’ as well.</p>
<p>For example, if you have administrative permissions to a job template, you can view, modify, launch, and delete the job template if authenticated via session or basic authentication. In contrast, if you are authenticated using OAuth 2 token, and the related token scope is ‘read’, you can only view, but not manipulate or launch the job template, despite being an administrator. If the token scope is ‘write’ or ‘read write’, you can take full advantage of the job template as its administrator.</p>
<p>To acquire and use a token, first create an application token:</p>
<ol class="arabic simple">
<li><p>Make an application with <code class="docutils literal notranslate"><span class="pre">authorization_grant_type</span></code> set to <code class="docutils literal notranslate"><span class="pre">password</span></code>. HTTP POST the following to the <code class="docutils literal notranslate"><span class="pre">/api/v2/applications/</span></code> endpoint  (supplying your own organization ID):</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w">    </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Admin</span><span class="nv"> </span><span class="s">Internal</span><span class="nv"> </span><span class="s">Application&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;description&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;For</span><span class="nv"> </span><span class="s">use</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">secure</span><span class="nv"> </span><span class="s">services</span><span class="nv"> </span><span class="s">&amp;</span><span class="nv"> </span><span class="s">clients.</span><span class="nv"> </span><span class="s">&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;client_type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;confidential&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;redirect_uris&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;authorization_grant_type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;password&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;skip_authorization&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;organization&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">&lt;organization-id&gt;</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Make a token and POST to the <code class="docutils literal notranslate"><span class="pre">/api/v2/tokens/</span></code> endpoint:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w">    </span><span class="s">&quot;description&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;My</span><span class="nv"> </span><span class="s">Access</span><span class="nv"> </span><span class="s">Token&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;application&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">&lt;application-id&gt;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;scope&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;write&quot;</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>This returns a &lt;token-value&gt; that you can use to authenticate with for future requests (this will not be shown again).</p>
<ol class="arabic simple" start="3">
<li><p>Use the token to access a resource. The following uses curl as an example:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">curl -H &quot;Authorization</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bearer &lt;token-value&gt;&quot; -H &quot;Content-Type</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/json&quot; https://&lt;awx&gt;/api/v2/users/</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">-k</span></code> flag may be needed if you have not set up a CA yet and are using SSL.</p>
<p>To revoke a token, you can make a DELETE on the detail page for that token, using that token’s ID. For example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">curl -u &lt;user&gt;:&lt;password&gt; -X DELETE https://&lt;awx&gt;/api/v2/tokens/&lt;pk&gt;/</span>
</pre></div>
</div>
<p>Similarly, using a token:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">curl -H &quot;Authorization</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bearer &lt;token-value&gt;&quot; -X DELETE https://&lt;awx&gt;/api/v2/tokens/&lt;pk&gt;/</span>
</pre></div>
</div>
</section>
</section>
<section id="application-functions">
<span id="ag-oauth2-token-auth-grant-types"></span><h4><span class="section-number">19.3. </span>Application Functions<a class="headerlink" href="#application-functions" title="Link to this heading"></a></h4>
<p>This page lists OAuth 2 utility endpoints used for authorization, token refresh, and revoke. The <code class="docutils literal notranslate"><span class="pre">/api/o/</span></code> endpoints are not meant to be used in browsers and do not support HTTP GET. The endpoints prescribed here strictly follow RFC specifications for OAuth 2, so use that for detailed reference. The following is an example of the typical usage of these endpoints in AWX, in particular, when creating an application using various grant types:</p>
<blockquote>
<div><ul class="simple">
<li><p>Authorization Code</p></li>
<li><p>Password</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can perform any of the application functions described here using AWX user interface. Refer to the <a class="reference internal" href="index.html#ug-applications-auth"><span class="std std-ref">Applications</span></a> section of the <em>AWX User Guide</em> for more detail.</p>
</div>
<section id="application-using-authorization-code-grant-type">
<h5><span class="section-number">19.3.1. </span>Application using <code class="docutils literal notranslate"><span class="pre">authorization</span> <span class="pre">code</span></code> grant type<a class="headerlink" href="#application-using-authorization-code-grant-type" title="Link to this heading"></a></h5>
<p>The application <code class="docutils literal notranslate"><span class="pre">authorization</span> <span class="pre">code</span></code> grant type should be used when access tokens need to be issued directly to an external application or service.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<blockquote>
<div><p>You can only use the <code class="docutils literal notranslate"><span class="pre">authorization</span> <span class="pre">code</span></code> type to acquire an access token when using an application. When integrating an external webapp with AWX, that webapp may need to create OAuth2 Tokens on behalf of users in that other webapp. Creating an application in AWX with the <code class="docutils literal notranslate"><span class="pre">authorization</span> <span class="pre">code</span></code> grant type is the preferred way to do this because:</p>
<ul class="simple">
<li><p>this allows an external application to obtain a token from AWX for a user, using their credentials.</p></li>
<li><p>compartmentalized tokens issued for a particular application allows those tokens to be easily managed (revoke all tokens associated with that application without having to revoke <em>all</em> tokens in the system, for example)</p></li>
</ul>
</div></blockquote>
<p>To create an application named <em>AuthCodeApp</em> with the <code class="docutils literal notranslate"><span class="pre">authorization-code</span></code> grant type, perform a POST to the <code class="docutils literal notranslate"><span class="pre">/api/v2/applications/</span></code> endpoint:</p>
</div>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w">    </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;AuthCodeApp&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;user&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;client_type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;confidential&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;redirect_uris&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;http://&lt;awx&gt;/api/v2&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;authorization_grant_type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;authorization-code&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;skip_authorization&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
<span class="p p-Indicator">}</span>


<span class="nt">.. _`Django-oauth-toolkit simple test application`</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http://django-oauth-toolkit.herokuapp.com/consumer/</span>
</pre></div>
</div>
<p>The workflow that occurs when you issue a <strong>GET</strong> to the <code class="docutils literal notranslate"><span class="pre">authorize</span></code> endpoint from the client application with the <code class="docutils literal notranslate"><span class="pre">response_type</span></code>, <code class="docutils literal notranslate"><span class="pre">client_id</span></code>, <code class="docutils literal notranslate"><span class="pre">redirect_uris</span></code>, and <code class="docutils literal notranslate"><span class="pre">scope</span></code>:</p>
<ol class="arabic simple">
<li><p>AWX responds with the authorization code and status to the <code class="docutils literal notranslate"><span class="pre">redirect_uri</span></code> specified in the application.</p></li>
<li><p>The client application then makes a <strong>POST</strong> to the <code class="docutils literal notranslate"><span class="pre">api/o/token/</span></code> endpoint on AWX with the <code class="docutils literal notranslate"><span class="pre">code</span></code>, <code class="docutils literal notranslate"><span class="pre">client_id</span></code>, <code class="docutils literal notranslate"><span class="pre">client_secret</span></code>, <code class="docutils literal notranslate"><span class="pre">grant_type</span></code>, and <code class="docutils literal notranslate"><span class="pre">redirect_uri</span></code>.</p></li>
<li><p>AWX responds with the <code class="docutils literal notranslate"><span class="pre">access_token</span></code>, <code class="docutils literal notranslate"><span class="pre">token_type</span></code>, <code class="docutils literal notranslate"><span class="pre">refresh_token</span></code>, and <code class="docutils literal notranslate"><span class="pre">expires_in</span></code>.</p></li>
</ol>
<p>Refer to <a class="reference external" href="http://django-oauth-toolkit.readthedocs.io/en/latest/tutorial/tutorial_01.html#test-your-authorization-server">Django’s Test Your Authorization Server</a> toolkit to test this flow.</p>
<blockquote>
<div></div></blockquote>
<p>You may specify the number of seconds an authorization code remains valid in the <strong>System settings</strong> screen:</p>
<img alt="_images/configure-awx-system-misc-sys-authcode-expire.png" src="_images/configure-awx-system-misc-sys-authcode-expire.png" />
<p>Requesting an access token after this duration will fail. The duration defaults to 600 seconds (10 minutes), based on the <a class="reference external" href="https://tools.ietf.org/html/rfc6749">RFC6749</a> recommendation.</p>
<p>The best way to set up app integrations with AWX using the Authorization Code grant type is to whitelist the origins for those cross-site requests. More generally, you need to whitelist the service or application you are integrating with AWX, for which you want to provide access tokens. To do this, have your Administrator add this whitelist to their local AWX settings:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">CORS_ALLOWED_ORIGIN_REGEXES = [</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">r&quot;http://django-oauth-toolkit.herokuapp.com*&quot;,</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">r&quot;http://www.example.com*&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">]</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">http://django-oauth-toolkit.herokuapp.com</span></code> and <code class="docutils literal notranslate"><span class="pre">http://www.example.com</span></code> are applications needing tokens with which to access AWX.</p>
</section>
<section id="application-using-password-grant-type">
<h5><span class="section-number">19.3.2. </span>Application using <code class="docutils literal notranslate"><span class="pre">password</span></code> grant type<a class="headerlink" href="#application-using-password-grant-type" title="Link to this heading"></a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">password</span></code> grant type or <code class="docutils literal notranslate"><span class="pre">Resource</span> <span class="pre">owner</span> <span class="pre">password-based</span></code> grant type is ideal for users who have native access to the web app and should be used when the client is the Resource owner. The following supposes an application, ‘Default Application’ with grant type <code class="docutils literal notranslate"><span class="pre">password</span></code>:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w">    </span><span class="s">&quot;id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;application&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="nv">...</span>
<span class="w">    </span><span class="nv">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Default</span><span class="nv"> </span><span class="s">Application&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;user&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;client_id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;gwSPoasWSdNkMDtBN3Hu2WYQpPWCO9SwUEsKK22l&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;client_secret&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;fI6ZpfocHYBGfm1tP92r0yIgCyfRdDQt0Tos9L8a4fNsJjQQMwp9569eIaUBsaVDgt2eiwOGe0bg5m5vCSstClZmtdy359RVx2rQK5YlIWyPlrolpt2LEpVeKXWaiybo&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;client_type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;confidential&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;redirect_uris&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;authorization_grant_type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;password&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;skip_authorization&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Logging in is not required for <code class="docutils literal notranslate"><span class="pre">password</span></code> grant type, so you can simply use curl to acquire a personal access token through the <code class="docutils literal notranslate"><span class="pre">/api/v2/tokens/</span></code> endpoint:</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>curl --user &lt;user&gt;:&lt;password&gt; -H &quot;Content-type: application/json&quot; \
--data &#39;{
    &quot;description&quot;: &quot;Token for Nagios Monitoring app&quot;,
    &quot;application&quot;: 1,
    &quot;scope&quot;: &quot;write&quot;
}&#39; \
https://&lt;awx&gt;/api/v2/tokens/
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The special OAuth 2 endpoints only support using the <code class="docutils literal notranslate"><span class="pre">x-www-form-urlencoded</span></code> <strong>Content-type</strong>, so as a result, none of the <code class="docutils literal notranslate"><span class="pre">api/o/*</span></code> endpoints accept <code class="docutils literal notranslate"><span class="pre">application/json</span></code>.</p>
</div>
<p>Upon success, a response displays in JSON format containing the access token, refresh token and other information:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">HTTP/1.1 200 OK</span>
<span class="l l-Scalar l-Scalar-Plain">Server</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx/1.12.2</span>
<span class="nt">Date</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Tue, 05 Dec 2017 16:48:09 GMT</span>
<span class="nt">Content-Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/json</span>
<span class="nt">Content-Length</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">163</span>
<span class="nt">Connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">keep-alive</span>
<span class="nt">Content-Language</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en</span>
<span class="nt">Vary</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Accept-Language, Cookie</span>
<span class="nt">Pragma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no-cache</span>
<span class="nt">Cache-Control</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no-store</span>
<span class="nt">Strict-Transport-Security</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">max-age=15768000</span>

<span class="p p-Indicator">{</span><span class="s">&quot;access_token&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;9epHOqHhnXUcgYK8QanOmUQPSgX92g&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;token_type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Bearer&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;expires_in&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">315360000000</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;refresh_token&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;jMRX6QvzOTf046KHee3TU5mT3nyXsz&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;scope&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;read&quot;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
</section>
</section>
<section id="application-token-functions">
<h4><span class="section-number">19.4. </span>Application Token Functions<a class="headerlink" href="#application-token-functions" title="Link to this heading"></a></h4>
<p>This section describes the refresh and revoke functions associated with tokens. Everything that follows (Refreshing and revoking tokens at the <code class="docutils literal notranslate"><span class="pre">/api/o/</span></code> endpoints) can currently only be done with application tokens.</p>
<section id="refresh-an-existing-access-token">
<h5><span class="section-number">19.4.1. </span>Refresh an existing access token<a class="headerlink" href="#refresh-an-existing-access-token" title="Link to this heading"></a></h5>
<p>The following example shows an existing access token with a refresh token provided:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w">    </span><span class="s">&quot;id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">35</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;access_token&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="nv">...</span>
<span class="w">    </span><span class="nv">&quot;user&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;token&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;omMFLk7UKpB36WN2Qma9H3gbwEBSOc&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;refresh_token&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;AL0NK9TTpv0qp54dGbC4VUZtsZ9r8z&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;application&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;expires&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;2017-12-06T03:46:17.087022Z&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;scope&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;read</span><span class="nv"> </span><span class="s">write&quot;</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">/api/o/token/</span></code> endpoint is used for refreshing the access token:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">curl \</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">-d &quot;grant_type=refresh_token&amp;refresh_token=AL0NK9TTpv0qp54dGbC4VUZtsZ9r8z&quot; \</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">-u &quot;gwSPoasWSdNkMDtBN3Hu2WYQpPWCO9SwUEsKK22l:fI6ZpfocHYBGfm1tP92r0yIgCyfRdDQt0Tos9L8a4fNsJjQQMwp9569eIaUBsaVDgt2eiwOGe0bg5m5vCSstClZmtdy359RVx2rQK5YlIWyPlrolpt2LEpVeKXWaiybo&quot; \</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">http://&lt;awx&gt;/api/o/token/ -i</span>
</pre></div>
</div>
<p>In the above POST request, <code class="docutils literal notranslate"><span class="pre">refresh_token</span></code> is provided by <code class="docutils literal notranslate"><span class="pre">refresh_token</span></code> field of the access token above that. The authentication information is of format <code class="docutils literal notranslate"><span class="pre">&lt;client_id&gt;:&lt;client_secret&gt;</span></code>, where <code class="docutils literal notranslate"><span class="pre">client_id</span></code> and <code class="docutils literal notranslate"><span class="pre">client_secret</span></code> are the corresponding fields of the underlying related application of the access token.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The special OAuth 2 endpoints only support using the <code class="docutils literal notranslate"><span class="pre">x-www-form-urlencoded</span></code> <strong>Content-type</strong>, so as a result, none of the <code class="docutils literal notranslate"><span class="pre">api/o/*</span></code> endpoints accept <code class="docutils literal notranslate"><span class="pre">application/json</span></code>.</p>
</div>
<p>Upon success, a response displays in JSON format containing the new (refreshed) access token with the same scope information as the previous one:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">HTTP/1.1 200 OK</span>
<span class="l l-Scalar l-Scalar-Plain">Server</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx/1.12.2</span>
<span class="nt">Date</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Tue, 05 Dec 2017 17:54:06 GMT</span>
<span class="nt">Content-Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/json</span>
<span class="nt">Content-Length</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">169</span>
<span class="nt">Connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">keep-alive</span>
<span class="nt">Content-Language</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">en</span>
<span class="nt">Vary</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Accept-Language, Cookie</span>
<span class="nt">Pragma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no-cache</span>
<span class="nt">Cache-Control</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">no-store</span>
<span class="nt">Strict-Transport-Security</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">max-age=15768000</span>

<span class="p p-Indicator">{</span><span class="s">&quot;access_token&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;NDInWxGJI4iZgqpsreujjbvzCfJqgR&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;token_type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Bearer&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;expires_in&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">315360000000</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;refresh_token&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;DqOrmz8bx3srlHkZNKmDpqA86bnQkT&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;scope&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;read</span><span class="nv"> </span><span class="s">write&quot;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Essentially, the refresh operation replaces the existing token by deleting the original and then immediately creating a new token with the same scope and related application as the original one. Verify that new token is present and the old one is deleted in the <code class="docutils literal notranslate"><span class="pre">/api/v2/tokens/</span></code> endpoint.</p>
</section>
<section id="revoke-an-access-token">
<span id="ag-oauth2-token-revoke"></span><h5><span class="section-number">19.4.2. </span>Revoke an access token<a class="headerlink" href="#revoke-an-access-token" title="Link to this heading"></a></h5>
<p>Similarly, you can revoke an access token by using the <code class="docutils literal notranslate"><span class="pre">/api/o/revoke-token/</span></code> endpoint.</p>
<p>Revoking an access token by this method is the same as deleting the token resource object, but it allows you to delete a token by providing its token value, and the associated <code class="docutils literal notranslate"><span class="pre">client_id</span></code> (and <code class="docutils literal notranslate"><span class="pre">client_secret</span></code> if the application is <code class="docutils literal notranslate"><span class="pre">confidential</span></code>). For example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">curl -d &quot;token=rQONsve372fQwuc2pn76k3IHDCYpi7&quot; \</span>
<span class="l l-Scalar l-Scalar-Plain">-u &quot;gwSPoasWSdNkMDtBN3Hu2WYQpPWCO9SwUEsKK22l:fI6ZpfocHYBGfm1tP92r0yIgCyfRdDQt0Tos9L8a4fNsJjQQMwp9569eIaUBsaVDgt2eiwOGe0bg5m5vCSstClZmtdy359RVx2rQK5YlIWyPlrolpt2LEpVeKXWaiybo&quot; \</span>
<span class="l l-Scalar l-Scalar-Plain">http://&lt;awx&gt;/api/o/revoke_token/ -i</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The special OAuth 2 endpoints only support using the <code class="docutils literal notranslate"><span class="pre">x-www-form-urlencoded</span></code> <strong>Content-type</strong>, so as a result, none of the <code class="docutils literal notranslate"><span class="pre">api/o/*</span></code> endpoints accept <code class="docutils literal notranslate"><span class="pre">application/json</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <strong>Allow External Users to Create Oauth2 Tokens</strong> (<code class="docutils literal notranslate"><span class="pre">ALLOW_OAUTH2_FOR_EXTERNAL_USERS</span></code> in the API) setting is disabled by default. External users refer to users authenticated externally with a service like LDAP, or any of the other SSO services. This setting ensures external users cannot <em>create</em> their own tokens. If you enable then disable it, any tokens created by external users in the meantime will still exist, and are not automatically revoked.</p>
</div>
<p>Alternatively, you can use the <code class="docutils literal notranslate"><span class="pre">manage</span></code> utility, <a class="reference internal" href="index.html#ag-manage-utility-revoke-tokens"><span class="std std-ref">revoke_oauth2_tokens</span></a>, to revoke tokens as described in the <a class="reference internal" href="index.html#ag-token-utility"><span class="std std-ref">Token and session management</span></a> section.</p>
<p>This setting can be configured at the system-level in the AWX User Interface:</p>
<img alt="_images/configure-awx-system-oauth2-tokens-toggle.png" src="_images/configure-awx-system-oauth2-tokens-toggle.png" />
<p>Upon success, a response of <code class="docutils literal notranslate"><span class="pre">200</span> <span class="pre">OK</span></code> displays. Verify the deletion by checking whether the token is present in the <code class="docutils literal notranslate"><span class="pre">/api/v2/tokens/</span></code> endpoint.</p>
</section>
</section>
</section>
<span id="document-administration/social_auth"></span><section id="setting-up-social-authentication">
<span id="ag-social-auth"></span><h3><span class="section-number">20. </span>Setting up Social Authentication<a class="headerlink" href="#setting-up-social-authentication" title="Link to this heading"></a></h3>
<p id="index-0">Authentication methods help simplify logins for end users–offering single sign-ons using existing login information to sign into a third party website rather than creating a new login account specifically for that website.</p>
<p>Account authentication can be configured in the AWX User Interface and saved to the PostgreSQL database. For instructions, refer to the <a class="reference internal" href="index.html#ag-configure-awx"><span class="std std-ref">AWX Configuration</span></a> section.</p>
<p>Account authentication in AWX can be configured to centrally use OAuth2, while enterprise-level account authentication can be configured for <a class="reference internal" href="index.html#ag-auth-azure"><span class="std std-ref">Azure</span></a>, <a class="reference internal" href="index.html#ag-auth-radius"><span class="std std-ref">RADIUS</span></a>, <a class="reference internal" href="index.html#ag-auth-saml"><span class="std std-ref">SAML</span></a>, or even <a class="reference internal" href="index.html#ag-auth-ldap"><span class="std std-ref">LDAP</span></a> as a source for authentication information. See <a class="reference internal" href="index.html#ag-ent-auth"><span class="std std-ref">Setting up Enterprise Authentication</span></a> for more detail.</p>
<p>For websites, such as Microsoft Azure, Google or GitHub, that provide account information, account information is often implemented using the OAuth standard. OAuth is a secure authorization protocol which is commonly used in conjunction with account authentication to grant 3rd party applications a “session token” allowing them to make API calls to providers on the user’s behalf.</p>
<p>Security Assertion Markup Language (<a class="reference internal" href="index.html#ag-auth-saml"><span class="std std-ref">SAML</span></a>) is an XML-based, open-standard data format for exchanging account authentication and authorization data between  an identity provider and a service provider.</p>
<p>The <a class="reference internal" href="index.html#ag-auth-radius"><span class="std std-ref">RADIUS</span></a> distributed client/server system allows you to secure networks against unauthorized access and can be implemented in network environments requiring high levels of security while maintaining network access for remote users.</p>
<section id="github-settings">
<span id="ag-auth-github"></span><h4><span class="section-number">20.1. </span>GitHub settings<a class="headerlink" href="#github-settings" title="Link to this heading"></a></h4>
<p id="index-1">To set up social authentication for GitHub, you will need to obtain an OAuth2 key and secret for a web application. To do this, you must first register the new application with GitHub at <a class="reference external" href="https://github.com/settings/developers">https://github.com/settings/developers</a>. In order to register the application, you must supply it with your homepage URL, which is the <strong>Callback URL</strong> shown in the Details tab for the GitHub default settings page. The OAuth2 key (Client ID) and secret (Client Secret) will be used to supply the required fields in the AWX User Interface.</p>
<ol class="arabic simple">
<li><p>Click <strong>Settings</strong> from the left navigation bar.</p></li>
<li><p>On the left side of the Settings window, click <strong>GitHub settings</strong> from the list of Authentication options.</p></li>
<li><p>Click the <strong>GitHub Default</strong> tab if not already selected.</p></li>
</ol>
<p>The <strong>GitHub OAuth2 Callback URL</strong> field is already pre-populated and non-editable. Once the application is registered, GitHub displays the Client ID and Client Secret.</p>
<ol class="arabic simple" start="4">
<li><p>Click <strong>Edit</strong> and copy and paste GitHub’s Client ID into the <strong>GitHub OAuth2 Key</strong> field.</p></li>
<li><p>Copy and paste GitHub’s Client Secret into the <strong>GitHub OAuth2 Secret</strong> field.</p></li>
<li><p>For details on completing the mapping fields, see <a class="reference internal" href="#ag-org-team-maps"><span class="std std-ref">Organization and Team Mapping</span></a>.</p></li>
<li><p>Click <strong>Save</strong> when done.</p></li>
<li><p>To verify that the authentication was configured correctly, logout of AWX and the login screen will now display the GitHub logo to allow logging in with those credentials.</p></li>
</ol>
<img alt="_images/configure-awx-auth-github-logo.png" src="_images/configure-awx-auth-github-logo.png" />
<section id="github-organization-settings">
<span id="ag-auth-github-org"></span><h5><span class="section-number">20.1.1. </span>GitHub Organization settings<a class="headerlink" href="#github-organization-settings" title="Link to this heading"></a></h5>
<p id="index-2">When defining account authentication with either an organization or a team within an organization, you should use the specific organization and team settings. Account authentication can be limited by an organization as well as by a team within an organization.</p>
<p>You can also choose to allow all by specifying non-organization or non-team based settings (as shown above).</p>
<p>You can limit users who can login to AWX by limiting only those in an organization or on a team within an organization.</p>
<p>To set up social authentication for a GitHub Organization, you will need to obtain an OAuth2 key and secret for a web application. To do this, you must first register your organization-owned application at <code class="docutils literal notranslate"><span class="pre">https://github.com/organizations/&lt;yourorg&gt;/settings/applications</span></code>. In order to register the application, you must supply it with your Authorization callback URL, which is the <strong>Callback URL</strong> shown in the Details page. Each key and secret must belong to a unique application and cannot be shared or reused between different authentication backends. The OAuth2 key (Client ID) and secret (Client Secret) will be used to supply the required fields in the AWX User Interface.</p>
<ol class="arabic simple">
<li><p>Click <strong>Settings</strong> from the left navigation bar.</p></li>
<li><p>On the left side of the Settings window, click <strong>GitHub settings</strong> from the list of Authentication options.</p></li>
<li><p>Click the <strong>GitHub Organization</strong> tab.</p></li>
</ol>
<p>The <strong>GitHub Organization OAuth2 Callback URL</strong> field is already pre-populated and non-editable.</p>
<p>Once the application is registered, GitHub displays the Client ID and Client Secret.</p>
<ol class="arabic simple" start="4">
<li><p>Click <strong>Edit</strong> and copy and paste GitHub’s Client ID into the <strong>GitHub Organization OAuth2 Key</strong> field.</p></li>
<li><p>Copy and paste GitHub’s Client Secret into the <strong>GitHub Organization OAuth2 Secret</strong> field.</p></li>
<li><p>Enter the name of your GitHub organization, as used in your organization’s URL (e.g., <a class="reference external" href="https://github.com">https://github.com</a>/&lt;yourorg&gt;/) in the <strong>GitHub Organization Name</strong> field.</p></li>
<li><p>For details on completing the mapping fields, see <a class="reference internal" href="#ag-org-team-maps"><span class="std std-ref">Organization and Team Mapping</span></a>.</p></li>
<li><p>Click <strong>Save</strong> when done.</p></li>
<li><p>To verify that the authentication was configured correctly, logout of AWX and the login screen will now display the GitHub Organization logo to allow logging in with those credentials.</p></li>
</ol>
<img alt="_images/configure-awx-auth-github-orgs-logo.png" src="_images/configure-awx-auth-github-orgs-logo.png" />
</section>
<section id="github-team-settings">
<span id="ag-auth-github-team"></span><h5><span class="section-number">20.1.2. </span>GitHub Team settings<a class="headerlink" href="#github-team-settings" title="Link to this heading"></a></h5>
<p id="index-3">To set up social authentication for a GitHub Team, you will need to obtain an OAuth2 key and secret for a web application. To do this, you must first register your team-owned application at <code class="docutils literal notranslate"><span class="pre">https://github.com/organizations/&lt;yourorg&gt;/settings/applications</span></code>. In order to register the application, you must supply it with your Authorization callback URL, which is the <strong>Callback URL</strong> shown in the Details page. Each key and secret must belong to a unique application and cannot be shared or reused between different authentication backends. The OAuth2 key (Client ID) and secret (Client Secret) will be used to supply the required fields in the AWX User Interface.</p>
<ol class="arabic simple">
<li><p>Find the numeric team ID using the GitHub API: <a class="reference external" href="http://fabian-kostadinov.github.io/2015/01/16/how-to-find-a-github-team-id/">http://fabian-kostadinov.github.io/2015/01/16/how-to-find-a-github-team-id/</a>. The Team ID will be used to supply a required field in the AWX User Interface.</p></li>
<li><p>Click <strong>Settings</strong> from the left navigation bar.</p></li>
<li><p>On the left side of the Settings window, click <strong>GitHub settings</strong> from the list of Authentication options.</p></li>
<li><p>Click the <strong>GitHub Team</strong> tab.</p></li>
</ol>
<p>The <strong>GitHub Team OAuth2 Callback URL</strong> field is already pre-populated and non-editable.  Once the application is registered, GitHub displays the Client ID and Client Secret.</p>
<ol class="arabic simple" start="5">
<li><p>Click <strong>Edit</strong> and copy and paste GitHub’s Client ID into the <strong>GitHub Team OAuth2 Key</strong> field.</p></li>
<li><p>Copy and paste GitHub’s Client Secret into the <strong>GitHub Team OAuth2 Secret</strong> field.</p></li>
<li><p>Copy and paste GitHub’s team ID in the <strong>GitHub Team ID</strong> field.</p></li>
<li><p>For details on completing the mapping fields, see <a class="reference internal" href="#ag-org-team-maps"><span class="std std-ref">Organization and Team Mapping</span></a>.</p></li>
<li><p>Click <strong>Save</strong> when done.</p></li>
<li><p>To verify that the authentication was configured correctly, logout of AWX and the login screen will now display the GitHub Team logo to allow logging in with those credentials.</p></li>
</ol>
<img alt="_images/configure-awx-auth-github-teams-logo.png" src="_images/configure-awx-auth-github-teams-logo.png" />
</section>
<section id="github-enterprise-settings">
<h5><span class="section-number">20.1.3. </span>GitHub Enterprise settings<a class="headerlink" href="#github-enterprise-settings" title="Link to this heading"></a></h5>
<p id="index-4">To set up social authentication for a GitHub Enterprise, you will need to obtain a GitHub Enterprise URL, an API URL, OAuth2 key and secret for a web application. To obtain the URLs, refer to the GitHub documentation on <a class="reference external" href="https://docs.github.com/en/enterprise-server&#64;3.1/rest/reference/enterprise-admin">GitHub Enterprise administration</a> . To obtain the  key and secret, you must first register your enterprise-owned application at <code class="docutils literal notranslate"><span class="pre">https://github.com/organizations/&lt;yourorg&gt;/settings/applications</span></code>. In order to register the application, you must supply it with your Authorization callback URL, which is the <strong>Callback URL</strong> shown in the Details page. Because its hosted on site and not github.com, you must specify which auth adapter it will talk to.</p>
<p>Each key and secret must belong to a unique application and cannot be shared or reused between different authentication backends. The OAuth2 key (Client ID) and secret (Client Secret) will be used to supply the required fields in the AWX User Interface.</p>
<ol class="arabic simple">
<li><p>Click <strong>Settings</strong> from the left navigation bar.</p></li>
<li><p>On the left side of the Settings window, click <strong>GitHub settings</strong> from the list of Authentication options.</p></li>
<li><p>Click the <strong>GitHub Enterprise</strong> tab.</p></li>
</ol>
<p>The <strong>GitHub Enterprise OAuth2 Callback URL</strong> field is already pre-populated and non-editable.  Once the application is registered, GitHub displays the Client ID and Client Secret.</p>
<ol class="arabic simple" start="4">
<li><p>Click <strong>Edit</strong> to configure GitHub Enterprise settings.</p></li>
<li><p>In the <strong>GitHub Enterprise URL</strong> field, enter the hostname of the GitHub Enterprise instance (e.g., <a class="reference external" href="https://github.example.com">https://github.example.com</a>).</p></li>
<li><p>In the <strong>GitHub Enterprise API URL</strong> field, enter the API URL of the GitHub Enterprise instance (e.g., <a class="reference external" href="https://github.example.com/api/v3">https://github.example.com/api/v3</a>)</p></li>
<li><p>Copy and paste GitHub’s Client ID into the <strong>GitHub Enterprise OAuth2 Key</strong> field.</p></li>
<li><p>Copy and paste GitHub’s Client Secret into the <strong>GitHub Enterprise OAuth2 Secret</strong> field.</p></li>
<li><p>For details on completing the mapping fields, see <a class="reference internal" href="#ag-org-team-maps"><span class="std std-ref">Organization and Team Mapping</span></a>.</p></li>
<li><p>Click <strong>Save</strong> when done.</p></li>
<li><p>To verify that the authentication was configured correctly, logout of AWX and the login screen will now display the GitHub Enterprise logo to allow logging in with those credentials.</p></li>
</ol>
<img alt="_images/configure-awx-auth-github-ent-logo.png" src="_images/configure-awx-auth-github-ent-logo.png" />
</section>
<section id="github-enterprise-organization-settings">
<h5><span class="section-number">20.1.4. </span>GitHub Enterprise Organization settings<a class="headerlink" href="#github-enterprise-organization-settings" title="Link to this heading"></a></h5>
<p id="index-5">To set up social authentication for a GitHub Enterprise Org, you will need to obtain a GitHub Enterprise Org URL, an Org API URL, an Org OAuth2 key and secret for a web application. To obtain the URLs, refer to the GitHub documentation on <a class="reference external" href="https://docs.github.com/en/enterprise-server&#64;3.1/rest/reference/enterprise-admin">GitHub Enterprise administration</a> . To obtain the  key and secret, you must first register your enterprise organization-owned application at <code class="docutils literal notranslate"><span class="pre">https://github.com/organizations/&lt;yourorg&gt;/settings/applications</span></code>. In order to register the application, you must supply it with your Authorization callback URL, which is the <strong>Callback URL</strong> shown in the Details page. Because its hosted on site and not github.com, you must specify which auth adapter it will talk to.</p>
<p>Each key and secret must belong to a unique application and cannot be shared or reused between different authentication backends. The OAuth2 key (Client ID) and secret (Client Secret) will be used to supply the required fields in the AWX User Interface.</p>
<ol class="arabic simple">
<li><p>Click <strong>Settings</strong> from the left navigation bar.</p></li>
<li><p>On the left side of the Settings window, click <strong>GitHub settings</strong> from the list of Authentication options.</p></li>
<li><p>Click the <strong>GitHub Enterprise Organization</strong> tab.</p></li>
</ol>
<p>The <strong>GitHub Enterprise Organization OAuth2 Callback URL</strong> field is already pre-populated and non-editable.  Once the application is registered, GitHub displays the Client ID and Client Secret.</p>
<ol class="arabic simple" start="4">
<li><p>Click <strong>Edit</strong> to configure GitHub Enterprise Organization settings.</p></li>
<li><p>In the <strong>GitHub Enterprise Organization URL</strong> field, enter the hostname of the GitHub Enterprise Org instance (e.g., <a class="reference external" href="https://github.orgexample.com">https://github.orgexample.com</a>).</p></li>
<li><p>In the <strong>GitHub Enterprise Organization API URL</strong> field, enter the API URL of the GitHub Enterprise Org instance (e.g., <a class="reference external" href="https://github.orgexample.com/api/v3">https://github.orgexample.com/api/v3</a>)</p></li>
<li><p>Copy and paste GitHub’s Client ID into the <strong>GitHub Enterprise Organization OAuth2 Key</strong> field.</p></li>
<li><p>Copy and paste GitHub’s Client Secret into the <strong>GitHub Enterprise Organization OAuth2 Secret</strong> field.</p></li>
<li><p>Enter the name of your GitHub Enterprise organization, as used in your organization’s URL (e.g., <a class="reference external" href="https://github.com">https://github.com</a>/&lt;yourorg&gt;/) in the <strong>GitHub Enterprise Organization Name</strong> field.</p></li>
<li><p>For details on completing the mapping fields, see <a class="reference internal" href="#ag-org-team-maps"><span class="std std-ref">Organization and Team Mapping</span></a>.</p></li>
<li><p>Click <strong>Save</strong> when done.</p></li>
<li><p>To verify that the authentication was configured correctly, logout of AWX and the login screen will now display the GitHub Enterprise Organization logo to allow logging in with those credentials.</p></li>
</ol>
<img alt="_images/configure-awx-auth-github-ent-org-logo.png" src="_images/configure-awx-auth-github-ent-org-logo.png" />
</section>
<section id="github-enterprise-team-settings">
<h5><span class="section-number">20.1.5. </span>GitHub Enterprise Team settings<a class="headerlink" href="#github-enterprise-team-settings" title="Link to this heading"></a></h5>
<p id="index-6">To set up social authentication for a GitHub Enterprise teams, you will need to obtain a GitHub Enterprise Org URL, an Org API URL, an Org OAuth2 key and secret for a web application. To obtain the URLs, refer to the GitHub documentation on <a class="reference external" href="https://docs.github.com/en/enterprise-server&#64;3.1/rest/reference/enterprise-admin">GitHub Enterprise administration</a> . To obtain the  key and secret, you must first register your enterprise team-owned application at <code class="docutils literal notranslate"><span class="pre">https://github.com/organizations/&lt;yourorg&gt;/settings/applications</span></code>. In order to register the application, you must supply it with your Authorization callback URL, which is the <strong>Callback URL</strong> shown in the Details page. Because its hosted on site and not github.com, you must specify which auth adapter it will talk to.</p>
<p>Each key and secret must belong to a unique application and cannot be shared or reused between different authentication backends. The OAuth2 key (Client ID) and secret (Client Secret) will be used to supply the required fields in the AWX User Interface.</p>
<ol class="arabic simple">
<li><p>Find the numeric team ID using the GitHub API: <a class="reference external" href="http://fabian-kostadinov.github.io/2015/01/16/how-to-find-a-github-team-id/">http://fabian-kostadinov.github.io/2015/01/16/how-to-find-a-github-team-id/</a>. The Team ID will be used to supply a required field in the AWX User Interface.</p></li>
<li><p>Click <strong>Settings</strong> from the left navigation bar.</p></li>
<li><p>On the left side of the Settings window, click <strong>GitHub settings</strong> from the list of Authentication options.</p></li>
<li><p>Click the <strong>GitHub Enterprise Team</strong> tab.</p></li>
</ol>
<p>The <strong>GitHub Enterprise Team OAuth2 Callback URL</strong> field is already pre-populated and non-editable.  Once the application is registered, GitHub displays the Client ID and Client Secret.</p>
<ol class="arabic simple" start="5">
<li><p>Click <strong>Edit</strong> to configure GitHub Enterprise Team settings.</p></li>
<li><p>In the <strong>GitHub Enterprise Team URL</strong> field, enter the hostname of the GitHub Enterprise team instance (e.g., <a class="reference external" href="https://github.teamexample.com">https://github.teamexample.com</a>).</p></li>
<li><p>In the <strong>GitHub Enterprise Team API URL</strong> field, enter the API URL of the GitHub Enterprise team instance (e.g., <a class="reference external" href="https://github.teamexample.com/api/v3">https://github.teamexample.com/api/v3</a>)</p></li>
<li><p>Copy and paste GitHub’s Client ID into the <strong>GitHub Enterprise Team OAuth2 Key</strong> field.</p></li>
<li><p>Copy and paste GitHub’s Client Secret into the <strong>GitHub Enterprise Team OAuth2 Secret</strong> field.</p></li>
<li><p>Copy and paste GitHub’s team ID in the <strong>GitHub Enterprise Team ID</strong> field.</p></li>
<li><p>For details on completing the mapping fields, see <a class="reference internal" href="#ag-org-team-maps"><span class="std std-ref">Organization and Team Mapping</span></a>.</p></li>
<li><p>Click <strong>Save</strong> when done.</p></li>
<li><p>To verify that the authentication was configured correctly, logout of AWX and the login screen will now display the GitHub Enterprise Teams logo to allow logging in with those credentials.</p></li>
</ol>
<img alt="_images/configure-awx-auth-github-ent-teams-logo.png" src="_images/configure-awx-auth-github-ent-teams-logo.png" />
</section>
</section>
<section id="google-oauth2-settings">
<span id="ag-auth-google-oauth2"></span><h4><span class="section-number">20.2. </span>Google OAuth2 settings<a class="headerlink" href="#google-oauth2-settings" title="Link to this heading"></a></h4>
<p id="index-7">To set up social authentication for Google, you will need to obtain an OAuth2 key and secret for a web application. To do this, you must first create a project and set it up with Google. Refer to <a class="reference external" href="https://support.google.com/googleapi/answer/6158849">https://support.google.com/googleapi/answer/6158849</a> for instructions. If you already completed the setup process, you can access those credentials by going to the Credentials section of the <a class="reference external" href="https://console.developers.google.com/">Google API Manager Console</a>. The OAuth2 key (Client ID) and secret (Client secret) will be used to supply the required fields in the AWX User Interface.</p>
<ol class="arabic simple">
<li><p>Click <strong>Settings</strong> from the left navigation bar.</p></li>
<li><p>On the left side of the Settings window, click <strong>Google OAuth 2 settings</strong> from the list of Authentication options.</p></li>
</ol>
<p>The <strong>Google OAuth2 Callback URL</strong> field is already pre-populated and non-editable.</p>
<ol class="arabic simple" start="3">
<li><p>The following fields are also pre-populated. If not, use the credentials Google supplied during the web application setup process, and look for the values with the same format as the ones shown in the example below:</p></li>
</ol>
<blockquote>
<div><ul>
<li><p>Click <strong>Edit</strong> and copy and paste Google’s Client ID into the <strong>Google OAuth2 Key</strong> field.</p></li>
<li><p>Copy and paste Google’s Client secret into the <strong>Google OAuth2 Secret</strong> field.</p>
<img alt="_images/configure-awx-auth-google.png" src="_images/configure-awx-auth-google.png" />
</li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>To complete the remaining optional fields, refer to the tooltips in each of the fields for instructions and required format.</p></li>
<li><p>For details on completing the mapping fields, see <a class="reference internal" href="#ag-org-team-maps"><span class="std std-ref">Organization and Team Mapping</span></a>.</p></li>
<li><p>Click <strong>Save</strong> when done.</p></li>
<li><p>To verify that the authentication was configured correctly, logout of AWX and the login screen will now display the Google logo to indicate it as a alternate method of logging into AWX.</p></li>
</ol>
<img alt="_images/configure-awx-auth-google-logo.png" src="_images/configure-awx-auth-google-logo.png" />
</section>
<section id="organization-and-team-mapping">
<span id="ag-org-team-maps"></span><h4><span class="section-number">20.3. </span>Organization and Team Mapping<a class="headerlink" href="#organization-and-team-mapping" title="Link to this heading"></a></h4>
<section id="organization-mapping">
<span id="index-8"></span><h5><span class="section-number">20.3.1. </span>Organization mapping<a class="headerlink" href="#organization-mapping" title="Link to this heading"></a></h5>
<p>You will need to control which users are placed into which organizations based on their username and email address (mapping out your organization admins/users from social or enterprise-level authentication accounts).</p>
<p>Dictionary keys are organization names. Organizations will be created, if not already present and if the license allows for multiple organizations. Otherwise, the single default organization is used regardless of the key.</p>
<p>Values are dictionaries defining the options for each organization’s membership.  For each organization, it is possible to specify which users are automatically users of the organization and also which users can administer the organization.</p>
<p><strong>admins</strong>: None, True/False, string or list/tuple of strings.</p>
<blockquote>
<div><ul class="simple">
<li><p>If <strong>None</strong>, organization admins will not be updated.</p></li>
<li><p>If <strong>True</strong>, all users using account authentication will automatically be added as admins of the organization.</p></li>
<li><p>If <strong>False</strong>, no account authentication users will be automatically added as admins of the organization.</p></li>
<li><p>If a string or list of strings, specifies the usernames and emails for users who will be added to the organization. Strings beginning and ending with <code class="docutils literal notranslate"><span class="pre">/</span></code> will be compiled into regular expressions; modifiers <code class="docutils literal notranslate"><span class="pre">i</span></code> (case-insensitive) and <code class="docutils literal notranslate"><span class="pre">m</span></code> (multi-line) may be specified after the ending <code class="docutils literal notranslate"><span class="pre">/</span></code>.</p></li>
</ul>
</div></blockquote>
<p><strong>remove_admins</strong>: True/False. Defaults to <strong>True</strong>.</p>
<blockquote>
<div><ul class="simple">
<li><p>When <strong>True</strong>, a user who does not match is removed from the organization’s administrative list.</p></li>
</ul>
</div></blockquote>
<p><strong>users</strong>: None, True/False, string or list/tuple of strings. Same rules apply as for <strong>admins</strong>.</p>
<p><strong>remove_users</strong>: True/False. Defaults to <strong>True</strong>. Same rules apply as for <strong>remove_admins</strong>.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w">    </span><span class="s">&quot;Default&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">        </span><span class="s">&quot;users&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span>
<span class="w">    </span><span class="p p-Indicator">},</span>
<span class="w">    </span><span class="s">&quot;Test</span><span class="nv"> </span><span class="s">Org&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">        </span><span class="s">&quot;admins&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;admin@example.com&quot;</span><span class="p p-Indicator">],</span>
<span class="w">        </span><span class="s">&quot;users&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span>
<span class="w">    </span><span class="p p-Indicator">},</span>
<span class="w">    </span><span class="s">&quot;Test</span><span class="nv"> </span><span class="s">Org</span><span class="nv"> </span><span class="s">2&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">        </span><span class="s">&quot;admins&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;admin@example.com&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;/^awx-[^@]+?@.*$/i&quot;</span><span class="p p-Indicator">],</span>
<span class="w">        </span><span class="s">&quot;users&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;/^[^@].*?@example\\.com$/&quot;</span>
<span class="w">    </span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Organization mappings may be specified separately for each account authentication backend.  If defined, these configurations will take precedence over the global configuration above.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">SOCIAL_AUTH_GOOGLE_OAUTH2_ORGANIZATION_MAP = {}</span>
<span class="l l-Scalar l-Scalar-Plain">SOCIAL_AUTH_GITHUB_ORGANIZATION_MAP = {}</span>
<span class="l l-Scalar l-Scalar-Plain">SOCIAL_AUTH_GITHUB_ORG_ORGANIZATION_MAP = {}</span>
<span class="l l-Scalar l-Scalar-Plain">SOCIAL_AUTH_GITHUB_TEAM_ORGANIZATION_MAP = {}</span>
<span class="l l-Scalar l-Scalar-Plain">SOCIAL_AUTH_SAML_ORGANIZATION_MAP = {}</span>
</pre></div>
</div>
</section>
<section id="team-mapping">
<h5><span class="section-number">20.3.2. </span>Team mapping<a class="headerlink" href="#team-mapping" title="Link to this heading"></a></h5>
<p>Team mapping is the mapping of team members (users) from social auth accounts. Keys are team names (will be created if not present). Values are dictionaries of options for each team’s membership, where each can contain the following parameters:</p>
<p><strong>organization</strong>: string. The name of the organization to which the team
belongs.  The team will be created if the combination of organization and
team name does not exist.  The organization will first be created if it
does not exist.  If the license does not allow for multiple organizations,
the team will always be assigned to the single default organization.</p>
<p><strong>users</strong>: None, True/False, string or list/tuple of strings.</p>
<blockquote>
<div><ul class="simple">
<li><p>If <strong>None</strong>, team members will not be updated.</p></li>
<li><p>If <strong>True</strong>/<strong>False</strong>, all social auth users will be added/removed as team members.</p></li>
<li><p>If a string or list of strings, specifies expressions used to match users. User will be added as a team member if the username or email matches. Strings beginning and ending with <code class="docutils literal notranslate"><span class="pre">/</span></code> will be compiled into regular expressions; modifiers <code class="docutils literal notranslate"><span class="pre">i</span></code> (case-insensitive) and <code class="docutils literal notranslate"><span class="pre">m</span></code> (multi-line) may be specified after the ending <code class="docutils literal notranslate"><span class="pre">/</span></code>.</p></li>
</ul>
</div></blockquote>
<p><strong>remove</strong>: True/False. Defaults to <strong>True</strong>. When <strong>True</strong>, a user who does not match the rules above is removed from the team.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w">    </span><span class="s">&quot;My</span><span class="nv"> </span><span class="s">Team&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">        </span><span class="s">&quot;organization&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Test</span><span class="nv"> </span><span class="s">Org&quot;</span><span class="p p-Indicator">,</span>
<span class="w">        </span><span class="s">&quot;users&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;/^[^@]+?@test\\.example\\.com$/&quot;</span><span class="p p-Indicator">],</span>
<span class="w">        </span><span class="s">&quot;remove&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span>
<span class="w">    </span><span class="p p-Indicator">},</span>
<span class="w">    </span><span class="s">&quot;Other</span><span class="nv"> </span><span class="s">Team&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">        </span><span class="s">&quot;organization&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Test</span><span class="nv"> </span><span class="s">Org</span><span class="nv"> </span><span class="s">2&quot;</span><span class="p p-Indicator">,</span>
<span class="w">        </span><span class="s">&quot;users&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;/^[^@]+?@test\\.example\\.com$/&quot;</span><span class="p p-Indicator">],</span>
<span class="w">        </span><span class="s">&quot;remove&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
<span class="w">    </span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Team mappings may be specified separately for each account authentication backend, based on which of these you setup.  When defined, these configurations take precedence over the global configuration above.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">SOCIAL_AUTH_GOOGLE_OAUTH2_TEAM_MAP = {}</span>
<span class="l l-Scalar l-Scalar-Plain">SOCIAL_AUTH_GITHUB_TEAM_MAP = {}</span>
<span class="l l-Scalar l-Scalar-Plain">SOCIAL_AUTH_GITHUB_ORG_TEAM_MAP = {}</span>
<span class="l l-Scalar l-Scalar-Plain">SOCIAL_AUTH_GITHUB_TEAM_TEAM_MAP = {}</span>
<span class="l l-Scalar l-Scalar-Plain">SOCIAL_AUTH_SAML_TEAM_MAP = {}</span>
</pre></div>
</div>
<p>Uncomment the line below (i.e. set <code class="docutils literal notranslate"><span class="pre">SOCIAL_AUTH_USER_FIELDS</span></code> to an empty list) to prevent new user accounts from being created.  Only users who have previously logged in to AWX using social or enterprise-level authentication or have a user account with a matching email address will be able to login.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">SOCIAL_AUTH_USER_FIELDS = []</span>
</pre></div>
</div>
</section>
</section>
</section>
<span id="document-administration/ent_auth"></span><section id="setting-up-enterprise-authentication">
<span id="ag-ent-auth"></span><h3><span class="section-number">21. </span>Setting up Enterprise Authentication<a class="headerlink" href="#setting-up-enterprise-authentication" title="Link to this heading"></a></h3>
<p id="index-0">This section describes setting up authentication for the following enterprise systems:</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#azure-ad-settings" id="id1">Azure AD settings</a></p></li>
<li><p><a class="reference internal" href="#ldap-authentication" id="id2">LDAP Authentication</a></p></li>
<li><p><a class="reference internal" href="#radius-settings" id="id3">RADIUS settings</a></p></li>
<li><p><a class="reference internal" href="#saml-settings" id="id4">SAML settings</a></p>
<ul>
<li><p><a class="reference internal" href="#transparent-saml-logins" id="id5">Transparent SAML Logins</a></p></li>
<li><p><a class="reference internal" href="#enabling-logging-for-saml" id="id6">Enabling Logging for SAML</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#tacacs-settings" id="id7">TACACS+ settings</a></p></li>
<li><p><a class="reference internal" href="#generic-oidc-settings" id="id8">Generic OIDC settings</a></p></li>
</ul>
</nav>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For LDAP authentication, see <a class="reference internal" href="index.html#ag-auth-ldap"><span class="std std-ref">Setting up LDAP Authentication</span></a>.</p>
</div>
<p>Azure, RADIUS, SAML, and TACACS+ users are categorized as ‘Enterprise’ users. The following rules apply to Enterprise users:</p>
<ul class="simple">
<li><p>Enterprise users can only be created via the first successful login attempt from remote authentication backend.</p></li>
<li><p>Enterprise users cannot be created/authenticated if non-enterprise users with the same name has already been created in AWX.</p></li>
<li><p>AWX passwords of enterprise users should always be empty and cannot be set by any user if there are enterprise backend-enabled.</p></li>
<li><p>If enterprise backends are disabled, an enterprise user can be converted to a normal AWX user by setting the password field. However, this operation is irreversible, as the converted AWX user can no longer be treated as enterprise user.</p></li>
</ul>
<section id="azure-ad-settings">
<span id="ag-auth-azure"></span><h4><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">21.1. </span>Azure AD settings</a><a class="headerlink" href="#azure-ad-settings" title="Link to this heading"></a></h4>
<p id="index-1">To set up enterprise authentication for Microsoft Azure Active Directory (AD), you will need to obtain an OAuth2 key and secret by registering your organization-owned application from Azure at <a class="reference external" href="https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app">https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app</a>. Each key and secret must belong to a unique application and cannot be shared or reused between different authentication backends. In order to register the application, you must supply it with your webpage URL, which is the Callback URL shown in the Settings Authentication screen.</p>
<ol class="arabic">
<li><p>Click <strong>Settings</strong> from the left navigation bar.</p></li>
<li><p>On the left side of the Settings window, click <strong>Azure AD settings</strong> from the list of Authentication options.</p></li>
<li><p>The <strong>Azure AD OAuth2 Callback URL</strong> field is already pre-populated and non-editable.
Once the application is registered, Azure displays the Application ID and Object ID.</p></li>
<li><p>Click <strong>Edit</strong> and copy and paste Azure’s Application ID to the <strong>Azure AD OAuth2 Key</strong> field.</p>
<p>Following Azure AD’s documentation for connecting your app to Microsoft Azure Active Directory, supply the key (shown at one time only) to the client for authentication.</p>
</li>
<li><p>Copy and paste the actual secret key created for your Azure AD application to the <strong>Azure AD OAuth2 Secret</strong> field of the Settings - Authentication screen.</p></li>
<li><p>For details on completing the mapping fields, see <a class="reference internal" href="index.html#ag-org-team-maps"><span class="std std-ref">Organization and Team Mapping</span></a>.</p></li>
<li><p>Click <strong>Save</strong> when done.</p></li>
<li><p>To verify that the authentication was configured correctly, logout of AWX and the login screen will now display the Microsoft Azure logo to allow logging in with those credentials.</p></li>
</ol>
<img alt="AWX login screen displaying the Microsoft Azure logo for authentication." src="_images/configure-awx-auth-azure-logo.png" />
<p>For application registering basics in Azure AD, refer to the <a class="reference external" href="https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-overview">Azure AD Identity Platform (v2)</a> overview.</p>
</section>
<section id="ldap-authentication">
<h4><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">21.2. </span>LDAP Authentication</a><a class="headerlink" href="#ldap-authentication" title="Link to this heading"></a></h4>
<p>Refer to the <a class="reference internal" href="index.html#ag-auth-ldap"><span class="std std-ref">Setting up LDAP Authentication</span></a> section.</p>
</section>
<section id="radius-settings">
<span id="ag-auth-radius"></span><h4><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">21.3. </span>RADIUS settings</a><a class="headerlink" href="#radius-settings" title="Link to this heading"></a></h4>
<p id="index-2">AWX can be configured to centrally use RADIUS as a source for authentication information.</p>
<ol class="arabic simple">
<li><p>Click <strong>Settings</strong> from the left navigation bar.</p></li>
<li><p>On the left side of the Settings window, click <strong>RADIUS settings</strong> from the list of Authentication options.</p></li>
<li><p>Click <strong>Edit</strong> and enter the Host or IP of the Radius server in the <strong>Radius Server</strong> field. If this field is left blank, Radius authentication is disabled.</p></li>
<li><p>Enter the port and secret information in the next two fields.</p></li>
<li><p>Click <strong>Save</strong> when done.</p></li>
</ol>
</section>
<section id="saml-settings">
<span id="ag-auth-saml"></span><h4><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">21.4. </span>SAML settings</a><a class="headerlink" href="#saml-settings" title="Link to this heading"></a></h4>
<p id="index-3">SAML allows the exchange of authentication and authorization data between an Identity Provider (IdP - a system of servers that provide the Single Sign On service) and a Service Provider (in this case, AWX). AWX can be configured to talk with SAML in order to authenticate (create/login/logout) AWX users. User Team and Organization membership can be embedded in the SAML response to AWX.</p>
<img alt="Diagram depicting SAML topology for AWX." src="_images/configure-awx-auth-saml-topology.png" />
<p>The following instructions describe AWX as the service provider.</p>
<p>To setup SAML authentication:</p>
<ol class="arabic simple">
<li><p>Click <strong>Settings</strong> from the left navigation bar.</p></li>
<li><p>On the left side of the Settings window, click <strong>SAML settings</strong> from the list of Authentication options.</p></li>
<li><p>The <strong>SAML Assertion Consume Service (ACS) URL</strong> and <strong>SAML Service Provider Metadata URL</strong> fields are pre-populated and are non-editable. Contact the Identity Provider administrator and provide the information contained in these fields.</p></li>
<li><p>Click <strong>Edit</strong> and set the <strong>SAML Service Provider Entity ID</strong> to be the same as the <strong>Base URL of the service</strong> field that can be found in the Miscellaneous System settings screen by clicking <strong>Settings</strong> from the left navigation bar. Through the API, it can be viewed in the <code class="docutils literal notranslate"><span class="pre">/api/v2/settings/system</span></code>, under the <code class="docutils literal notranslate"><span class="pre">TOWER_URL_BASE</span></code> variable. The Entity ID can be set to any one of the individual AWX cluster nodes, but it is good practice to set it to the URL of the Service Provider. Ensure that the Base URL matches the FQDN of the load balancer (if used).</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Base URL is different for each node in a cluster. Commonly, a load balancer will sit in front of many AWX cluster nodes to provide a single entry point, the AWX Cluster FQDN. The SAML Service Provider must be able establish an outbound connection and route to the AWX Cluster Node or the AWX Cluster FQDN set in the SAML Service Provider Entity ID.</p>
</div>
<p>In this example, the Service Provider is the AWX cluster, and therefore, the ID is set to the AWX Cluster FQDN.</p>
<img alt="Configuring SAML Service Provider Entity ID in AWX." src="_images/configure-awx-auth-saml-spentityid.png" />
<ol class="arabic simple" start="5">
<li><p>Create a server certificate for the Ansible cluster. Typically when an Ansible cluster is configured, AWX nodes will be configured to handle HTTP traffic only and the load balancer will be an SSL Termination Point. In this case, an SSL certificate is required for the load balancer, and not for the individual AWX Cluster Nodes. SSL can either be enabled or disabled per individual AWX node, but should be disabled when using an SSL terminated load balancer. It is recommended to use a non-expiring self signed certificate to avoid periodically updating certificates. This way, authentication will not fail in case someone forgets to update the certificate.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <strong>SAML Service Provider Public Certificate</strong> field should contain the entire certificate, including the “—–BEGIN CERTIFICATE—–” and “—–END CERTIFICATE—–“.</p>
</div>
<p>If you are using a CA bundle with your certificate, include the entire bundle in this field.</p>
<img alt="Configuring SAML Service Provider Public Certificate in AWX." src="_images/configure-awx-auth-saml-cert.png" />
<p>As an example for public certs:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">-----BEGIN CERTIFICATE——</span>
<span class="nn">...</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cert text ...</span>
<span class="l l-Scalar l-Scalar-Plain">-----END CERTIFICATE——</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Create an optional private key for AWX to use as a service provider (SP) and enter it in the <strong>SAML Service Provider Private Key</strong> field.</p></li>
</ol>
<p>As an example for private keys:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">-----BEGIN PRIVATE KEY--</span>
<span class="nn">...</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">key text ...</span>
<span class="l l-Scalar l-Scalar-Plain">-----END PRIVATE KEY——</span>
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li><p>Provide the IdP with some details about the AWX cluster during the SSO process in the <strong>SAML Service Provider Organization Info</strong> field.</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w">  </span><span class="s">&quot;en-US&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">    </span><span class="s">&quot;url&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;http://www.example.com&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;displayname&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Example&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;example&quot;</span>
<span class="w">  </span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>For example:</p>
<img alt="Configuring SAML Organization information in AWX." src="_images/configure-awx-auth-saml-org-info.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These fields are required in order to properly configure SAML within AWX.</p>
</div>
<ol class="arabic simple" start="8">
<li><p>Provide the IdP with the technical contact information in the <strong>SAML Service Provider Technical Contact</strong> field. Do not remove the contents of this field.</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="s">&quot;givenName&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Some</span><span class="nv"> </span><span class="s">User&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;emailAddress&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;suser@example.com&quot;</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>For example:</p>
<img alt="Configuring SAML Technical Contact information in AWX." src="_images/configure-awx-auth-saml-techcontact-info.png" />
<ol class="arabic simple" start="9">
<li><p>Provide the IdP with the support contact information in the <strong>SAML Service Provider Support Contact</strong> field. Do not remove the contents of this field.</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="s">&quot;givenName&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Some</span><span class="nv"> </span><span class="s">User&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;emailAddress&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;suser@example.com&quot;</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>For example:</p>
<img alt="Configuring SAML Support Contact information in AWX." src="_images/configure-awx-auth-saml-suppcontact-info.png" />
<ol class="arabic simple" start="10">
<li><p>In the <strong>SAML Enabled Identity Providers</strong> field, provide information on how to connect to each Identity Provider listed. AWX expects the following SAML attributes in the example below:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">Username(urn:oid:0.9.2342.19200300.100.1.1)</span>
<span class="l l-Scalar l-Scalar-Plain">Email(urn:oid:0.9.2342.19200300.100.1.3)</span>
<span class="l l-Scalar l-Scalar-Plain">FirstName(urn:oid:2.5.4.42)</span>
<span class="l l-Scalar l-Scalar-Plain">LastName(urn:oid:2.5.4.4)</span>
</pre></div>
</div>
<p>If these attributes are not known, map existing SAML attributes to lastname, firstname, email and username.</p>
<p>Configure the required keys for each IDp:</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">attr_user_permanent_id</span></code> - the unique identifier for the user. It can be configured to match any of the attribute sent from the IdP. Usually, it is set to <code class="docutils literal notranslate"><span class="pre">name_id</span></code> if <code class="docutils literal notranslate"><span class="pre">SAML:nameid</span></code> attribute is sent to the AWX node or it can be the username attribute, or a custom unique identifier.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">entity_id</span></code> - the Entity ID provided by the Identity Provider administrator. The admin creates a SAML profile for AWX and it generates a unique URL.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">url</span></code> - the Single Sign On (SSO) URL AWX redirects the user to, when SSO is activated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x509_cert</span></code> - the certificate provided by the IdP admin generated from the SAML profile created on the Identity Provider. Remove the <code class="docutils literal notranslate"><span class="pre">--BEGIN</span> <span class="pre">CERTIFICATE--</span></code> and <code class="docutils literal notranslate"><span class="pre">--END</span> <span class="pre">CERTIFICATE--</span></code> headers, then enter the cert as one non-breaking string.</p></li>
</ul>
</div></blockquote>
<p>Multiple SAML IdPs are supported. Some IdPs may provide user data using attribute names that differ from the default OIDs (<a class="reference external" href="https://github.com/omab/python-social-auth/blob/master/social/backends/saml.py">https://github.com/omab/python-social-auth/blob/master/social/backends/saml.py</a>). The SAML <code class="docutils literal notranslate"><span class="pre">NameID</span></code> is a special attribute used by some Identity Providers to tell the Service Provider (AWX cluster) what the unique user identifier is. If it is used, set the <code class="docutils literal notranslate"><span class="pre">attr_user_permanent_id</span></code> to <code class="docutils literal notranslate"><span class="pre">name_id</span></code> as shown in the example. Other attribute names may be overridden for each IdP as shown below.</p>
</div></blockquote>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="s">&quot;myidp&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">  </span><span class="s">&quot;entity_id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;https://idp.example.com&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;url&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;https://myidp.example.com/sso&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;x509cert&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="p p-Indicator">},</span>
<span class="s">&quot;onelogin&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">  </span><span class="s">&quot;entity_id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;https://app.onelogin.com/saml/metadata/123456&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;url&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;https://example.onelogin.com/trust/saml2/http-post/sso/123456&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;x509cert&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;attr_user_permanent_id&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;name_id&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;attr_first_name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;User.FirstName&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;attr_last_name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;User.LastName&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;attr_username&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;User.email&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;attr_email&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;User.email&quot;</span>
<span class="w">  </span><span class="p p-Indicator">}</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<img alt="Configuring SAML Identity Providers (IdPs) in AWX." src="_images/configure-awx-auth-saml-idps.png" />
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not create a SAML user that shares the same email with another user (including a non-SAML user). Doing so will result in the accounts being merged. Be aware that this same behavior exists for System Admin users, thus a SAML login with the same email address as the System Admin user will login with System Admin privileges. For future reference, you can remove (or add) Admin Privileges based on SAML mappings, as described in subsequent steps.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The IdP provides the email, last name and firstname using the well known SAML urn. The IdP uses a custom SAML attribute to identify a user, which is an attribute that AWX is unable to read. Instead, AWX can understand the unique identifier name, which is the URN. Use the URN listed in the SAML “Name” attribute for the user attributes as shown in the example below.</p>
<img alt="Configuring SAML Identity Providers (IdPs) in AWX using URNs." src="_images/configure-awx-auth-saml-idps-urn.png" />
</div>
<ol class="arabic simple" start="11">
<li><p>Optionally provide the <strong>SAML Organization Map</strong>. For further detail, see <a class="reference internal" href="index.html#ag-org-team-maps"><span class="std std-ref">Organization and Team Mapping</span></a>.</p></li>
<li><p>AWX can be configured to look for particular attributes that contain Team and Organization membership to associate with users when they log into AWX. The attribute names are defined in the <strong>SAML Organization Attribute Mapping</strong> and the <strong>SAML Team Attribute Mapping</strong> fields.</p></li>
</ol>
<p><strong>Example SAML Organization Attribute Mapping</strong></p>
<p>Below is an example SAML attribute that embeds user organization membership in the attribute <em>member-of</em>.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">&lt;saml2:AttributeStatement&gt;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&lt;saml2:Attribute FriendlyName=&quot;member-of&quot; Name=&quot;member-of&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">NameFormat=&quot;urn:oasis:names:tc:SAML:2.0:attrname-format:unspecified&quot;&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">&lt;saml2:AttributeValue&gt;Engineering&lt;/saml2:AttributeValue&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">&lt;saml2:AttributeValue&gt;IT&lt;/saml2:AttributeValue&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">&lt;saml2:AttributeValue&gt;HR&lt;/saml2:AttributeValue&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">&lt;saml2:AttributeValue&gt;Sales&lt;/saml2:AttributeValue&gt;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&lt;/saml2:Attribute&gt;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&lt;saml2:Attribute FriendlyName=&quot;admin-of&quot; Name=&quot;admin-of&quot;</span>
<span class="l l-Scalar l-Scalar-Plain">NameFormat=&quot;urn:oasis:names:tc:SAML:2.0:attrname-format:unspecified&quot;&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">&lt;saml2:AttributeValue&gt;Engineering&lt;/saml2:AttributeValue&gt;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">&lt;/saml2:Attribute&gt;</span>
<span class="l l-Scalar l-Scalar-Plain">&lt;/saml2:AttributeStatement&gt;</span>
</pre></div>
</div>
<p>Below is the corresponding AWX configuration.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w">  </span><span class="s">&quot;saml_attr&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;member-of&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;saml_admin_attr&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;admin-of&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;remove&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;remove_admins&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">saml_attr</span></code>: is the SAML attribute name where the organization array can be found and <code class="docutils literal notranslate"><span class="pre">remove</span></code> is set to <strong>True</strong> to remove a user from all organizations before adding the user to the list of Organizations. To keep the user in whatever Organization(s) they are in while adding the user to the Organization(s) in the SAML attribute, set <code class="docutils literal notranslate"><span class="pre">remove</span></code> to <strong>False</strong>.</p>
<p><code class="docutils literal notranslate"><span class="pre">saml_admin_attr</span></code>: Similar to the <code class="docutils literal notranslate"><span class="pre">saml_attr</span></code> attribute, but instead of conveying organization membership, this attribute conveys admin organization permissions.</p>
<p><strong>Example SAML Team Attribute Mapping</strong></p>
<p>Below is another example of a SAML attribute that contains a Team membership in a list.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">&lt;saml:AttributeStatement&gt;</span>
<span class="w">     </span><span class="l l-Scalar l-Scalar-Plain">&lt;saml:Attribute</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">xmlns:x500=&quot;urn:oasis:names:tc:SAML:2.0:profiles:attribute:X500&quot;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">x500:Encoding=&quot;LDAP&quot;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">NameFormat=&quot;urn:oasis:names:tc:SAML:2.0:attrname-format:uri&quot;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">Name=&quot;urn:oid:1.3.6.1.4.1.5923.1.1.1.1&quot;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">FriendlyName=&quot;eduPersonAffiliation&quot;&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">&lt;saml:AttributeValue</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">xsi:type=&quot;xs:string&quot;&gt;member&lt;/saml:AttributeValue&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">&lt;saml:AttributeValue</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">xsi:type=&quot;xs:string&quot;&gt;staff&lt;/saml:AttributeValue&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">&lt;/saml:Attribute&gt;</span>
<span class="l l-Scalar l-Scalar-Plain">&lt;/saml:AttributeStatement&gt;</span>
</pre></div>
</div>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w">    </span><span class="s">&quot;saml_attr&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;eduPersonAffiliation&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;remove&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;team_org_map&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">    </span><span class="p p-Indicator">{</span>
<span class="w">        </span><span class="s">&quot;team&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;member&quot;</span><span class="p p-Indicator">,</span>
<span class="w">        </span><span class="s">&quot;organization&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Default1&quot;</span>
<span class="w">    </span><span class="p p-Indicator">},</span>
<span class="w">    </span><span class="p p-Indicator">{</span>
<span class="w">        </span><span class="s">&quot;team&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;staff&quot;</span><span class="p p-Indicator">,</span>
<span class="w">        </span><span class="s">&quot;organization&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Default2&quot;</span>
<span class="w">    </span><span class="p p-Indicator">}</span>
<span class="w">  </span><span class="p p-Indicator">]</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">saml_attr</span></code>: The SAML attribute name where the team array can be found.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove</span></code>: Set <code class="docutils literal notranslate"><span class="pre">remove</span></code> to <strong>True</strong> to remove user from all Teams before adding the user to the list of Teams. To keep the user in whatever Team(s) they are in while adding the user to the Team(s) in the SAML attribute, set <code class="docutils literal notranslate"><span class="pre">remove</span></code> to <strong>False</strong>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">team_org_map</span></code>: An array of dictionaries of the form <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">&quot;team&quot;:</span> <span class="pre">&quot;&lt;AWX</span> <span class="pre">Team</span> <span class="pre">Name&gt;&quot;,</span> <span class="pre">&quot;organization&quot;:</span> <span class="pre">&quot;&lt;AWX</span> <span class="pre">Org</span> <span class="pre">Name&gt;&quot;</span> <span class="pre">}</span></code> that defines mapping from AWX Team -&gt; AWX Organization. This is needed because the same named Team can exist in multiple Organizations in AWX. The organization to which a team listed in a SAML attribute belongs to, would be ambiguous without this mapping.</p></li>
</ul>
<p>You could create an alias to override both Teams and Orgs in the <strong>SAML Team Attribute Mapping</strong>. This option becomes very handy in cases when the SAML backend sends out complex group names, like in the example below:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w"> </span><span class="s">&quot;remove&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
<span class="w"> </span><span class="s">&quot;team_org_map&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">  </span><span class="p p-Indicator">{</span>
<span class="w">   </span><span class="s">&quot;team&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;internal:unix:domain:admins&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;organization&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Default&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;team_alias&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Administrators&quot;</span>
<span class="w">  </span><span class="p p-Indicator">},</span>
<span class="w">  </span><span class="p p-Indicator">{</span>
<span class="w">   </span><span class="s">&quot;team&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Domain</span><span class="nv"> </span><span class="s">Users&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;organization_alias&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;OrgAlias&quot;</span><span class="p p-Indicator">,</span>
<span class="w">   </span><span class="s">&quot;organization&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;Default&quot;</span>
<span class="w">  </span><span class="p p-Indicator">}</span>
<span class="w"> </span><span class="p p-Indicator">],</span>
<span class="w"> </span><span class="s">&quot;saml_attr&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;member-of&quot;</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Once the user authenticates, AWX creates organization and team aliases, as expected.</p>
<ol class="arabic simple" start="13">
<li><p>Optionally provide team membership mapping in the <strong>SAML Team Map</strong> field. For further detail, see <a class="reference internal" href="index.html#ag-org-team-maps"><span class="std std-ref">Organization and Team Mapping</span></a>.</p></li>
<li><p>Optionally provide security settings in the <strong>SAML Security Config</strong> field. This field is the equivalent to the <code class="docutils literal notranslate"><span class="pre">SOCIAL_AUTH_SAML_SECURITY_CONFIG</span></code> field in the API. Refer to the <a class="reference external" href="https://github.com/onelogin/python-saml#settings">OneLogin’s SAML Python Toolkit</a> for further detail.</p></li>
</ol>
<p>AWX uses the <code class="docutils literal notranslate"><span class="pre">python-social-auth</span></code> library when users log in through SAML. This library relies on the <code class="docutils literal notranslate"><span class="pre">python-saml</span></code> library to make available the settings for the next two optional fields, <strong>SAML Service Provider Extra Configuration Data</strong> and <strong>SAML IDP to EXTRA_DATA Attribute Mapping</strong>.</p>
<ol class="arabic simple" start="15">
<li><p>The <strong>SAML Service Provider Extra Configuration Data</strong> field is equivalent to the <code class="docutils literal notranslate"><span class="pre">SOCIAL_AUTH_SAML_SP_EXTRA</span></code> in the API. Refer to the <a class="reference external" href="https://github.com/onelogin/python-saml#settings">python-saml library documentation</a> to learn about the valid service provider extra (<code class="docutils literal notranslate"><span class="pre">SP_EXTRA</span></code>) parameters.</p></li>
</ol>
<ol class="arabic simple" start="16">
<li><p>The <strong>SAML IDP to EXTRA_DATA Attribute Mapping</strong> field is equivalent to the <code class="docutils literal notranslate"><span class="pre">SOCIAL_AUTH_SAML_EXTRA_DATA</span></code> in the API.  See Python’s <a class="reference external" href="https://python-social-auth.readthedocs.io/en/latest/backends/saml.html#advanced-settings">SAML Advanced Settings</a> documentation for more information.</p></li>
</ol>
<ol class="arabic simple" id="ag-auth-saml-user-flags-attr-map" start="17">
<li><p>The <strong>SAML User Flags Attribute Mapping</strong> field allows you to map SAML roles and attributes to special user flags. The following attributes are valid in this field:</p></li>
</ol>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">is_superuser_role</span></code>: Specifies one or more SAML roles which will grant a user the superuser flag</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_superuser_attr</span></code>: Specifies a SAML attribute which will grant a user the superuser flag</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_superuser_value</span></code>: Specifies one or more values required for <code class="docutils literal notranslate"><span class="pre">is_superuser_attr</span></code> that is required for the user to be a superuser</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove_superusers</span></code>: Boolean indicating if the superuser flag should be removed for users or not. Defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>. (See below for more details)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_system_auditor_role</span></code>: Specifies one or more SAML roles which will grant a user the system auditor flag</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_system_auditor_attr</span></code>: Specifies a SAML attribute which will grant a user the system auditor flag</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_system_auditor_value</span></code>: Specifies one or more values required for <code class="docutils literal notranslate"><span class="pre">is_system_auditor_attr</span></code> that is required for the user to be a system auditor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove_system_auditors</span></code>: Boolean indicating if the system_auditor flag should be removed for users or not. Defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>. (See below for more details)</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">role</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code> fields are lists and are <cite>or</cite> logic. So if you specify two roles: <cite>[ “Role 1”, “Role 2” ]</cite> and the SAML user has either role the logic will consider them to have the required role for the flag. This is the same with the <code class="docutils literal notranslate"><span class="pre">value</span></code> field, if you specify: <cite>[ “Value 1”, “Value 2”]</cite> and the SAML user has either value for their attribute the logic will consider their attribute value to have matched.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">role</span></code> and <code class="docutils literal notranslate"><span class="pre">attr</span></code> are both specified for either <code class="docutils literal notranslate"><span class="pre">superuser</span></code> or <code class="docutils literal notranslate"><span class="pre">system_auditor</span></code>, the settings for <code class="docutils literal notranslate"><span class="pre">attr</span></code> will take precedence over a <code class="docutils literal notranslate"><span class="pre">role</span></code>.  System Admin and System Auditor roles are evaluated at login for a SAML user. If you grant a SAML user one of these roles through the UI and not through the SAML settings, the roles will be removed on the user’s next login unless the <code class="docutils literal notranslate"><span class="pre">remove</span></code> flag is set to false. The remove flag, if <code class="docutils literal notranslate"><span class="pre">false</span></code>, will never allow the SAML adapter to remove the corresponding flag from a user.  The following table describes how the logic works.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Has one or more roles</p></th>
<th class="head"><p>Has Attr</p></th>
<th class="head"><p>Has one or more Attr Values</p></th>
<th class="head"><p>Remove Flag</p></th>
<th class="head"><p>Previous Flag</p></th>
<th class="head"><p>Is Flagged</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>No</p></td>
<td><p>No</p></td>
<td><p>N/A</p></td>
<td><p>True</p></td>
<td><p>False</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>No</p></td>
<td><p>No</p></td>
<td><p>N/A</p></td>
<td><p>False</p></td>
<td><p>False</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>No</p></td>
<td><p>No</p></td>
<td><p>N/A</p></td>
<td><p>True</p></td>
<td><p>True</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>No</p></td>
<td><p>No</p></td>
<td><p>N/A</p></td>
<td><p>False</p></td>
<td><p>True</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>N/A</p></td>
<td><p>True</p></td>
<td><p>False</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>N/A</p></td>
<td><p>False</p></td>
<td><p>False</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>N/A</p></td>
<td><p>True</p></td>
<td><p>True</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>N/A</p></td>
<td><p>False</p></td>
<td><p>True</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>True</p></td>
<td><p>False</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>False</p></td>
<td><p>False</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>True</p></td>
<td><p>True</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>False</p></td>
<td><p>True</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>True</p></td>
<td><p>False</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>False</p></td>
<td><p>False</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>True</p></td>
<td><p>True</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>False</p></td>
<td><p>True</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Unset</p></td>
<td><p>True</p></td>
<td><p>False</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Unset</p></td>
<td><p>False</p></td>
<td><p>False</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Unset</p></td>
<td><p>True</p></td>
<td><p>True</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>Unset</p></td>
<td><p>False</p></td>
<td><p>True</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>True</p></td>
<td><p>False</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>False</p></td>
<td><p>False</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>True</p></td>
<td><p>True</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>False</p></td>
<td><p>True</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>True</p></td>
<td><p>False</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>False</p></td>
<td><p>False</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>True</p></td>
<td><p>True</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>False</p></td>
<td><p>True</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Unset</p></td>
<td><p>True</p></td>
<td><p>False</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Unset</p></td>
<td><p>False</p></td>
<td><p>False</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Unset</p></td>
<td><p>True</p></td>
<td><p>True</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Unset</p></td>
<td><p>False</p></td>
<td><p>True</p></td>
<td><p>Yes</p></td>
</tr>
</tbody>
</table>
<p>Each time a SAML user authenticates to AWX, these checks will be performed and the user flags will be altered as needed. If <code class="docutils literal notranslate"><span class="pre">System</span> <span class="pre">Administrator</span></code> or <code class="docutils literal notranslate"><span class="pre">System</span> <span class="pre">Auditor</span></code> is set for a SAML user within the UI, the SAML adapter will override the UI setting based on the rules above. If you would prefer that the user flags for SAML users do not get removed when a SAML user logs in, you can set the <code class="docutils literal notranslate"><span class="pre">remove_</span></code> flag to <code class="docutils literal notranslate"><span class="pre">false</span></code>. With the remove flag set to <code class="docutils literal notranslate"><span class="pre">false</span></code>, a user flag set to <code class="docutils literal notranslate"><span class="pre">true</span></code> through either the UI, API or SAML adapter will not be removed. However, if a user does not have the flag, and the above rules determine the flag should be added, it will be added, even if the flag is <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
<p>Example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w">    </span><span class="s">&quot;is_superuser_attr&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;blueGroups&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;is_superuser_role&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;is_superuser&quot;</span><span class="p p-Indicator">],</span>
<span class="w">    </span><span class="s">&quot;is_superuser_value&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;cn=My-Sys-Admins,ou=memberlist,ou=mygroups,o=myco.com&quot;</span><span class="p p-Indicator">],</span>
<span class="w">    </span><span class="s">&quot;is_system_auditor_attr&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;blueGroups&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;is_system_auditor_role&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;is_system_auditor&quot;</span><span class="p p-Indicator">],</span>
<span class="w">    </span><span class="s">&quot;is_system_auditor_value&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;cn=My-Auditors,ou=memberlist,ou=mygroups,o=myco.com&quot;</span><span class="p p-Indicator">]</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<ol class="arabic" start="18">
<li><p>Click <strong>Save</strong> when done.</p></li>
<li><p>To verify that the authentication was configured correctly, load the auto-generated URL found in the <strong>SAML Service Provider Metadata URL</strong> into a browser. It should output XML output, otherwise, it is not configured correctly.</p>
<p>Alternatively,  logout of AWX and the login screen will now display the SAML logo to indicate it as a alternate method of logging into AWX.</p>
<img alt="AWX login screen displaying the SAML logo for authentication." src="_images/configure-awx-auth-saml-logo.png" />
</li>
</ol>
<section id="transparent-saml-logins">
<h5><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">21.4.1. </span>Transparent SAML Logins</a><a class="headerlink" href="#transparent-saml-logins" title="Link to this heading"></a></h5>
<p id="index-4">For transparent logins to work, you must first get IdP-initiated logins to work. To achieve this:</p>
<ol class="arabic simple">
<li><p>Set the <code class="docutils literal notranslate"><span class="pre">RelayState</span></code> on the IdP to the key of the IdP definition in the <code class="docutils literal notranslate"><span class="pre">SAML</span> <span class="pre">Enabled</span> <span class="pre">Identity</span> <span class="pre">Providers</span></code> field as previously described. In the example given above, <code class="docutils literal notranslate"><span class="pre">RelayState</span></code> would need to be either <code class="docutils literal notranslate"><span class="pre">myidp</span></code> or <code class="docutils literal notranslate"><span class="pre">onelogin</span></code>.</p></li>
<li><p>Once this is working, specify the redirect URL for non-logged-in users to somewhere other than the default AWX login page by using the <strong>Login redirect override URL</strong> field in the Miscellaneous Authentication settings window of the <strong>Settings</strong> menu, accessible from the left navigation bar. This should be set to <code class="docutils literal notranslate"><span class="pre">/sso/login/saml/?idp=&lt;name-of-your-idp&gt;</span></code> for transparent SAML login, as shown in the example.</p></li>
</ol>
<img alt="Configuring the login redirect URL in AWX Miscellaneous Authentication Settings." src="_images/configure-awx-system-login-redirect-url.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The above is a sample of a typical IdP format, but may not be the correct format for your particular case. You may need to reach out to your IdP for the correct transparent redirect URL as that URL is not the same for all IdPs.</p>
</div>
<ol class="arabic simple" start="3">
<li><p>After transparent SAML login is configured, to log in using local credentials or a different SSO, go directly to <code class="docutils literal notranslate"><span class="pre">https://&lt;your-awx-server&gt;/login</span></code>.  This provides the standard AWX login page, including SSO authentication buttons, and allows you to log in with any configured method.</p></li>
</ol>
</section>
<section id="enabling-logging-for-saml">
<h5><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">21.4.2. </span>Enabling Logging for SAML</a><a class="headerlink" href="#enabling-logging-for-saml" title="Link to this heading"></a></h5>
<p>You can enable logging messages for the SAML adapter the same way you can enable logging for LDAP. Refer to the <a class="reference internal" href="index.html#ldap-logging"><span class="std std-ref">Enabling Logging for LDAP</span></a> section.</p>
</section>
</section>
<section id="tacacs-settings">
<span id="ag-auth-tacacs"></span><h4><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">21.5. </span>TACACS+ settings</a><a class="headerlink" href="#tacacs-settings" title="Link to this heading"></a></h4>
<p id="index-5">Terminal Access Controller Access-Control System Plus (TACACS+) is a protocol that handles remote authentication and related services for networked access control through a centralized server. In particular, TACACS+ provides authentication, authorization and accounting (AAA) services, in which you can configure AWX to use as a source for authentication.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This feature is deprecated and will be removed in a future release.</p>
</div>
<ol class="arabic simple">
<li><p>Click <strong>Settings</strong> from the left navigation bar.</p></li>
<li><p>On the left side of the Settings window, click <strong>TACACs+ settings</strong> from the list of Authentication options.</p></li>
<li><p>Click <strong>Edit</strong> and enter information in the following fields:</p></li>
</ol>
<ul class="simple">
<li><p><strong>TACACS+ Server</strong>: Provide the hostname or IP address of the TACACS+ server with which to authenticate. If this field is left blank, TACACS+ authentication is disabled.</p></li>
<li><p><strong>TACACS+ Port</strong>: TACACS+ uses port 49 by default, which is already pre-populated.</p></li>
<li><p><strong>TACACS+ Secret</strong>: Secret key for TACACS+ authentication server.</p></li>
<li><p><strong>TACACS+ Auth Session Timeout</strong>: Session timeout value in seconds. The default is 5 seconds.</p></li>
<li><p><strong>TACACS+ Authentication Protocol</strong>: The protocol used by TACACS+ client. Options are <strong>ascii</strong> or <strong>pap</strong>.</p></li>
</ul>
<img alt="TACACS+ configuration details in AWX settings." src="_images/configure-awx-auth-tacacs.png" />
<ol class="arabic simple" start="4">
<li><p>Click <strong>Save</strong> when done.</p></li>
</ol>
</section>
<section id="generic-oidc-settings">
<span id="ag-auth-oidc"></span><h4><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">21.6. </span>Generic OIDC settings</a><a class="headerlink" href="#generic-oidc-settings" title="Link to this heading"></a></h4>
<p>Similar to SAML, OpenID Connect (OIDC) is uses the OAuth 2.0 framework. It allows third-party applications to verify the identity and obtain basic end-user information. The main difference between OIDC and SAML is that SAML has a service provider (SP)-to-IdP trust relationship, whereas OIDC establishes the trust with the channel (HTTPS) that is used to obtain the security token. To obtain the credentials needed to setup OIDC with AWX, refer to the documentation from the identity provider (IdP) of your choice that has OIDC support.</p>
<p>To configure OIDC in AWX:</p>
<ol class="arabic simple">
<li><p>Click <strong>Settings</strong> from the left navigation bar.</p></li>
<li><p>On the left side of the Settings window, click <strong>Generic OIDC settings</strong> from the list of Authentication options.</p></li>
<li><p>Click <strong>Edit</strong> and enter information in the following fields:</p></li>
</ol>
<ul class="simple">
<li><p><strong>OIDC Key</strong>: Client ID from your 3rd-party IdP.</p></li>
<li><p><strong>OIDC Secret</strong>: Client Secret from your IdP.</p></li>
<li><p><strong>OIDC Provider URL</strong>: URL for your OIDC provider.</p></li>
<li><p><strong>Verify OIDC Provider Certificate</strong>: Use the toggle to enable/disable the OIDC provider SSL certificate verification.</p></li>
</ul>
<p>The example below shows specific values associated to GitHub as the generic IdP:</p>
<blockquote>
<div><img alt="OpenID Connect (OIDC) configuration details in AWX settings." src="_images/configure-awx-auth-oidc.png" />
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Click <strong>Save</strong> when done.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is currently no support for team and organization mappings for OIDC at this time. The OIDC adapter does authentication only and not authorization. In other words, it is only capable of authenticating whether this user is who they say they are, not authorizing what this user is allowed to do. Configuring generic OIDC creates the UserID appended with an ID/key to differentiate the same user ID originating from two different sources and therefore, considered different users. So one will get an ID of just the user name and the second will be the <code class="docutils literal notranslate"><span class="pre">username-&lt;random</span> <span class="pre">number&gt;</span></code>.</p>
</div>
<ol class="arabic simple" start="5">
<li><p>To verify that the authentication was configured correctly, logout of AWX and the login screen will now display the OIDC logo to indicate it as a alternate method of logging into AWX.</p></li>
</ol>
<blockquote>
<div><img alt="AWX login screen displaying the OpenID Connect (OIDC) logo for authentication." src="_images/configure-awx-auth-oidc-logo.png" />
</div></blockquote>
</section>
</section>
<span id="document-administration/ldap_auth"></span><section id="setting-up-ldap-authentication">
<span id="ag-auth-ldap"></span><h3><span class="section-number">22. </span>Setting up LDAP Authentication<a class="headerlink" href="#setting-up-ldap-authentication" title="Link to this heading"></a></h3>
<p id="index-0">This chapter describes how to integrate LDAP authentication with AWX.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the LDAP server you want to connect to has a certificate that is self-signed or signed by a corporate internal certificate authority (CA), the CA certificate must be added to the system’s trusted CAs. Otherwise, connection to the LDAP server will result in an error that the certificate issuer is not recognized.</p>
</div>
<p>Administrators use LDAP as a source for account authentication information for AWX users. User authentication is provided, but not the synchronization of user permissions and credentials. Organization membership (as well as the organization admin) and team memberships can be synchronized.</p>
<p>When so configured, a user who logs in with an LDAP username and password automatically gets an AWX account created for them and they can be automatically placed into organizations as either regular users or organization administrators.</p>
<p>Users created locally in the user interface, take precedence over those logging into controller for their first time with an alternative authentication solution. You must delete the local user if you want to re-use it with another authentication method, such as LDAP.</p>
<p>Users created through an LDAP login cannot change their username, given name, surname, or set a local password for themselves. You can also configure this to restrict editing of other field names.</p>
<p>To configure LDAP integration for AWX:</p>
<ol class="arabic simple">
<li><p>First, create a user in LDAP that has access to read the entire LDAP structure.</p></li>
<li><p>Test if you can make successful queries to the LDAP server, use the <code class="docutils literal notranslate"><span class="pre">ldapsearch</span></code> command, which is a command line tool that can be installed on AWX command line as well as on other Linux and OSX systems. Use the following command to query the ldap server, where <em>josie</em> and <em>Josie4Cloud</em> are replaced by attributes that work for your setup:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ldapsearch -x  -H ldap://win -D &quot;CN=josie,CN=Users,DC=website,DC=com&quot; -b &quot;dc=website,dc=com&quot; -w Josie4Cloud</span>
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">CN=josie,CN=users,DC=website,DC=com</span></code> is the Distinguished Name of the connecting user.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ldapsearch</span></code> utility is not automatically pre-installed with AWX, however, you can install it from the <code class="docutils literal notranslate"><span class="pre">openldap-clients</span></code> package.</p>
</div>
<ol class="arabic simple" start="3">
<li><p>In the AWX User Interface, click <strong>Settings</strong> from the left navigation and click to select <strong>LDAP settings</strong> from the list of Authentication options.</p></li>
</ol>
<blockquote>
<div><p>Multiple LDAP configurations are not needed per LDAP server, but you can configure multiple LDAP servers from this page, otherwise, leave the server at <strong>Default</strong>:</p>
<img alt="_images/configure-awx-auth-ldap-servers.png" src="_images/configure-awx-auth-ldap-servers.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The equivalent API endpoints will show <code class="docutils literal notranslate"><span class="pre">AUTH_LDAP_*</span></code> repeated: <code class="docutils literal notranslate"><span class="pre">AUTH_LDAP_1_*</span></code>, <code class="docutils literal notranslate"><span class="pre">AUTH_LDAP_2_*</span></code>, …, <code class="docutils literal notranslate"><span class="pre">AUTH_LDAP_5_*</span></code> to denote server designations.</p>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>To enter or modify the LDAP server address to connect to, click <strong>Edit</strong> and enter  in the <strong>LDAP Server URI</strong> field using the same format as the one prepopulated in the text field:</p></li>
</ol>
<img alt="_images/configure-awx-auth-ldap-server-uri.png" src="_images/configure-awx-auth-ldap-server-uri.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Multiple LDAP servers may be specified by separating each with spaces or commas. Click the <img alt="help" src="_images/tooltips-icon.png" /> icon to comply with proper syntax and rules.</p>
</div>
<ol class="arabic simple" start="5">
<li><p>Enter the password to use for the Binding user in the <strong>LDAP Bind Password</strong> text field. In this example, the password is ‘passme’:</p></li>
</ol>
<img alt="_images/configure-awx-auth-ldap-bind-pwd.png" src="_images/configure-awx-auth-ldap-bind-pwd.png" />
<ol class="arabic simple" start="6">
<li><p>Click to select a group type from the <strong>LDAP Group Type</strong> drop-down menu list.</p></li>
</ol>
<blockquote>
<div><p>LDAP Group Types include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PosixGroupType</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GroupOfNamesType</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GroupOfUniqueNamesType</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ActiveDirectoryGroupType</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OrganizationalRoleGroupType</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MemberDNGroupType</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NISGroupType</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NestedGroupOfNamesType</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NestedGroupOfUniqueNamesType</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NestedActiveDirectoryGroupType</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NestedOrganizationalRoleGroupType</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NestedMemberDNGroupType</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PosixUIDGroupType</span></code></p></li>
</ul>
<p>The LDAP Group Types that are supported by leveraging the underlying <a class="reference external" href="https://django-auth-ldap.readthedocs.io/en/latest/groups.html#types-of-groups">django-auth-ldap library</a>. To specify the parameters for the selected group type, see <a class="reference internal" href="#ldap-grp-params"><span class="std std-ref">Step 15</span></a> below.</p>
</div></blockquote>
<ol class="arabic simple" start="7">
<li><p>The <strong>LDAP Start TLS</strong> is disabled by default. To enable TLS when the LDAP connection is not using SSL/TLS, click the toggle to <strong>ON</strong>.</p></li>
</ol>
<img alt="_images/configure-awx-auth-ldap-start-tls.png" src="_images/configure-awx-auth-ldap-start-tls.png" />
<ol class="arabic simple" start="8">
<li><p>Enter the Distinguished Name in the <strong>LDAP Bind DN</strong> text field to specify the user that AWX uses to connect (Bind) to the LDAP server. Below uses the example, <code class="docutils literal notranslate"><span class="pre">CN=josie,CN=users,DC=website,DC=com</span></code>:</p></li>
</ol>
<img alt="_images/configure-awx-auth-ldap-bind-dn.png" src="_images/configure-awx-auth-ldap-bind-dn.png" />
<ol class="arabic simple" start="9">
<li><p>If that name is stored in key <code class="docutils literal notranslate"><span class="pre">sAMAccountName</span></code>, the <strong>LDAP User DN Template</strong> populates with <code class="docutils literal notranslate"><span class="pre">(sAMAccountName=%(user)s)</span></code>. Active Directory stores the username to <code class="docutils literal notranslate"><span class="pre">sAMAccountName</span></code>. Similarly, for OpenLDAP, the key is <code class="docutils literal notranslate"><span class="pre">uid</span></code>–hence the line becomes <code class="docutils literal notranslate"><span class="pre">(uid=%(user)s)</span></code>.</p></li>
<li><p>Enter the group distinguish name to allow users within that group to access AWX in the <strong>LDAP Require Group</strong> field, using the same format as the one shown in the text field, <code class="docutils literal notranslate"><span class="pre">CN=awx</span> <span class="pre">Users,OU=Users,DC=website,DC=com</span></code>.</p></li>
</ol>
<img alt="_images/configure-awx-auth-ldap-req-group.png" src="_images/configure-awx-auth-ldap-req-group.png" />
<ol class="arabic simple" start="11">
<li><p>Enter the group distinguish name to prevent users within that group to access AWX in the <strong>LDAP Deny Group</strong> field, using the same format as the one shown in the text field. In this example, leave the field blank.</p></li>
<li><p>Enter where to search for users while authenticating in the <strong>LDAP User Search</strong> field using the same format as the one shown in the text field. In this example, use:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span>
<span class="s">&quot;OU=Users,DC=website,DC=com&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;SCOPE_SUBTREE&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;(cn=%(user)s)&quot;</span>
<span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>The first line specifies where to search for users in the LDAP tree. In the above example, the users are searched recursively starting from <code class="docutils literal notranslate"><span class="pre">DC=website,DC=com</span></code>.</p>
<p>The second line specifies the scope where the users should be searched:</p>
<blockquote>
<div><ul class="simple">
<li><p>SCOPE_BASE:  This value is used to indicate searching only the entry at the base DN, resulting in only that entry being returned</p></li>
<li><p>SCOPE_ONELEVEL:  This value is used to indicate searching all entries one level under the base DN - but not including the base DN and not including any entries under that one level under the base DN.</p></li>
<li><p>SCOPE_SUBTREE: This value is used to indicate searching of all entries at all levels under and including the specified base DN.</p></li>
</ul>
</div></blockquote>
<p>The third line specifies the key name where the user name is stored.</p>
<img alt="_images/configure-awx-authen-ldap-user-search.png" src="_images/configure-awx-authen-ldap-user-search.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For multiple search queries, the proper syntax is:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span>
<span class="w">  </span><span class="p p-Indicator">[</span>
<span class="w">  </span><span class="s">&quot;OU=Users,DC=northamerica,DC=acme,DC=com&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;SCOPE_SUBTREE&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;(sAMAccountName=%(user)s)&quot;</span>
<span class="w">  </span><span class="p p-Indicator">],</span>
<span class="w">  </span><span class="p p-Indicator">[</span>
<span class="w">  </span><span class="s">&quot;OU=Users,DC=apac,DC=corp,DC=com&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;SCOPE_SUBTREE&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;(sAMAccountName=%(user)s)&quot;</span>
<span class="w">  </span><span class="p p-Indicator">],</span>
<span class="w">  </span><span class="p p-Indicator">[</span>
<span class="w">  </span><span class="s">&quot;OU=Users,DC=emea,DC=corp,DC=com&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;SCOPE_SUBTREE&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;(sAMAccountName=%(user)s)&quot;</span>
<span class="w">  </span><span class="p p-Indicator">]</span>
<span class="p p-Indicator">]</span>
</pre></div>
</div>
</div>
<ol class="arabic simple" start="13">
<li><p>In the <strong>LDAP Group Search</strong> text field, specify which groups should be searched and how to search them. In this example, use:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="s">&quot;dc=example,dc=com&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;SCOPE_SUBTREE&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;(objectClass=group)&quot;</span>
<span class="w"> </span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The first line specifies the BASE DN where the groups should be searched.</p></li>
<li><p>The second lines specifies the scope and is the same as that for the user directive.</p></li>
<li><p>The third line specifies what the <code class="docutils literal notranslate"><span class="pre">objectclass</span></code> of a group object is in the LDAP you are using.</p></li>
</ul>
<img alt="_images/configure-awx-authen-ldap-group-search.png" src="_images/configure-awx-authen-ldap-group-search.png" />
<ol class="arabic simple" start="14">
<li><p>Enter the user attributes in the <strong>LDAP User Attribute Map</strong> the text field. In this example, use:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="s">&quot;first_name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;givenName&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;last_name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;sn&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;email&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;mail&quot;</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>The above example retrieves users by last name from the key <code class="docutils literal notranslate"><span class="pre">sn</span></code>. You can use the same LDAP query for the user to figure out what keys they are stored under.</p>
<img alt="_images/configure-awx-auth-ldap-user-attrb-map.png" src="_images/configure-awx-auth-ldap-user-attrb-map.png" />
<ol class="arabic simple" id="ldap-grp-params" start="15">
<li><p>Depending on the selected <strong>LDAP Group Type</strong>, different parameters are available in the <strong>LDAP Group Type Parameters</strong> field to account for this. <code class="docutils literal notranslate"><span class="pre">LDAP_GROUP_TYPE_PARAMS</span></code> is a dictionary, which will be converted by AWX to kwargs and passed to the LDAP Group Type class selected. There are two common parameters used by any of the LDAP Group Type; <code class="docutils literal notranslate"><span class="pre">name_attr</span></code> and <code class="docutils literal notranslate"><span class="pre">member_attr</span></code>. Where <code class="docutils literal notranslate"><span class="pre">name_attr</span></code> defaults to <code class="docutils literal notranslate"><span class="pre">cn</span></code> and <code class="docutils literal notranslate"><span class="pre">member_attr</span></code> defaults to <code class="docutils literal notranslate"><span class="pre">member</span></code>:</p></li>
</ol>
<blockquote>
<div><div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span><span class="s">&quot;name_attr&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;cn&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;member_attr&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;member&quot;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>To determine what parameters a specific LDAP Group Type expects. refer to the <a class="reference external" href="https://django-auth-ldap.readthedocs.io/en/latest/reference.html#django_auth_ldap.config.LDAPGroupType">django_auth_ldap</a> documentation around the classes <code class="docutils literal notranslate"><span class="pre">init</span></code> parameters.</p>
</div></blockquote>
<ol class="arabic simple" start="16">
<li><p>Enter the user profile flags in the <strong>LDAP User Flags by Group</strong> the text field. In this example, use the following syntax to set LDAP users as “Superusers” and “Auditors”:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="s">&quot;is_superuser&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;cn=superusers,ou=groups,dc=website,dc=com&quot;</span><span class="p p-Indicator">,</span>
<span class="s">&quot;is_system_auditor&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;cn=auditors,ou=groups,dc=website,dc=com&quot;</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>The above example retrieves users who are flagged as superusers or as auditor in their profile.</p>
<img alt="_images/configure-awx-auth-ldap-user-flags.png" src="_images/configure-awx-auth-ldap-user-flags.png" />
<ol class="arabic simple" start="17">
<li><p>For details on completing the mapping fields, see <a class="reference internal" href="#ag-ldap-org-team-maps"><span class="std std-ref">LDAP Organization and Team Mapping</span></a>.</p></li>
</ol>
<img alt="_images/configure-ldap-orgs-teams-mapping.png" src="_images/configure-ldap-orgs-teams-mapping.png" />
<ol class="arabic simple" start="18">
<li><p>Click <strong>Save</strong> when done.</p></li>
</ol>
<p>With these values entered on this form, you can now make a successful authentication with LDAP.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>AWX does not actively sync users, but they are created during their initial login.
To improve performance associated with LDAP authentication, see <a class="reference internal" href="#ldap-auth-perf-tips"><span class="std std-ref">LDAP authentication performance tips</span></a> at the end of this chapter.</p>
</div>
<section id="ldap-organization-and-team-mapping">
<span id="ag-ldap-org-team-maps"></span><h4><span class="section-number">22.1. </span>LDAP Organization and Team Mapping<a class="headerlink" href="#ldap-organization-and-team-mapping" title="Link to this heading"></a></h4>
<p id="index-1">You can control which users are placed into which organizations based on LDAP attributes (mapping out between your organization admins/users and LDAP groups).</p>
<p>Keys are organization names. Organizations will be created if not present. Values are dictionaries defining the options for each organization’s membership. For each organization, it is possible to specify what groups are automatically users of the organization and also what groups can administer the organization.</p>
<dl class="simple">
<dt><strong>admins</strong>: None, True/False, string or list/tuple of strings.</dt><dd><ul class="simple">
<li><p>If <strong>None</strong>, organization admins will not be updated based on LDAP values.</p></li>
<li><p>If <strong>True</strong>, all users in LDAP will automatically be added as admins of the organization.</p></li>
<li><p>If <strong>False</strong>, no LDAP users will be automatically added as admins of the organization.</p></li>
<li><p>If a string or list of strings, specifies the group DN(s) that will be added of the organization if they match any of the specified groups.</p></li>
</ul>
</dd>
<dt><strong>remove_admins</strong>: True/False. Defaults to <strong>False</strong>.</dt><dd><ul class="simple">
<li><p>When <strong>True</strong>, a user who is not an member of the given groups will be removed from the organization’s administrative list.</p></li>
</ul>
</dd>
</dl>
<p><strong>users</strong>: None, True/False, string or list/tuple of strings. Same rules apply as for <strong>admins</strong>.</p>
<p><strong>remove_users</strong>: True/False. Defaults to <strong>False</strong>. Same rules apply as <strong>remove_admins</strong>.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="s">&quot;LDAP</span><span class="nv"> </span><span class="s">Organization&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">  </span><span class="s">&quot;admins&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;cn=engineering_admins,ou=groups,dc=example,dc=com&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;remove_admins&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;users&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">    </span><span class="s">&quot;cn=engineering,ou=groups,dc=example,dc=com&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;cn=sales,ou=groups,dc=example,dc=com&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="s">&quot;cn=it,ou=groups,dc=example,dc=com&quot;</span>
<span class="w">  </span><span class="p p-Indicator">],</span>
<span class="w">  </span><span class="s">&quot;remove_users&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
<span class="p p-Indicator">},</span>
<span class="s">&quot;LDAP</span><span class="nv"> </span><span class="s">Organization</span><span class="nv"> </span><span class="s">2&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">  </span><span class="s">&quot;admins&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">    </span><span class="s">&quot;cn=Administrators,cn=Builtin,dc=example,dc=com&quot;</span>
<span class="w">  </span><span class="p p-Indicator">],</span>
<span class="w">  </span><span class="s">&quot;remove_admins&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;users&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;remove_users&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">false</span>
<span class="p p-Indicator">}</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Mapping between team members (users) and LDAP groups. Keys are team names (will be created if not present). Values are dictionaries of options for each team’s membership, where each can contain the following parameters:</p>
<p><strong>organization</strong>: string. The name of the organization to which the team belongs. The team will be created if the combination of organization and team name does not exist. The organization will first be created if it does not exist.</p>
<p><strong>users</strong>: None, True/False, string or list/tuple of strings.</p>
<blockquote>
<div><ul class="simple">
<li><p>If <strong>None</strong>, team members will not be updated.</p></li>
<li><p>If <strong>True/False</strong>, all LDAP users will be added/removed as team members.</p></li>
<li><p>If a string or list of strings, specifies the group DN(s). User will be added as a team member if the user is a member of ANY of these groups.</p></li>
</ul>
</div></blockquote>
<p><strong>remove</strong>: True/False. Defaults to <strong>False</strong>. When <strong>True</strong>, a user who is not a member of the given groups will be removed from the team.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="s">&quot;LDAP</span><span class="nv"> </span><span class="s">Engineering&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">  </span><span class="s">&quot;organization&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;LDAP</span><span class="nv"> </span><span class="s">Organization&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;users&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;cn=engineering,ou=groups,dc=example,dc=com&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;remove&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span>
<span class="p p-Indicator">},</span>
<span class="s">&quot;LDAP</span><span class="nv"> </span><span class="s">IT&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">  </span><span class="s">&quot;organization&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;LDAP</span><span class="nv"> </span><span class="s">Organization&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;users&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;cn=it,ou=groups,dc=example,dc=com&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;remove&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span>
<span class="p p-Indicator">},</span>
<span class="s">&quot;LDAP</span><span class="nv"> </span><span class="s">Sales&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">  </span><span class="s">&quot;organization&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;LDAP</span><span class="nv"> </span><span class="s">Organization&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;users&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;cn=sales,ou=groups,dc=example,dc=com&quot;</span><span class="p p-Indicator">,</span>
<span class="w">  </span><span class="s">&quot;remove&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">true</span>
<span class="p p-Indicator">}</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
</section>
<section id="enabling-logging-for-ldap">
<span id="ldap-logging"></span><h4><span class="section-number">22.2. </span>Enabling Logging for LDAP<a class="headerlink" href="#enabling-logging-for-ldap" title="Link to this heading"></a></h4>
<p id="index-2">To enable logging for LDAP, you must set the level to <code class="docutils literal notranslate"><span class="pre">DEBUG</span></code> in the Settings configuration window:</p>
<ol class="arabic simple">
<li><p>Click <strong>Settings</strong> from the left navigation pane and click to select <strong>Logging settings</strong> from the System list of options.</p></li>
<li><p>Click <strong>Edit</strong>.</p></li>
<li><p>Set the <strong>Logging Aggregator Level Threshold</strong> field to <strong>Debug</strong>.</p></li>
</ol>
<img alt="_images/settings-system-logging-debug.png" src="_images/settings-system-logging-debug.png" />
<ol class="arabic simple" start="4">
<li><p>Click <strong>Save</strong> to save your changes.</p></li>
</ol>
</section>
<section id="referrals">
<h4><span class="section-number">22.3. </span>Referrals<a class="headerlink" href="#referrals" title="Link to this heading"></a></h4>
<p id="index-3">Active Directory uses “referrals” in case the queried object is not available in its database. It has been noted that this does not work properly with the django LDAP client and, most of the time, it helps to disable referrals. Disable LDAP referrals by adding the following lines to your <code class="docutils literal notranslate"><span class="pre">/etc/awx/conf.d/custom.py</span></code> file:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">AUTH_LDAP_GLOBAL_OPTIONS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span>
<span class="w">    </span>ldap.OPT_REFERRALS:<span class="w"> </span>False,
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="ldap-authentication-performance-tips">
<span id="ldap-auth-perf-tips"></span><h4><span class="section-number">22.4. </span>LDAP authentication performance tips<a class="headerlink" href="#ldap-authentication-performance-tips" title="Link to this heading"></a></h4>
<p id="index-4">When an LDAP user authenticates, by default, all user-related attributes will be updated in the database on each log in. In some environments, this operation can be skipped due to performance issues. To avoid it, you can disable the option <cite>AUTH_LDAP_ALWAYS_UPDATE_USER</cite>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>With this option set to False, no changes to LDAP user’s attributes will be updated. Attributes will only be updated the first time the user is created.</p>
</div>
</section>
</section>
<span id="document-administration/authentication_timeout"></span><section id="changing-the-default-timeout-for-authentication">
<h3><span class="section-number">23. </span>Changing the Default Timeout for Authentication<a class="headerlink" href="#changing-the-default-timeout-for-authentication" title="Link to this heading"></a></h3>
<p id="index-0">The default length of time, in seconds, that your supplied token is valid can be changed in the System Settings screen of the AWX user interface:</p>
<ol class="arabic simple">
<li><p>Click the <strong>Settings</strong> from the left navigation bar.</p></li>
</ol>
<ol class="arabic simple" start="3">
<li><p>Click <strong>Miscellaneous Authentication settings</strong> under the System settings.</p></li>
</ol>
<ol class="arabic simple" start="3">
<li><p>Click <strong>Edit</strong>.</p></li>
<li><p>Enter the timeout period in seconds in the <strong>Idle Time Force Log Out</strong> text field.</p></li>
</ol>
<img alt="Miscellaneous Authentication settings showing the Idle Time Force Logout field where you can adjust the token validity period." src="_images/configure-awx-system-timeout.png" />
<ol class="arabic simple" start="4">
<li><p>Click <strong>Save</strong> to apply your changes.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are accessing AWX directly and are having trouble getting your authentication to stay, in that you have to keep logging in over and over, try clearing your web browser’s cache. In situations like this, it is often found that the authentication token has been cached in the browser session and must be cleared.</p>
</div>
</section>
<span id="document-administration/kerberos_auth"></span><section id="user-authentication-with-kerberos">
<h3><span class="section-number">24. </span>User Authentication with Kerberos<a class="headerlink" href="#user-authentication-with-kerberos" title="Link to this heading"></a></h3>
<p id="index-0">User authentication via Active Directory (AD), also referred to as authentication through Kerberos, is supported through AWX.</p>
<p>To get started, first set up the Kerberos packages in AWX so that you can successfully generate a Kerberos ticket. To install the packages, use the following steps:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">yum install krb5-workstation</span>
<span class="l l-Scalar l-Scalar-Plain">yum install krb5-devel</span>
<span class="l l-Scalar l-Scalar-Plain">yum install krb5-libs</span>
</pre></div>
</div>
<p>Once installed, edit the <code class="docutils literal notranslate"><span class="pre">/etc/krb5.conf</span></code> file, as follows, to provide the address of the AD, the domain, etc.:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="nv">logging</span><span class="p p-Indicator">]</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default = FILE:/var/log/krb5libs.log</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kdc = FILE:/var/log/krb5kdc.log</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">admin_server = FILE:/var/log/kadmind.log</span>

<span class="l l-Scalar l-Scalar-Plain">[libdefaults]</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default_realm = WEBSITE.COM</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dns_lookup_realm = false</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dns_lookup_kdc = false</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ticket_lifetime = 24h</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">renew_lifetime = 7d</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">forwardable = true</span>

<span class="l l-Scalar l-Scalar-Plain">[realms]</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">WEBSITE.COM = {</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">kdc = WIN-SA2TXZOTVMV.website.com</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">admin_server = WIN-SA2TXZOTVMV.website.com</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">}</span>

<span class="l l-Scalar l-Scalar-Plain">[domain_realm]</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.website.com = WEBSITE.COM</span>
<span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">website.com = WEBSITE.COM</span>
</pre></div>
</div>
<p>After the configuration file has been updated, you should be able to successfully authenticate and get a valid token.
The following steps show how to authenticate and get a token:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="nv">root@ip-172-31-26-180 ~</span><span class="p p-Indicator">]</span><span class="c1"># kinit username</span>
<span class="nt">Password for username@WEBSITE.COM</span><span class="p">:</span>
<span class="p p-Indicator">[</span><span class="nv">root@ip-172-31-26-180 ~</span><span class="p p-Indicator">]</span><span class="c1">#</span>

<span class="l l-Scalar l-Scalar-Plain">Check if we got a valid ticket.</span>

<span class="p p-Indicator">[</span><span class="nv">root@ip-172-31-26-180 ~</span><span class="p p-Indicator">]</span><span class="c1"># klist</span>
<span class="nt">Ticket cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FILE:/tmp/krb5cc_0</span>
<span class="nt">Default principal</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">username@WEBSITE.COM</span>

<span class="l l-Scalar l-Scalar-Plain">Valid starting     Expires            Service principal</span>
<span class="l l-Scalar l-Scalar-Plain">01/25/16 11:42:56  01/25/16 21:42:53  krbtgt/WEBSITE.COM@WEBSITE.COM</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">renew until 02/01/16 11:42:56</span>
<span class="p p-Indicator">[</span><span class="nv">root@ip-172-31-26-180 ~</span><span class="p p-Indicator">]</span><span class="c1">#</span>
</pre></div>
</div>
<p>Once you have a valid ticket, you can check to ensure that everything is working as expected from command line. To test this, make sure that your inventory looks like the following:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">[</span><span class="nv">windows</span><span class="p p-Indicator">]</span>
<span class="l l-Scalar l-Scalar-Plain">win01.WEBSITE.COM</span>

<span class="l l-Scalar l-Scalar-Plain">[windows:vars]</span>
<span class="l l-Scalar l-Scalar-Plain">ansible_user = username@WEBSITE.COM</span>
<span class="l l-Scalar l-Scalar-Plain">ansible_connection = winrm</span>
<span class="l l-Scalar l-Scalar-Plain">ansible_port = 5986</span>
</pre></div>
</div>
<p>You should also:</p>
<ul class="simple">
<li><p>Ensure that the hostname is the proper client hostname matching the entry in AD and is not the IP address.</p></li>
<li><p>In the username declaration, ensure that the domain name (the text after <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>) is properly entered with regard to upper- and lower-case letters, as Kerberos is case sensitive. For AWX, you should also ensure that the inventory looks the same.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you encounter a <code class="docutils literal notranslate"><span class="pre">Server</span> <span class="pre">not</span> <span class="pre">found</span> <span class="pre">in</span> <span class="pre">Kerberos</span> <span class="pre">database</span></code> error message, and your inventory is configured using FQDNs (<strong>not IP addresses</strong>), ensure that the service principal name is not missing or mis-configured.</p>
</div>
<p>Now, running a playbook should run as expected. You can test this by running the playbook as the <code class="docutils literal notranslate"><span class="pre">awx</span></code> user.</p>
<p>Once you have verified that playbooks work properly, integration with AWX is easy. Generate the Kerberos ticket as the <code class="docutils literal notranslate"><span class="pre">awx</span></code> user and AWX should automatically pick up the generated ticket for authentication.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The python <code class="docutils literal notranslate"><span class="pre">kerberos</span></code> package must be installed. Ansible is designed to check if <code class="docutils literal notranslate"><span class="pre">kerberos</span></code> package is installed and, if so, it uses kerberos authentication.</p>
</div>
<section id="ad-and-kerberos-credentials">
<h4><span class="section-number">24.1. </span>AD and Kerberos Credentials<a class="headerlink" href="#ad-and-kerberos-credentials" title="Link to this heading"></a></h4>
<p>Active Directory only:</p>
<ul class="simple">
<li><p>If you are only planning to run playbooks against Windows machines with AD usernames and passwords as machine credentials, you can use “user&#64;&lt;domain&gt;” format for the username and an associated password.</p></li>
</ul>
<p>With Kerberos:</p>
<ul class="simple">
<li><p>If Kerberos is installed, you can create a machine credential with the username and password, using the “user&#64;&lt;domain&gt;” format for the username.</p></li>
</ul>
</section>
<section id="working-with-kerberos-tickets">
<h4><span class="section-number">24.2. </span>Working with Kerberos Tickets<a class="headerlink" href="#working-with-kerberos-tickets" title="Link to this heading"></a></h4>
<p>Ansible defaults to automatically managing Kerberos tickets when both the username and password are specified in the machine credential for a host that is configured for kerberos. A new ticket is created in a temporary credential cache for each host, before each task executes (to minimize the chance of ticket expiration). The temporary credential caches are deleted after each task, and will not interfere with the default credential cache.</p>
<p>To disable automatic ticket management (e.g., to use an existing SSO ticket or call <code class="docutils literal notranslate"><span class="pre">kinit</span></code> manually to populate the default credential cache), set <code class="docutils literal notranslate"><span class="pre">ansible_winrm_kinit_mode=manual</span></code> via the inventory.</p>
<p>Automatic ticket management requires a standard kinit binary on the control host system path. To specify a different location or binary name, set the <code class="docutils literal notranslate"><span class="pre">ansible_winrm_kinit_cmd</span></code> inventory variable to the fully-qualified path to an MIT krbv5 kinit-compatible binary.</p>
</section>
</section>
<span id="document-administration/session_limits"></span><section id="working-with-session-limits">
<span id="ag-session-limits"></span><h3><span class="section-number">25. </span>Working with Session Limits<a class="headerlink" href="#working-with-session-limits" title="Link to this heading"></a></h3>
<p id="index-0">Setting a session limit allows administrators to limit the number of simultaneous sessions per user or per IP address.</p>
<p>A session is created for each browser that a user uses to log in, which forces the user to log out any extra sessions after they exceed the administrator-defined maximum.</p>
<p>Session limits may be important, depending on your particular setup. For example, perhaps you only want a single user on your system with a single login per device (where the user could log in on his work laptop, phone, or home computer). In such a case, you would want to create a session limit equal to 1 (one). If the user logs in on his laptop, for example, then logs in using his phone, his laptop session expires (times out) and only the login on the phone persists. Proactive session limits will kick the user out when the session is idle. The default value is <strong>-1</strong>, which disables the maximum sessions allowed altogether, meaning you can have as many sessions without an imposed limit.</p>
<p>While session counts can be very limited, they can also be expanded to cover as many session logins as are needed by your organization.</p>
<p>When a user logs in and their login results in other users being logged out, the session limit has been reached and those users who are logged out are notified as to why the logout occurred.</p>
<p>To make changes to your session limits, navigate to the <strong>Miscellaneous System settings</strong> of the Settings menu and edit the <strong>Maximum Number Of Simultaneous Logged In Sessions</strong> setting or use the <a class="reference internal" href="index.html#api-browsable-api"><span class="std std-ref">Browsable API</span></a> if you are comfortable with making REST requests.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To make the best use of session limits, disable <code class="docutils literal notranslate"><span class="pre">AUTH_BASIC_ENABLED</span></code> by changing the value to <code class="docutils literal notranslate"><span class="pre">False</span></code>, as it falls outside of the scope of session limit enforcement. Alternatively, in the System Settings of the AWX UI, toggle the <strong>Enable HTTP Basic Auth</strong> to off.</p>
</div>
<img alt="_images/configure-awx-session-limits.png" src="_images/configure-awx-session-limits.png" />
</section>
<span id="document-administration/custom_rebranding"></span><section id="using-custom-logos-in-awx">
<span id="ag-custom-rebranding"></span><h3><span class="section-number">26. </span>Using Custom Logos in AWX<a class="headerlink" href="#using-custom-logos-in-awx" title="Link to this heading"></a></h3>
<p id="index-0">AWX supports the use of a custom logo and login message. You can add a custom logo by uploading an image; and supply a custom login message from the <strong>User Interface settings</strong> of the Settings menu.</p>
<img alt="Edit User Interface Settings form." src="_images/configure-awx-ui.png" />
<p>For the custom logo to look its best, use a <code class="docutils literal notranslate"><span class="pre">.png</span></code> file with a transparent background. GIF, PNG, and JPEG formats are supported.</p>
<p>If needed, you can add specific information (such as a legal notice or a disclaimer) to a text box in the login modal by
adding it to the <strong>Custom Login Info</strong> text field.</p>
<p>For example, if you uploaded a specific logo, and added the following text:</p>
<img alt="Edit User Interface Settings form populated with custom text and logo." src="_images/configure-awx-ui-logo-filled.png" />
<p>The Tower login dialog would look like this:</p>
<img alt="AWX login screen with custom text and logo." src="_images/configure-awx-ui-angry-spud-login.png" />
<p>Selecting <code class="docutils literal notranslate"><span class="pre">Revert</span></code> will result in the appearance of the standard automation controller logo.</p>
<img alt="AWX login screen with default AWX logo." src="_images/login-form.png" />
</section>
<span id="document-administration/troubleshooting"></span><section id="troubleshooting-awx">
<span id="admin-troubleshooting"></span><h3><span class="section-number">27. </span>Troubleshooting AWX<a class="headerlink" href="#troubleshooting-awx" title="Link to this heading"></a></h3>
<p id="index-0">Some troubleshooting tools are built in the AWX user interface that may help you address some issues you might encounter. To access these tools, navigate to <strong>Settings</strong> and select <strong>Troubleshooting</strong>.</p>
<img alt="_images/settings_troubleshooting_highlighted.png" src="_images/settings_troubleshooting_highlighted.png" />
<p>The options available are:</p>
<ul class="simple">
<li><p><strong>Enable or Disable tmp dir cleanup</strong>: choose whether you want to clean up the <code class="docutils literal notranslate"><span class="pre">tmp</span></code> directory.</p></li>
<li><p><strong>Debug Web Requests</strong>: choose whether you want web requests to log messages for debugging purposes.</p></li>
<li><p><strong>Release Receptor Work</strong>: disables cleaning up job pods. If you disable this, the jobs pods will remain in your cluster indefinitely, allowing you to examine them post-run. If you are missing data there, run <code class="docutils literal notranslate"><span class="pre">kubectl</span> <span class="pre">logs</span> <span class="pre">&lt;job-pod-name&gt;</span></code> and provide the logs in a issue report.</p></li>
</ul>
<img alt="_images/troubleshooting_options.png" src="_images/troubleshooting_options.png" />
<p>Click <strong>Edit</strong> to modify the settings. Use the toggle to enable and disable the appropriate settings.</p>
<section id="error-logging-and-extra-settings">
<span id="admin-troubleshooting-extra-settings"></span><h4><span class="section-number">27.1. </span>Error logging and extra settings<a class="headerlink" href="#error-logging-and-extra-settings" title="Link to this heading"></a></h4>
<p id="index-1">AWX server errors are streamed and not logged, however you may be able to pass them in on the AWX spec file.</p>
<p>With <code class="docutils literal notranslate"><span class="pre">extra_settings</span></code>, you can pass multiple custom settings via the <code class="docutils literal notranslate"><span class="pre">awx-operator</span></code>. The parameter <code class="docutils literal notranslate"><span class="pre">extra_settings</span></code>  will be appended to the <code class="docutils literal notranslate"><span class="pre">/etc/tower/settings.py</span></code> file and can be an alternative to the <code class="docutils literal notranslate"><span class="pre">extra_volumes</span></code> parameter.</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Name</p></td>
<td><p>Description</p></td>
<td><p>Default</p></td>
</tr>
<tr class="row-even"><td><p>extra_settings</p></td>
<td><p>Extra settings</p></td>
<td><p>‘’</p></td>
</tr>
</tbody>
</table>
<p>Parameters configured in <code class="docutils literal notranslate"><span class="pre">extra_settings</span></code> are set as read-only settings in AWX.  As a result, they cannot be changed in the UI after deployment. If you need to change the setting after the initial deployment, you need to change it on the AWX CR spec.</p>
<p>Example configuration of <code class="docutils literal notranslate"><span class="pre">extra_settings</span></code> parameter:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">extra_settings</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">setting</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MAX_PAGE_SIZE</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;500&quot;</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">setting</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AUTH_LDAP_BIND_DN</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;cn=admin,dc=example,dc=com&quot;</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">setting</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LOG_AGGREGATOR_LEVEL</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&#39;DEBUG&#39;&quot;</span>
</pre></div>
</div>
<p>For some settings, such as <code class="docutils literal notranslate"><span class="pre">LOG_AGGREGATOR_LEVEL</span></code>, the value may need double quotes as shown in the above example.</p>
</section>
<section id="sosreport">
<span id="admin-troubleshooting-sosreport"></span><h4><span class="section-number">27.2. </span>sosreport<a class="headerlink" href="#sosreport" title="Link to this heading"></a></h4>
<p id="index-2">The <code class="docutils literal notranslate"><span class="pre">sosreport</span></code> is a utility that collects diagnostic information for root cause analysis.</p>
</section>
<section id="problems-connecting-to-your-host">
<h4><span class="section-number">27.3. </span>Problems connecting to your host<a class="headerlink" href="#problems-connecting-to-your-host" title="Link to this heading"></a></h4>
<p id="index-3">If you are unable to run the <code class="docutils literal notranslate"><span class="pre">helloworld.yml</span></code> example playbook from the Quick Start Guide or other playbooks due to host connection errors, try the following:</p>
<ul class="simple">
<li><p>Can you <code class="docutils literal notranslate"><span class="pre">ssh</span></code> to your host? Ansible depends on SSH access to the servers you are managing.</p></li>
<li><p>Are your hostnames and IPs correctly added in your inventory file? (Check for typos.)</p></li>
</ul>
</section>
<section id="unable-to-login-to-awx-via-http">
<h4><span class="section-number">27.4. </span>Unable to login to AWX via HTTP<a class="headerlink" href="#unable-to-login-to-awx-via-http" title="Link to this heading"></a></h4>
<p>Access to AWX is intentionally restricted through a secure protocol (HTTPS). In cases where your configuration is set up to run an AWX node behind a load balancer or proxy as “HTTP only”, and you only want to access it without SSL (for troubleshooting, for example), you may change the settings of the <code class="docutils literal notranslate"><span class="pre">/etc/tower/conf.d</span></code> of your AWX instance. The operator has <code class="docutils literal notranslate"><span class="pre">extra_settings</span></code> that allows you to change a file-based setting in OCP. See <a class="reference internal" href="#admin-troubleshooting-extra-settings"><span class="std std-ref">Error logging and extra settings</span></a> for detail.</p>
<p>Once in the spec, set the following accordingly:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">SESSION_COOKIE_SECURE = False</span>
<span class="l l-Scalar l-Scalar-Plain">CSRF_COOKIE_SECURE = False</span>
</pre></div>
</div>
<p>Changing these settings to <code class="docutils literal notranslate"><span class="pre">False</span></code> will allow AWX to manage cookies and login sessions when using the HTTP protocol. This must be done on every node of a cluster installation to properly take effect.</p>
<p>To apply the changes, run:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">awx-service restart</span>
</pre></div>
</div>
</section>
<section id="websockets-port-for-live-events-not-working">
<h4><span class="section-number">27.5. </span>WebSockets port for live events not working<a class="headerlink" href="#websockets-port-for-live-events-not-working" title="Link to this heading"></a></h4>
<p id="index-4">AWX uses port 80/443 on the AWX server to stream live updates of playbook activity and other events to the client browser. These ports are configured for 80/443 by default, but if they are blocked by firewalls, close any firewall rules that opened up or added for the previous websocket ports, this will ensure your firewall allows traffic through this port.</p>
</section>
<section id="problems-running-a-playbook">
<h4><span class="section-number">27.6. </span>Problems running a playbook<a class="headerlink" href="#problems-running-a-playbook" title="Link to this heading"></a></h4>
<p id="index-5">If you are unable to run the <code class="docutils literal notranslate"><span class="pre">helloworld.yml</span></code> example playbook from the Quick Start Guide or other playbooks due to playbook errors, try the following:</p>
<ul class="simple">
<li><p>Are you authenticating with the user currently running the commands? If not, check how the username has been setup or pass the <code class="docutils literal notranslate"><span class="pre">--user=username</span></code> or <code class="docutils literal notranslate"><span class="pre">-u</span> <span class="pre">username</span></code> commands to specify a user.</p></li>
<li><p>Is your YAML file correctly indented? You may need to line up your whitespace correctly. Indentation level is significant in YAML. You can use <code class="docutils literal notranslate"><span class="pre">yamlint</span></code> to check your playbook. For more information, refer to the YAML primer at: <a class="reference external" href="http://docs.ansible.com/YAMLSyntax.html">http://docs.ansible.com/YAMLSyntax.html</a></p></li>
<li><p>Items beginning with a <code class="docutils literal notranslate"><span class="pre">-</span></code> are considered list items or plays. Items with the format of <code class="docutils literal notranslate"><span class="pre">key:</span> <span class="pre">value</span></code> operate as hashes or dictionaries. Ensure you don’t have extra or missing <code class="docutils literal notranslate"><span class="pre">-</span></code> plays.</p></li>
</ul>
</section>
<section id="problems-when-running-a-job">
<h4><span class="section-number">27.7. </span>Problems when running a job<a class="headerlink" href="#problems-when-running-a-job" title="Link to this heading"></a></h4>
<p id="index-6">If you are having trouble running a job from a playbook, you should review the playbook YAML file. When importing a playbook, either manually or via a source control mechanism, keep in mind that the host definition is controlled by AWX and should be set to <code class="docutils literal notranslate"><span class="pre">hosts:</span> <span class="pre">all</span></code>.</p>
</section>
<section id="playbooks-aren-t-showing-up-in-the-job-template-drop-down">
<h4><span class="section-number">27.8. </span>Playbooks aren’t showing up in the “Job Template” drop-down<a class="headerlink" href="#playbooks-aren-t-showing-up-in-the-job-template-drop-down" title="Link to this heading"></a></h4>
<p id="index-7">If your playbooks are not showing up in the Job Template drop-down list, here are a few things you can check:</p>
<ul class="simple">
<li><p>Make sure that the playbook is valid YML and can be parsed by Ansible.</p></li>
<li><p>Make sure the permissions and ownership of the project path (/var/lib/awx/projects) is set up so that the “awx” system user can view the files. You can run this command to change the ownership:</p></li>
</ul>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">chown awx -R /var/lib/awx/projects/</span>
</pre></div>
</div>
</section>
<section id="playbook-stays-in-pending">
<h4><span class="section-number">27.9. </span>Playbook stays in pending<a class="headerlink" href="#playbook-stays-in-pending" title="Link to this heading"></a></h4>
<p id="index-8">If you are attempting to run a playbook Job and it stays in the “Pending” state indefinitely, try the following:</p>
<ul class="simple">
<li><p>Ensure all supervisor services are running via <code class="docutils literal notranslate"><span class="pre">supervisorctl</span> <span class="pre">status</span></code>.</p></li>
<li><p>Check to ensure that the <code class="docutils literal notranslate"><span class="pre">/var/</span></code> partition has more than 1 GB of space available. Jobs will not complete with insufficient space on the <code class="docutils literal notranslate"><span class="pre">/var/</span></code> partition.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">awx-service</span> <span class="pre">restart</span></code> on the AWX server.</p></li>
</ul>
<p>If you continue to have problems, run <code class="docutils literal notranslate"><span class="pre">sosreport</span></code> as root on the AWX server, then file a <a class="reference external" href="http://support.ansible.com/">support request</a> with the result.</p>
</section>
<section id="cancel-an-awx-job">
<h4><span class="section-number">27.10. </span>Cancel an AWX job<a class="headerlink" href="#cancel-an-awx-job" title="Link to this heading"></a></h4>
<p id="index-9">When issuing a <code class="docutils literal notranslate"><span class="pre">cancel</span></code> request on a currently running AWX job, AWX issues a <code class="docutils literal notranslate"><span class="pre">SIGINT</span></code> to the <code class="docutils literal notranslate"><span class="pre">ansible-playbook</span></code> process. While this causes Ansible to stop dispatching new tasks and exit, in many cases, module tasks that were already dispatched to remote hosts will run to completion. This behavior is similar to pressing <code class="docutils literal notranslate"><span class="pre">Ctrl-C</span></code> during a command-line Ansible run.</p>
<p>With respect to software dependencies, if a running job is canceled, the job is essentially removed but the dependencies will remain.</p>
</section>
<section id="reusing-an-external-database-causes-installations-to-fail">
<h4><span class="section-number">27.11. </span>Reusing an external database causes installations to fail<a class="headerlink" href="#reusing-an-external-database-causes-installations-to-fail" title="Link to this heading"></a></h4>
<p id="index-10">Instances have been reported where reusing the external DB during subsequent installation of nodes causes installation failures.</p>
<p>For example, say that you performed a clustered installation. Next, say that you needed to do this again and performed a second clustered installation reusing the same external database, only this subsequent installation failed.</p>
<p>When setting up an external database which has been used in a prior installation, the database used for the clustered node must be manually cleared before any additional installations can succeed.</p>
</section>
<section id="private-ec2-vpc-instances-in-the-awx-inventory">
<h4><span class="section-number">27.12. </span>Private EC2 VPC Instances in the AWX Inventory<a class="headerlink" href="#private-ec2-vpc-instances-in-the-awx-inventory" title="Link to this heading"></a></h4>
<p id="index-11">By default, AWX only shows instances in a VPC that have an Elastic IP (EIP) associated with them. To see all of your VPC instances, perform the following steps:</p>
<ol class="arabic simple">
<li><p>In the AWX interface, select your inventory.</p></li>
<li><p>Click on the group that has the Source set to AWS, and click on the Source tab.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">Source</span> <span class="pre">Variables</span></code> box, enter:</p></li>
</ol>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">vpc_destination_variable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">private_ip_address</span>
</pre></div>
</div>
<p>Next, save and then trigger an update of the group. Once this is done, you should be able to see all of your VPC instances.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>AWX must be running inside the VPC with access to those instances if you want to configure them.</p>
</div>
</section>
<section id="troubleshooting-error-provided-hosts-list-is-empty">
<h4><span class="section-number">27.13. </span>Troubleshooting “Error: provided hosts list is empty”<a class="headerlink" href="#troubleshooting-error-provided-hosts-list-is-empty" title="Link to this heading"></a></h4>
<p id="index-12">If you receive the message “Skipping: No Hosts Matched” when you are trying to run a playbook through AWX, here are a few things to check:</p>
<ul class="simple">
<li><p>Make sure that your hosts declaration line in your playbook matches the name of your group/host in inventory exactly (these are case sensitive).</p></li>
<li><p>If it does match and you are using Ansible Core 2.0 or later, check your group names for spaces and modify them to use underscores or no spaces to ensure that the groups can be recognized.</p></li>
<li><p>Make sure that if you have specified a Limit in the Job Template that it is a valid limit value and still matches something in your inventory. The Limit field takes a pattern argument, described here: <a class="reference external" href="http://docs.ansible.com/intro_patterns.html">http://docs.ansible.com/intro_patterns.html</a></p></li>
</ul>
<p>Please file a support ticket if you still run into issues after checking these options.</p>
</section>
</section>
<span id="document-administration/tipsandtricks"></span><section id="awx-tips-and-tricks">
<span id="tips-and-tricks"></span><h3><span class="section-number">28. </span>AWX Tips and Tricks<a class="headerlink" href="#awx-tips-and-tricks" title="Link to this heading"></a></h3>
<nav class="contents local" id="contents">
<span id="index-0"></span><ul class="simple">
<li><p><a class="reference internal" href="#using-the-awx-cli-tool" id="id1">Using the AWX CLI Tool</a></p></li>
<li><p><a class="reference internal" href="#changing-the-awx-admin-password" id="id2">Changing the AWX Admin Password</a></p></li>
<li><p><a class="reference internal" href="#creating-an-awx-admin-from-the-commandline" id="id3">Creating an AWX Admin from the commandline</a></p></li>
<li><p><a class="reference internal" href="#setting-up-a-jump-host-to-use-with-awx" id="id4">Setting up a jump host to use with AWX</a></p></li>
<li><p><a class="reference internal" href="#view-ansible-outputs-for-json-commands-when-using-awx" id="id5">View Ansible outputs for JSON commands when using AWX</a></p></li>
<li><p><a class="reference internal" href="#locate-and-configure-the-ansible-configuration-file" id="id6">Locate and configure the Ansible configuration file</a></p></li>
<li><p><a class="reference internal" href="#view-a-listing-of-all-ansible-variables" id="id7">View a listing of all ansible_ variables</a></p></li>
<li><p><a class="reference internal" href="#the-allow-jinja-in-extra-vars-variable" id="id8">The ALLOW_JINJA_IN_EXTRA_VARS variable</a></p></li>
<li><p><a class="reference internal" href="#using-execution-environments" id="id9">Using execution environments</a></p></li>
<li><p><a class="reference internal" href="#configuring-the-awxhost-hostname-for-notifications" id="id10">Configuring the <code class="docutils literal notranslate"><span class="pre">awxhost</span></code> hostname for notifications</a></p></li>
<li><p><a class="reference internal" href="#launching-jobs-with-curl" id="id11">Launching Jobs with curl</a></p></li>
<li><p><a class="reference internal" href="#dynamic-inventory-and-private-ip-addresses" id="id12">Dynamic Inventory and private IP addresses</a></p></li>
<li><p><a class="reference internal" href="#filtering-instances-returned-by-the-dynamic-inventory-sources-in-awx" id="id13">Filtering instances returned by the dynamic inventory sources in AWX</a></p></li>
<li><p><a class="reference internal" href="#using-an-unreleased-module-from-ansible-source-with-awx" id="id14">Using an unreleased module from Ansible source with AWX</a></p></li>
<li><p><a class="reference internal" href="#using-callback-plugins-with-awx" id="id15">Using callback plugins with AWX</a></p></li>
<li><p><a class="reference internal" href="#connecting-to-windows-with-winrm" id="id16">Connecting to Windows with winrm</a></p></li>
<li><p><a class="reference internal" href="#importing-existing-inventory-files-and-host-group-vars-into-awx" id="id17">Importing existing inventory files and host/group vars into AWX</a></p></li>
</ul>
</nav>
<section id="using-the-awx-cli-tool">
<h4><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">28.1. </span>Using the AWX CLI Tool</a><a class="headerlink" href="#using-the-awx-cli-tool" title="Link to this heading"></a></h4>
<p id="index-1">AWX has a full-featured command line interface. Refer to <a class="reference external" href="https://docs.ansible.com/automation-controller/latest/html/controllercli/usage.html">AWX Command Line Interface</a>  documentation for configuration and usage instructions.</p>
<blockquote>
<div></div></blockquote>
</section>
<section id="changing-the-awx-admin-password">
<span id="tips-change-password"></span><h4><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">28.2. </span>Changing the AWX Admin Password</a><a class="headerlink" href="#changing-the-awx-admin-password" title="Link to this heading"></a></h4>
<p id="index-2">During the installation process, you are prompted to enter an administrator password which is used for the <code class="docutils literal notranslate"><span class="pre">admin</span></code> superuser/first user created in AWX. If you log into the instance via SSH, it will tell you the default admin password in the prompt. If you need to change this password at any point, run the following command as root on the AWX server:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">awx-manage changepassword admin</span>
</pre></div>
</div>
<p>Next, enter a new password. After that, the password you have entered will work as the admin password in the web UI.</p>
<p>To set policies at creation time for password validation using Django, see <a class="reference internal" href="index.html#ag-security-django-password"><span class="std std-ref">Django password policies</span></a> for detail.</p>
</section>
<section id="creating-an-awx-admin-from-the-commandline">
<h4><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">28.3. </span>Creating an AWX Admin from the commandline</a><a class="headerlink" href="#creating-an-awx-admin-from-the-commandline" title="Link to this heading"></a></h4>
<p id="index-3">Once in a while you may find it helpful to create an admin (superuser) account from the commandline. To create an admin, run the following command as root on the AWX server and enter in the admin information as prompted:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">awx-manage createsuperuser</span>
</pre></div>
</div>
</section>
<section id="setting-up-a-jump-host-to-use-with-awx">
<h4><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">28.4. </span>Setting up a jump host to use with AWX</a><a class="headerlink" href="#setting-up-a-jump-host-to-use-with-awx" title="Link to this heading"></a></h4>
<p id="index-4">Credentials supplied by AWX will not flow to the jump host via ProxyCommand. They are only used for the end-node once the tunneled connection is set up.</p>
<p>To make this work, configure a fixed user/keyfile in the AWX user’s SSH config in the ProxyCommand definition that sets up the connection through the jump host. For example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">Host tampa</span>
<span class="l l-Scalar l-Scalar-Plain">Hostname 10.100.100.11</span>
<span class="l l-Scalar l-Scalar-Plain">IdentityFile [privatekeyfile]</span>

<span class="l l-Scalar l-Scalar-Plain">Host 10.100..</span>
<span class="l l-Scalar l-Scalar-Plain">Proxycommand ssh -W [jumphostuser]@%h:%p tampa</span>
</pre></div>
</div>
<p>You can also add a jump host to your AWX instance through Inventory variables. These variables can be set at either the inventory, group, or host level. To add this, navigate to your inventory and in the <code class="docutils literal notranslate"><span class="pre">variables</span></code> field of whichever level you choose, add the following variables:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">ansible_user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;user_name&gt;</span>
<span class="nt">ansible_connection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ssh</span>
<span class="nt">ansible_ssh_common_args</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;-o</span><span class="nv"> </span><span class="s">ProxyCommand=&quot;ssh</span><span class="nv"> </span><span class="s">-W</span><span class="nv"> </span><span class="s">%h:%p</span><span class="nv"> </span><span class="s">-q</span><span class="nv"> </span><span class="s">&lt;user_name&gt;@&lt;jump_server_name&gt;&quot;&#39;</span>
</pre></div>
</div>
</section>
<section id="view-ansible-outputs-for-json-commands-when-using-awx">
<h4><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">28.5. </span>View Ansible outputs for JSON commands when using AWX</a><a class="headerlink" href="#view-ansible-outputs-for-json-commands-when-using-awx" title="Link to this heading"></a></h4>
<p id="index-5">When working with AWX, you can use the API to obtain the Ansible outputs for commands in JSON format.</p>
<p>To view the Ansible outputs, browse to:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">https://&lt;awx server name&gt;/api/v2/jobs/&lt;job_id&gt;/job_events/</span>
</pre></div>
</div>
</section>
<section id="locate-and-configure-the-ansible-configuration-file">
<h4><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">28.6. </span>Locate and configure the Ansible configuration file</a><a class="headerlink" href="#locate-and-configure-the-ansible-configuration-file" title="Link to this heading"></a></h4>
<p id="index-6">While Ansible does not require a configuration file, OS packages often include a default one in <code class="docutils literal notranslate"><span class="pre">/etc/ansible/ansible.cfg</span></code> for possible customization. In order to use a custom <code class="docutils literal notranslate"><span class="pre">ansible.cfg</span></code> file, place it at the root of your project. AWX runs <code class="docutils literal notranslate"><span class="pre">ansible-playbook</span></code> from the root of the project directory, where it will then find the custom <code class="docutils literal notranslate"><span class="pre">ansible.cfg</span></code> file. An <code class="docutils literal notranslate"><span class="pre">ansible.cfg</span></code> anywhere else in the project will be ignored.</p>
<p>To learn which values you can use in this file, refer to the <a class="reference external" href="https://github.com/ansible/ansible/blob/devel/examples/ansible.cfg">configuration file on github</a>.</p>
<p>Using the defaults are acceptable for starting out, but know that you can configure the default module path or connection type here, as well as other things.</p>
<p>AWX overrides some ansible.cfg options. For example, AWX stores the SSH ControlMaster sockets, the SSH agent socket, and any other per-job run items in a per-job temporary directory that is passed to the container used for job execution.</p>
</section>
<section id="view-a-listing-of-all-ansible-variables">
<h4><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">28.7. </span>View a listing of all ansible_ variables</a><a class="headerlink" href="#view-a-listing-of-all-ansible-variables" title="Link to this heading"></a></h4>
<p id="index-7">Ansible by default gathers “facts” about the machines under its management, accessible in Playbooks and in templates. To view all facts available about a machine, run the <code class="docutils literal notranslate"><span class="pre">setup</span></code> module as an ad hoc action:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">ansible -m setup hostname</span>
</pre></div>
</div>
<p>This prints out a dictionary of all facts available for that particular host. For more information, refer to: <a class="reference external" href="https://docs.ansible.com/ansible/playbooks_variables.html#information-discovered-from-systems-facts">https://docs.ansible.com/ansible/playbooks_variables.html#information-discovered-from-systems-facts</a></p>
</section>
<section id="the-allow-jinja-in-extra-vars-variable">
<span id="ag-tips-jinja-extravars"></span><h4><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">28.8. </span>The ALLOW_JINJA_IN_EXTRA_VARS variable</a><a class="headerlink" href="#the-allow-jinja-in-extra-vars-variable" title="Link to this heading"></a></h4>
<p>Setting <code class="docutils literal notranslate"><span class="pre">ALLOW_JINJA_IN_EXTRA_VARS</span> <span class="pre">=</span> <span class="pre">template</span></code> only works for saved job template extra variables. Prompted variables and survey variables are excluded from the ‘template’. This parameter has three values: <code class="docutils literal notranslate"><span class="pre">template</span></code> to allow usage of Jinja saved directly on a job template definition (the default), <code class="docutils literal notranslate"><span class="pre">never</span></code> to disable all Jinja usage (recommended), and <code class="docutils literal notranslate"><span class="pre">always</span></code> to always allow Jinja (strongly discouraged, but an option for prior compatibility).</p>
<p>This parameter is configurable in the Jobs Settings screen of the AWX UI:</p>
<img alt="_images/settings-jobs-jinja.png" src="_images/settings-jobs-jinja.png" />
</section>
<section id="using-execution-environments">
<h4><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">28.9. </span>Using execution environments</a><a class="headerlink" href="#using-execution-environments" title="Link to this heading"></a></h4>
<p id="index-8">See <a class="reference internal" href="index.html#ug-execution-environments"><span class="std std-ref">Execution Environments</span></a> in the <em>AWX User Guide</em>.</p>
</section>
<section id="configuring-the-awxhost-hostname-for-notifications">
<h4><a class="toc-backref" href="#id10" role="doc-backlink"><span class="section-number">28.10. </span>Configuring the <code class="docutils literal notranslate"><span class="pre">awxhost</span></code> hostname for notifications</a><a class="headerlink" href="#configuring-the-awxhost-hostname-for-notifications" title="Link to this heading"></a></h4>
<p id="index-9">In the <a class="reference internal" href="index.html#configure-awx-system"><span class="std std-ref">System Settings</span></a>, you can replace <code class="docutils literal notranslate"><span class="pre">https://awxhost</span></code> in the <strong>Base URL of the service</strong> field with your preferred hostname to change the notification hostname.</p>
<img alt="_images/configure-awx-system-misc-baseurl.png" src="_images/configure-awx-system-misc-baseurl.png" />
<p>New installations of AWX should not have to set the hostname for notifications.</p>
</section>
<section id="launching-jobs-with-curl">
<span id="launch-jobs-curl"></span><h4><a class="toc-backref" href="#id11" role="doc-backlink"><span class="section-number">28.11. </span>Launching Jobs with curl</a><a class="headerlink" href="#launching-jobs-with-curl" title="Link to this heading"></a></h4>
<p id="index-10">Launching jobs with AWX API is simple. Here are some easy to follow examples using the <code class="docutils literal notranslate"><span class="pre">curl</span></code> tool.</p>
<p>Assuming that your Job Template ID is ‘1’, your AWX IP is 192.168.42.100, and that <code class="docutils literal notranslate"><span class="pre">admin</span></code> and <code class="docutils literal notranslate"><span class="pre">awxsecret</span></code> are valid login credentials, you can create a new job this way:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">curl -f -k -H &#39;Content-Type</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/json&#39; -XPOST \</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">--user admin:awxsecret \</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">http://192.168.42.100/api/v2/job_templates/1/launch/</span>
</pre></div>
</div>
<p>This returns a JSON object that you can parse and use to extract the ‘id’ field, which is the ID of the newly created job.</p>
<p>You can also pass extra variables to the Job Template call, such as is shown in the following example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>curl -f -k -H &#39;Content-Type: application/json&#39; -XPOST \
    -d &#39;{&quot;extra_vars&quot;: &quot;{\&quot;foo\&quot;: \&quot;bar\&quot;}&quot;}&#39; \
    --user admin:awxsecret http://192.168.42.100/api/v2/job_templates/1/launch/
</pre></div>
</div>
<p>You can view the live API documentation by logging into <a class="reference external" href="http://192.168.42.100/api/">http://192.168.42.100/api/</a> and browsing around to the various objects available.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">extra_vars</span></code> parameter needs to be a string which contains JSON, not just a JSON dictionary, as you might expect. Use caution when escaping the quotes, etc.</p>
</div>
</section>
<section id="dynamic-inventory-and-private-ip-addresses">
<h4><a class="toc-backref" href="#id12" role="doc-backlink"><span class="section-number">28.12. </span>Dynamic Inventory and private IP addresses</a><a class="headerlink" href="#dynamic-inventory-and-private-ip-addresses" title="Link to this heading"></a></h4>
<p id="index-11">By default, AWX only shows instances in a VPC that have an Elastic IP (EIP) address associated with them. To view all of your VPC instances, perform the following steps:</p>
<ul class="simple">
<li><p>In the AWX interface, select your inventory.</p></li>
<li><p>Click on the group that has the Source set to AWS, and click on the Source tab.</p></li>
<li><p>In the “Source Variables” box, enter: <code class="docutils literal notranslate"><span class="pre">vpc_destination_variable:</span> <span class="pre">private_ip_address</span></code></p></li>
</ul>
<p>Save and trigger an update of the group. You should now be able to see all of your VPC instances.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>AWX must be running inside the VPC with access to those instances in order to usefully configure them.</p>
</div>
</section>
<section id="filtering-instances-returned-by-the-dynamic-inventory-sources-in-awx">
<h4><a class="toc-backref" href="#id13" role="doc-backlink"><span class="section-number">28.13. </span>Filtering instances returned by the dynamic inventory sources in AWX</a><a class="headerlink" href="#filtering-instances-returned-by-the-dynamic-inventory-sources-in-awx" title="Link to this heading"></a></h4>
<p id="index-12">By default, the dynamic inventory sources in AWX (AWS, Google, etc) return all instances available to the cloud credentials being used. They are automatically joined into groups based on various attributes. For example, AWS instances are grouped by region, by tag name and value, by security groups, etc. To target specific instances in your environment, write your playbooks so that they target the generated group names. For example:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tag_Name_webserver</span>
<span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
<p>You can also use the <code class="docutils literal notranslate"><span class="pre">Limit</span></code> field in the Job Template settings to limit a playbook run to a certain group, groups, hosts, or a combination thereof. The syntax is the same as the <code class="docutils literal notranslate"><span class="pre">--limit</span> <span class="pre">parameter</span></code> on the ansible-playbook command line.</p>
<p>You may also create your own groups by copying the auto-generated groups into your custom groups. Make sure that the <code class="docutils literal notranslate"><span class="pre">Overwrite</span></code> option is disabled on your dynamic inventory source, otherwise subsequent synchronization operations will delete and replace your custom groups.</p>
</section>
<section id="using-an-unreleased-module-from-ansible-source-with-awx">
<h4><a class="toc-backref" href="#id14" role="doc-backlink"><span class="section-number">28.14. </span>Using an unreleased module from Ansible source with AWX</a><a class="headerlink" href="#using-an-unreleased-module-from-ansible-source-with-awx" title="Link to this heading"></a></h4>
<p id="index-13">If there is a feature that is available in the latest Ansible core branch that you would like to leverage with your AWX system, making use of it in AWX is fairly simple.</p>
<p>First, determine which is the updated module you want to use from the available Ansible Core Modules or Ansible Extra Modules GitHub repositories.</p>
<p>Next, create a new directory, at the same directory level of your Ansible source playbooks, named <code class="docutils literal notranslate"><span class="pre">/library</span></code>.</p>
<p>Once this is created, copy the module you want to use and drop it into the <code class="docutils literal notranslate"><span class="pre">/library</span></code> directory–it will be consumed first over your system modules and can be removed once you have updated the stable version via your normal package manager.</p>
</section>
<section id="using-callback-plugins-with-awx">
<h4><a class="toc-backref" href="#id15" role="doc-backlink"><span class="section-number">28.15. </span>Using callback plugins with AWX</a><a class="headerlink" href="#using-callback-plugins-with-awx" title="Link to this heading"></a></h4>
<p id="index-14">Ansible has a flexible method of handling actions during playbook runs, called callback plugins. You can use these plugins with AWX to do things like notify services upon playbook runs or failures, send emails after every playbook run, etc. For official documentation on the callback plugin architecture, refer to: <a class="reference external" href="http://docs.ansible.com/developing_plugins.html#callbacks">http://docs.ansible.com/developing_plugins.html#callbacks</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>AWX does not support the <code class="docutils literal notranslate"><span class="pre">stdout</span></code> callback plugin because Ansible only allows one, and it is already being used by AWX for streaming event data.</p>
</div>
<p>You may also want to review some example plugins, which should be modified for site-specific purposes, such as those available at:
<a class="reference external" href="https://github.com/ansible/ansible/tree/devel/lib/ansible/plugins/callback">https://github.com/ansible/ansible/tree/devel/lib/ansible/plugins/callback</a></p>
<p>To use these plugins, put the callback plugin <code class="docutils literal notranslate"><span class="pre">.py</span></code> file into a directory called <code class="docutils literal notranslate"><span class="pre">/callback_plugins</span></code> alongside your playbook in your AWX Project. Then, specify their paths (one path per line) in the <strong>Ansible Callback Plugins</strong> field of the Job settings, located towards the bottom of the screen:</p>
<img alt="_images/configure-awx-jobs-callback.png" src="_images/configure-awx-jobs-callback.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To have most callbacks shipped with Ansible applied globally, you must add them to the <code class="docutils literal notranslate"><span class="pre">callback_whitelist</span></code> section of your <code class="docutils literal notranslate"><span class="pre">ansible.cfg</span></code>. If you have a custom callbacks, refer to the Ansible documentation for <a class="reference external" href="https://docs.ansible.com/ansible/latest/plugins/callback.html#enabling-callback-plugins">Enabling callback plugins</a>.</p>
</div>
</section>
<section id="connecting-to-windows-with-winrm">
<h4><a class="toc-backref" href="#id16" role="doc-backlink"><span class="section-number">28.16. </span>Connecting to Windows with winrm</a><a class="headerlink" href="#connecting-to-windows-with-winrm" title="Link to this heading"></a></h4>
<p id="index-15">By default AWX attempts to <code class="docutils literal notranslate"><span class="pre">ssh</span></code> to hosts. You must add the <code class="docutils literal notranslate"><span class="pre">winrm</span></code> connection info to the group variables to which the Windows hosts belong.  To get started, edit the Windows group in which the hosts reside and place the variables in the source/edit screen for the group.</p>
<p>To add <code class="docutils literal notranslate"><span class="pre">winrm</span></code> connection info:</p>
<p>Edit the properties for the selected group by clicking on the <img alt="edit" src="_images/edit-button.png" /> button to the right of the group name that contains the Windows servers.  In the “variables” section, add your connection information as such: <code class="docutils literal notranslate"><span class="pre">ansible_connection:</span> <span class="pre">winrm</span></code></p>
<p>Once done, save your edits. If Ansible was previously attempting an SSH connection and failed, you should re-run the job template.</p>
</section>
<section id="importing-existing-inventory-files-and-host-group-vars-into-awx">
<h4><a class="toc-backref" href="#id17" role="doc-backlink"><span class="section-number">28.17. </span>Importing existing inventory files and host/group vars into AWX</a><a class="headerlink" href="#importing-existing-inventory-files-and-host-group-vars-into-awx" title="Link to this heading"></a></h4>
<p id="index-16">To import an existing static inventory and the accompanying host and group vars into AWX, your inventory should be in a structure that looks similar to the following:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">inventory/</span>
<span class="l l-Scalar l-Scalar-Plain">|-- group_vars</span>
<span class="l l-Scalar l-Scalar-Plain">|   `-- mygroup</span>
<span class="l l-Scalar l-Scalar-Plain">|-- host_vars</span>
<span class="l l-Scalar l-Scalar-Plain">|   `-- myhost</span>
<span class="l l-Scalar l-Scalar-Plain">`-- hosts</span>
</pre></div>
</div>
<p>To import these hosts and vars, run the <code class="docutils literal notranslate"><span class="pre">awx-manage</span></code> command:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">awx-manage inventory_import --source=inventory/ \</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">--inventory-name=&quot;My AWX Inventory&quot;</span>
</pre></div>
</div>
<p>If you only have a single flat file of inventory, a file called ansible-hosts, for example, import it like the following:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">awx-manage inventory_import --source=./ansible-hosts \</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">--inventory-name=&quot;My AWX Inventory&quot;</span>
</pre></div>
</div>
<p>In case of conflicts or to overwrite an inventory named “My AWX Inventory”, run:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">awx-manage inventory_import --source=inventory/ \</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">--inventory-name=&quot;My AWX Inventory&quot; \</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">--overwrite --overwrite-vars</span>
</pre></div>
</div>
<p>If you receive an error, such as:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="nt">ValueError</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">need more than 1 value to unpack</span>
</pre></div>
</div>
<p>Create a directory to hold the hosts file, as well as the group_vars:</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">mkdir -p inventory-directory/group_vars</span>
</pre></div>
</div>
<p>Then, for each of the groups that have :vars listed, create a file called <code class="docutils literal notranslate"><span class="pre">inventory-directory/group_vars/&lt;groupname&gt;</span></code> and format the variables in YAML format.</p>
<p>Once broken out, the importer will handle the conversion correctly.</p>
</section>
</section>
</div>
</section>
<span id="document-upgrade_migration/index"></span><section id="upgrades-and-migrations">
<span id="upgrade-migration-start"></span><h2>Upgrades and Migrations<a class="headerlink" href="#upgrades-and-migrations" title="Link to this heading"></a></h2>
<p>Review important information before upgrading or migrating AWX deployments.</p>
<p>This guide applies to the latest version of AWX only.
The content in this guide is updated frequently and might contain functionality that is not available in previous versions.
Likewise content in this guide can be removed or replaced if it applies to functionality that is no longer available in the latest version.</p>
<p><strong>Join us online</strong></p>
<p>We talk about AWX documentation on Matrix at <a class="reference external" href="index.html#docs:ansible.im">#docs:ansible.im</a> and on libera IRC at <code class="docutils literal notranslate"><span class="pre">#ansible-docs</span></code> if you ever want to join us and chat about the docs!</p>
<p>You can also find lots of AWX discussion and get answers to questions at <a class="reference external" href="https://forum.ansible.com/">forum.ansible.com</a>.</p>
<div class="toctree-wrapper compound">
<span id="document-upgrade_migration/upgrade_considerations"></span><section id="upgrading-awx">
<h3><span class="section-number">1. </span>Upgrading AWX<a class="headerlink" href="#upgrading-awx" title="Link to this heading"></a></h3>
<p id="index-0">Refer to <a class="reference internal" href="index.html#ag-restart-awx"><span class="std std-ref">Starting, Stopping, and Restarting AWX</span></a> for detail.</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#upgrade-planning" id="id2">Upgrade Planning</a></p></li>
<li><p><a class="reference internal" href="#running-the-setup-playbook" id="id3">Running the Setup Playbook</a></p></li>
</ul>
</nav>
<section id="upgrade-planning">
<span id="id1"></span><h4><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">1.1. </span>Upgrade Planning</a><a class="headerlink" href="#upgrade-planning" title="Link to this heading"></a></h4>
<p>This section covers changes that you should keep in mind as you attempt to upgrade your AWX instance.</p>
<ul class="simple">
<li><p>Clustered upgrades require special attention to instance and instance groups prior to starting the upgrade. See <cite>:ref:`ag_clustering</cite> for details.</p></li>
</ul>
</section>
<section id="running-the-setup-playbook">
<h4><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">1.2. </span>Running the Setup Playbook</a><a class="headerlink" href="#running-the-setup-playbook" title="Link to this heading"></a></h4>
<p id="index-1">AWX setup playbook script uses the <code class="docutils literal notranslate"><span class="pre">inventory</span></code> file and is invoked as <code class="docutils literal notranslate"><span class="pre">./setup.sh</span></code> from the path where you unpacked the AWX installer tarball.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">root@localhost:~$ ./setup.sh</span>
</pre></div>
</div>
<p>The setup script takes the following arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-h</span></code> – Show this help message and exit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-i</span> <span class="pre">INVENTORY_FILE</span></code> – Path to Ansible inventory file (default: <code class="docutils literal notranslate"><span class="pre">inventory</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-e</span> <span class="pre">EXTRA_VARS</span></code> – Set additional Ansible variables as key=value or YAML/JSON (i.e. <code class="docutils literal notranslate"><span class="pre">-e</span> <span class="pre">bundle_install=false</span></code> forces an online installation)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-b</span></code> – Perform a database backup in lieu of installing</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-r</span></code> – Perform a database restore in lieu of installing (a default restore path is used unless EXTRA_VARS are provided with a non-default path, as shown in the code example below)</p></li>
</ul>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">./setup.sh -e &#39;restore_backup_file=/path/to/nondefault/location&#39; -r</span>
</pre></div>
</div>
</section>
</section>
<span id="document-upgrade_migration/upgrade_to_ees"></span><section id="upgrading-to-execution-environments">
<span id="upgrade-venv"></span><h3><span class="section-number">2. </span>Upgrading to Execution Environments<a class="headerlink" href="#upgrading-to-execution-environments" title="Link to this heading"></a></h3>
<p id="index-0">Refer to <a class="reference internal" href="index.html#ag-restart-awx"><span class="std std-ref">Starting, Stopping, and Restarting AWX</span></a> in the <em>AWX Administration Guide</em> and <a class="reference internal" href="index.html#ug-execution-environments"><span class="std std-ref">Execution Environments</span></a> in the <em>AWX User Guide</em> for detail.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When upgrading, it is highly recommended to always rebuild on top of the base execution environment that corresponds to the AWX version you are using. See <a class="reference internal" href="index.html#ug-build-ees"><span class="std std-ref">Building an Execution Environment</span></a> for more information.</p>
</div>
<section id="view-mesh-topology">
<span id="mesh-topology-ee"></span><h4><span class="section-number">2.1. </span>View mesh topology<a class="headerlink" href="#view-mesh-topology" title="Link to this heading"></a></h4>
<p id="index-1">If you configured a <a class="reference internal" href="index.html#term-Mesh"><span class="xref std std-term">mesh</span></a> topology, the installer can graphically validate your mesh configuration through a generated graph rendering tool. The graph is generated by reading the contents of the inventory file.</p>
<img alt="_images/mesh-topology-rendering.png" src="_images/mesh-topology-rendering.png" />
<p>Any given inventory file must include some sort of execution capacity that is governed by at least one control <a class="reference internal" href="index.html#term-Node"><span class="xref std std-term">node</span></a>. That is, it is unacceptable to produce an inventory file that only contains control-only nodes, execution-only nodes or hop-only nodes. There is a tightly coupled relationship between control and execution nodes that must be respected at all times. The installer will fail if the inventory files aren’t properly defined. The only exception to this rule would be a single hybrid node, as it will satisfy the control and execution constraints.</p>
<p>In order to run jobs on an execution node, either the installer needs to pre-register the node, or user needs to make a PATCH request to <code class="docutils literal notranslate"><span class="pre">/api/v2/instances/N/</span></code> to change the enabled field to true.</p>
<p>If you have already deployed a mesh topology and want to view node type, node health, and specific details about each node, see <a class="reference internal" href="index.html#ag-topology-viewer"><span class="std std-ref">Topology Viewer</span></a> in the <em>AWX Administration Guide</em>.</p>
</section>
</section>
</div>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-release_notes/index"></span><section id="release-notes">
<span id="releasenotes-start"></span><h2>Release Notes<a class="headerlink" href="#release-notes" title="Link to this heading"></a></h2>
<p>AWX release notes, known issues, and related reference materials.</p>
<p>This guide applies to the latest version of AWX only.
The content in this guide is updated frequently and might contain functionality that is not available in previous versions.
Likewise content in this guide can be removed or replaced if it applies to functionality that is no longer available in the latest version.</p>
<p><strong>Join us online</strong></p>
<p>We talk about AWX documentation on Matrix at <a class="reference external" href="index.html#docs:ansible.im">#docs:ansible.im</a> if you ever want to join us and chat about the docs!</p>
<p>You can also find lots of AWX discussion and get answers to questions on the <a class="reference external" href="https://forum.ansible.com/c/project/7/">Ansible Community Forum</a>.</p>
<div class="toctree-wrapper compound">
<span id="document-release_notes/relnotes"></span><section id="release-notes">
<span id="id1"></span><h3><span class="section-number">1. </span>Release Notes<a class="headerlink" href="#release-notes" title="Link to this heading"></a></h3>
<p id="index-0">Refer to <a class="reference external" href="https://github.com/ansible/awx/releases">AWX Release Notes</a>.</p>
</section>
<span id="document-release_notes/known_issues"></span><section id="known-issues">
<span id="ir-known-issues"></span><h3><span class="section-number">2. </span>Known Issues<a class="headerlink" href="#known-issues" title="Link to this heading"></a></h3>
<nav class="contents local" id="contents">
<span id="index-0"></span><ul class="simple">
<li><p><a class="reference internal" href="#the-csrf-trusted-origin-setting" id="id1">The <code class="docutils literal notranslate"><span class="pre">CSRF_TRUSTED_ORIGIN</span></code> setting</a></p></li>
<li><p><a class="reference internal" href="#launching-the-ansible-runner-component-not-working-as-expected" id="id2">Launching the ansible-runner component not working as expected</a></p></li>
<li><p><a class="reference internal" href="#deleted-default-orgs-produces-duplicate-ansible-galaxy-credentials" id="id3">Deleted default orgs produces duplicate Ansible-Galaxy credentials</a></p></li>
<li><p><a class="reference internal" href="#isolated-nodes-unsupported-in-an-openshift-deployment" id="id4">Isolated nodes unsupported in an OpenShift deployment</a></p></li>
<li><p><a class="reference internal" href="#browsers-ignoring-the-autocomplete-off-setting" id="id5">Browsers ignoring the <code class="docutils literal notranslate"><span class="pre">autocomplete=off</span></code> setting</a></p></li>
<li><p><a class="reference internal" href="#login-via-http-requires-workaround" id="id6">Login via HTTP requires workaround</a></p></li>
<li><p><a class="reference internal" href="#job-slicing-and-limit-interactions" id="id7">Job slicing and limit interactions</a></p></li>
<li><p><a class="reference internal" href="#misuse-of-job-slicing-can-cause-errors-in-job-scheduling" id="id8">Misuse of job slicing can cause errors in job scheduling</a></p></li>
<li><p><a class="reference internal" href="#default-ldap-directory-must-be-configured-to-use-ldap-authentication" id="id9">Default LDAP directory must be configured to use LDAP Authentication</a></p></li>
<li><p><a class="reference internal" href="#potential-security-issue-using-x-forwarded-for-in-remote-host-headers" id="id10">Potential security issue using <code class="docutils literal notranslate"><span class="pre">X_FORWARDED_FOR</span></code> in <code class="docutils literal notranslate"><span class="pre">REMOTE_HOST_HEADERS</span></code></a></p></li>
<li><p><a class="reference internal" href="#server-error-when-accessing-saml-metadata-via-hostname" id="id11">Server error when accessing SAML metadata via hostname</a></p></li>
<li><p><a class="reference internal" href="#saml-authentication-revokes-admin-role-upon-login" id="id12">SAML authentication revokes admin role upon login</a></p></li>
<li><p><a class="reference internal" href="#live-events-status-indicators" id="id13">Live events status indicators</a></p></li>
<li><p><a class="reference internal" href="#vmware-self-signed-certs" id="id14">VMWare Self-Signed Certs</a></p></li>
<li><p><a class="reference internal" href="#awx-manage-inventory-import-user" id="id15">awx-manage inventory_import user</a></p></li>
<li><p><a class="reference internal" href="#upgrading-existing-instance-groups-on-ocp-deployments" id="id16">Upgrading existing Instance Groups on OCP deployments</a></p></li>
<li><p><a class="reference internal" href="#database-on-disk-becomes-corrupted" id="id17">Database on Disk Becomes Corrupted</a></p></li>
<li><p><a class="reference internal" href="#local-management-not-functioning-as-expected" id="id18">Local management not functioning as expected</a></p></li>
<li><p><a class="reference internal" href="#problems-when-using-ssh-customization" id="id19">Problems when using SSH customization</a></p></li>
<li><p><a class="reference internal" href="#database-server-installed-on-nodes" id="id20">Database server installed on nodes</a></p></li>
<li><p><a class="reference internal" href="#reactivating-oauth-authentication-accounts-which-have-been-deleted" id="id21">Reactivating OAuth authentication accounts which have been deleted</a></p></li>
<li><p><a class="reference internal" href="#using-vaulted-variables-in-inventory-sourced-from-a-project" id="id22">Using vaulted variables in inventory sourced from a project</a></p></li>
<li><p><a class="reference internal" href="#saved-scheduled-and-workflow-configurations-and-surveys" id="id23">Saved scheduled and workflow configurations and surveys</a></p></li>
</ul>
</nav>
<section id="the-csrf-trusted-origin-setting">
<span id="ki-csrf-trusted-origin-setting"></span><h4><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">2.1. </span>The <code class="docutils literal notranslate"><span class="pre">CSRF_TRUSTED_ORIGIN</span></code> setting</a><a class="headerlink" href="#the-csrf-trusted-origin-setting" title="Link to this heading"></a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">CSRF_TRUSTED_ORIGIN</span></code> setting may be required if you are using AWX behind a load balancer. With the update to Django 4.2, CSRF (Cross Sight Request Forgery) checking is more strict. Because of this, using AWX behind a load balancer can cause issues when it previously worked. If you encounter an error like the following, you will need to add the sources to the <code class="docutils literal notranslate"><span class="pre">CSRF_TRUSTED_ORIGIN</span></code> settings.</p>
<div class="highlight-YAML+Jinja notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">WARNING [b336a554] django.security.csrf Forbidden (Origin checking failed - https://localhost:3001 does not match any trusted origins.)</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/api/login/</span>
</pre></div>
</div>
<p>Refer to the <a class="reference external" href="https://docs.djangoproject.com/en/4.2/ref/settings/#csrf-trusted-origins">Django csrf-trusted-origins documentation</a> for further detail on how to resolve this error.</p>
</section>
<section id="launching-the-ansible-runner-component-not-working-as-expected">
<h4><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">2.2. </span>Launching the ansible-runner component not working as expected</a><a class="headerlink" href="#launching-the-ansible-runner-component-not-working-as-expected" title="Link to this heading"></a></h4>
<p>A change was made to the way the ansible-runner component is launched (the executable inside of the execution environment that AWX launches to run a playbook), introduced a backward incompatibility. It is highly recommended to always rebuild on top of the base execution environments that corresponds to the AWX version you are using. This should be the ideal way to upgrade in general.</p>
</section>
<section id="deleted-default-orgs-produces-duplicate-ansible-galaxy-credentials">
<h4><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">2.3. </span>Deleted default orgs produces duplicate Ansible-Galaxy credentials</a><a class="headerlink" href="#deleted-default-orgs-produces-duplicate-ansible-galaxy-credentials" title="Link to this heading"></a></h4>
<p>Despite being able to run subsequent installs when deleting the default organization, it does not automatically remove or fix duplicate Ansible-Galaxy credentials.</p>
</section>
<section id="isolated-nodes-unsupported-in-an-openshift-deployment">
<h4><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">2.4. </span>Isolated nodes unsupported in an OpenShift deployment</a><a class="headerlink" href="#isolated-nodes-unsupported-in-an-openshift-deployment" title="Link to this heading"></a></h4>
<p>Isolated nodes are not currently supported when deploying AWX in OpenShift.</p>
</section>
<section id="browsers-ignoring-the-autocomplete-off-setting">
<h4><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">2.5. </span>Browsers ignoring the <code class="docutils literal notranslate"><span class="pre">autocomplete=off</span></code> setting</a><a class="headerlink" href="#browsers-ignoring-the-autocomplete-off-setting" title="Link to this heading"></a></h4>
<p>AWX leverages the <code class="docutils literal notranslate"><span class="pre">autocomplete=off</span></code> attribute on forms to relay to the browser that it should not autocomplete the fields within that form. In some scenarios, however, the browser may ignore this setting and attempt to save and/or autocomplete fields. This tends to happen on forms that appear to contain login fields like username and password, such as the <em>User</em> form and some <em>Settings</em> forms. Further investigation is underway to deliver options that prevent this behavior.</p>
</section>
<section id="login-via-http-requires-workaround">
<h4><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">2.6. </span>Login via HTTP requires workaround</a><a class="headerlink" href="#login-via-http-requires-workaround" title="Link to this heading"></a></h4>
<p>To access AWX nodes behind your load balancer (in traditional cluster AWX installs) via HTTP, refer to the procedure described in the <a class="reference internal" href="index.html#admin-troubleshooting"><span class="std std-ref">Troubleshooting AWX</span></a> of the <em>AWX Administration Guide</em>.</p>
</section>
<section id="job-slicing-and-limit-interactions">
<h4><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">2.7. </span>Job slicing and limit interactions</a><a class="headerlink" href="#job-slicing-and-limit-interactions" title="Link to this heading"></a></h4>
<p>When passing a limit to a Sliced Job, if the limit causes slices to have no hosts assigned, those slices will fail, causing the overall job to fail.</p>
</section>
<section id="misuse-of-job-slicing-can-cause-errors-in-job-scheduling">
<h4><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">2.8. </span>Misuse of job slicing can cause errors in job scheduling</a><a class="headerlink" href="#misuse-of-job-slicing-can-cause-errors-in-job-scheduling" title="Link to this heading"></a></h4>
<p>Job slicing is intended to scale job executions horizontally. Enabling job slicing on a job template divides an inventory to be acted upon in the number of slices configured at launch time and then starts a job for each slice.</p>
<p>It is expected that the number of slices will be equal to or less than the number of controller nodes. Setting an extremely high number of job slices (e.g., thousands), while allowed, can cause performance degradation as the job scheduler is not designed to schedule simultaneously thousands of workflow nodes, which are what the sliced jobs become.</p>
</section>
<section id="default-ldap-directory-must-be-configured-to-use-ldap-authentication">
<h4><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">2.9. </span>Default LDAP directory must be configured to use LDAP Authentication</a><a class="headerlink" href="#default-ldap-directory-must-be-configured-to-use-ldap-authentication" title="Link to this heading"></a></h4>
<p>The ability to configure up to six LDAP directories for authentication requires a value. On the settings page for LDAP, there is a “Default” LDAP configuration followed by five-numbered configuration slots. If the “Default” is not populated, AWX will not try to authenticate using the other directory configurations.</p>
</section>
<section id="potential-security-issue-using-x-forwarded-for-in-remote-host-headers">
<h4><a class="toc-backref" href="#id10" role="doc-backlink"><span class="section-number">2.10. </span>Potential security issue using <code class="docutils literal notranslate"><span class="pre">X_FORWARDED_FOR</span></code> in <code class="docutils literal notranslate"><span class="pre">REMOTE_HOST_HEADERS</span></code></a><a class="headerlink" href="#potential-security-issue-using-x-forwarded-for-in-remote-host-headers" title="Link to this heading"></a></h4>
<p>If placing AWX nodes behind some sort of proxy, this may pose a security issue. This approach assumes traffic is always flowing exclusively through your load balancer, and that traffic that circumvents the load balancer is suspect to <code class="docutils literal notranslate"><span class="pre">X-Forwarded-For</span></code> header spoofing.</p>
</section>
<section id="server-error-when-accessing-saml-metadata-via-hostname">
<h4><a class="toc-backref" href="#id11" role="doc-backlink"><span class="section-number">2.11. </span>Server error when accessing SAML metadata via hostname</a><a class="headerlink" href="#server-error-when-accessing-saml-metadata-via-hostname" title="Link to this heading"></a></h4>
<p>When AWX is accessed via hostname only (e.g. <a class="reference external" href="https://my-little-awx">https://my-little-awx</a>), trying to read the SAML metadata from /sso/metadata/saml/ generates a <code class="docutils literal notranslate"><span class="pre">sp_acs_url_invalid</span></code> server error.</p>
<p>A configuration in which uses SAML when accessing AWX via hostname only instead of an FQDN, is not supported. Doing so will generate an error that is captured in the browser with full traceback information.</p>
</section>
<section id="saml-authentication-revokes-admin-role-upon-login">
<h4><a class="toc-backref" href="#id12" role="doc-backlink"><span class="section-number">2.12. </span>SAML authentication revokes admin role upon login</a><a class="headerlink" href="#saml-authentication-revokes-admin-role-upon-login" title="Link to this heading"></a></h4>
<p>Older versions of AWX, the SAML adapter did not evaluate the System Auditor or System Admin roles for a user logging in. Because of this, the login process would not change a user’s system roles that were granted through the User Interface. The adapter now has a setting called <strong>SAML User Flags Attribute Mapping</strong> to grant users logging in these roles based on either SAML attributes or roles, and the adapter defaults to removing these roles if unspecified akin to the LDAP adapter. Refer to the <a class="reference internal" href="index.html#ag-auth-saml-user-flags-attr-map"><span class="std std-ref">logic table</span></a> that shows the relationship between how the role, attribute, and attribute value settings are configured and whether or not a user will be granted the System Admin/Auditor roles.</p>
</section>
<section id="live-events-status-indicators">
<h4><a class="toc-backref" href="#id13" role="doc-backlink"><span class="section-number">2.13. </span>Live events status indicators</a><a class="headerlink" href="#live-events-status-indicators" title="Link to this heading"></a></h4>
<p>Live events status dots are either seen as a red or orange dot at the top of AWX Dashboard when something goes wrong. They are not seen at all when the system is in a healthy state.  If you encounter a red or orange live events status indicator, even when your system seems fine, the following suggestions may offer a solution:</p>
<ul class="simple">
<li><p>Try manually refreshing/reloading your browser page.</p></li>
<li><p>Try changing web browsers, as Firefox and Safari have been reported to have issues trusting self-signed certificates.</p></li>
<li><p>Try creating a self-signed certificate that matches your DNS and import it into your trust manually.</p></li>
<li><p>Try using an incognito or private browsing session.</p></li>
<li><p>Try disabling your browser plugins to ensure none are blocking the service.</p></li>
</ul>
<p>Live event status dots are used for troubleshooting problems with your AWX instance. You can collect troubleshooting help by running a <code class="docutils literal notranslate"><span class="pre">sosreport</span></code>. As root, run the command <code class="docutils literal notranslate"><span class="pre">sosreport</span></code> from your system to automatically generate a diagnostic tar file, then contact Ansible’s Support team with the collected information for further assistance. For more information on <code class="docutils literal notranslate"><span class="pre">sosreport</span></code>, refer to <a class="reference internal" href="index.html#admin-troubleshooting-sosreport"><span class="std std-ref">sosreport</span></a> in the <em>AWX Administration Guide</em>.</p>
</section>
<section id="vmware-self-signed-certs">
<h4><a class="toc-backref" href="#id14" role="doc-backlink"><span class="section-number">2.14. </span>VMWare Self-Signed Certs</a><a class="headerlink" href="#vmware-self-signed-certs" title="Link to this heading"></a></h4>
<p>If you have a VMware instance that uses a self-signed certificate, then you will need to add the following to the <cite>Source Vars</cite> configuration of the Cloud Group:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&quot;source_vars&quot;: ---validate_certs: False
</pre></div>
</div>
<p>You can set this in inventory source for VMware vCenter as follows:</p>
<img alt="_images/ki-vmware-source-variables-example.png" src="_images/ki-vmware-source-variables-example.png" />
</section>
<section id="awx-manage-inventory-import-user">
<h4><a class="toc-backref" href="#id15" role="doc-backlink"><span class="section-number">2.15. </span>awx-manage inventory_import user</a><a class="headerlink" href="#awx-manage-inventory-import-user" title="Link to this heading"></a></h4>
<p>In general, the use of <code class="docutils literal notranslate"><span class="pre">awx-manage</span></code> commands is supported when executed by the root or awx user. However, even when run as the root user, the command <code class="docutils literal notranslate"><span class="pre">awx-manage</span> <span class="pre">inventory_import</span></code> may fail to authenticate with the private registry where the execution environments are hosted. The workaround is to run the command as the <code class="docutils literal notranslate"><span class="pre">awx</span></code> user, given that the images should be pre-pulled by the installer which correctly authenticates.</p>
</section>
<section id="upgrading-existing-instance-groups-on-ocp-deployments">
<h4><a class="toc-backref" href="#id16" role="doc-backlink"><span class="section-number">2.16. </span>Upgrading existing Instance Groups on OCP deployments</a><a class="headerlink" href="#upgrading-existing-instance-groups-on-ocp-deployments" title="Link to this heading"></a></h4>
<p>All job execution occurs in Container Groups are deployed on OpenShift. Creating new “normal” Instance Groups is disabled in the user interface, however upon upgrade, nothing happens to regular instance groups. This is a known issue because any resources that attempt to use the normal instance group that contains control plane pods as instances will have 0 capacity and jobs will stay in the pending state indefinitely. The workaround is to delete all of these “normal” instance groups. By default, there is a Container Group where job execution will occur in the same namespace as AWX pods are deployed. Additional capacity can be provided by configuring other Container Groups on the same or any other OpenShift cluster.</p>
</section>
<section id="database-on-disk-becomes-corrupted">
<h4><a class="toc-backref" href="#id17" role="doc-backlink"><span class="section-number">2.17. </span>Database on Disk Becomes Corrupted</a><a class="headerlink" href="#database-on-disk-becomes-corrupted" title="Link to this heading"></a></h4>
<p>If AWX is not cleanly shutdown, it leaves a <code class="docutils literal notranslate"><span class="pre">/var/lib/awx/beat.db</span></code> file on disk. If that happens, the dispatcher won’t start, and you must manually delete the <code class="docutils literal notranslate"><span class="pre">/var/lib/awx/beat.db</span></code> file and restart AWX before the dispatcher will start properly.</p>
</section>
<section id="local-management-not-functioning-as-expected">
<h4><a class="toc-backref" href="#id18" role="doc-backlink"><span class="section-number">2.18. </span>Local management not functioning as expected</a><a class="headerlink" href="#local-management-not-functioning-as-expected" title="Link to this heading"></a></h4>
<p>All playbooks are executed by AWX in a Linux container called an automation execution environment.</p>
<p>The use  of <code class="docutils literal notranslate"><span class="pre">delegate_to:</span> <span class="pre">localhost</span></code> or <code class="docutils literal notranslate"><span class="pre">local_action</span></code> to manage the executing host will not function in this environment, as it will still be executing inside the container.</p>
<p>To manage the local host where execution is running, you will need to use the ssh connection plugin to connect from the container to the local host.</p>
</section>
<section id="problems-when-using-ssh-customization">
<h4><a class="toc-backref" href="#id19" role="doc-backlink"><span class="section-number">2.19. </span>Problems when using SSH customization</a><a class="headerlink" href="#problems-when-using-ssh-customization" title="Link to this heading"></a></h4>
<p>The Job Isolation functionality in AWX limits the directories available for playbooks to the project that is in use. If you are attempting to customize SSH behavior by using a custom SSH configuration in the awx user’s home directory, this directory must be added to the list of directories exposed to the container.</p>
<p>For example, to add a custom SSH config in <code class="docutils literal notranslate"><span class="pre">/var/lib/awx/.ssh/config</span></code> and make it available for AWX jobs, you can specify the path in the <strong>Job Execution Isolation Path</strong> field accessed from the <strong>Jobs</strong> tab of the Settings screen:</p>
<img alt="_images/ki-job-isolation_path.png" src="_images/ki-job-isolation_path.png" />
</section>
<section id="database-server-installed-on-nodes">
<h4><a class="toc-backref" href="#id20" role="doc-backlink"><span class="section-number">2.20. </span>Database server installed on nodes</a><a class="headerlink" href="#database-server-installed-on-nodes" title="Link to this heading"></a></h4>
<p>All nodes in the cluster get a database server even if the nodes do not have a database. This is unexpected and may take up space.</p>
</section>
<section id="reactivating-oauth-authentication-accounts-which-have-been-deleted">
<h4><a class="toc-backref" href="#id21" role="doc-backlink"><span class="section-number">2.21. </span>Reactivating OAuth authentication accounts which have been deleted</a><a class="headerlink" href="#reactivating-oauth-authentication-accounts-which-have-been-deleted" title="Link to this heading"></a></h4>
<p>Once a user who logs in using social authentication has been deleted, the user will not be able to login again or be recreated until the system administrator runs a <code class="docutils literal notranslate"><span class="pre">cleanup_deleted</span></code> action with <code class="docutils literal notranslate"><span class="pre">days=0</span></code> to allow users to login again. Once <code class="docutils literal notranslate"><span class="pre">cleanup_deleted</span></code> has been run, AWX must be restarted. Accounts which have been deleted prior to having the <code class="docutils literal notranslate"><span class="pre">cleanup_deleted</span></code> action run will receive a “Your account is inactive” message upon trying to login.</p>
</section>
<section id="using-vaulted-variables-in-inventory-sourced-from-a-project">
<h4><a class="toc-backref" href="#id22" role="doc-backlink"><span class="section-number">2.22. </span>Using vaulted variables in inventory sourced from a project</a><a class="headerlink" href="#using-vaulted-variables-in-inventory-sourced-from-a-project" title="Link to this heading"></a></h4>
<p>When using inventory from a source control project, individual vaulted variable values are supported. Vaulted files are not currently supported.</p>
</section>
<section id="saved-scheduled-and-workflow-configurations-and-surveys">
<h4><a class="toc-backref" href="#id23" role="doc-backlink"><span class="section-number">2.23. </span>Saved scheduled and workflow configurations and surveys</a><a class="headerlink" href="#saved-scheduled-and-workflow-configurations-and-surveys" title="Link to this heading"></a></h4>
<p>If a configuration of a job template is scheduled or added to a workflow with answers from a prompted survey, changing the Job Template survey to supply different variable names may cause the saved configuration to not function. The workaround is to delete the saved schedule configuration/workflow node, and recreate it with answers from the updated survey.</p>
</section>
</section>
<span id="document-release_notes/supported_locales"></span><section id="supported-locales">
<h3><span class="section-number">3. </span>Supported Locales<a class="headerlink" href="#supported-locales" title="Link to this heading"></a></h3>
<p id="index-0">AWX supports the following locales for UTC-friendly date and time information.</p>
<p>AWX automatically sets the locale preference based on the user’s browser settings. For Safari, Internet Explorer, and older versions of Chrome as well as FireFox, this is handled automatically.</p>
<p>For newer versions of Chrome (v32 and later) and FireFox (v32 and later), AWX uses the language preferences set from your browser’s language settings. The browser lists the user’s preferred languages and selects the first in the array as the user’s top choice, which AWX uses as the preferred locale. This means that you can change your browser’s language and change your AWX locale preferences (although you may need to reload/refresh AWX in your browser to see this change.)</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">az</span></code> – Cyrillic</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bg</span></code> – Bulgarian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bs</span></code> – Bosnian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ca</span></code> – Catalan</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cs</span></code> – Czech</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">da</span></code> – Danish</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">de</span></code> – German</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">el</span></code> – Greek</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">en-gb</span></code> – English (United Kingdom)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">es</span></code> – Spanish</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">et</span></code> – Estonian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eu</span></code> – Basque</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fa</span></code> – Persian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fi</span></code> – Finnish</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fo</span></code> – Faroese</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fr</span></code> – French</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gl</span></code> – Galician</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">he</span></code> – Hebrew</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hr</span></code> – Croatian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hu</span></code> – Hungarian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> – Indonesian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is</span></code> – Icelandic</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">it</span></code> – Italian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ja</span></code> – Japanese</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ka</span></code> – Georgian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lt</span></code> – Lithuanian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lv</span></code> – Latvian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mk</span></code> – Macedonian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nb</span></code> – Norwegian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nl</span></code> – Dutch</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pl</span></code> – Polish</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pt-br</span></code> – Portuguese (Brazil)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pt</span></code> – Portuguese</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ro</span></code> – Romanian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ru</span></code> – Russian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sk</span></code> – Slovak</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sl</span></code> – Slovenian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sq</span></code> – Albanian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sr</span></code> – Serbian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sv</span></code> – Swedish</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">th</span></code> – Thai</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tr</span></code> – Turkish</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">uk</span></code> – Ukrainian</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vi</span></code> – Vietnamese</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zh-cn</span></code> – Chinese (simplified)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zh-tw</span></code> – Chinese (traditional)</p></li>
</ul>
</section>
</div>
<section id="copyright-red-hat-inc">
<h3>Copyright © Red Hat, Inc.<a class="headerlink" href="#copyright-red-hat-inc" title="Link to this heading"></a></h3>
<p>Ansible, Ansible Automation Platform, Red Hat, and Red Hat Enterprise Linux are trademarks of Red Hat, Inc., registered in the United States and other countries.</p>
<p>If you distribute this document, or a modified version of it, you must provide attribution to Red Hat, Inc. and provide a link to the original version.</p>
<p><strong>Third Party Rights</strong></p>
<p>Ubuntu and Canonical are registered trademarks of Canonical Ltd.</p>
<p>The CentOS Project is copyright protected. The CentOS Marks are trademarks of Red Hat, Inc. (“Red Hat”).</p>
<p>Microsoft, Windows, Windows Azure, and Internet Explore are trademarks of Microsoft, Inc.</p>
<p>VMware is a registered trademark or trademark of VMware, Inc.</p>
<p>Amazon Web Services”, “AWS”, “Amazon EC2”, and “EC2”, are trademarks of Amazon Web Services, Inc. or its affiliates.</p>
<p>OpenStack™ and OpenStack logo are trademarks of OpenStack, LLC.</p>
<p>Chrome™ and Google Compute Engine™ service registered trademarks of Google Inc.</p>
<p>Safari® is a registered trademark of Apple, Inc.</p>
<p>Firefox® is a registered trademark of the Mozilla Foundation.</p>
<p>All other trademarks are the property of their respective owners.</p>
</section>
</section>
</div>
</section>


           </div>
          </div>
          

<footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Red Hat.</p>
  </div>

  
   Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
  <a href="https://sphinx-ansible-theme.rtfd.io">Sphinx Ansible Theme</a>
  that is based on the
  <a href="https://github.com/readthedocs/sphinx_rtd_theme">Read the Docs theme</a>
  and is maintained by the <a href="https://docs.ansible.com/ansible/4/community/">Ansible Community</a>.


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script><!-- extra footer elements for Ansible beyond RTD Sphinx Theme -->

</body>
</html>